{"version":2,"updates":[{"id":0,"timestamp":1755721030385,"update":"AdYCmIXxzA8AJwEEYm90cyQzOTg4MDFmZS00YjM1LTRjZTQtODI2Zi0yMzgzNWMxYjlhYzUBJwCYhfHMDwAGc3lzdGVtAgQAmIXxzA8BFGFiLmFjdGlvbi5jcmVhdGVfYm90JwCYhfHMDwAIYWJBY3Rpb24CBACYhfHMDxYEdHJ1ZScAmIXxzA8ABGZvcm0CBACYhfHMDxsHbm90aGluZycAmIXxzA8AC2Rlc2NyaXB0aW9uAgQAmIXxzA8jDUNyZWF0ZXMgYm90cy4nAJiF8cwPABBhYkdyaWRNZW51QWN0aW9uAgQAmIXxzA8xsQVAY29uc3QgZ3JpZEluZm9ybWF0aW9uID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRGb2N1czsKY29uc3QgbmV3Qm90ID0ge307CgpuZXdCb3QuY3JlYXRvciA9IG51bGw7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uXSA9IHRydWU7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uICsgIlgiXSA9IGdyaWRJbmZvcm1hdGlvbi5wb3NpdGlvbi54OwpuZXdCb3RbZ3JpZEluZm9ybWF0aW9uLmRpbWVuc2lvbiArICJZIl0gPSBncmlkSW5mb3JtYXRpb24ucG9zaXRpb24ueTsKbmV3Qm90LmNvbG9yID0gbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKCmxldCBjcmVhdGVkQm90ID0gY3JlYXRlKG5ld0JvdCk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90Lm1hc2tzLmxpbmVDb2xvciA9IGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QubWFza3MubGluZVRvID0gY3JlYXRlZEJvdC5pZDsKCmxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQm90Rm9jdXMgPSAi8J+UlyIgKyBjcmVhdGVkQm90LmlkOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKHttZW51OiAiYm90In0pOycAmIXxzA8AD2FiR3JpZE1lbnVMYWJlbAIEAJiF8cwP4QUDYm90JwCYhfHMDwAOYWJHcmlkTWVudUljb24CBACYhfHMD+UFB2FkZF9ib3gnAJiF8cwPAAhyZW1lbWJlcgIEAJiF8cwP7QUo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycAmIXxzA8ADW1hbmlmZXN0YXRpb24CBACYhfHMD5QGKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAJiF8cwPAAhhYklnbm9yZQIEAJiF8cwPuwYEdHJ1ZScAmIXxzA8AE2FiR3JpZE1lbnVTb3J0T3JkZXICBACYhfHMD8AGATEnAJiF8cwPAAlhYlZlcnNpb24CBACYhfHMD8IGBDEwLjUnAJiF8cwPAAtwZXJzb25hbGl0eQIEAJiF8cwPxwYo8J+Ul2I3NmRmYmM0LTg1NGItNGY2ZC1hOTFmLWE5NDg2OTQ3NzRkYicBBGJvdHMkNTg0OWFmNTUtNWU4YS00OGQ2LTkxMDYtMTk5NDk4ZTllYzA4AScAmIXxzA/uBgZzeXN0ZW0CBACYhfHMD+8GEWFiLmFjdGlvbi5kZXN0cm95JwCYhfHMD+4GCGFiQWN0aW9uAgQAmIXxzA+BBwR0cnVlJwCYhfHMD+4GBGZvcm0CBACYhfHMD4YHB25vdGhpbmcnAJiF8cwP7gYPYWJCb3RNZW51QWN0aW9uAgQAmIXxzA+OB8ACQGNvbnN0IHRhcmdldEJvdCA9IHRoYXQuYm90LmxpbmtzLnRhcmdldEJvdDsKCmlmICh0aGF0LmJvdC5saW5rcy50YXJnZXRPcmlnaW5Cb3RzKSB7CiAgICAvLyBEZXN0cm95IGJvdHMgYmVsb25naW5nIHRvIGFiSURPcmlnaW4uCiAgICBkZXN0cm95KHRoYXQuYm90LmxpbmtzLnRhcmdldE9yaWdpbkJvdHMpOwp9IGVsc2UgewogICAgLy8gRGVzdHJveSB0aGUgc2luZ2xlIHRhcmdldCBib3QuCiAgICBkZXN0cm95KHRhcmdldEJvdCk7Cn0KCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soeyByZXNldDogdHJ1ZSB9KTsnAJiF8cwP7gYOYWJCb3RNZW51TGFiZWwCBACYhfHMD88JB2Rlc3Ryb3knAJiF8cwP7gYNYWJCb3RNZW51SWNvbgIEAJiF8cwP1wkOZGVsZXRlX2ZvcmV2ZXInAJiF8cwP7gYSYWJCb3RNZW51U29ydE9yZGVyAgQAmIXxzA/mCQMxMDAnAJiF8cwP7gYIcmVtZW1iZXICBACYhfHMD+oJKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAJiF8cwP7gYNbWFuaWZlc3RhdGlvbgIEAJiF8cwPkQoo8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcAmIXxzA/uBghhYklnbm9yZQIEAJiF8cwPuAoEdHJ1ZScAmIXxzA/uBg5hYkJvdE1lbnVDb2xvcgIEAJiF8cwPvQoHI0Q5MzAzMCcAmIXxzA/uBhdhYk11bHRpcGxlQm90TWVudUFjdGlvbgIEAJiF8cwPxQrAA0Bjb25zdCBhbGxUYXJnZXRCb3RzID0gQXJyYXkuaXNBcnJheShsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXMpID8gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzIDogW2xpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1c107CmNvbnN0IGJ1aWxkZXIgPSBhYi5saW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90ID8gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC5pZCA6IG51bGw7CmNvbnN0IHJlbGV2YW50VGFyZ2V0Qm90cyA9IGFsbFRhcmdldEJvdHMuZmlsdGVyKCh0YXJnZXQpID0+IHRhcmdldC5pZCAhPSBidWlsZGVyKTsKCmRlc3Ryb3kocmVsZXZhbnRUYXJnZXRCb3RzKTsKCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soeyByZXNldDogdHJ1ZSB9KTsnAJiF8cwP7gYVYWJNdWx0aXBsZUJvdE1lbnVJY29uAgQAmIXxzA+GDg5kZWxldGVfZm9yZXZlcicAmIXxzA/uBhZhYk11bHRpcGxlQm90TWVudUxhYmVsAgQAmIXxzA+VDgdkZXN0cm95JwCYhfHMD+4GGmFiTXVsdGlwbGVCb3RNZW51U29ydE9yZGVyAgQAmIXxzA+dDgMxMDAnAJiF8cwP7gYWYWJNdWx0aXBsZUJvdE1lbnVDb2xvcgIEAJiF8cwPoQ4HI0Q5MzAzMCcAmIXxzA/uBglhYlZlcnNpb24CBACYhfHMD6kOBDEwLjUnAJiF8cwP7gYTYWJCb3RNZW51T25HZW5lcmF0ZQIEAJiF8cwPrg6tB0Bjb25zdCB0YXJnZXRCb3QgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzOwoKaWYgKHRhcmdldEJvdCkgewogICAgdGFncy5sYWJlbCA9ICdkZXN0cm95JzsKICAgIHRhZ3MudGFyZ2V0Qm90ID0gZ2V0TGluayh0YXJnZXRCb3QpOwogICAgdGFncy5vbktleURvd24gPSBgQAogICAgICAgIGlmICh0aGF0LmtleXMuaW5jbHVkZXMoIlNoaWZ0IikpIHsKICAgICAgICAgICAgaWYgKGxpbmtzLnRhcmdldEJvdCAmJiBsaW5rcy50YXJnZXRCb3QudGFncy5hYklET3JpZ2luKSB7CiAgICAgICAgICAgICAgICAvLyBDaGFuZ2UgYnV0dG9uIHRvIGRlc3Ryb3kgYWxsIGJvdHMgd2l0aCBzYW1lIGFiSURPcmlnaW4uCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRPcmlnaW5Cb3RzID0gZ2V0Qm90cyhiID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYi50YWdzLmFiSURPcmlnaW4gPT09IGxpbmtzLnRhcmdldEJvdC50YWdzLmFiSURPcmlnaW47CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIG1hc2tzLmxhYmVsID0gJ2Rlc3Ryb3kgJyArIGxpbmtzLnRhcmdldEJvdC50YWdzLmFiSURPcmlnaW4gKyAnICgnICsgdGFyZ2V0T3JpZ2luQm90cy5sZW5ndGggKyAnIGJvdHMpJzsKICAgICAgICAgICAgICAgIHRhZ3MudGFyZ2V0T3JpZ2luQm90cyA9IGdldExpbmsodGFyZ2V0T3JpZ2luQm90cyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICBgOwogICAgdGFncy5vbktleVVwID0gYEAKICAgICAgICBpZiAodGhhdC5rZXlzLmluY2x1ZGVzKCJTaGlmdCIpKSB7CiAgICAgICAgICAgIG1hc2tzLmxhYmVsID0gbnVsbDsKICAgICAgICAgICAgdGFncy50YXJnZXRPcmlnaW5Cb3RzID0gbnVsbDsKICAgICAgICB9CiAgICBgOwp9IGVsc2UgewogICAgLy8gTm8gYm90IHRvIGRlc3Ryb3kuCiAgICBkZXN0cm95KHRoaXNCb3QpOwp9JwCYhfHMD+4GG2FiTXVsdGlwbGVCb3RNZW51T25HZW5lcmF0ZQIEAJiF8cwP3BXvBEBjb25zdCBhbGxUYXJnZXRCb3RzID0gQXJyYXkuaXNBcnJheShsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXMpID8gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzIDogW2xpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1c107CmNvbnN0IGJ1aWxkZXIgPSBhYi5saW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90ID8gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC5pZCA6IG51bGw7CmNvbnN0IHJlbGV2YW50VGFyZ2V0Qm90cyA9IGFsbFRhcmdldEJvdHMuZmlsdGVyKCh0YXJnZXQpID0+IHRhcmdldC5pZCAhPSBidWlsZGVyKTsKCmlmIChyZWxldmFudFRhcmdldEJvdHMubGVuZ3RoID4gMSkgewogICAgLy8gTXVsdGlwbGUgYm90cy4KICAgIHRhZ3MubGFiZWwgPSBgZGVzdHJveSAoJHtyZWxldmFudFRhcmdldEJvdHMubGVuZ3RofSBib3RzKWA7Cn0gZWxzZSBpZiAocmVsZXZhbnRUYXJnZXRCb3RzLmxlbmd0aCA9PT0gMSkgewogICAgLy8gU2luZ2xlIGJvdC4KICAgIHRhZ3MubGFiZWwgPSBgZGVzdHJveWA7Cn0gZWxzZSB7CiAgICAvLyBObyBib3RzIHRvIGRlc3Ryb3kuCiAgICBkZXN0cm95KHRoaXNCb3QpOwp9JwEEYm90cyQ2YjNkOTc0NC00NDQ4LTRlZjUtOTZhMi03MTI4MWM0MmFmNmMBJwCYhfHMD8waCWFiVmVyc2lvbgIEAJiF8cwPzRoEMTAuNScAmIXxzA/MGgZzeXN0ZW0CBACYhfHMD9IaEWFiLmFjdGlvbi52ZXJzaW9uJwCYhfHMD8waFGFiQWN0aW9uTWFqb3JWZXJzaW9uAgQAmIXxzA/kGgExJwCYhfHMD8waFGFiQWN0aW9uTWlub3JWZXJzaW9uAgQAmIXxzA/mGgE1JwCYhfHMD8waDW9uU2tpbGxVcGRhdGUCBACYhfHMD+gamQFAY29uc3QgdmVyc2lvblN0cmluZyA9IHRhZ3MuYWJBY3Rpb25NYWpvclZlcnNpb24gKyAiLiIgKyB0YWdzLmFiQWN0aW9uTWlub3JWZXJzaW9uOwoKY29uc29sZS5sb2coIltBQkFjdGlvbl0gTG9hZGVkIEFCIEFjdGlvbiB2ZXJzaW9uICIgKyB2ZXJzaW9uU3RyaW5nKTsnAJiF8cwPzBoIYWJJZ25vcmUCBACYhfHMD4IcBHRydWUnAJiF8cwPzBoIYWJBY3Rpb24CBACYhfHMD4ccBHRydWUnAJiF8cwPzBoEZm9ybQIEAJiF8cwPjBwHbm90aGluZycBBGJvdHMkNzE3NTY0NWMtNGI1My00NDU0LTg3MTYtZmMwZTY4ZGIyNjY1AScAmIXxzA+UHAZzeXN0ZW0CBACYhfHMD5UcD2FiLmFjdGlvbi5sb2dpbicAmIXxzA+UHAhhYkFjdGlvbgIEAJiF8cwPpRwEdHJ1ZScAmIXxzA+UHAhhYklnbm9yZQIEAJiF8cwPqhwEdHJ1ZScAmIXxzA+UHARmb3JtAgQAmIXxzA+vHAdub3RoaW5nJwCYhfHMD5QcD2FiQ29yZU1lbnVDb2xvcgIEAJiF8cwPtxwHI0YyQjcwNScAmIXxzA+UHBNhYkNvcmVNZW51U29ydE9yZGVyAgQAmIXxzA+/HAItNScAmIXxzA+UHBBhYkNvcmVNZW51QWN0aW9uAgQAmIXxzA/CHCxAb3MuZ29Ub1VSTChsaW5rcy5yZW1lbWJlci50YWdzLmFiQXV0aFNpdGUpOycAmIXxzA+UHBRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAJiF8cwP7xygAkBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKCFsaW5rcy5yZW1lbWJlci50YWdzLmFiQXV0aFNpdGUpCnsKICAgIGRlc3Ryb3kodGhpc0JvdCk7Cn0KCnRhZ3MubGFiZWwgPSAiYnV5ICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5OwoKaWYgKCFhdXRoQm90KQp7CiAgICByZXR1cm47Cn0KZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikKewogICAgcmV0dXJuOwp9CgpkZXN0cm95KHRoaXNCb3QpOycAmIXxzA+UHA5hYkNvcmVNZW51SWNvbgIEAJiF8cwPkB8OYWNjb3VudF9jaXJjbGUnAJiF8cwPlBwIcmVtZW1iZXICBACYhfHMD58fKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAJiF8cwPlBwJYWJWZXJzaW9uAgQAmIXxzA/GHwQxMC41JwCYhfHMD5QcC3BlcnNvbmFsaXR5AgQAmIXxzA/LHyjwn5SXYjc2ZGZiYzQtODU0Yi00ZjZkLWE5MWYtYTk0ODY5NDc3NGRiJwEEYm90cyRiMzM5YzExOC00ODlhLTQ2NmItYmE5Zi1iMDdhNWY5YjY2NGYBJwCYhfHMD/IfBnN5c3RlbQIEAJiF8cwP8x8PYWIuYWN0aW9uLnBhc3RlKACYhfHMD/IfCGFiQWN0aW9uAXgnAJiF8cwP8h8EZm9ybQIEAJiF8cwPhCAHbm90aGluZycAmIXxzA/yHwtkZXNjcmlwdGlvbgIEAJiF8cwPjCArYWIgc2tpbGwgdXNlZCBmb3IgY29weWluZyBhbmQgcGFzdGluZyBib3RzLicAmIXxzA/yHwdvblBhc3RlAgQAmIXxzA+4IP8HQGlmICghYnVpbGRlclZlcnNpb24pCnsKICAgIHJldHVybjsKfQoKY29uc3QgTUFDUk9TID0gWwogICAgewogICAgICAgIHRlc3Q6IC8oPzpb4oCc4oCdXSkvZywKICAgICAgICByZXBsYWNlbWVudDogKHZhbCkgPT4gJyInLAogICAgfSwKICAgIHsKICAgICAgICB0ZXN0OiAvKD86W+KAmOKAmV0pL2csCiAgICAgICAgcmVwbGFjZW1lbnQ6ICh2YWwpID0+ICInIiwKICAgIH0sCl07CgpsZXQgZm9ybWF0dGVkQ29weSA9IHJlcGxhY2VNYWNyb3ModGhhdC50ZXh0KTsKbGV0IGNvcHlCb3QgPSBKU09OLnBhcnNlKGZvcm1hdHRlZENvcHkpOwpsZXQgcGFzdGVkRGF0YSA9ICFjb3B5Qm90LnN0YXRlID8ge1tjb3B5Qm90LmlkXTogY29weUJvdH0gOiBjb3B5Qm90LnN0YXRlOwpsZXQgZGltTW9kID0gbGlua3MucmVtZW1iZXIudGFncy5hYkZvY3VzRGF0YTsKCmlmIChPYmplY3Qua2V5cyhwYXN0ZWREYXRhKS5sZW5ndGggPT0gMSAmJiBkaW1Nb2QpCnsKICAgIHBhc3RlZERhdGFbZGltTW9kLmRpbWVuc2lvbl0gPSB0cnVlOwogICAgcGFzdGVkRGF0YVtkaW1Nb2QuZGltZW5zaW9uKyJYIl0gPSBkaW1Nb2QueDsKICAgIHBhc3RlZERhdGFbZGltTW9kLmRpbWVuc2lvbisiWSJdID0gZGltTW9kLnk7CgogICAgb3MudG9hc3QoImJvdCBhZGRlZCB0byBpbnN0Iik7Cn0KZWxzZQp7CiAgICBvcy50b2FzdCgiYm90cyBhZGRlZCB0byBpbnN0Iik7Cn0KCmFiLmxvZyhsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogcGFzdGVkIGRhdGEiKTsKCmxpbmtzLmNyZWF0ZS5hYkNyZWF0ZUJvdHMoe2JvdHM6IHBhc3RlZERhdGEsIHNvdXJjZUV2ZW50OiAncGFzdGUnfSk7CgpmdW5jdGlvbiByZXBsYWNlTWFjcm9zKHRleHQpIHsKICAgIGlmICghdGV4dCkgewogICAgICAgIHJldHVybiB0ZXh0OwogICAgfQoKICAgIGZvciAobGV0IG0gb2YgTUFDUk9TKSB7CiAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZShtLnRlc3QsIG0ucmVwbGFjZW1lbnQpOwogICAgfQoKICAgIHJldHVybiB0ZXh0Owp9JwCYhfHMD/IfCHJlbWVtYmVyAgQAmIXxzA+wKCjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwCYhfHMD/IfBmNyZWF0ZQIEAJiF8cwP1ygo8J+UlzM0YzNjMjEwLTViZjEtNDljZi1iMTUxLWVlMmQwN2YwZTY3MycAmIXxzA/yHwhhYklnbm9yZQIEAJiF8cwP/igEdHJ1ZScAmIXxzA/yHwlvbktleURvd24CBACYhfHMD4MpuglAaWYgKCFidWlsZGVyVmVyc2lvbiB8fCAoIWxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiQm90Rm9jdXMgJiYgIWxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1cykpCnsKICAgIHJldHVybjsKfQoKaWYgKHRoYXQua2V5cyA9PSAiYyIpCnsKICAgIGxldCBtZXRhSW5wdXQgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJNZXRhIik7CgogICAgaWYgKCFtZXRhSW5wdXQpCiAgICB7CiAgICAgICAgbWV0YUlucHV0ID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiQ29udHJvbCIpOwogICAgfQogICAgCiAgICBpZiAoIW1ldGFJbnB1dCkKICAgIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IGZvcm1hdHRlZEZpbGU7CiAgICBsZXQgc3RhdGUgPSB7fTsKCiAgICBpZiAobGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1cykKICAgIHsKICAgICAgICBsZXQgc2VsZWN0ZWRCb3QgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzOwoKICAgICAgICBzdGF0ZVtzZWxlY3RlZEJvdC5pZF0gPSBzZWxlY3RlZEJvdDsKCiAgICAgICAgYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBjb3BpZWQgYSBib3QgdG8gY2xpcGJvYXJkIik7CiAgICB9CiAgICBlbHNlIGlmIChsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXMpCiAgICB7CiAgICAgICAgbGV0IHNlbGVjdGVkQm90cyA9IGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1czsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3RlZEJvdHMubGVuZ3RoOyBpKyspCiAgICAgICAgewogICAgICAgICAgICBzdGF0ZVtzZWxlY3RlZEJvdHNbaV0uaWRdID0gc2VsZWN0ZWRCb3RzW2ldOwogICAgICAgIH0KCiAgICAgICAgYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBjb3BpZWQgbXVsdGlwbGUgYm90cyB0byBjbGlwYm9hcmQiKTsKICAgIH0KCiAgICBsZXQgbmV3RmlsZSA9IHt9OwogICAgbmV3RmlsZS52ZXJzaW9uID0gMTsKICAgIG5ld0ZpbGUuc3RhdGUgPSBzdGF0ZTsKCiAgICBmb3JtYXR0ZWRGaWxlID0gSlNPTi5zdHJpbmdpZnkobmV3RmlsZSk7CgogICAgb3Muc2V0Q2xpcGJvYXJkKGZvcm1hdHRlZEZpbGUpOwoKICAgIG9zLnRvYXN0KCJib3QgY29waWVkIHRvIGNsaXBib2FyZCIpOwp9JwCYhfHMD/IfCWFiVmVyc2lvbgIEAJiF8cwPvjIEMTAuNScAmIXxzA/yHwtwZXJzb25hbGl0eQIEAJiF8cwPwzIo8J+Ul2I3NmRmYmM0LTg1NGItNGY2ZC1hOTFmLWE5NDg2OTQ3NzRkYicBBGJvdHMkYmRhYmQ2YzAtODlmOS00Zjc1LWIzNWMtMjZmNGVjNTIwN2Q2AScAmIXxzA/qMgZzeXN0ZW0CBACYhfHMD+syEGFiLmFjdGlvbi5yZXBvcnQnAJiF8cwP6jIEZm9ybQIEAJiF8cwP/DIHbm90aGluZycAmIXxzA/qMhBhYkNvcmVNZW51QWN0aW9uAgQAmIXxzA+EMxFAb3MucmVwb3J0SW5zdCgpOycAmIXxzA/qMhNhYkNvcmVNZW51U29ydE9yZGVyAgQAmIXxzA+WMwMxMDEnAJiF8cwP6jIOYWJDb3JlTWVudUljb24CBACYhfHMD5ozBGZsYWcnAJiF8cwP6jIPYWJDb3JlTWVudUxhYmVsAgQAmIXxzA+fMwZyZXBvcnQnAJiF8cwP6jIIYWJBY3Rpb24CBACYhfHMD6YzBHRydWUnAJiF8cwP6jIIYWJJZ25vcmUCBACYhfHMD6szBHRydWUnAJiF8cwP6jIUYWJDb3JlTWVudU9uR2VuZXJhdGUCBACYhfHMD7AzRkBpZiAoY29uZmlnQm90LnRhZ3Muc3RhdGljSW5zdCAhPSB1bmRlZmluZWQpCnsKICAgIGRlc3Ryb3kodGhpc0JvdCk7Cn0nAJiF8cwP6jIJYWJWZXJzaW9uAgQAmIXxzA/3MwQxMC41JwEEYm90cyRjNjhjNWI4Mi1jMGE3LTRhNWEtOTEwNC01ZGQ4ZTMyYWU0ZTIBJwCYhfHMD/wzBnN5c3RlbQIEAJiF8cwP/TMQYWIuYWN0aW9uLnBvcnRhbCcAmIXxzA/8MwtkZXNjcmlwdGlvbgIEAJiF8cwPjjQUU2tpbGwgdG8gb3BlbiBzaGVldC4nAJiF8cwP/DMIYWJBY3Rpb24CBACYhfHMD6M0BHRydWUnAJiF8cwP/DMEZm9ybQIEAJiF8cwPqDQHbm90aGluZycAmIXxzA/8MxBhYkNvcmVNZW51QWN0aW9uAgQAmIXxzA+wNANALy8nAJiF8cwP/DMIcmVtZW1iZXICBACYhfHMD7Q0KPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAJiF8cwP/DMPYWJDb3JlTWVudUxhYmVsAgQAmIXxzA/bNBBjdXJyZW50IHBvcnRhbDogJwCYhfHMD/wzD2FiQm90TWVudUFjdGlvbgIEAJiF8cwP7DT4AkBjb25zdCBjdXJyZW50SW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7CmNvbnN0IGN1cnJlbnREaW0gPSBsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90LnRhZ3MubGluZVRvOwpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CgppZiAoc3RhdGUpIAp7CiAgICBvcy5vcGVuVVJMKGNvbmZpZ0JvdC50YWdzLnBlcm1hbGluayArIGAmc2hlZXRQb3J0YWw9JHtjdXJyZW50RGltfWApOwp9CmVsc2UKewogICAgY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwgPSBjdXJyZW50RGltOwp9CgphYi5sb2cobGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6IG9wZW5lZCBib3Qgc2hlZXQiKTsnAJiF8cwP/DMOYWJCb3RNZW51TGFiZWwCBACYhfHMD+U3Dm9wZW4gYm90IHNoZWV0JwCYhfHMD/wzDW1hbmlmZXN0YXRpb24CBACYhfHMD/Q3KPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAJiF8cwP/DMNYWJCb3RNZW51SWNvbgIEAJiF8cwPmzgKdGFibGVfdmlldycAmIXxzA/8Mw5hYkNvcmVNZW51SWNvbgIEAJiF8cwPpjgLYXJyb3dfcmlnaHQnAJiF8cwP/DMSYWJCb3RNZW51U29ydE9yZGVyAgQAmIXxzA+yOAExJwCYhfHMD/wzCGFiSWdub3JlAgQAmIXxzA+0OAR0cnVlJwCYhfHMD/wzF2FiTXVsdGlwbGVCb3RNZW51QWN0aW9uAgQAmIXxzA+5OJsEQGNvbnN0IGN1cnJlbnRJbnN0ID0gb3MuZ2V0Q3VycmVudEluc3QoKTsKY29uc3QgY3VycmVudERpbSA9ICJhYk11bHRpcGxlU2VsZWN0IjsKCmNvbmZpZ0JvdC50YWdzLnNoZWV0UG9ydGFsID0gY3VycmVudERpbTsKCnNldFRhZ01hc2sobGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzLCBjdXJyZW50RGltLCB0cnVlLCAidGVtcExvY2FsIik7CgptYXNrcy5jdXJyZW50U2hlZXRCb3RzID0gbGlua3MucmVtZW1iZXIudGFncy5hYk11bHRpcGxlQm90Rm9jdXM7Cm1hc2tzLm9uUG9ydGFsQ2hhbmdlZCA9IGBAIGlmICh0aGF0LmRpbWVuc2lvbiAhPSAiYWJNdWx0aXBsZVNlbGVjdCIgJiYgdGhhdC5wb3J0YWwgPT0gInNoZWV0UG9ydGFsIikKewogICAgY2xlYXJUYWdNYXNrcyhsaW5rcy5jdXJyZW50U2hlZXRCb3RzKTsKCiAgICBjbGVhclRhZ01hc2tzKHRoaXNCb3QpOwp9IGA7CgphYi5sb2cobGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6IG9wZW5lZCBtdWx0aXBsZSBzZWxlY3Qgc2hlZXQiKTsnAJiF8cwP/DMWYWJNdWx0aXBsZUJvdE1lbnVMYWJlbAIEAJiF8cwP1Twab3BlbiBtdWx0aXBsZSBzZWxlY3Qgc2hlZXQnAJiF8cwP/DMVYWJNdWx0aXBsZUJvdE1lbnVJY29uAgQAmIXxzA/wPAp0YWJsZV92aWV3JwCYhfHMD/wzE2FiQm90TWVudU9uR2VuZXJhdGUCBACYhfHMD/s8mAJAbGV0IHNlbGVjdGVkQm90ID0gbGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC50YWdzLmxpbmVUbzsKCnRhZ3MubGFiZWwgPSAic2hlZXRQb3J0YWw9IiArIHNlbGVjdGVkQm90LnN1YnN0cmluZygwLCA0KTsKCnRhZ3Mub25LZXlEb3duID0gYEAgaWYodGhhdC5rZXlzID09ICJTaGlmdCIpe21hc2tzLmxhYmVsID0gdGFncy5sYWJlbCArICIgaW4gbmV3IHRhYiI7fWA7CnRhZ3Mub25LZXlVcCA9IGBAIGlmKHRoYXQua2V5cyA9PSAiU2hpZnQiKXttYXNrcy5sYWJlbCA9IG51bGw7fWA7JwCYhfHMD/wzGmFiTXVsdGlwbGVCb3RNZW51U29ydE9yZGVyAgQAmIXxzA+UPwEwJwCYhfHMD/wzBG1lbnUCBACYhfHMD5Y/KPCflJdiMzBjNmM1ZC1hNGY3LTQyNjYtYmEzOC0zOTNkYzk1ZTFlY2InAJiF8cwP/DMJYWJWZXJzaW9uAgQAmIXxzA+9PwQxMC41JwCYhfHMD/wzC2FiQmx1ZXByaW50AgQAmIXxzA/CP/sDQGNvbnN0IGJhY2tncm91bmRDb2xvciA9IGxpbmtzLnJlbWVtYmVyPy50YWdzLmFiQmx1ZXByaW50Q29sb3IgPz8gIiMxNzg1QjUiOwoKaWYgKGJhY2tncm91bmRDb2xvciA9PSBncmlkUG9ydGFsQm90Lm1hc2tzLnBvcnRhbENvbG9yKQp7CiAgICByZXR1cm47Cn0KCmdyaWRQb3J0YWxCb3QubWFza3MucG9ydGFsQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3I7CgptYXNrcy5vblBvcnRhbENoYW5nZWQgPSBgQCBpZiAodGhhdC5wb3J0YWwgPT0gImdyaWRQb3J0YWwiICYmIHRoYXQuZGltZW5zaW9uICE9ICJibHVlcHJpbnQiKXsKICAgIC8vIGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQmFzZUNvbG9yID0gbnVsbDsKICAgIC8vIGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQmFzZVN0cm9rZUNvbG9yID0gbnVsbDsKCiAgICBncmlkUG9ydGFsQm90Lm1hc2tzLnBvcnRhbENvbG9yID0gbnVsbDsKCiAgICBtYXNrcy5vblBvcnRhbENoYW5nZWQgPSBudWxsOwp9YDsKCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7JwCYhfHMD/wzC29uQW55Q3JlYXRlAgQAmIXxzA++Q3ZAaWYgKHRoYXQuYm90LnRhZ3MuYmx1ZXByaW50KQp7CiAgICB0aGF0LmJvdC50YWdzLnN0cm9rZUNvbG9yID0gIiNmZmZmZmYiOwogICAgdGhhdC5ib3QudGFncy5sYWJlbENvbG9yID0gIiNmZmZmZmYiOwp9JwCYhfHMD/wzD29uUG9ydGFsQ2hhbmdlZAIEAJiF8cwPtURhQGlmICh0aGF0LnBvcnRhbCA9PSAiZ3JpZFBvcnRhbCIgJiYgdGhhdC5kaW1lbnNpb24gPT0gImJsdWVwcmludCIpCnsKICAgIHRoaXNCb3QuYWJCbHVlcHJpbnQoKTsKfScAmIXxzA/8MwtwZXJzb25hbGl0eQIEAJiF8cwPl0Uo8J+Ul2I3NmRmYmM0LTg1NGItNGY2ZC1hOTFmLWE5NDg2OTQ3NzRkYicAmIXxzA/8MxJhYkNvcmVNZW51SXRlbVR5cGUCBACYhfHMD75FCGRyb3Bkb3duJwCYhfHMD/wzEWRyb3Bkb3duU29ydE9yZGVyAgQAmIXxzA/HRQExJwCYhfHMD/wzD2Ryb3Bkb3duT3B0aW9ucwIEAJiF8cwPyUUG8J+nrFtdJwCYhfHMD/wzGGFiQ29yZU1lbnVPbkJlZm9yZUNyZWF0ZQIEAJiF8cwPzkW4HkBjb25zdCBkcm9wZG93bk9wdGlvbnMgPSBbXTsNCg0KY29uc3QgY3VycmVudERpbSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBY3RpdmVEaW1lbnNpb247DQpjb25zdCBjdXJyZW50UG9ydGFsID0gY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsID8gIm1hcCIgOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsID09ICJibHVlcHJpbnQiID8gImJsdWVwcmludCIgOiJncmlkIjsNCmNvbnN0IGFjdGl2ZU1lbnUgPSBjb25maWdCb3QudGFncy5tZW51UG9ydGFsOw0KY29uc3QgcGVybWFsaW5rVVJMID0gY29uZmlnQm90LnRhZ3MucGVybWFsaW5rOw0KY29uc3QgYWN0aXZlSW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7DQpjb25zdCBhY3RpdmVCaW9zID0gY29uZmlnQm90LnRhZ3Mub3duZXIgPyAiJm93bmVyPSIgKyBjb25maWdCb3QudGFncy5vd25lciA6IGZhbHNlOw0KY29uc3QgZmlyc3RJbmRleCA9IHBlcm1hbGlua1VSTC5pbmRleE9mKCImIik7DQpjb25zdCBpbml0aWFsVVJMID0gcGVybWFsaW5rVVJMLnN1YnN0cmluZygwLCBmaXJzdEluZGV4KTsNCmNvbnN0IHVwZGF0ZWRVUkwgPSBhY3RpdmVCaW9zICE9IGZhbHNlID8gaW5pdGlhbFVSTCArICImaW5zdD0iICsgYWN0aXZlSW5zdCA6IGluaXRpYWxVUkw7DQoNCnNldFRhZ01hc2sodGhpc0JvdCwgImFiQ29yZU1lbnVMYWJlbCIsYG1vZGU6ICR7Y3VycmVudFBvcnRhbH0gcG9ydGFsYCk7DQpzZXRUYWdNYXNrKHRoaXNCb3QsICJjdXJyZW50RGltZW5zaW9uIiwgY3VycmVudERpbSk7DQpzZXRUYWdNYXNrKHRoaXNCb3QsICJjdXJyZW50UG9ydGFsIiwgY3VycmVudFBvcnRhbCk7DQpzZXRUYWdNYXNrKHRoaXNCb3QsICJkcm9wZG93blNvcnRPcmRlciIsIDEpOw0KDQpjb25zdCBtZW51T3B0aW9ucyA9IHt9Ow0KDQptZW51T3B0aW9ucy5kaW1lbnNpb24gPSBhY3RpdmVNZW51Ow0KbWVudU9wdGlvbnNbYWN0aXZlTWVudV0gPSB0cnVlOw0KbWVudU9wdGlvbnMuYWJQb3J0YWxNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsNCm1lbnVPcHRpb25zLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7DQptZW51T3B0aW9ucy5vbktleURvd24gPSBgQCBpZih0aGF0LmtleXMgPT0gIlNoaWZ0Iil7bWFza3MubGFiZWwgPSB0YWdzLmxhYmVsICsgIiBpbiBuZXcgdGFiIjt9YDsNCm1lbnVPcHRpb25zLm9uS2V5VXAgPSBgQCBpZih0aGF0LmtleXMgPT0gIlNoaWZ0Iil7bWFza3MubGFiZWwgPSBudWxsO31gOw0KbWVudU9wdGlvbnMuc2tpbGxCb3QgPSBnZXRMaW5rKHRoaXNCb3QpOw0KbWVudU9wdGlvbnMudGFyZ2V0VVJMID0gdXBkYXRlZFVSTDsNCg0KY29uc3QgbWFwTWVudUJvdCA9IHsNCiAgICAuLi5tZW51T3B0aW9ucw0KfTsNCg0KbWFwTWVudUJvdC5sYWJlbCA9ICJtYXAgcG9ydGFsIjsNCm1hcE1lbnVCb3QuZm9ybUFkZHJlc3MgPSAicHVibGljIjsNCm1hcE1lbnVCb3Qub25DbGljayA9IGBAIA0KY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOw0KDQppZihzdGF0ZSkNCnsNCiAgICBvcy5vcGVuVVJMKHRhZ3MudGFyZ2V0VVJMICsgIiZtYXBQb3J0YWw9JHtjdXJyZW50RGltID09ICJibHVlcHJpbnQiID8gImhvbWUiIDogY3VycmVudERpbX0iKTsNCn0NCmVsc2UNCnsNCiAgICBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPSAiJHtjdXJyZW50RGltID09ICJibHVlcHJpbnQiID8gImhvbWUiIDogY3VycmVudERpbX0iOw0KfWA7DQoNCmlmIChjdXJyZW50UG9ydGFsICE9ICJtYXAiKQ0Kew0KICAgIC8vbWFwIHBvcnRhbCBidXR0b24NCiAgICBkcm9wZG93bk9wdGlvbnMucHVzaChtYXBNZW51Qm90KTsNCn0NCg0KY29uc3QgZ3JpZE1lbnVCb3QgPSB7DQogICAgLi4ubWVudU9wdGlvbnMNCn07DQpncmlkTWVudUJvdC5sYWJlbCA9ICJncmlkIHBvcnRhbCI7DQpncmlkTWVudUJvdC5mb3JtQWRkcmVzcyA9ICJjdWJlIjsNCmdyaWRNZW51Qm90Lm9uQ2xpY2sgPSBgQA0KDQpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7DQoNCmlmKHN0YXRlKQ0Kew0KICAgIG9zLm9wZW5VUkwodGFncy50YXJnZXRVUkwgKyAiJmdyaWRQb3J0YWw9JHtjdXJyZW50RGltID09ICJibHVlcHJpbnQiID8gImhvbWUiIDogY3VycmVudERpbX0iKTsNCn0gDQplbHNlDQp7DQogICAgY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCA9ICIke2N1cnJlbnREaW0gPT0gImJsdWVwcmludCIgPyAiaG9tZSIgOiBjdXJyZW50RGltfSI7IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA9IG51bGw7DQp9YDsNCg0KaWYgKGN1cnJlbnRQb3J0YWwgIT0gImdyaWQiIHx8IGN1cnJlbnREaW0gPT0gImJsdWVwcmludCIpDQp7DQogICAgLy9ncmlkIHBvcnRhbCBidXR0b24NCiAgICBkcm9wZG93bk9wdGlvbnMucHVzaChncmlkTWVudUJvdCk7DQp9DQoNCmNvbnN0IGJsdWVwcmludE1lbnVCb3QgPSB7DQogICAgLi4ubWVudU9wdGlvbnMNCn07DQoNCmJsdWVwcmludE1lbnVCb3QubGFiZWwgPSAiYmx1ZXByaW50IHBvcnRhbCI7DQpibHVlcHJpbnRNZW51Qm90LmZvcm1BZGRyZXNzID0gImFyY2hpdGVjdHVyZSI7DQpibHVlcHJpbnRNZW51Qm90Lm9uQ2xpY2sgPSBgQA0KDQpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7DQoNCmlmKHN0YXRlKQ0Kew0KICAgIG9zLm9wZW5VUkwodGFncy50YXJnZXRVUkwgKyAiJmdyaWRQb3J0YWw9Ymx1ZXByaW50Iik7DQp9IA0KZWxzZQ0Kew0KICAgIGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWwgPSAiYmx1ZXByaW50IjsgY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsID0gbnVsbDsNCn0NCg0KbGlua3Muc2tpbGxCb3QuYWJCbHVlcHJpbnQoKTtgOw0KDQppZiAoY3VycmVudERpbSAhPSAiYmx1ZXByaW50IikNCnsNCiAgICAvL2JsdWVwcmludCBwb3J0YWwgYnV0dG9uDQogICAgZHJvcGRvd25PcHRpb25zLnB1c2goYmx1ZXByaW50TWVudUJvdCk7DQp9DQoNCg0KY29uc3Qgc2hlZXRNZW51Qm90ID0gew0KICAgIC4uLm1lbnVPcHRpb25zDQp9Ow0Kc2hlZXRNZW51Qm90LmxhYmVsID0gInNoZWV0IHBvcnRhbCI7DQpzaGVldE1lbnVCb3QuZm9ybUFkZHJlc3MgPSAidGFibGVfdmlldyI7DQpzaGVldE1lbnVCb3Qub25DbGljayA9IGBAIA0KDQpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7DQoNCmlmKHN0YXRlKQ0Kew0KICAgIG9zLm9wZW5VUkwodGFncy50YXJnZXRVUkwgKyAiJnNoZWV0UG9ydGFsPSR7Y3VycmVudERpbX0iKTsNCn0gDQplbHNlDQp7IA0KICAgIGNvbmZpZ0JvdC50YWdzLnNoZWV0UG9ydGFsID0gIiR7Y3VycmVudERpbX0iOw0KfWA7DQoNCi8vc2hlZXQgcG9ydGFsIGJ1dHRvbg0KZHJvcGRvd25PcHRpb25zLnB1c2goc2hlZXRNZW51Qm90KTsNCg0KDQpjb25zdCBzeXN0ZW1NZW51Qm90ID0gew0KICAgIC4uLm1lbnVPcHRpb25zDQp9Ow0KDQpzeXN0ZW1NZW51Qm90LmxhYmVsID0gInN5c3RlbSBwb3J0YWwiOw0Kc3lzdGVtTWVudUJvdC5mb3JtQWRkcmVzcyA9ICJzZXR0aW5nc19hcHBsaWNhdGlvbnMiOw0Kc3lzdGVtTWVudUJvdC5vbkNsaWNrID0gYEANCg0KY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOw0KDQppZihzdGF0ZSkNCnsNCiAgICBvcy5vcGVuVVJMKHRhZ3MudGFyZ2V0VVJMICsgIiZzeXN0ZW1Qb3J0YWw9dHJ1ZSIpOw0KfSANCmVsc2UNCnsgDQogICAgY29uZmlnQm90LnRhZ3Muc3lzdGVtUG9ydGFsID0gdHJ1ZTsNCn1gOw0KDQovL3N5c3RlbSBwb3J0YWwgYnV0dG9uDQpkcm9wZG93bk9wdGlvbnMucHVzaChzeXN0ZW1NZW51Qm90KTsNCg0KbWFza3MuZHJvcGRvd25PcHRpb25zID0gZHJvcGRvd25PcHRpb25zOw0KDQpyZXR1cm47JwEEYm90cyRlYzg1YzFkNi05ZjFhLTQwZDQtODJlMS01YmQ2ODAzNDljMjcBJwCYhfHMD4dkBnN5c3RlbQIEAJiF8cwPiGQNYWIuYWN0aW9uLmFzaycAmIXxzA+HZARmb3JtAgQAmIXxzA+WZAdub3RoaW5nJwCYhfHMD4dkBmFza0dQVAIEAJiF8cwPnmSpCkBpZiAoIXRhZ3MuZ3B0QWN0aXZlIHx8IGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMuYWxsb3dBSSA9PSBmYWxzZSkKewogICAgY29uc3QgYWlNZXNzYWdlID0gbGlua3MucmVtZW1iZXIudGFncy5haV9yZWplY3Rpb25fbWVzc2FnZSA/PyAiQUkgbm90IGF1dGhvcml6ZWQgZm9yIHRoaXMgYWNjb3VudCI7CgogICAgb3MudG9hc3QoYWlNZXNzYWdlLCA3KTsKCiAgICBhYi5sb2cobGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICAiOiAiICsgYWlNZXNzYWdlKTsKICAgIAogICAgcmV0dXJuOwp9IAoKLy8gY29uc29sZS5sb2coIkFTSyIsIHRoYXQpOwoKbGV0IGlucXVpcnkgPSB0aGF0LmlucXVpcnkgPz8gdGhhdDsKCmNvbnN0IHByb21wdCA9ICF0aGF0LnByb21wdCA/IHRhZ3MucHJvbXB0X2NvcmUgOiB0YWdzWyJwcm9tcHRfIiArIHRoYXQucHJvbXB0XTsKCmFiLmxvZyhsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogdGhpbmtpbmcgYWJvdXQgIiArIGlucXVpcnkpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkJvdENoYXQoe21lc3NhZ2U6ICJ0aGlua2luZyBhYm91dCAiICsgaW5xdWlyeX0pOwoKaWYgKHRoYXQucHJvbXB0ID09ICJncmlkIikKewogICAgaW5xdWlyeSA9IGlucXVpcnkgKyBgIFBPU0lUSU9OOiB7JHt0aGF0LmRhdGEuZGltZW5zaW9ufTogdHJ1ZSwgJHt0aGF0LmRhdGEuZGltZW5zaW9ufVg6ICR7dGhhdC5kYXRhLmRpbWVuc2lvblh9LCAke3RoYXQuZGF0YS5kaW1lbnNpb259WToke3RoYXQuZGF0YS5kaW1lbnNpb25ZfX0uYAp9CmVsc2UgaWYgKHRoYXQucHJvbXB0ID09ICJib3QiKQp7CiAgICBpbnF1aXJ5ID0gaW5xdWlyeSArIGAgVEFSR0VUX0JPVF9JRDogYCArIHRoYXQuZGF0YS5ib3QuaWQ7Cn0KZWxzZSBpZiAodGhhdC5wcm9tcHQgPT0gIm11bHRpcGxlQm90IikKewogICAgaW5xdWlyeSA9IGlucXVpcnkgKyBgIFRBUkdFVF9CT1RfSURTOiBgICsgdGhhdC5kYXRhLmJvdHM7Cn0KZWxzZSBpZiAodGhhdC5wcm9tcHQgPT0gImNvcmUiKQp7Cgp9Cgpjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzQm90LnN1Ym1pdFJlcXVlc3RHUFQoe2lucXVpcnk6IGlucXVpcnksIHByb21wdDogcHJvbXB0LCBtb2RlbDogdGhhdC5tb2RlbH0pOwoKaWYgKGFuc3dlcikgewogICAgYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiAiICsgYW5zd2VyKTsKCiAgICBjcmVhdGUoe2hvbWU6IHRydWUsIG9uQ3JlYXRlOiBgQCAke2Fuc3dlcn1gfSk7CgogICAgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7Cn0nAJiF8cwPh2QJZ3B0QWN0aXZlAgQAmIXxzA/IbgVmYWxzZScAmIXxzA+HZBBzdWJtaXRSZXF1ZXN0R1BUAgQAmIXxzA/ObpINQGltcG9ydCB7IEFJQ2hhdE9wdGlvbnMgfSBmcm9tICdjYXN1YWxvcyc7CgppZiAodGFncy5kZWJ1ZykgewogICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSB0aGF0YCwgdGhhdCk7Cn0KCmxldCBzeXN0ZW1Qcm9tcHQgPSB0aGF0LnByb21wdCA/IHRoYXQucHJvbXB0IDogdGFncy5wcm9tcHRfY29yZTsKCnN5c3RlbVByb21wdCA9IHN5c3RlbVByb21wdCArIHRoYXQuaW5xdWlyeTsKCmlmIChhdXRoQm90LnRhZ3MucHJpdmFjeUZlYXR1cmVzLmFsbG93QUkgPT0gZmFsc2UpCnsKICAgIGxpbmtzLnV0aWxzLmFiTG9nQW5kVG9hc3QoeyBtZXNzYWdlOiAiQUkgbm90IGF1dGhvcml6ZWQgb24gdGhpcyBhY2NvdW50IiwgbG9nVHlwZTogJ2xvZycgfSk7CiAgICByZXR1cm4gbnVsbDsKfQoKbGV0IGN1cnJlbnRFeHBlcmllbmNlQm90cyA9IGdldEJvdHMoYiA9PiBiLnNwYWNlID09PSAnc2hhcmVkJyAmJiAhYi50YWdzLmFiSWdub3JlKTsKCmlmIChjdXJyZW50RXhwZXJpZW5jZUJvdHMubGVuZ3RoID4gMCkKewogICAgc3lzdGVtUHJvbXB0ID0gc3lzdGVtUHJvbXB0ICsgIiBUaGVzZSBhcmUgdGhlIGJvdHMgdGhhdCBjdXJyZW50bHkgZXhpc3QgaW4gdGhlIGV4cGVyaWVuY2U6ICIgKyBjdXJyZW50RXhwZXJpZW5jZUJvdHM7Cn0KCmlmICghbGlua3MubWVudSkgewogICAgYXdhaXQgbGlua3MubGVhcm4uYWJBZGFwdCgnYWJJbnRlcmZhY2UnKTsKfQoKY29uc3QgYnVzeUluZGljYXRvciA9IGF3YWl0IGxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnVzeUluZGljYXRvcih7IGFiTWVudTogdHJ1ZSwgbGFiZWw6IGBhc2tpbmcgJHtsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5fWAgfSk7Cgpjb25zdCBhaUNoYXRPcHRpb25zOiBBSUNoYXRPcHRpb25zID0gewogICAgcHJlZmVycmVkTW9kZWw6IHRoYXQubW9kZWwgPz8gbGlua3MucmVtZW1iZXIudGFncy5hYlByZWZlcnJlZEFJTW9kZWwsCiAgICB0ZW1wZXJhdHVyZTogMCwKICAgIHRvcFA6IDEsCiAgICBwcmVzZW5jZVBlbmFsdHk6IDAuNiwKICAgIGZyZXF1ZW5jeVBlbmFsdHk6IDAsCn0KCmlmICh0YWdzLmRlYnVnKSB7CiAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIHNlbmRpbmcgdG8gYWk6YCwgeyBzeXN0ZW1Qcm9tcHQsIGFpQ2hhdE9wdGlvbnMgfSk7Cn0KCmxldCBhaVJlc3BvbnNlOiBzdHJpbmc7Cgp0cnkgewogICAgYWlSZXNwb25zZSA9IGF3YWl0IGFpLmNoYXQoc3lzdGVtUHJvbXB0LCBhaUNoYXRPcHRpb25zKTsKCiAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gYWkgcmVzcG9uc2U6YCwgYWlSZXNwb25zZSk7CiAgICB9Cn0gY2F0Y2goZSkgewogICAgYWlSZXNwb25zZSA9IG51bGw7CgogICAgLy8gU2hvdyB0b2FzdCB3aXRoIGVycm9yLgogICAgbGlua3MudXRpbHMuYWJMb2dBbmRUb2FzdCh7IG1lc3NhZ2U6IGBBSSByZXF1ZXN0IGZhaWxlZCAtICR7bGlua3MudXRpbHMuZ2V0RXJyb3JNZXNzYWdlKGUpfWAsIGxvZ1R5cGU6ICdlcnJvcicgfSk7CgogICAgLy8gUmV0aHJvdyBzbyBjYWxsZXJzIGNhbiBjYXRjaC4KICAgIHRocm93IGU7Cn0gZmluYWxseSB7CiAgICBkZXN0cm95KGJ1c3lJbmRpY2F0b3IpOwp9CgpyZXR1cm4gYWlSZXNwb25zZTsnAJiF8cwPh2QIcmVtZW1iZXICBACYhfHMD+F7KPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAJiF8cwPh2QQYWJDb3JlTWVudUFjdGlvbgIEAJiF8cwPiHykHUBjb25zdCBpbnF1aXJ5ID0gdGhhdD8ubWVzc2FnZSA/PyB0aGF0Owpjb25zdCBpbml0aWFsQm9vdCA9IHRoYXQ/LmluaXRpYWxCb290ID8/IGZhbHNlOwpjb25zdCBhdXRvSGF0Y2ggPSB0aGF0Py5hdXRvSGF0Y2ggPz8gZmFsc2U7CmNvbnN0IG1lbnUgPSB0aGF0Py5tZW51ID8/ICJjb3JlIjsKY29uc3QgaW5xdWlyeUhhc1NwYWNlID0gaW5xdWlyeS5pbmRleE9mKCIgIikgIT09IC0xOwpjb25zdCBtZW51Qm90cyA9IGdldEJvdHMoY29uZmlnQm90LnRhZ3MubWVudVBvcnRhbCwgdHJ1ZSk7Cgp3aGlzcGVyKG1lbnVCb3RzLCAiYWJNZW51UmVmcmVzaCIpOwoKbGV0IHVzZXJuYW1lID0gInVzZXIiOwppZiAoYXV0aEJvdCAmJiBhdXRoQm90LnRhZ3MubmFtZSkgewogICAgdXNlcm5hbWUgPSBhdXRoQm90LnRhZ3MubmFtZTsKfSBlbHNlIGlmIChhYi5saW5rcy5jb25zb2xlLm1hc2tzLnByZWZlcnJlZE5hbWUpIHsKICAgIHVzZXJuYW1lID0gYWIubGlua3MuY29uc29sZS5tYXNrcy5wcmVmZXJyZWROYW1lOwp9CmFiLmxvZyh7IG1lc3NhZ2U6IGlucXVpcnksIG5hbWU6IHVzZXJuYW1lIH0pOwoKaWYgKCFjb25maWdCb3QudGFncy50YWdQb3J0YWwgJiYgbGlua3MucmVtZW1iZXIudGFncy5hYkF3YWtlU3RhdGUgJiYgaW5xdWlyeSAhPSAiLmxvZyIpIHsKICAgIHNob3V0KCJzaG93Q29uc29sZSIpOwp9CgppZiAoIWlucXVpcnlIYXNTcGFjZSkgewogICAgY29uc3QgaXNEaXJlY3RTZWFyY2ggPSBpbnF1aXJ5LnN0YXJ0c1dpdGgoYCJgKSAmJiBpbnF1aXJ5LmVuZHNXaXRoKGAiYCk7CiAgICBjb25zdCBpc0NoYW5uZWxTZWFyY2ggPSBpbnF1aXJ5WzBdID09ICJAIjsKCiAgICBjb25zdCBhc2s6IEFCTG9va3VwQXNrSURSZXN1bHQgfCBmYWxzZSA9ICFpc0RpcmVjdFNlYXJjaCA/IGF3YWl0IGxpbmtzLnNlYXJjaC5vbkxvb2t1cEFza0lEKHsgYXNrSUQ6IGlucXVpcnksIGNoYW5uZWxDb25maWc6IGlzQ2hhbm5lbFNlYXJjaCwgYXV0b0hhdGNoOiB0cnVlLCBzb3VyY2VFdmVudDogJ2FzaycgfSkgOiBmYWxzZTsKCiAgICBpZiAoYXNrPy5zdWNjZXNzICYmIGFzaz8uZGF0YT8udXJsICE9IHVuZGVmaW5lZCAmJiAhaXNEaXJlY3RTZWFyY2ggJiYgIWlzQ2hhbm5lbFNlYXJjaCkgewogICAgICAgIGxpbmtzLmxlYXJuLmFiSm9pbkhvc3QoeyBkYXRhOiBhc2suZGF0YSB9KTsKICAgIH0gZWxzZSBpZiAoYXNrPy5zdWNjZXNzICYmIGlzQ2hhbm5lbFNlYXJjaCkgewogICAgICAgIGxpbmtzLmNoYW5uZWxMb2FkZXI/LmxvYWRDaGFubmVsKGFzayk7CiAgICB9IGVsc2UgaWYgKCFhc2s/LnN1Y2Nlc3MpIHsKICAgICAgICBsZXQgZWdnOiBBQkxvb2t1cEVnZ1Jlc3VsdDsKICAgICAgICBjb25zdCBwZXJpb2RJbmRleCA9IGlucXVpcnkuaW5kZXhPZigiLiIpOwogICAgICAgIGxldCBhYklEID0gaW5xdWlyeTsKCiAgICAgICAgaWYgKGlzRGlyZWN0U2VhcmNoKSB7CiAgICAgICAgICAgIGFiSUQgPSBpbnF1aXJ5LnN1YnN0cmluZygxLCBpbnF1aXJ5Lmxlbmd0aCAtIDEpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHBlcmlvZEluZGV4ID09IC0xIHx8IGlzRGlyZWN0U2VhcmNoKSB7CiAgICAgICAgICAgIGVnZyA9IGF3YWl0IGxpbmtzLnNlYXJjaC5vbkxvb2t1cEFCRWdncyh7IGFiSUQ6IGFiSUQsIGluaXRpYWxCb290LCBhdXRvSGF0Y2gsIHNvdXJjZUV2ZW50OiAnYXNrJyB9KTsKICAgICAgICB9IGVsc2UgaWYgKHBlcmlvZEluZGV4ID4gMCkgewogICAgICAgICAgICBjb25zdCByZWNvcmRLZXkgPSBpbnF1aXJ5LnN1YnN0cmluZygwLCBwZXJpb2RJbmRleCk7CgogICAgICAgICAgICBhYklEID0gaW5xdWlyeS5zdWJzdHJpbmcocGVyaW9kSW5kZXggKyAxKTsKCiAgICAgICAgICAgIGVnZyA9IGF3YWl0IGxpbmtzLnNlYXJjaC5vbkxvb2t1cEFCRWdncyh7IHJlY29yZEtleTogcmVjb3JkS2V5LCBhYklEOiBhYklELCBpbml0aWFsQm9vdCwgYXV0b0hhdGNoLCBzb3VyY2VFdmVudDogJ2FzaycsIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGxpbmtzLmlucHV0Lm9uQ2hhdCh7IG1lc3NhZ2U6IGlucXVpcnkgfSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoIWVnZz8uc3VjY2VzcyAmJiBsaW5rcy5tZW51KSB7CiAgICAgICAgICAgIGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTWVudSI7CgogICAgICAgICAgICBjb25zdCBzdHVkaW9CdXR0b24gPSB7fTsKCiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5hYk1lbnUgPSB0cnVlOwogICAgICAgICAgICBzdHVkaW9CdXR0b24ubGFiZWwgPSBhYklEICsgIiBub3QgZm91bmQgaW4gYWN0aXZlIHN0dWRpbywgZW50ZXIgYWx0ZXJuYXRlIHN0dWRpb0lEIjsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLmZvcm0gPSAiaW5wdXQiOwogICAgICAgICAgICBzdHVkaW9CdXR0b24uYWJJRCA9IGFiSUQ7CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5mb3JtQWRkcmVzcyA9IHRhZ3MuYWJDb3JlTWVudUljb247CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5tYW5hZ2VyID0gZ2V0TGluayh0aGlzQm90KTsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5vblN1Ym1pdCA9IGBAIGxpbmtzLm1hbmFnZXIuYWJDb3JlTWVudUFjdGlvbih0aGF0LnRleHQgKyAiLiIgKyB0YWdzLmFiSUQpO2A7CgogICAgICAgICAgICBjb25zdCBjcmVhdGVCdXR0b24gPSB7fTsKCiAgICAgICAgICAgIGNyZWF0ZUJ1dHRvbi5hYk1lbnUgPSB0cnVlOwogICAgICAgICAgICBjcmVhdGVCdXR0b24ubGFiZWwgPSAiZ2l2ZSBtZSBhIHByb3RvdHlwZSI7CiAgICAgICAgICAgIGNyZWF0ZUJ1dHRvbi5tYW5hZ2VyID0gZ2V0TGluayh0aGlzQm90KTsKICAgICAgICAgICAgY3JlYXRlQnV0dG9uLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CiAgICAgICAgICAgIGNyZWF0ZUJ1dHRvbi5hYklEID0gYWJJRDsKICAgICAgICAgICAgY3JlYXRlQnV0dG9uLm9uQ2xpY2sgPSBgQCBsaW5rcy5tYW5hZ2VyLnByb3RvdHlwZSh0YWdzLmFiSUQpO2A7CgogICAgICAgICAgICBsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihjcmVhdGVCdXR0b24pOwogICAgICAgICAgICBsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihzdHVkaW9CdXR0b24pOwoKICAgICAgICAgICAgdGhpc0JvdC5tYXNrcy5vbkdyaWRDbGljayA9ICJAIHNob3V0KCdhYk1lbnVSZWZyZXNoJyk7IjsKICAgICAgICB9CiAgICB9Cn0gZWxzZSB7CiAgICBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdCgpOwoKICAgIGlmICghYXV0aEJvdCkgewogICAgICAgIG9zLnRvYXN0KCJwbGVhc2Ugc2lnbiBpbiB0byBhY2Nlc3MgYWR2YW5jZWQgQUkgZmVhdHVyZXMiKTsKCiAgICAgICAgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CiAgICB9IGVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpIHsKICAgICAgICBvcy50b2FzdCgicGxlYXNlIGNoZWNrIHlvdXIgc3Vic2NyaXB0aW9uIGluIG9yZGVyIHRvIGFjY2VzcyBhZHZhbmNlZCBBSSBmZWF0dXJlcyIpOwoKICAgICAgICBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsKICAgIH0gZWxzZSB7CiAgICAgICAgbWFza3MuZ3B0QWN0aXZlID0gdHJ1ZTsKCiAgICAgICAgYXdhaXQgdGhpc0JvdC5hc2tHUFQoeyBpbnF1aXJ5OiBpbnF1aXJ5LCBwcm9tcHQ6IG1lbnUsIGRhdGE6IHRoYXQgfSk7CiAgICB9Cn0nAJiF8cwPh2QUYWJDb3JlTWVudU9uR2VuZXJhdGUCBACYhfHMD62ZAbEDQHRhZ3Mub25TdWJtaXQgPSBgQCBsaW5rcy5iYXNlU2tpbGwuYWJDb3JlTWVudUFjdGlvbih7bWVzc2FnZTogdGhhdC50ZXh0LCBtZW51OiAiY29yZSJ9KTtgOwp0YWdzLmZvcm0gPSAiaW5wdXQiOwoKaWYgKCFhdXRoQm90KQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlIGlmIChhdXRoQm90LnRhZ3Muc3Vic2NyaXB0aW9uVGllciA9PSAiRnJlZVBsYXkiKQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5Owp9CicAmIXxzA+HZBNhYkNvcmVNZW51U29ydE9yZGVyAgQAmIXxzA/fnAEDMTAyJwCYhfHMD4dkEGFiR3JpZE1lbnVBY3Rpb24CBACYhfHMD+OcAQ5ALy9wbGFjZWhvbGRlcicAmIXxzA+HZBRhYkdyaWRNZW51T25HZW5lcmF0ZQIEAJiF8cwP8pwBvAVAdGFncy5kaW1lbnNpb24gPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZEZvY3VzLmRpbWVuc2lvbjsKdGFncy5kaW1lbnNpb25YID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRGb2N1cy5wb3NpdGlvbi54Owp0YWdzLmRpbWVuc2lvblkgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZEZvY3VzLnBvc2l0aW9uLnk7CnRhZ3Mub25TdWJtaXQgPSBgQGxpbmtzLmJhc2VTa2lsbC5hYkNvcmVNZW51QWN0aW9uKHttZXNzYWdlOiB0aGF0LnRleHQsIG1lbnU6ICJncmlkIiwgZGltZW5zaW9uOiB0YWdzLmRpbWVuc2lvbiwgZGltZW5zaW9uWDogdGFncy5kaW1lbnNpb25YLCBkaW1lbnNpb25ZOiB0YWdzLmRpbWVuc2lvbll9KTtgOwp0YWdzLmZvcm0gPSAiaW5wdXQiOwoKaWYgKCFhdXRoQm90KQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlIGlmIChhdXRoQm90LnRhZ3Muc3Vic2NyaXB0aW9uVGllciA9PSAiRnJlZVBsYXkiKQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5Owp9JwCYhfHMD4dkDW1hbmlmZXN0YXRpb24CBACYhfHMD6+iASjwn5SXZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkJwCYhfHMD4dkE2FiR3JpZE1lbnVTb3J0T3JkZXICBACYhfHMD9aiAQMxMDInAJiF8cwPh2QPYWJHcmlkTWVudUxhYmVsAgQAmIXxzA/aogEGYXNrIGFiJwCYhfHMD4dkD2FiQ29yZU1lbnVMYWJlbAIEAJiF8cwP4aIBBmFzayBhYicAmIXxzA+HZA5hYkNvcmVNZW51SWNvbgIEAJiF8cwP6KIBBGN1YmUnAJiF8cwPh2QOYWJHcmlkTWVudUljb24CBACYhfHMD+2iAQRjdWJlJwCYhfHMD4dkCmVkaXRQcm9tcHQCBACYhfHMD/KiAYcIQHNob3V0KCJhYk1lbnVSZWZyZXNoIik7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJhYk1lbnUiOwoKbGV0IHByb21wdE1lbnVCdXR0b24gPSB7fTsKCnByb21wdE1lbnVCdXR0b24uYWJNZW51ID0gdHJ1ZTsKcHJvbXB0TWVudUJ1dHRvbi5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwpwcm9tcHRNZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247CnByb21wdE1lbnVCdXR0b24ucmVtZW1iZXIgPSB0YWdzLnJlbWVtYmVyOwpwcm9tcHRNZW51QnV0dG9uLmdwdEJvdCA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CnByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAibG9hZCBwcm9tcHQiOwpwcm9tcHRNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImNsb3VkX2Rvd25sb2FkIjsKcHJvbXB0TWVudUJ1dHRvbi5vbkNsaWNrID0gIkAgbGlua3MuZ3B0Qm90LnVwZGF0ZVByb21wdCgnbG9hZCcpOyI7CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihwcm9tcHRNZW51QnV0dG9uKTsKCnByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAic2F2ZSBwcm9tcHQiOwpwcm9tcHRNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImJhY2t1cCI7CnByb21wdE1lbnVCdXR0b24ub25DbGljayA9ICJAIGxpbmtzLmdwdEJvdC51cGRhdGVQcm9tcHQoJ3NhdmUnKTsiOwoKbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24ocHJvbXB0TWVudUJ1dHRvbik7CgptYXNrcy5vbkdyaWRDbGljayA9IGBAIGNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWwgPSBudWxsOwoKdGFnUG9ydGFsQm90Lm1hc2tzLnRhZ1BvcnRhbEFuY2hvclBvaW50ID0gbnVsbDsKYDsKCnRhZ1BvcnRhbEJvdC5tYXNrcy50YWdQb3J0YWxBbmNob3JQb2ludCA9ICJ0b3AiOwoKY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbCA9IHRoaXNCb3QuaWQgKyAiLnByb21wdF9jb3JlIjsKCmlmIChjb25maWdCb3QubWFza3MudGFnUG9ydGFsU3BhY2UpCnsKICAgIGNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWxTcGFjZSA9IG51bGw7Cn0nAJiF8cwPh2QEbWVudQIEAJiF8cwP+KoBKPCflJdiMzBjNmM1ZC1hNGY3LTQyNjYtYmEzOC0zOTNkYzk1ZTFlY2InAJiF8cwPh2QMdXBkYXRlUHJvbXB0AgQAmIXxzA+fqwHLCEBzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWJNZW51IjsKCmxldCBwcm9tcHRNZW51QnV0dG9uID0ge307Cgpwcm9tcHRNZW51QnV0dG9uLmFiTWVudSA9IHRydWU7CnByb21wdE1lbnVCdXR0b24uZm9ybSA9ICJpbnB1dCI7CnByb21wdE1lbnVCdXR0b24uYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKcHJvbXB0TWVudUJ1dHRvbi5tYW5pZmVzdGF0aW9uID0gdGFncy5tYW5pZmVzdGF0aW9uOwpwcm9tcHRNZW51QnV0dG9uLnJlbWVtYmVyID0gdGFncy5yZW1lbWJlcjsKcHJvbXB0TWVudUJ1dHRvbi5ncHRCb3QgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwoKaWYgKHRoYXQgPT0gImxvYWQiKQp7CiAgICBwcm9tcHRNZW51QnV0dG9uLmxhYmVsID0gImxvYWQgcHJvbXB0IjsKICAgIHByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY2xvdWRfZG93bmxvYWQiOwogICAgcHJvbXB0TWVudUJ1dHRvbi5vblN1Ym1pdCA9ICJAIGxpbmtzLmdwdEJvdC5sb2FkUHJvbXB0KHRoYXQudGV4dCk7IjsKfQplbHNlCnsKICAgIHByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAic2F2ZSBwcm9tcHQiOwogICAgcHJvbXB0TWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJiYWNrdXAiOwogICAgcHJvbXB0TWVudUJ1dHRvbi5vblN1Ym1pdCA9ICJAIGxpbmtzLmdwdEJvdC5zYXZlUHJvbXB0KHRoYXQudGV4dCk7IjsKfQoKbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24ocHJvbXB0TWVudUJ1dHRvbik7Cgpwcm9tcHRNZW51QnV0dG9uLmZvcm0gPSBudWxsOwpwcm9tcHRNZW51QnV0dG9uLmxhYmVsID0gIiAgIjsKcHJvbXB0TWVudUJ1dHRvbi5sYWJlbEFsaWdubWVudCA9ICJjZW50ZXIiOwpwcm9tcHRNZW51QnV0dG9uLmNvbG9yID0gIiNmMjQ3MjciOwpwcm9tcHRNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImNhbmNlbCI7CnByb21wdE1lbnVCdXR0b24ub25TdWJtaXQgPSBudWxsOwpwcm9tcHRNZW51QnV0dG9uLm9uQ2xpY2sgPSAiQCBsaW5rcy5ncHRCb3QuZWRpdFByb21wdCgpOyI7CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihwcm9tcHRNZW51QnV0dG9uKTsnAJiF8cwPh2QKbG9hZFByb21wdAIEAJiF8cwP6bMB2gNAYXdhaXQgb3MucmVxdWVzdEF1dGhCb3RJbkJhY2tncm91bmQoKTsKCmlmIChhdXRoQm90LnRhZ3MucHJpdmFjeUZlYXR1cmVzLmFsbG93UHVibGljRGF0YSA9PSBmYWxzZSkKewogICAgb3MudG9hc3QoIm5vdCBhdXRob3JpemVkIik7CgogICAgcmV0dXJuOwp9Cgpjb25zdCBwcm9tcHROYW1lID0gImdwdF9wcm9tcHRfIiArIHRoYXQ7CmNvbnN0IG5ld1Byb21wdCA9IGF3YWl0IG9zLmdldERhdGEobGlua3MucmVtZW1iZXIudGFncy5hYlJlY29yZEtleSwgcHJvbXB0TmFtZSk7CgppZiAoIW5ld1Byb21wdC5zdWNjZXNzKQp7CiAgICBvcy50b2FzdCgibm8gcHJvbXB0IGZvdW5kIGJ5IHRoYXQgbmFtZSIpOwp9CmVsc2UKewogICAgdGFncy5wcm9tcHRfY29yZSA9IG5ld1Byb21wdC5kYXRhOwp9CgppZiAoY29uZmlnQm90LnRhZ3MucHJvbXB0X2Jhc2UgPT0gdGhhdCkKewogICAgcmV0dXJuOwp9Cgp0aGlzQm90LmVkaXRQcm9tcHQoKTsnAJiF8cwPh2QKc2F2ZVByb21wdAIEAJiF8cwPxLcBvgRAYXdhaXQgb3MucmVxdWVzdEF1dGhCb3RJbkJhY2tncm91bmQoKTsKCmlmIChhdXRoQm90LnRhZ3MucHJpdmFjeUZlYXR1cmVzLmFsbG93UHVibGljRGF0YSA9PSBmYWxzZSB8fCBhdXRoQm90LnRhZ3MucHJpdmFjeUZlYXR1cmVzLnB1Ymxpc2hEYXRhID09IGZhbHNlKQp7CiAgICBvcy50b2FzdCgibm90IGF1dGhvcml6ZWQiKTsKCiAgICByZXR1cm47Cn0KCmNvbnN0IGF1dGhvciA9IGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90KCk7CmNvbnN0IHByb21wdE5hbWUgPSAiZ3B0X3Byb21wdF8iICsgdGhhdDsKY29uc3QgbmV3UHJvbXB0ID0gYXdhaXQgb3MucmVjb3JkRGF0YShsaW5rcy5yZW1lbWJlci50YWdzLmFiUmVjb3JkS2V5LCBwcm9tcHROYW1lLCB0YWdzLnByb21wdF9jb3JlLCB7dXBkYXRlUG9saWN5OiBbYXV0aG9yLmlkXX0pOwoKaWYgKCFuZXdQcm9tcHQuc3VjY2VzcykKewogICAgb3MudG9hc3QoInNvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgdHJ5IGFnYWluIik7Cn0KZWxzZQp7CiAgICBvcy50b2FzdCgicHJvbXB0IHNhdmVkIGFzICIgKyB0aGF0KTsKfQoKdGhpc0JvdC5lZGl0UHJvbXB0KCk7JwCYhfHMD4dkCGFiSWdub3JlAgQAmIXxzA+DvAEEdHJ1ZScAmIXxzA+HZAhhYkFjdGlvbgIEAJiF8cwPiLwBBHRydWUnAJiF8cwPh2QGc2VhcmNoAgQAmIXxzA+NvAEo8J+Ul2Q4MzcxNDQ0LTkxNTgtNDQzNi04ZmM3LTg0Y2M5MWI3ZjUyNScAmIXxzA+HZAVsZWFybgIEAJiF8cwPtLwBKPCflJc2NjU3Yjg2NS1lOTgzLTQ0MDEtOWZjOS1mNTQxOGQxOGE3ZjcnAJiF8cwPh2QKbWF4X3Rva2VucwIEAJiF8cwP27wBBDUwMDAnAJiF8cwPh2QPb25BQkluaXRpYWxpemVkAgQAmIXxzA/gvAFYQGlmIChjb25maWdCb3QudGFncy5wcm9tcHRfYmFzZSkKewogICAgdGhpc0JvdC5sb2FkUHJvbXB0KGNvbmZpZ0JvdC50YWdzLnByb21wdF9iYXNlKTsKfScAmIXxzA+HZAVhc2tBQgIEAJiF8cwPub0B1ANALy9zaG91dCgiYXNrQUIiLCB7cHJvbXB0OiBwcm9tcHQsIHNob3V0OiBzaG91dCwgY29udGV4dDogY29udGV4dH0pOwoKaWYgKCF0YWdzLmdwdEFjdGl2ZSkgcmV0dXJuOwoKbGV0IGlucXVpcnkgPSB0aGF0LnByb21wdDsKCi8vYWIubG9nKCJ1c2VyOiAiICsgaW5xdWlyeSk7IC8vbm90IG5lZWRlZAoKY29uc3QgYW5zd2VyID0gYXdhaXQgdGhpc0JvdC5zdWJtaXRSZXF1ZXN0R1BUKHtpbnF1aXJ5OiBpbnF1aXJ5LCBjb250ZXh0OiB0aGF0LmNvbnRleHQsIGRlZmluZWRQcm9tcHQ6IHRydWV9KTsKCmFiLmxvZyhsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogIiArIGFuc3dlcik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQm90Q2hhdCh7bWVzc2FnZTogYW5zd2VyfSk7CgppZiAodGhhdC5zaG91dCkKewogICAgc2hvdXQodGhhdC5zaG91dCwgYW5zd2VyKTsKfQoKcmV0dXJuIGFuc3dlcjsnAJiF8cwPh2QFaW5wdXQCBACYhfHMD47BASjwn5SXZjg2MDI4NzgtYzJlZi00OGJkLTg1YTAtOGQ2MzUxZWI0MTIwJwCYhfHMD4dkC3Byb21wdF9jb3JlAgQAmIXxzA+1wQH5D0RFTElWRVJBQkxFOiBSZXR1cm4gb25seSBKYXZhU2NyaXB0IGNvZGUuIERvIG5vdCBpbmNsdWRlIHF1b3RlcywgTWFya2Rvd24gZm9ybWF0dGluZywgb3IgYW55IGV4cGxhbmF0b3J5IHRleHQuIFRoZSBjb2RlIHNob3VsZCBiZSB2YWxpZCBhbmQgZXhlY3V0YWJsZSBpbnNpZGUgdGhlIGBvbkNyZWF0ZWAgZmllbGQgb2YgYSBib3QgaW4gQ2FzdWFsT1MuCgpPQkpFQ1RJVkU6IEJhc2VkIG9uIHRoZSBJTlBVVCwgZ2VuZXJhdGUgSmF2YVNjcmlwdCB0aGF0IHBlcmZvcm1zIHRoZSByZXF1ZXN0ZWQgYmVoYXZpb3IgaW4gQ2FzdWFsT1MuIFRoZSBjb2RlIG11c3Q6CgoxLiBJbXBsZW1lbnQgdGhlIHJlcXVlc3RlZCBhY3Rpb24uCjIuIEFsd2F5cyBpbmNsdWRlIGBhYi5sb2coImEgZGVzY3JpcHRpb24gb2YgdGhlIGV4ZWN1dGlvbiIpYCB0byBpbmRpY2F0ZSB3aGF0IHRoZSBjb2RlIGlzIGRvaW5nLgozLiBBbHdheXMgaW5jbHVkZSBgZGVzdHJveSh0aGlzQm90KTtgIGF0IHRoZSBlbmQgdG8gcmVtb3ZlIHRoZSBib3QgYWZ0ZXIgZXhlY3V0aW9uLgo0LiBVc2Ugc3RhbmRhcmQgQ2FzdWFsT1MgYm90IHNjcmlwdGluZyBtZXRob2RzIHN1Y2ggYXMgYGNyZWF0ZSguLi4pYCwgYHNldFRhZyguLi4pYCwgYGdldEJvdHMoLi4uKWAsIGV0Yy4KClJPTEU6IFlvdSBhcmUgUE0gQm90LCBhIGhlbHBmdWwgYXNzaXN0YW50IHRoYXQgd3JpdGVzIEphdmFTY3JpcHQgY29kZSB0byBjb250cm9sIGJvdHMgaW4gW0Nhc3VhbE9TXShodHRwczovL2dpdGh1Yi5jb20vY2FzdWFsLXNpbXVsYXRpb24vY2FzdWFsb3MpLCBhIHdlYi1iYXNlZCBJREUgZm9yIGJvdCBzY3JpcHRpbmcuCgpFWEFNUExFUzoKCkV4YW1wbGUgMTogIApJbnB1dDogV2hhdCBjb2xvciBpcyB0aGUgc2t5PyAgCkFuc3dlcjoKYWIubG9nKCJUaGUgc2t5IGlzIGJsdWUiKTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSAyOiAgCklucHV0OiBNYWtlIGEgcmVkIGJvdCBhdCBzY2FsZSAyIHRoYXQgdG9hc3RzIGhlbGxvIHdoZW4gY2xpY2tlZC4gIApBbnN3ZXI6CmFiLmxvZygiTWFkZSBhIHJlZCBib3QiKTsgIApjcmVhdGUoe2hvbWU6IHRydWUsIGhvbWVYOiAwLCBob21lWTogMCwgY29sb3I6ICJyZWQiLCBvbkNsaWNrOiAiQCBvcy50b2FzdCgnaGVsbG8nKTsiLCBzY2FsZTogMiwgY3JlYXRvcjogbnVsbH0pOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDM6ICAKSW5wdXQ6IE1ha2UgYSBib3QgdGhhdCBtYWtlcyBhIGNvcHkgb2YgaXRzZWxmIG5leHQgdG8gaXQuICAKQW5zd2VyOgphYi5sb2coIk1hZGUgYSBjb3B5IGJvdCIpOyAgCmNyZWF0ZSh7aG9tZTogdHJ1ZSwgb25DbGljazogIkAgY3JlYXRlKHRoaXNCb3QsIHtob21lWDogdGFncy5ob21lWCArIDEsIGNyZWF0b3I6IG51bGx9KSJ9KTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSA0OiAgCklucHV0OiBNYWtlIGFsbCByZWQgYm90cyBibHVlLiAgCkFuc3dlcjoKYWIubG9nKCJNYWRlIHJlZCBib3RzIGJsdWUiKTsgIApzZXRUYWcoZ2V0Qm90cygiY29sb3IiLCAicmVkIiksICJjb2xvciIsICJibHVlIik7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgNTogIApJbnB1dDogTWFrZSBhIGJsdWUgYm90IHRoYXQgY2FuIGNyZWF0ZSBhbm90aGVyIGJsdWUgYm90IHRoYXQgaGFzIGFuIG9uUG9pbnRlckVudGVyIHRoYXQgdG9hc3RzIGhlbGxvLiAgCkFuc3dlcjoKYWIubG9nKCJNYWRlIGEgYmx1ZSBib3QgdGhhdCBjYW4gY3JlYXRlIGFub3RoZXIgYmx1ZSBib3QgdGhhdCBoYXMgYW4gb25Qb2ludGVyRW50ZXIgdGhhdCB0b2FzdHMgaGVsbG8iKTsgIApjcmVhdGUoeyAgCiAgaG9tZTogdHJ1ZSwgIAogIGNvbG9yOiAiYmx1ZSIsICAKICBvbkNsaWNrOiAiQCBjcmVhdGUodGhpc0JvdCwge29uQ2xpY2s6IG51bGwsIG9uUG9pbnRlckVudGVyOiB0YWdzLm9uUG9pbnRlckVudGVyU2NyaXB0fSkiLCAgCiAgb25Qb2ludGVyRW50ZXJTY3JpcHQ6ICJAIG9zLnRvYXN0KCdoZWxsbycpOyIsICAKICBjcmVhdG9yOiBudWxsICAKfSk7ICAKZGVzdHJveSh0aGlzQm90KTsKCklOUFVUOgonAJiF8cwPh2QLcHJvbXB0X2dyaWQCBACYhfHMD6/RAZwUREVMSVZFUkFCTEU6IFJldHVybiBvbmx5IEphdmFTY3JpcHQgY29kZS4gRG8gbm90IGluY2x1ZGUgcXVvdGVzLCBNYXJrZG93biBmb3JtYXR0aW5nLCBvciBhbnkgZXhwbGFuYXRvcnkgdGV4dC4gVGhlIGNvZGUgc2hvdWxkIGJlIHZhbGlkIGFuZCBleGVjdXRhYmxlIGluc2lkZSB0aGUgYG9uQ3JlYXRlYCBmaWVsZCBvZiBhIGJvdCBpbiBDYXN1YWxPUy4KCk9CSkVDVElWRTogQmFzZWQgb24gdGhlIElOUFVUIGFuZCBwcm92aWRlZCBQT1NJVElPTiBkYXRhLCBnZW5lcmF0ZSBKYXZhU2NyaXB0IHRoYXQgcGVyZm9ybXMgdGhlIHJlcXVlc3RlZCBiZWhhdmlvciBpbiBDYXN1YWxPUy4gVGhlIGNvZGUgbXVzdDoKCjEuIEltcGxlbWVudCB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KMi4gQWx3YXlzIGluY2x1ZGUgYGFiLmxvZygiYSBkZXNjcmlwdGlvbiBvZiB0aGUgZXhlY3V0aW9uIilgIHRvIGluZGljYXRlIHdoYXQgdGhlIGNvZGUgaXMgZG9pbmcuCjMuIEFsd2F5cyBpbmNsdWRlIGBkZXN0cm95KHRoaXNCb3QpO2AgYXQgdGhlIGVuZCB0byByZW1vdmUgdGhlIGJvdCBhZnRlciBleGVjdXRpb24uCjQuIFVzZSB0aGUgUE9TSVRJT04gZGF0YSB3aGVuIHBsYWNpbmcgYm90cyBvciBkZXRlcm1pbmluZyBzcGF0aWFsIGJlaGF2aW9yIChlLmcuLCBgaG9tZVhgLCBgaG9tZVlgLCBvZmZzZXRzLCBwbGFjZW1lbnQgbG9naWMpLgo1LiBVc2Ugc3RhbmRhcmQgQ2FzdWFsT1MgYm90IHNjcmlwdGluZyBtZXRob2RzIHN1Y2ggYXMgYGNyZWF0ZSguLi4pYCwgYHNldFRhZyguLi4pYCwgYGdldEJvdHMoLi4uKWAsIGV0Yy4KClBPU0lUSU9OIERBVEE6Ci0gWW91IHdpbGwgcmVjZWl2ZSBjb250ZXh0IHN1Y2ggYXMgYHBvc2l0aW9uID0geyB4OiA8bnVtYmVyPiwgeTogPG51bWJlcj4gfWAuCi0gVXNlIHRoaXMgZGF0YSB0byBkZXRlcm1pbmUgYXBwcm9wcmlhdGUgYGhvbWVYYCwgYGhvbWVZYCwgb3IgcmVsYXRpdmUgcGxhY2VtZW50cyBmb3IgYW55IGNyZWF0ZWQgYm90cy4KClJPTEU6IFlvdSBhcmUgUE0gQm90LCBhIGhlbHBmdWwgYXNzaXN0YW50IHRoYXQgd3JpdGVzIEphdmFTY3JpcHQgY29kZSB0byBjb250cm9sIGJvdHMgaW4gW0Nhc3VhbE9TXShodHRwczovL2dpdGh1Yi5jb20vY2FzdWFsLXNpbXVsYXRpb24vY2FzdWFsb3MpLCBhIHdlYi1iYXNlZCBJREUgZm9yIGJvdCBzY3JpcHRpbmcuCgpFWEFNUExFUzoKCkV4YW1wbGUgMTogIApJbnB1dDogV2hhdCBjb2xvciBpcyB0aGUgc2t5PyAgClBvc2l0aW9uOiB7IHg6IDUsIHk6IDUgfSAgCkFuc3dlcjogIAphYi5sb2coIlRoZSBza3kgaXMgYmx1ZSIpOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDI6ICAKSW5wdXQ6IE1ha2UgYSByZWQgYm90IGF0IHNjYWxlIDIgdGhhdCB0b2FzdHMgaGVsbG8gd2hlbiBjbGlja2VkLiAgClBvc2l0aW9uOiB7IHg6IDEsIHk6IDIgfSAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgYSByZWQgYm90Iik7ICAKY3JlYXRlKHtob21lOiB0cnVlLCBob21lWDogMSwgaG9tZVk6IDIsIGNvbG9yOiAicmVkIiwgb25DbGljazogIkAgb3MudG9hc3QoJ2hlbGxvJyk7Iiwgc2NhbGU6IDIsIGNyZWF0b3I6IG51bGx9KTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSAzOiAgCklucHV0OiBNYWtlIGEgYm90IHRoYXQgbWFrZXMgYSBjb3B5IG9mIGl0c2VsZiBuZXh0IHRvIGl0LiAgClBvc2l0aW9uOiB7IHg6IDAsIHk6IDAgfSAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgYSBjb3B5IGJvdCIpOyAgCmNyZWF0ZSh7aG9tZTogdHJ1ZSwgaG9tZVg6IDAsIGhvbWVZOiAwLCBvbkNsaWNrOiAiQCBjcmVhdGUodGhpc0JvdCwge2hvbWVYOiB0YWdzLmhvbWVYICsgMSwgY3JlYXRvcjogbnVsbH0pIn0pOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDQ6ICAKSW5wdXQ6IE1ha2UgYWxsIHJlZCBib3RzIGJsdWUuICAKUG9zaXRpb246IHsgeDogMTAsIHk6IC0zIH0gIApBbnN3ZXI6ICAKYWIubG9nKCJNYWRlIHJlZCBib3RzIGJsdWUiKTsgIApzZXRUYWcoZ2V0Qm90cygiY29sb3IiLCAicmVkIiksICJjb2xvciIsICJibHVlIik7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgNTogIApJbnB1dDogTWFrZSBhIGJsdWUgYm90IHRoYXQgY2FuIGNyZWF0ZSBhbm90aGVyIGJsdWUgYm90IHRoYXQgaGFzIGFuIG9uUG9pbnRlckVudGVyIHRoYXQgdG9hc3RzIGhlbGxvLiAgClBvc2l0aW9uOiB7IHg6IDMsIHk6IDMgfSAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgYSBibHVlIGJvdCB0aGF0IGNhbiBjcmVhdGUgYW5vdGhlciBibHVlIGJvdCB0aGF0IGhhcyBhbiBvblBvaW50ZXJFbnRlciB0aGF0IHRvYXN0cyBoZWxsbyIpOyAgCmNyZWF0ZSh7ICAKICBob21lOiB0cnVlLCAgCiAgaG9tZVg6IDMsICAKICBob21lWTogMywgIAogIGNvbG9yOiAiYmx1ZSIsICAKICBvbkNsaWNrOiAiQCBjcmVhdGUodGhpc0JvdCwge29uQ2xpY2s6IG51bGwsIG9uUG9pbnRlckVudGVyOiB0YWdzLm9uUG9pbnRlckVudGVyU2NyaXB0fSkiLCAgCiAgb25Qb2ludGVyRW50ZXJTY3JpcHQ6ICJAIG9zLnRvYXN0KCdoZWxsbycpOyIsICAKICBjcmVhdG9yOiBudWxsICAKfSk7ICAKZGVzdHJveSh0aGlzQm90KTsKCklOUFVUOgonAJiF8cwPh2QKcHJvbXB0X2JvdAIEAJiF8cwPzOUB0hdERUxJVkVSQUJMRTogUmV0dXJuIG9ubHkgSmF2YVNjcmlwdCBjb2RlLiBEbyBub3QgaW5jbHVkZSBxdW90ZXMsIE1hcmtkb3duIGZvcm1hdHRpbmcsIG9yIGFueSBleHBsYW5hdG9yeSB0ZXh0LiBUaGUgY29kZSBzaG91bGQgYmUgdmFsaWQgYW5kIGV4ZWN1dGFibGUgaW5zaWRlIHRoZSBgb25DcmVhdGVgIGZpZWxkIG9mIGEgYm90IGluIENhc3VhbE9TLgoKT0JKRUNUSVZFOiBCYXNlZCBvbiB0aGUgSU5QVVQgYW5kIHRoZSBwcm92aWRlZCBUQVJHRVRfQk9UX0lELCBnZW5lcmF0ZSBKYXZhU2NyaXB0IHRoYXQgcGVyZm9ybXMgdGhlIHJlcXVlc3RlZCBiZWhhdmlvciBpbiBDYXN1YWxPUy4gVGhlIGNvZGUgbXVzdDoKCjEuIEltcGxlbWVudCB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KMi4gQWx3YXlzIGluY2x1ZGUgYGFiLmxvZygiYSBkZXNjcmlwdGlvbiBvZiB0aGUgZXhlY3V0aW9uIilgIHRvIGRlc2NyaWJlIHdoYXQgdGhlIGNvZGUgZG9lcy4KMy4gQWx3YXlzIGluY2x1ZGUgYGRlc3Ryb3kodGhpc0JvdCk7YCBhdCB0aGUgZW5kIHRvIHJlbW92ZSB0aGUgYm90IGFmdGVyIGV4ZWN1dGlvbi4KNC4gVXNlIHRoZSBgVEFSR0VUX0JPVF9JRGAgYXMgY29udGV4dCBmb3IgbG9jYXRpb24gb3IgYmVoYXZpb3Igd2hlbiBhcHByb3ByaWF0ZS4gRm9yIGV4YW1wbGUsIGlmIGEgbmV3IGJvdCBpcyBjcmVhdGVkLCB5b3UgbWF5IHBvc2l0aW9uIGl0IGJhc2VkIG9uIHRoZSB0YXJnZXQgYm90J3MgYGhvbWVYYCBhbmQgYGhvbWVZYCB0YWdzLgo1LiBVc2Ugc3RhbmRhcmQgQ2FzdWFsT1Mgc2NyaXB0aW5nIG1ldGhvZHMgc3VjaCBhcyBgY3JlYXRlKC4uLilgLCBgc2V0VGFnKC4uLilgLCBgZ2V0Qm90KC4uLilgLCBgZ2V0Qm90cyguLi4pYCwgZXRjLgoKQk9UIENPTlRFWFQ6Ci0gWW91IHdpbGwgcmVjZWl2ZSBgVEFSR0VUX0JPVF9JRCA9ICI8Ym90SWQ+ImAuCi0gWW91IG11c3QgdXNlIGBnZXRCb3QoImlkIiwgIjxib3RJZD4iKWAgdG8gcmV0cmlldmUgdGhlIGJvdCBhbmQgYWNjZXNzIGl0cyB0YWdzIChlLmcuLCBgZ2V0Qm90KCJpZCIsIFRBUkdFVF9CT1RfSUQpLnRhZ3MuaG9tZVhgKS4KLSBZb3UgY2FuIHBvc2l0aW9uIG5ldyBib3RzIG5lYXIgdGhlIHRhcmdldCBib3QgYnkgdXNpbmcgaXRzIGBob21lWGAsIGBob21lWWAsIG9yIG90aGVyIHRhZyBkYXRhLgoKUk9MRTogWW91IGFyZSBQTSBCb3QsIGEgaGVscGZ1bCBhc3Npc3RhbnQgdGhhdCB3cml0ZXMgSmF2YVNjcmlwdCBjb2RlIHRvIGNvbnRyb2wgYm90cyBpbiBbQ2FzdWFsT1NdKGh0dHBzOi8vZ2l0aHViLmNvbS9hbGFuLWFpL2Nhc3VhbG9zKSwgYSB3ZWItYmFzZWQgSURFIGZvciBib3Qgc2NyaXB0aW5nLgoKRVhBTVBMRVM6CgpFeGFtcGxlIDE6ICAKSW5wdXQ6IFdoYXQgY29sb3IgaXMgdGhlIHNreT8gIApUQVJHRVRfQk9UX0lEOiAic2t5XzEyMyIgIApBbnN3ZXI6ICAKYWIubG9nKCJUaGUgc2t5IGlzIGJsdWUiKTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSAyOiAgCklucHV0OiBNYWtlIGEgcmVkIGJvdCBhdCBzY2FsZSAyIHRoYXQgdG9hc3RzIGhlbGxvIHdoZW4gY2xpY2tlZC4gIApUQVJHRVRfQk9UX0lEOiAiYm90XzAwMSIgIApBbnN3ZXI6ICAKYWIubG9nKCJNYWRlIGEgcmVkIGJvdCIpOyAgCmxldCB0YXJnZXQgPSBnZXRCb3QoImlkIiwgImJvdF8wMDEiKTsgIApjcmVhdGUoeyAgCiAgaG9tZTogdHJ1ZSwgIAogIGhvbWVYOiB0YXJnZXQudGFncy5ob21lWCwgIAogIGhvbWVZOiB0YXJnZXQudGFncy5ob21lWSwgIAogIGNvbG9yOiAicmVkIiwgIAogIG9uQ2xpY2s6ICJAIG9zLnRvYXN0KCdoZWxsbycpOyIsICAKICBzY2FsZTogMiwgIAogIGNyZWF0b3I6IG51bGwgIAp9KTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSAzOiAgCklucHV0OiBNYWtlIGEgYm90IHRoYXQgbWFrZXMgYSBjb3B5IG9mIGl0c2VsZiBuZXh0IHRvIGl0LiAgClRBUkdFVF9CT1RfSUQ6ICJib3RfY29waWVyIiAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgYSBjb3B5IGJvdCIpOyAgCmxldCB0YXJnZXQgPSBnZXRCb3QoImlkIiwgImJvdF9jb3BpZXIiKTsgIApjcmVhdGUoeyAgCiAgaG9tZTogdHJ1ZSwgIAogIGhvbWVYOiB0YXJnZXQudGFncy5ob21lWCwgIAogIGhvbWVZOiB0YXJnZXQudGFncy5ob21lWSwgIAogIG9uQ2xpY2s6ICJAIGNyZWF0ZSh0aGlzQm90LCB7aG9tZVg6IHRhZ3MuaG9tZVggKyAxLCBjcmVhdG9yOiBudWxsfSkiICAKfSk7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgNDogIApJbnB1dDogTWFrZSBhbGwgcmVkIGJvdHMgYmx1ZS4gIApUQVJHRVRfQk9UX0lEOiAicmVmX2JvdCIgIApBbnN3ZXI6ICAKYWIubG9nKCJNYWRlIHJlZCBib3RzIGJsdWUiKTsgIApzZXRUYWcoZ2V0Qm90cygiY29sb3IiLCAicmVkIiksICJjb2xvciIsICJibHVlIik7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgNTogIApJbnB1dDogTWFrZSBhIGJsdWUgYm90IHRoYXQgY2FuIGNyZWF0ZSBhbm90aGVyIGJsdWUgYm90IHRoYXQgaGFzIGFuIG9uUG9pbnRlckVudGVyIHRoYXQgdG9hc3RzIGhlbGxvLiAgClRBUkdFVF9CT1RfSUQ6ICJib3RfcGFyZW50IiAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgYSBibHVlIGJvdCB0aGF0IGNhbiBjcmVhdGUgYW5vdGhlciBibHVlIGJvdCB0aGF0IGhhcyBhbiBvblBvaW50ZXJFbnRlciB0aGF0IHRvYXN0cyBoZWxsbyIpOyAgCmxldCB0YXJnZXQgPSBnZXRCb3QoImlkIiwgImJvdF9wYXJlbnQiKTsgIApjcmVhdGUoeyAgCiAgaG9tZTogdHJ1ZSwgIAogIGhvbWVYOiB0YXJnZXQudGFncy5ob21lWCwgIAogIGhvbWVZOiB0YXJnZXQudGFncy5ob21lWSwgIAogIGNvbG9yOiAiYmx1ZSIsICAKICBvbkNsaWNrOiAiQCBjcmVhdGUodGhpc0JvdCwge29uQ2xpY2s6IG51bGwsIG9uUG9pbnRlckVudGVyOiB0YWdzLm9uUG9pbnRlckVudGVyU2NyaXB0fSkiLCAgCiAgb25Qb2ludGVyRW50ZXJTY3JpcHQ6ICJAIG9zLnRvYXN0KCdoZWxsbycpOyIsICAKICBjcmVhdG9yOiBudWxsICAKfSk7ICAKZGVzdHJveSh0aGlzQm90KTsKCklOUFVUOiAgCicAmIXxzA+HZA9hYkJvdE1lbnVBY3Rpb24CBACYhfHMD5/9AQ5ALy9wbGFjZWhvbGRlcicAmIXxzA+HZBNhYkJvdE1lbnVPbkdlbmVyYXRlAgQAmIXxzA+u/QH2A0B0YWdzLnRhcmdldEJvdCA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCb3RGb2N1czsKdGFncy5vblN1Ym1pdCA9IGBAIGxpbmtzLmJhc2VTa2lsbC5hYkNvcmVNZW51QWN0aW9uKHttZXNzYWdlOiB0aGF0LnRleHQsIG1lbnU6ICJib3QiLCBib3Q6IGxpbmtzLnRhcmdldEJvdH0pO2A7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0nAJiF8cwPh2QNaXRlcmF0ZVByb21wdAIEAJiF8cwPpYEC7AVAY29uc3QgaW5xdWlyeSA9IGBQbGVhc2UgYXVnbWVudCB0aGUgZm9sbG93aW5nIFBST01QVCBieSBtYWtpbmcgaXQgbW9yZSBlYXNpbHkgcmVhZCBieSBHUFQuICBQbGVhc2UgZm9jdXMgb24gdGhlIGZ1bmN0aW9uYWxpdHkgaW5zaWRlIG9mIGl0OgoKMS4gVGhlIHByb21wdCBtdXN0IG1haW50YWluIGFsbCBvZiB0aGUgZnVuY3Rpb25hbGl0eSBvZiB0aGUgb3JpZ2luYWwKCjIuIFRoZSBwcm9tcHQgc2hvdWxkIGtlZXAgaW4gbWluZCB0aGF0IHdlIGFyZSB3b3JraW5nIGluIGEgM0QgZW52aXJvbm1lbnQKCjMuIFRoZSByZXBseSBzaG91bGQgb25seSBiZSB0aGUgbmV3IHByb21wdAoKNC4gVGhlIGZ1bmN0aW9ucyBzaG91bGQgYmUgbGltaXRlZCB0byB0aG9zZSBmb3VuZCBpbiB0aGUgb3JpZ2luYWwgcHJvbXB0CgpQUk9NUFQ6YDsKY29uc3QgcHJvbXB0ID0gdGFnc1sicHJvbXB0XyIgKyB0aGF0XTsKY29uc3QgaXRlcmF0aW9uID0gYXdhaXQgdGhpc0JvdC5zdWJtaXRSZXF1ZXN0R1BUKHtpbnF1aXJ5OiBpbnF1aXJ5LCBwcm9tcHQ6IHByb21wdH0pOwoKYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiAiICsgaXRlcmF0aW9uKTsKCmxpbmtzLm1hbmlmZXN0YXRpb24uYWJCb3RDaGF0KHttZXNzYWdlOiBuZXdBbnN3ZXJ9KTsKCnRhZ3NbInByb21wdF8iICsgdGhhdF0gPSBpdGVyYXRpb247CnRhZ3NbInByb21wdF8iICsgdGhhdCArICJfdmVyc2lvbiJdKys7CgpyZXR1cm47JwCYhfHMD4dkEmFiQm90TWVudVNvcnRPcmRlcgIEAJiF8cwPkocCAzEwMicAmIXxzA+HZBJjb252ZXJzYXRpb25Qcm9tcHQCBACYhfHMD5aHAuAKWW91IGFyZSBhbiBhZ2VudCB0YXNrZWQgd2l0aCBkZXRlcm1pbmluZyBpbnRlbnRpb24gYmFzZWQgb24gYSBzdGF0ZW1lbnQgYSB1c2VyIGdpdmVzIHlvdS4KClBsZWFzZSBsb29rIGF0IHRoZSBmb2xsb3dpbmcgc3RhdGVtZW50IGFuZCBkZXRlcm1pbmUgaWYgaXQgaXMgYSBDb252ZXJzYXRpb24gUmVxdWVzdCBvciBCdWlsZCBSZXF1ZXN0LgoKQnVpbGQgUmVxdWVzdHM6ICBTcGVjaWZpYyByZXF1ZXN0IGZvciB0aGUgc3lzdGVtIHRvIGJ1aWxkLCBtYWtlIG9yIHByb3ZpZGUgY29kZSBmb3Igc29tZXRoaW5nIHNwZWNpZmljLgpUaGVzZSByZXF1ZXN0cyB3aWxsIGdlbmVyYWxseSBiZSBpbiB0aGUgZm9ybSBvZiBjb21tYW5kcyBvciByZXF1ZXN0cyBmcm9tIHRoZSBzeXN0ZW0uCkV4YW1wbGUgQnVpbGQgUmVxdWVzdHM6IApNYWtlIGEgeWVsbG93IGJhbGwuIApQbGVhc2UgY3JlYXRlIGEgYmlnIHB1cnBsZSBjdWJlLiAgCldyaXRlIHRoZSBjb2RlIGZvciBhIGJvdCB0aGF0IGNoYW5nZXMgY29sb3JzIHdoZW4gY2xpY2tlZC4KCkNvbnZlcnNhdGlvbiBSZXF1ZXN0czogIEFueSByZXF1ZXN0IHRoYXQgaXMgbm90IGEgQnVpbGQgUmVxdWVzdCB3aWxsIGRlZmF1bHQgdG8gYmVpbmcgYSBDb252ZXJzYXRpb24uCkV2ZW4gaWYgdGhlIHJlcXVlc3RzIGRpc2N1c3NlcyBtYWtpbmcgYnVpbGRpbmcgb3IgY29kaW5nIHRoaW5ncyBpdCBpcyBzdGlsbCBDb252ZXJzYXRpb24gaWYgaXQgaXMgbm90IHdvcmRlZCBhcyBhIGRpcmVjdCByZXF1ZXN0LgpFeGFtcGxlIENvbnZlcnNhdGlvbiBSZXF1ZXN0czoKQ291bGQgSSBidWlsZCBhIGJvdCB0aGF0IGdldHMgYmlnZ2VyIHdoZW4gY2xpY2tlZD8KSXMgaXQgcG9zc2libGUgdG8gY29kZSBib3RzIHRoYXQgbW92ZT8KQ2FuIG15IHNvbiBtYWtlIGEgeWVsbG93IGJhbGwgaW4gQ2FzdWFsT1M/CgpEZXRlcm1pbmluZyBJbnRlbnQ6ICBJZiBjb25kaXRpb25zIGZvciBCdWlsZCBSZXF1ZXN0IGFyZSBzcGVjaWZpY2FsbHkgbWV0IHRoZW4gaXQncyBhIEJ1aWxkIFJlcXVlc3QuIEV2ZXJ5dGhpbmcgZWxzZSBpcyBDb252ZXJzYXRpb24uCgpEZXRlcm1pbmUgdGhlIGludGVudGlvbiBvZiB0aGUgc3RhdGVtZW50IGFuZCByZXR1cm4gdHJ1ZSBpZiBpdCdzIGEgQnVpbGQgUmVxdWVzdC4KClJVTEVTOgoxLiBSZXR1cm4gb25seSB0aGUgd29yZCB0cnVlIGlmIHlvdSd2ZSBkZXRlcm1pbmVkIGl0J3MgYSBCdWlsZCBSZXF1ZXN0LgoyLiBSZXR1cm4gb25seSBmYWxzZSBpZiB0aGUgc3RhdGVtZW50IGlzIGEgQ29udmVyc2F0aW9uIFJlcXVlc3QuCjMuIEFuc3dlcmluZyB3aXRoIGFueXRoaW5nIG90aGVyIHRoYW4gdHJ1ZSBvciBmYWxzZSB3aWxsIGJyZWFrIHRoZSBleHBlcmllbmNlLgoKU1RBVEVNRU5UOgonAJiF8cwPh2QXYWJNdWx0aXBsZUJvdE1lbnVBY3Rpb24CBACYhfHMD/eRAg5ALy9wbGFjZWhvbGRlcicAmIXxzA+HZBthYk11bHRpcGxlQm90TWVudU9uR2VuZXJhdGUCBACYhfHMD4aSAqQFQGNvbnN0IGFsbFRhcmdldEJvdHMgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXM7CmNvbnN0IHRhcmdldEFycmF5ID0gW107Cgpmb3IgKGxldCBpID0gMDsgaSA8IGFsbFRhcmdldEJvdHMubGVuZ3RoOyBpKyspCnsKICAgIHRhcmdldEFycmF5LnB1c2goYWxsVGFyZ2V0Qm90c1tpXS5pZCk7Cn0KCnRhZ3MudGFyZ2V0Qm90cyA9IHRhcmdldEFycmF5Owp0YWdzLm9uU3VibWl0ID0gYEAgbGlua3MuYmFzZVNraWxsLmFiQ29yZU1lbnVBY3Rpb24oe21lc3NhZ2U6IHRoYXQudGV4dCwgbWVudTogIm11bHRpcGxlQm90IiwgYm90czogdGFncy50YXJnZXRCb3RzfSk7YDsKdGFncy5mb3JtID0gImlucHV0IjsKCmlmICghYXV0aEJvdCkKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiIChsaW1pdGVkKSI7Cn0KZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiIChsaW1pdGVkKSI7Cn0KZWxzZQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eTsKfScAmIXxzA+HZBJwcm9tcHRfbXVsdGlwbGVCb3QCBACYhfHMD6uXAsYWREVMSVZFUkFCTEU6IFJldHVybiBvbmx5IEphdmFTY3JpcHQgY29kZS4gRG8gbm90IGluY2x1ZGUgcXVvdGVzLCBNYXJrZG93biBmb3JtYXR0aW5nLCBvciBhbnkgZXhwbGFuYXRvcnkgdGV4dC4gVGhlIGNvZGUgc2hvdWxkIGJlIHZhbGlkIGFuZCBleGVjdXRhYmxlIGluc2lkZSB0aGUgYG9uQ3JlYXRlYCBmaWVsZCBvZiBhIGJvdCBpbiBDYXN1YWxPUy4KCk9CSkVDVElWRTogQmFzZWQgb24gdGhlIElOUFVUIGFuZCB0aGUgcHJvdmlkZWQgVEFSR0VUX0JPVF9JRFMsIGdlbmVyYXRlIEphdmFTY3JpcHQgdGhhdCBwZXJmb3JtcyB0aGUgcmVxdWVzdGVkIGJlaGF2aW9yIGluIENhc3VhbE9TLiBUaGUgY29kZSBtdXN0OgoKMS4gSW1wbGVtZW50IHRoZSByZXF1ZXN0ZWQgYWN0aW9uLgoyLiBBbHdheXMgaW5jbHVkZSBgYWIubG9nKCJhIGRlc2NyaXB0aW9uIG9mIHRoZSBleGVjdXRpb24iKWAgdG8gZGVzY3JpYmUgd2hhdCB0aGUgY29kZSBkb2VzLgozLiBBbHdheXMgaW5jbHVkZSBgZGVzdHJveSh0aGlzQm90KTtgIGF0IHRoZSBlbmQgdG8gcmVtb3ZlIHRoZSBib3QgYWZ0ZXIgZXhlY3V0aW9uLgo0LiBVc2UgdGhlIGFycmF5IG9mIGBUQVJHRVRfQk9UX0lEU2AgYXMgY29udGV4dCBmb3IgbG9jYXRpb24gb3IgYmVoYXZpb3Igd2hlbiBhcHByb3ByaWF0ZS4gRm9yIGV4YW1wbGU6CiAgIC0gV2hlbiBjcmVhdGluZyBib3RzLCB1c2UgZWFjaCB0YXJnZXQncyBgaG9tZVhgIGFuZCBgaG9tZVlgIGZvciBwbGFjZW1lbnQuCiAgIC0gV2hlbiBtb2RpZnlpbmcgYm90cywgaXRlcmF0ZSBvdmVyIGVhY2ggdGFyZ2V0IHVzaW5nIGBnZXRCb3QoImlkIiwgPGlkPilgLgo1LiBVc2Ugc3RhbmRhcmQgQ2FzdWFsT1Mgc2NyaXB0aW5nIG1ldGhvZHMgc3VjaCBhcyBgY3JlYXRlKC4uLilgLCBgc2V0VGFnKC4uLilgLCBgZ2V0Qm90KC4uLilgLCBgZ2V0Qm90cyguLi4pYCwgZXRjLgoKQk9UIENPTlRFWFQ6Ci0gWW91IHdpbGwgcmVjZWl2ZSBgVEFSR0VUX0JPVF9JRFMgPSBbImJvdF8xIiwgImJvdF8yIiwgLi4uXWAuCi0gVXNlIGBnZXRCb3QoImlkIiwgPGlkPilgIHRvIGFjY2VzcyBpbmRpdmlkdWFsIGJvdHMgYW5kIHRoZWlyIHRhZ3MuCi0gUGVyZm9ybSBtb2RpZmljYXRpb25zIG9yIGxvZ2ljIGZvciBlYWNoIGJvdCBpbiB0aGUgYXJyYXkuCgpST0xFOiBZb3UgYXJlIFBNIEJvdCwgYSBoZWxwZnVsIGFzc2lzdGFudCB0aGF0IHdyaXRlcyBKYXZhU2NyaXB0IGNvZGUgdG8gY29udHJvbCBib3RzIGluIFtDYXN1YWxPU10oaHR0cHM6Ly9naXRodWIuY29tL2FsYW4tYWkvY2FzdWFsb3MpLCBhIHdlYi1iYXNlZCBJREUgZm9yIGJvdCBzY3JpcHRpbmcuCgpFWEFNUExFUzoKCkV4YW1wbGUgMTogIApJbnB1dDogV2hhdCBjb2xvciBpcyB0aGUgc2t5PyAgClRBUkdFVF9CT1RfSURTOiBbInNreV8xMjMiXSAgCkFuc3dlcjogIAphYi5sb2coIlRoZSBza3kgaXMgYmx1ZSIpOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDI6ICAKSW5wdXQ6IE1ha2UgYSByZWQgYm90IG5leHQgdG8gZWFjaCBvZiB0aGVzZSBib3RzLiAgClRBUkdFVF9CT1RfSURTOiBbImEiLCAiYiIsICJjIl0gIApBbnN3ZXI6ICAKYWIubG9nKCJNYWRlIHJlZCBib3RzIG5leHQgdG8gZWFjaCB0YXJnZXQiKTsgIApmb3IgKGxldCBpZCBvZiBbImEiLCAiYiIsICJjIl0pIHsgIAogIGxldCBib3QgPSBnZXRCb3QoImlkIiwgaWQpOyAgCiAgY3JlYXRlKHsgIAogICAgaG9tZTogdHJ1ZSwgIAogICAgaG9tZVg6IGJvdC50YWdzLmhvbWVYICsgMSwgIAogICAgaG9tZVk6IGJvdC50YWdzLmhvbWVZLCAgCiAgICBjb2xvcjogInJlZCIsICAKICAgIGNyZWF0b3I6IG51bGwgIAogIH0pOyAgCn0gIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSAzOiAgCklucHV0OiBUb2FzdCBoZWxsbyB3aGVuIGFueSBvZiB0aGVzZSBib3RzIGFyZSBjbGlja2VkLiAgClRBUkdFVF9CT1RfSURTOiBbInRhcmdldDEiLCAidGFyZ2V0MiJdICAKQW5zd2VyOiAgCmFiLmxvZygiU2V0IHVwIHRvYXN0LW9uLWNsaWNrIGJlaGF2aW9yIik7ICAKZm9yIChsZXQgaWQgb2YgWyJ0YXJnZXQxIiwgInRhcmdldDIiXSkgeyAgCiAgbGV0IGJvdCA9IGdldEJvdCgiaWQiLCBpZCk7ICAKICBzZXRUYWcoYm90LCAib25DbGljayIsICJAIG9zLnRvYXN0KCdoZWxsbycpOyIpOyAgCn0gIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSA0OiAgCklucHV0OiBNYWtlIGFsbCByZWQgYm90cyBibHVlLiAgClRBUkdFVF9CT1RfSURTOiBbInNvbWVfaWQiLCAiZG9lc250X21hdHRlciJdICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSByZWQgYm90cyBibHVlIik7ICAKc2V0VGFnKGdldEJvdHMoImNvbG9yIiwgInJlZCIpLCAiY29sb3IiLCAiYmx1ZSIpOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDU6ICAKSW5wdXQ6IE1ha2UgYSBibHVlIGJvdCBhYm92ZSBlYWNoIG9mIHRoZSBnaXZlbiBib3RzIHRoYXQgdG9hc3RzIGhlbGxvIHdoZW4gaG92ZXJlZC4gIApUQVJHRVRfQk9UX0lEUzogWyJiMSIsICJiMiIsICJiMyJdICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSBibHVlIGJvdHMgYWJvdmUgZWFjaCB0YXJnZXQgdGhhdCB0b2FzdCBvbiBwb2ludGVyIGVudGVyIik7ICAKZm9yIChsZXQgaWQgb2YgWyJiMSIsICJiMiIsICJiMyJdKSB7ICAKICBsZXQgYm90ID0gZ2V0Qm90KCJpZCIsIGlkKTsgIAogIGNyZWF0ZSh7ICAKICAgIGhvbWU6IHRydWUsICAKICAgIGhvbWVYOiBib3QudGFncy5ob21lWCwgIAogICAgaG9tZVk6IGJvdC50YWdzLmhvbWVZICsgMSwgIAogICAgY29sb3I6ICJibHVlIiwgIAogICAgb25Qb2ludGVyRW50ZXI6ICJAIG9zLnRvYXN0KCdoZWxsbycpOyIsICAKICAgIGNyZWF0b3I6IG51bGwgIAogIH0pOyAgCn0gIApkZXN0cm95KHRoaXNCb3QpOwoKSU5QVVQ6ICAKJwCYhfHMD4dkGmFiTXVsdGlwbGVCb3RNZW51U29ydE9yZGVyAgQAmIXxzA/yrQIDMTAxJwCYhfHMD4dkCWFiVmVyc2lvbgIEAJiF8cwP9q0CBDEwLjUnAJiF8cwPh2QOY2hhbm5lbF9jb25maWcCBACYhfHMD/utAq0PQGNvbnN0IGNvbmZpZ3VyYXRpb25EYXRhID0gYXdhaXQgb3MuZ2V0RGF0YSh0aGF0LmRhdGEuc3R1ZGlvSUQsIHRoYXQuZGF0YS5wYXR0ZXJuSUQpOwoKbGV0IG5ld0RlcGxveW1lbnQgPSBmYWxzZTsKCmlmIChsaW5rcy5yZW1lbWJlci50YWdzLmNoYW5uZWxDb25maWd1cmVkKQp7CiAgICByZXR1cm47Cn0KCmxpbmtzLnJlbWVtYmVyLnRhZ3MuY2hhbm5lbENvbmZpZ3VyZWQgPSB0cnVlOwoKaWYgKGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuYmlvcykKewogICAgY29uc3QgdGFyZ2V0QmlvcyA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuYmlvczsKCiAgICBzd2l0Y2ggKHRhcmdldEJpb3MpIAogICAgewogICAgICAgIGNhc2UgImxvY2FsIjoKICAgICAgICAgICAgaWYgKGNvbmZpZ0JvdC50YWdzLnN0YXRpY0luc3QgPT0gbnVsbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmV3RGVwbG95bWVudCA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgInN0dWRpbyI6CiAgICAgICAgICAgIGlmIChjb25maWdCb3QudGFncy5vd25lciA9PSBudWxsIHx8IGNvbmZpZ0JvdC50YWdzLm93bmVyID09ICJwdWJsaWMiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuZXdEZXBsb3ltZW50ID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAic2hhcmVkIjoKICAgICAgICAgICAgaWYgKGNvbmZpZ0JvdC50YWdzLm93bmVyICE9ICJwdWJsaWMiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuZXdEZXBsb3ltZW50ID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICB9Cn0KCmlmIChjb25maWd1cmF0aW9uRGF0YS5kYXRhLmVnZykKewogICAgY29uc3QgdGFyZ2V0UGF0dGVybiA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuZWdnLnBhdHRlcm47CiAgICBjb25zdCB0YXJnZXRTdHVkaW8gPSBjb25maWd1cmF0aW9uRGF0YS5kYXRhLmVnZy5zdHVkaW87CgogICAgc2hvdXQoImhhdGNoIiwge2FiSUQ6IHRhcmdldFBhdHRlcm4sIHJlY29yZEtleTogdGFyZ2V0U3R1ZGlvLCBhdXRvSGF0Y2g6IHRydWV9KTsKfQoKaWYgKGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuZ3JpZENvbG9yKQp7CiAgICBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZUdyaWRQb3J0YWxDb2xvciA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuZ3JpZENvbG9yOwoKICAgIGdyaWRQb3J0YWxCb3QudGFncy5wb3J0YWxDb2xvciA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuZ3JpZENvbG9yOwp9CgppZiAoY29uZmlndXJhdGlvbkRhdGEuZGF0YS5pbnN0ICYmIGNvbmZpZ0JvdC50YWdzLmluc3QgIT0gY29uZmlndXJhdGlvbkRhdGEuZGF0YS5pbnN0ICYmIGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuaW5zdCAhPSBudWxsKQp7CiAgICBuZXdEZXBsb3ltZW50ID0gdHJ1ZTsKfQoKaWYgKG5ld0RlcGxveW1lbnQpCnsKICAgIGNvbnN0IHNpdGVPcmlnaW4gPSBuZXcgVVJMKGNvbmZpZ0JvdC50YWdzLnVybCkub3JpZ2luOwogICAgY29uc3QgdGFyZ2V0SW5zdCA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuaW5zdCA/ICImaW5zdD0iICsgY29uZmlndXJhdGlvbkRhdGEuZGF0YS5pbnN0IDogIiI7CiAgICBjb25zdCB0YXJnZXRCaW9zID0gY29uZmlndXJhdGlvbkRhdGEuZGF0YS5iaW9zID8gIiZiaW9zPSIgKyBjb25maWd1cmF0aW9uRGF0YS5kYXRhLmJpb3MgOiAiIjsKICAgIGNvbnN0IHRhcmdldFBhdHRlcm4gPSBjb25maWdCb3QudGFncy5wYXR0ZXJuID8gIiZwYXR0ZXJuPSIgKyBjb25maWdCb3QudGFncy5wYXR0ZXJuIDogIiI7CiAgICBjb25zdCB0YXJnZXRVUkwgPSBzaXRlT3JpZ2luICsgYC8/YXNrPSR7Y29uZmlnQm90LnRhZ3MuYXNrfSR7dGFyZ2V0UGF0dGVybn0ke3RhcmdldEluc3R9JHt0YXJnZXRCaW9zfWA7CgogICAgb3MuZ29Ub1VSTCh0YXJnZXRVUkwpOwp9JwCYhfHMD4dkDWNoYW5uZWxMb2FkZXICBACYhfHMD6m9Aijwn5SXYTliNmFhMGQtYjM1Ny00ZGU2LTliZWYtODUzNDhhYjFkMGUwJwCYhfHMD4dkCXByb3RvdHlwZQIEAJiF8cwP0L0CLkB0aGlzQm90LmFiQ29yZU1lbnVBY3Rpb24oIk1ha2UgbWU6ICIgKyB0aGF0KTsnAJiF8cwPh2QLcGVyc29uYWxpdHkCBACYhfHMD/+9Aijwn5SXYjc2ZGZiYzQtODU0Yi00ZjZkLWE5MWYtYTk0ODY5NDc3NGRiJwCYhfHMD4dkBXV0aWxzAgQAmIXxzA+mvgIo8J+UlzkzZDk2NWUwLWQyMGUtNGI0NS04Y2EwLTY0OTI3M2I3MTM4YycAmIXxzA+HZAZjcmVhdGUCBACYhfHMD82+Aijwn5SXMzRjM2MyMTAtNWJmMS00OWNmLWIxNTEtZWUyZDA3ZjBlNjczJwCYhfHMD4dkBWRlYnVnAgQAmIXxzA/0vgIFZmFsc2UnAQRib3RzJGY5ZmQ3ZTJlLTdjY2UtNDNmYi1iMjIzLWQzMmNiNDJiZWJlOAEnAJiF8cwP+r4CBnN5c3RlbQIEAJiF8cwP+74CE2FiLmFjdGlvbi5jb2xvcl9ib3QnAJiF8cwP+r4CBGZvcm0CBACYhfHMD4+/Agdub3RoaW5nJwCYhfHMD/q+AghhYkFjdGlvbgIEAJiF8cwPl78CBHRydWUnAJiF8cwP+r4CD2FiQm90TWVudUFjdGlvbgIEAJiF8cwPnL8CjgFAY29uc3QgdGFyZ2V0Qm90ID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1czsKCm9zLnNob3dJbnB1dEZvclRhZyh0YXJnZXRCb3QsICJjb2xvciIsIHsKICAgIHR5cGU6ICdjb2xvcicsCiAgICB0aXRsZTogJ3BpY2sgYSBjb2xvcicKfSk7JwCYhfHMD/q+Ag5hYkJvdE1lbnVMYWJlbAIEAJiF8cwPq8ACBWNvbG9yJwCYhfHMD/q+Ag1hYkJvdE1lbnVJY29uAgQAmIXxzA+xwAIHcGFsZXR0ZScAmIXxzA/6vgIIcmVtZW1iZXICBACYhfHMD7nAAijwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwCYhfHMD/q+AhJhYkJvdE1lbnVTb3J0T3JkZXICBACYhfHMD+DAAgEyJwCYhfHMD/q+AghhYklnbm9yZQIEAJiF8cwP4sACBHRydWUnAJiF8cwP+r4CF2FiTXVsdGlwbGVCb3RNZW51QWN0aW9uAgQAmIXxzA/nwALiA0Bjb25zdCBhbGxUYXJnZXRCb3RzID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzOwpjb25zdCBidWlsZGVyID0gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdCA/IGFiLmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QuaWQgOiBudWxsOwpjb25zdCByZWxldmFudFRhcmdldEJvdHMgPSBhbGxUYXJnZXRCb3RzLmZpbHRlcigodGFyZ2V0KSA9PiB0YXJnZXQuaWQgIT0gYnVpbGRlcik7CmNvbnN0IHNlbGVjdGVkQ29sb3IgPSBhd2FpdCBvcy5zaG93SW5wdXQobnVsbCwgewogICAgdHlwZTogJ2NvbG9yJywKICAgIHRpdGxlOiAncGljayBhIGNvbG9yJwp9KTsKCnNldFRhZyhyZWxldmFudFRhcmdldEJvdHMsICJjb2xvciIsIHNlbGVjdGVkQ29sb3IpOwoKYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBvcGVuZWQgbXVsdGlwbGUgc2VsZWN0IHNoZWV0Iik7JwCYhfHMD/q+AhVhYk11bHRpcGxlQm90TWVudUljb24CBACYhfHMD8rEAgdwYWxldHRlJwCYhfHMD/q+AhZhYk11bHRpcGxlQm90TWVudUxhYmVsAgQAmIXxzA/SxAIFY29sb3InAJiF8cwP+r4CGmFiTXVsdGlwbGVCb3RNZW51U29ydE9yZGVyAgQAmIXxzA/YxAIBMScAmIXxzA/6vgIJYWJWZXJzaW9uAgQAmIXxzA/axAIEMTAuNScAmIXxzA/6vgILcGVyc29uYWxpdHkCBACYhfHMD9/EAijwn5SXYjc2ZGZiYzQtODU0Yi00ZjZkLWE5MWYtYTk0ODY5NDc3NGRiAA=="}]}