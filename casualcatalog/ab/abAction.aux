{"version":2,"updates":[{"id":0,"timestamp":1754323482367,"update":"AdQC7rHChA4AJwEEYm90cyQzOTg4MDFmZS00YjM1LTRjZTQtODI2Zi0yMzgzNWMxYjlhYzUBJwDuscKEDgAGc3lzdGVtAgQA7rHChA4BFGFiLmFjdGlvbi5jcmVhdGVfYm90JwDuscKEDgAIYWJBY3Rpb24CBADuscKEDhYEdHJ1ZScA7rHChA4ABGZvcm0CBADuscKEDhsHbm90aGluZycA7rHChA4AC2Rlc2NyaXB0aW9uAgQA7rHChA4jDUNyZWF0ZXMgYm90cy4nAO6xwoQOABBhYkdyaWRNZW51QWN0aW9uAgQA7rHChA4xsQVAY29uc3QgZ3JpZEluZm9ybWF0aW9uID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRGb2N1czsKY29uc3QgbmV3Qm90ID0ge307CgpuZXdCb3QuY3JlYXRvciA9IG51bGw7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uXSA9IHRydWU7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uICsgIlgiXSA9IGdyaWRJbmZvcm1hdGlvbi5wb3NpdGlvbi54OwpuZXdCb3RbZ3JpZEluZm9ybWF0aW9uLmRpbWVuc2lvbiArICJZIl0gPSBncmlkSW5mb3JtYXRpb24ucG9zaXRpb24ueTsKbmV3Qm90LmNvbG9yID0gbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKCmxldCBjcmVhdGVkQm90ID0gY3JlYXRlKG5ld0JvdCk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90Lm1hc2tzLmxpbmVDb2xvciA9IGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QubWFza3MubGluZVRvID0gY3JlYXRlZEJvdC5pZDsKCmxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQm90Rm9jdXMgPSAi8J+UlyIgKyBjcmVhdGVkQm90LmlkOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKHttZW51OiAiYm90In0pOycA7rHChA4AD2FiR3JpZE1lbnVMYWJlbAIEAO6xwoQO4QUDYm90JwDuscKEDgAOYWJHcmlkTWVudUljb24CBADuscKEDuUFB2FkZF9ib3gnAO6xwoQOAAhyZW1lbWJlcgIEAO6xwoQO7QUo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA7rHChA4ADW1hbmlmZXN0YXRpb24CBADuscKEDpQGKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAO6xwoQOAAhhYklnbm9yZQIEAO6xwoQOuwYEdHJ1ZScA7rHChA4AE2FiR3JpZE1lbnVTb3J0T3JkZXICBADuscKEDsAGATEnAO6xwoQOAAlhYlZlcnNpb24CBADuscKEDsIGBDEwLjUnAO6xwoQOAAtwZXJzb25hbGl0eQIEAO6xwoQOxwYo8J+Ul2I3NmRmYmM0LTg1NGItNGY2ZC1hOTFmLWE5NDg2OTQ3NzRkYicBBGJvdHMkNTg0OWFmNTUtNWU4YS00OGQ2LTkxMDYtMTk5NDk4ZTllYzA4AScA7rHChA7uBgZzeXN0ZW0CBADuscKEDu8GEWFiLmFjdGlvbi5kZXN0cm95JwDuscKEDu4GCGFiQWN0aW9uAgQA7rHChA6BBwR0cnVlJwDuscKEDu4GBGZvcm0CBADuscKEDoYHB25vdGhpbmcnAO6xwoQO7gYPYWJCb3RNZW51QWN0aW9uAgQA7rHChA6OB8ACQGNvbnN0IHRhcmdldEJvdCA9IHRoYXQuYm90LmxpbmtzLnRhcmdldEJvdDsKCmlmICh0aGF0LmJvdC5saW5rcy50YXJnZXRPcmlnaW5Cb3RzKSB7CiAgICAvLyBEZXN0cm95IGJvdHMgYmVsb25naW5nIHRvIGFiSURPcmlnaW4uCiAgICBkZXN0cm95KHRoYXQuYm90LmxpbmtzLnRhcmdldE9yaWdpbkJvdHMpOwp9IGVsc2UgewogICAgLy8gRGVzdHJveSB0aGUgc2luZ2xlIHRhcmdldCBib3QuCiAgICBkZXN0cm95KHRhcmdldEJvdCk7Cn0KCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soeyByZXNldDogdHJ1ZSB9KTsnAO6xwoQO7gYOYWJCb3RNZW51TGFiZWwCBADuscKEDs8JB2Rlc3Ryb3knAO6xwoQO7gYNYWJCb3RNZW51SWNvbgIEAO6xwoQO1wkOZGVsZXRlX2ZvcmV2ZXInAO6xwoQO7gYSYWJCb3RNZW51U29ydE9yZGVyAgQA7rHChA7mCQMxMDAnAO6xwoQO7gYIcmVtZW1iZXICBADuscKEDuoJKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAO6xwoQO7gYNbWFuaWZlc3RhdGlvbgIEAO6xwoQOkQoo8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcA7rHChA7uBghhYklnbm9yZQIEAO6xwoQOuAoEdHJ1ZScA7rHChA7uBg5hYkJvdE1lbnVDb2xvcgIEAO6xwoQOvQoHI0Q5MzAzMCcA7rHChA7uBhdhYk11bHRpcGxlQm90TWVudUFjdGlvbgIEAO6xwoQOxQrAA0Bjb25zdCBhbGxUYXJnZXRCb3RzID0gQXJyYXkuaXNBcnJheShsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXMpID8gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzIDogW2xpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1c107CmNvbnN0IGJ1aWxkZXIgPSBhYi5saW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90ID8gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC5pZCA6IG51bGw7CmNvbnN0IHJlbGV2YW50VGFyZ2V0Qm90cyA9IGFsbFRhcmdldEJvdHMuZmlsdGVyKCh0YXJnZXQpID0+IHRhcmdldC5pZCAhPSBidWlsZGVyKTsKCmRlc3Ryb3kocmVsZXZhbnRUYXJnZXRCb3RzKTsKCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soeyByZXNldDogdHJ1ZSB9KTsnAO6xwoQO7gYVYWJNdWx0aXBsZUJvdE1lbnVJY29uAgQA7rHChA6GDg5kZWxldGVfZm9yZXZlcicA7rHChA7uBhZhYk11bHRpcGxlQm90TWVudUxhYmVsAgQA7rHChA6VDgdkZXN0cm95JwDuscKEDu4GGmFiTXVsdGlwbGVCb3RNZW51U29ydE9yZGVyAgQA7rHChA6dDgMxMDAnAO6xwoQO7gYWYWJNdWx0aXBsZUJvdE1lbnVDb2xvcgIEAO6xwoQOoQ4HI0Q5MzAzMCcA7rHChA7uBglhYlZlcnNpb24CBADuscKEDqkOBDEwLjUnAO6xwoQO7gYTYWJCb3RNZW51T25HZW5lcmF0ZQIEAO6xwoQOrg6tB0Bjb25zdCB0YXJnZXRCb3QgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzOwoKaWYgKHRhcmdldEJvdCkgewogICAgdGFncy5sYWJlbCA9ICdkZXN0cm95JzsKICAgIHRhZ3MudGFyZ2V0Qm90ID0gZ2V0TGluayh0YXJnZXRCb3QpOwogICAgdGFncy5vbktleURvd24gPSBgQAogICAgICAgIGlmICh0aGF0LmtleXMuaW5jbHVkZXMoIlNoaWZ0IikpIHsKICAgICAgICAgICAgaWYgKGxpbmtzLnRhcmdldEJvdCAmJiBsaW5rcy50YXJnZXRCb3QudGFncy5hYklET3JpZ2luKSB7CiAgICAgICAgICAgICAgICAvLyBDaGFuZ2UgYnV0dG9uIHRvIGRlc3Ryb3kgYWxsIGJvdHMgd2l0aCBzYW1lIGFiSURPcmlnaW4uCiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRPcmlnaW5Cb3RzID0gZ2V0Qm90cyhiID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYi50YWdzLmFiSURPcmlnaW4gPT09IGxpbmtzLnRhcmdldEJvdC50YWdzLmFiSURPcmlnaW47CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIG1hc2tzLmxhYmVsID0gJ2Rlc3Ryb3kgJyArIGxpbmtzLnRhcmdldEJvdC50YWdzLmFiSURPcmlnaW4gKyAnICgnICsgdGFyZ2V0T3JpZ2luQm90cy5sZW5ndGggKyAnIGJvdHMpJzsKICAgICAgICAgICAgICAgIHRhZ3MudGFyZ2V0T3JpZ2luQm90cyA9IGdldExpbmsodGFyZ2V0T3JpZ2luQm90cyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICBgOwogICAgdGFncy5vbktleVVwID0gYEAKICAgICAgICBpZiAodGhhdC5rZXlzLmluY2x1ZGVzKCJTaGlmdCIpKSB7CiAgICAgICAgICAgIG1hc2tzLmxhYmVsID0gbnVsbDsKICAgICAgICAgICAgdGFncy50YXJnZXRPcmlnaW5Cb3RzID0gbnVsbDsKICAgICAgICB9CiAgICBgOwp9IGVsc2UgewogICAgLy8gTm8gYm90IHRvIGRlc3Ryb3kuCiAgICBkZXN0cm95KHRoaXNCb3QpOwp9JwDuscKEDu4GG2FiTXVsdGlwbGVCb3RNZW51T25HZW5lcmF0ZQIEAO6xwoQO3BXvBEBjb25zdCBhbGxUYXJnZXRCb3RzID0gQXJyYXkuaXNBcnJheShsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXMpID8gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzIDogW2xpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1c107CmNvbnN0IGJ1aWxkZXIgPSBhYi5saW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90ID8gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC5pZCA6IG51bGw7CmNvbnN0IHJlbGV2YW50VGFyZ2V0Qm90cyA9IGFsbFRhcmdldEJvdHMuZmlsdGVyKCh0YXJnZXQpID0+IHRhcmdldC5pZCAhPSBidWlsZGVyKTsKCmlmIChyZWxldmFudFRhcmdldEJvdHMubGVuZ3RoID4gMSkgewogICAgLy8gTXVsdGlwbGUgYm90cy4KICAgIHRhZ3MubGFiZWwgPSBgZGVzdHJveSAoJHtyZWxldmFudFRhcmdldEJvdHMubGVuZ3RofSBib3RzKWA7Cn0gZWxzZSBpZiAocmVsZXZhbnRUYXJnZXRCb3RzLmxlbmd0aCA9PT0gMSkgewogICAgLy8gU2luZ2xlIGJvdC4KICAgIHRhZ3MubGFiZWwgPSBgZGVzdHJveWA7Cn0gZWxzZSB7CiAgICAvLyBObyBib3RzIHRvIGRlc3Ryb3kuCiAgICBkZXN0cm95KHRoaXNCb3QpOwp9JwEEYm90cyQ2YjNkOTc0NC00NDQ4LTRlZjUtOTZhMi03MTI4MWM0MmFmNmMBJwDuscKEDswaCWFiVmVyc2lvbgIEAO6xwoQOzRoEMTAuNScA7rHChA7MGgZzeXN0ZW0CBADuscKEDtIaEWFiLmFjdGlvbi52ZXJzaW9uJwDuscKEDswaFGFiQWN0aW9uTWFqb3JWZXJzaW9uAgQA7rHChA7kGgExJwDuscKEDswaFGFiQWN0aW9uTWlub3JWZXJzaW9uAgQA7rHChA7mGgE0JwDuscKEDswaDW9uU2tpbGxVcGRhdGUCBADuscKEDugamQFAY29uc3QgdmVyc2lvblN0cmluZyA9IHRhZ3MuYWJBY3Rpb25NYWpvclZlcnNpb24gKyAiLiIgKyB0YWdzLmFiQWN0aW9uTWlub3JWZXJzaW9uOwoKY29uc29sZS5sb2coIltBQkFjdGlvbl0gTG9hZGVkIEFCIEFjdGlvbiB2ZXJzaW9uICIgKyB2ZXJzaW9uU3RyaW5nKTsnAO6xwoQOzBoIYWJJZ25vcmUCBADuscKEDoIcBHRydWUnAO6xwoQOzBoIYWJBY3Rpb24CBADuscKEDoccBHRydWUnAO6xwoQOzBoEZm9ybQIEAO6xwoQOjBwHbm90aGluZycBBGJvdHMkNzE3NTY0NWMtNGI1My00NDU0LTg3MTYtZmMwZTY4ZGIyNjY1AScA7rHChA6UHAZzeXN0ZW0CBADuscKEDpUcD2FiLmFjdGlvbi5sb2dpbicA7rHChA6UHAhhYkFjdGlvbgIEAO6xwoQOpRwEdHJ1ZScA7rHChA6UHAhhYklnbm9yZQIEAO6xwoQOqhwEdHJ1ZScA7rHChA6UHARmb3JtAgQA7rHChA6vHAdub3RoaW5nJwDuscKEDpQcD2FiQ29yZU1lbnVDb2xvcgIEAO6xwoQOtxwHI0YyQjcwNScA7rHChA6UHBNhYkNvcmVNZW51U29ydE9yZGVyAgQA7rHChA6/HAItNScA7rHChA6UHBBhYkNvcmVNZW51QWN0aW9uAgQA7rHChA7CHCxAb3MuZ29Ub1VSTChsaW5rcy5yZW1lbWJlci50YWdzLmFiQXV0aFNpdGUpOycA7rHChA6UHBRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAO6xwoQO7xygAkBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKCFsaW5rcy5yZW1lbWJlci50YWdzLmFiQXV0aFNpdGUpCnsKICAgIGRlc3Ryb3kodGhpc0JvdCk7Cn0KCnRhZ3MubGFiZWwgPSAiYnV5ICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5OwoKaWYgKCFhdXRoQm90KQp7CiAgICByZXR1cm47Cn0KZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikKewogICAgcmV0dXJuOwp9CgpkZXN0cm95KHRoaXNCb3QpOycA7rHChA6UHA5hYkNvcmVNZW51SWNvbgIEAO6xwoQOkB8OYWNjb3VudF9jaXJjbGUnAO6xwoQOlBwIcmVtZW1iZXICBADuscKEDp8fKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAO6xwoQOlBwJYWJWZXJzaW9uAgQA7rHChA7GHwQxMC41JwDuscKEDpQcC3BlcnNvbmFsaXR5AgQA7rHChA7LHyjwn5SXYjc2ZGZiYzQtODU0Yi00ZjZkLWE5MWYtYTk0ODY5NDc3NGRiJwEEYm90cyRiMzM5YzExOC00ODlhLTQ2NmItYmE5Zi1iMDdhNWY5YjY2NGYBJwDuscKEDvIfBnN5c3RlbQIEAO6xwoQO8x8PYWIuYWN0aW9uLnBhc3RlKADuscKEDvIfCGFiQWN0aW9uAXgnAO6xwoQO8h8EZm9ybQIEAO6xwoQOhCAHbm90aGluZycA7rHChA7yHwtkZXNjcmlwdGlvbgIEAO6xwoQOjCArYWIgc2tpbGwgdXNlZCBmb3IgY29weWluZyBhbmQgcGFzdGluZyBib3RzLicA7rHChA7yHwdvblBhc3RlAgQA7rHChA64IP8HQGlmICghYnVpbGRlclZlcnNpb24pCnsKICAgIHJldHVybjsKfQoKY29uc3QgTUFDUk9TID0gWwogICAgewogICAgICAgIHRlc3Q6IC8oPzpb4oCc4oCdXSkvZywKICAgICAgICByZXBsYWNlbWVudDogKHZhbCkgPT4gJyInLAogICAgfSwKICAgIHsKICAgICAgICB0ZXN0OiAvKD86W+KAmOKAmV0pL2csCiAgICAgICAgcmVwbGFjZW1lbnQ6ICh2YWwpID0+ICInIiwKICAgIH0sCl07CgpsZXQgZm9ybWF0dGVkQ29weSA9IHJlcGxhY2VNYWNyb3ModGhhdC50ZXh0KTsKbGV0IGNvcHlCb3QgPSBKU09OLnBhcnNlKGZvcm1hdHRlZENvcHkpOwpsZXQgcGFzdGVkRGF0YSA9ICFjb3B5Qm90LnN0YXRlID8ge1tjb3B5Qm90LmlkXTogY29weUJvdH0gOiBjb3B5Qm90LnN0YXRlOwpsZXQgZGltTW9kID0gbGlua3MucmVtZW1iZXIudGFncy5hYkZvY3VzRGF0YTsKCmlmIChPYmplY3Qua2V5cyhwYXN0ZWREYXRhKS5sZW5ndGggPT0gMSAmJiBkaW1Nb2QpCnsKICAgIHBhc3RlZERhdGFbZGltTW9kLmRpbWVuc2lvbl0gPSB0cnVlOwogICAgcGFzdGVkRGF0YVtkaW1Nb2QuZGltZW5zaW9uKyJYIl0gPSBkaW1Nb2QueDsKICAgIHBhc3RlZERhdGFbZGltTW9kLmRpbWVuc2lvbisiWSJdID0gZGltTW9kLnk7CgogICAgb3MudG9hc3QoImJvdCBhZGRlZCB0byBpbnN0Iik7Cn0KZWxzZQp7CiAgICBvcy50b2FzdCgiYm90cyBhZGRlZCB0byBpbnN0Iik7Cn0KCmFiLmxvZyhsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogcGFzdGVkIGRhdGEiKTsKCmxpbmtzLmNyZWF0ZS5hYkNyZWF0ZUJvdHMoe2JvdHM6IHBhc3RlZERhdGEsIHNvdXJjZUV2ZW50OiAncGFzdGUnfSk7CgpmdW5jdGlvbiByZXBsYWNlTWFjcm9zKHRleHQpIHsKICAgIGlmICghdGV4dCkgewogICAgICAgIHJldHVybiB0ZXh0OwogICAgfQoKICAgIGZvciAobGV0IG0gb2YgTUFDUk9TKSB7CiAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZShtLnRlc3QsIG0ucmVwbGFjZW1lbnQpOwogICAgfQoKICAgIHJldHVybiB0ZXh0Owp9JwDuscKEDvIfCHJlbWVtYmVyAgQA7rHChA6wKCjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwDuscKEDvIfBmNyZWF0ZQIEAO6xwoQO1ygo8J+UlzM0YzNjMjEwLTViZjEtNDljZi1iMTUxLWVlMmQwN2YwZTY3MycA7rHChA7yHwhhYklnbm9yZQIEAO6xwoQO/igEdHJ1ZScA7rHChA7yHwlvbktleURvd24CBADuscKEDoMpuglAaWYgKCFidWlsZGVyVmVyc2lvbiB8fCAoIWxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiQm90Rm9jdXMgJiYgIWxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1cykpCnsKICAgIHJldHVybjsKfQoKaWYgKHRoYXQua2V5cyA9PSAiYyIpCnsKICAgIGxldCBtZXRhSW5wdXQgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJNZXRhIik7CgogICAgaWYgKCFtZXRhSW5wdXQpCiAgICB7CiAgICAgICAgbWV0YUlucHV0ID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiQ29udHJvbCIpOwogICAgfQogICAgCiAgICBpZiAoIW1ldGFJbnB1dCkKICAgIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IGZvcm1hdHRlZEZpbGU7CiAgICBsZXQgc3RhdGUgPSB7fTsKCiAgICBpZiAobGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1cykKICAgIHsKICAgICAgICBsZXQgc2VsZWN0ZWRCb3QgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzOwoKICAgICAgICBzdGF0ZVtzZWxlY3RlZEJvdC5pZF0gPSBzZWxlY3RlZEJvdDsKCiAgICAgICAgYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBjb3BpZWQgYSBib3QgdG8gY2xpcGJvYXJkIik7CiAgICB9CiAgICBlbHNlIGlmIChsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXMpCiAgICB7CiAgICAgICAgbGV0IHNlbGVjdGVkQm90cyA9IGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1czsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3RlZEJvdHMubGVuZ3RoOyBpKyspCiAgICAgICAgewogICAgICAgICAgICBzdGF0ZVtzZWxlY3RlZEJvdHNbaV0uaWRdID0gc2VsZWN0ZWRCb3RzW2ldOwogICAgICAgIH0KCiAgICAgICAgYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBjb3BpZWQgbXVsdGlwbGUgYm90cyB0byBjbGlwYm9hcmQiKTsKICAgIH0KCiAgICBsZXQgbmV3RmlsZSA9IHt9OwogICAgbmV3RmlsZS52ZXJzaW9uID0gMTsKICAgIG5ld0ZpbGUuc3RhdGUgPSBzdGF0ZTsKCiAgICBmb3JtYXR0ZWRGaWxlID0gSlNPTi5zdHJpbmdpZnkobmV3RmlsZSk7CgogICAgb3Muc2V0Q2xpcGJvYXJkKGZvcm1hdHRlZEZpbGUpOwoKICAgIG9zLnRvYXN0KCJib3QgY29waWVkIHRvIGNsaXBib2FyZCIpOwp9JwDuscKEDvIfCWFiVmVyc2lvbgIEAO6xwoQOvjIEMTAuNScA7rHChA7yHwtwZXJzb25hbGl0eQIEAO6xwoQOwzIo8J+Ul2I3NmRmYmM0LTg1NGItNGY2ZC1hOTFmLWE5NDg2OTQ3NzRkYicBBGJvdHMkYmRhYmQ2YzAtODlmOS00Zjc1LWIzNWMtMjZmNGVjNTIwN2Q2AScA7rHChA7qMgZzeXN0ZW0CBADuscKEDusyEGFiLmFjdGlvbi5yZXBvcnQnAO6xwoQO6jIEZm9ybQIEAO6xwoQO/DIHbm90aGluZycA7rHChA7qMhBhYkNvcmVNZW51QWN0aW9uAgQA7rHChA6EMxFAb3MucmVwb3J0SW5zdCgpOycA7rHChA7qMhNhYkNvcmVNZW51U29ydE9yZGVyAgQA7rHChA6WMwMxMDEnAO6xwoQO6jIOYWJDb3JlTWVudUljb24CBADuscKEDpozBGZsYWcnAO6xwoQO6jIPYWJDb3JlTWVudUxhYmVsAgQA7rHChA6fMwZyZXBvcnQnAO6xwoQO6jIIYWJBY3Rpb24CBADuscKEDqYzBHRydWUnAO6xwoQO6jIIYWJJZ25vcmUCBADuscKEDqszBHRydWUnAO6xwoQO6jIUYWJDb3JlTWVudU9uR2VuZXJhdGUCBADuscKEDrAzRkBpZiAoY29uZmlnQm90LnRhZ3Muc3RhdGljSW5zdCAhPSB1bmRlZmluZWQpCnsKICAgIGRlc3Ryb3kodGhpc0JvdCk7Cn0nAO6xwoQO6jIJYWJWZXJzaW9uAgQA7rHChA73MwQxMC41JwEEYm90cyRjNjhjNWI4Mi1jMGE3LTRhNWEtOTEwNC01ZGQ4ZTMyYWU0ZTIBJwDuscKEDvwzBnN5c3RlbQIEAO6xwoQO/TMQYWIuYWN0aW9uLnBvcnRhbCcA7rHChA78MwtkZXNjcmlwdGlvbgIEAO6xwoQOjjQUU2tpbGwgdG8gb3BlbiBzaGVldC4nAO6xwoQO/DMIYWJBY3Rpb24CBADuscKEDqM0BHRydWUnAO6xwoQO/DMEZm9ybQIEAO6xwoQOqDQHbm90aGluZycA7rHChA78MxBhYkNvcmVNZW51QWN0aW9uAgQA7rHChA6wNANALy8nAO6xwoQO/DMIcmVtZW1iZXICBADuscKEDrQ0KPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAO6xwoQO/DMPYWJDb3JlTWVudUxhYmVsAgQA7rHChA7bNBBjdXJyZW50IHBvcnRhbDogJwDuscKEDvwzD2FiQm90TWVudUFjdGlvbgIEAO6xwoQO7DT4AkBjb25zdCBjdXJyZW50SW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7CmNvbnN0IGN1cnJlbnREaW0gPSBsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90LnRhZ3MubGluZVRvOwpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7CgppZiAoc3RhdGUpIAp7CiAgICBvcy5vcGVuVVJMKGNvbmZpZ0JvdC50YWdzLnBlcm1hbGluayArIGAmc2hlZXRQb3J0YWw9JHtjdXJyZW50RGltfWApOwp9CmVsc2UKewogICAgY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwgPSBjdXJyZW50RGltOwp9CgphYi5sb2cobGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6IG9wZW5lZCBib3Qgc2hlZXQiKTsnAO6xwoQO/DMOYWJCb3RNZW51TGFiZWwCBADuscKEDuU3Dm9wZW4gYm90IHNoZWV0JwDuscKEDvwzDW1hbmlmZXN0YXRpb24CBADuscKEDvQ3KPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAO6xwoQO/DMNYWJCb3RNZW51SWNvbgIEAO6xwoQOmzgKdGFibGVfdmlldycA7rHChA78Mw5hYkNvcmVNZW51SWNvbgIEAO6xwoQOpjgLYXJyb3dfcmlnaHQnAO6xwoQO/DMSYWJCb3RNZW51U29ydE9yZGVyAgQA7rHChA6yOAExJwDuscKEDvwzCGFiSWdub3JlAgQA7rHChA60OAR0cnVlJwDuscKEDvwzF2FiTXVsdGlwbGVCb3RNZW51QWN0aW9uAgQA7rHChA65OJsEQGNvbnN0IGN1cnJlbnRJbnN0ID0gb3MuZ2V0Q3VycmVudEluc3QoKTsKY29uc3QgY3VycmVudERpbSA9ICJhYk11bHRpcGxlU2VsZWN0IjsKCmNvbmZpZ0JvdC50YWdzLnNoZWV0UG9ydGFsID0gY3VycmVudERpbTsKCnNldFRhZ01hc2sobGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzLCBjdXJyZW50RGltLCB0cnVlLCAidGVtcExvY2FsIik7CgptYXNrcy5jdXJyZW50U2hlZXRCb3RzID0gbGlua3MucmVtZW1iZXIudGFncy5hYk11bHRpcGxlQm90Rm9jdXM7Cm1hc2tzLm9uUG9ydGFsQ2hhbmdlZCA9IGBAIGlmICh0aGF0LmRpbWVuc2lvbiAhPSAiYWJNdWx0aXBsZVNlbGVjdCIgJiYgdGhhdC5wb3J0YWwgPT0gInNoZWV0UG9ydGFsIikKewogICAgY2xlYXJUYWdNYXNrcyhsaW5rcy5jdXJyZW50U2hlZXRCb3RzKTsKCiAgICBjbGVhclRhZ01hc2tzKHRoaXNCb3QpOwp9IGA7CgphYi5sb2cobGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6IG9wZW5lZCBtdWx0aXBsZSBzZWxlY3Qgc2hlZXQiKTsnAO6xwoQO/DMWYWJNdWx0aXBsZUJvdE1lbnVMYWJlbAIEAO6xwoQO1Twab3BlbiBtdWx0aXBsZSBzZWxlY3Qgc2hlZXQnAO6xwoQO/DMVYWJNdWx0aXBsZUJvdE1lbnVJY29uAgQA7rHChA7wPAp0YWJsZV92aWV3JwDuscKEDvwzE2FiQm90TWVudU9uR2VuZXJhdGUCBADuscKEDvs8mAJAbGV0IHNlbGVjdGVkQm90ID0gbGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC50YWdzLmxpbmVUbzsKCnRhZ3MubGFiZWwgPSAic2hlZXRQb3J0YWw9IiArIHNlbGVjdGVkQm90LnN1YnN0cmluZygwLCA0KTsKCnRhZ3Mub25LZXlEb3duID0gYEAgaWYodGhhdC5rZXlzID09ICJTaGlmdCIpe21hc2tzLmxhYmVsID0gdGFncy5sYWJlbCArICIgaW4gbmV3IHRhYiI7fWA7CnRhZ3Mub25LZXlVcCA9IGBAIGlmKHRoYXQua2V5cyA9PSAiU2hpZnQiKXttYXNrcy5sYWJlbCA9IG51bGw7fWA7JwDuscKEDvwzGmFiTXVsdGlwbGVCb3RNZW51U29ydE9yZGVyAgQA7rHChA6UPwEwJwDuscKEDvwzBG1lbnUCBADuscKEDpY/KPCflJdiMzBjNmM1ZC1hNGY3LTQyNjYtYmEzOC0zOTNkYzk1ZTFlY2InAO6xwoQO/DMJYWJWZXJzaW9uAgQA7rHChA69PwQxMC41JwDuscKEDvwzC2FiQmx1ZXByaW50AgQA7rHChA7CP/sDQGNvbnN0IGJhY2tncm91bmRDb2xvciA9IGxpbmtzLnJlbWVtYmVyPy50YWdzLmFiQmx1ZXByaW50Q29sb3IgPz8gIiMxNzg1QjUiOwoKaWYgKGJhY2tncm91bmRDb2xvciA9PSBncmlkUG9ydGFsQm90Lm1hc2tzLnBvcnRhbENvbG9yKQp7CiAgICByZXR1cm47Cn0KCmdyaWRQb3J0YWxCb3QubWFza3MucG9ydGFsQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3I7CgptYXNrcy5vblBvcnRhbENoYW5nZWQgPSBgQCBpZiAodGhhdC5wb3J0YWwgPT0gImdyaWRQb3J0YWwiICYmIHRoYXQuZGltZW5zaW9uICE9ICJibHVlcHJpbnQiKXsKICAgIC8vIGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQmFzZUNvbG9yID0gbnVsbDsKICAgIC8vIGxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQmFzZVN0cm9rZUNvbG9yID0gbnVsbDsKCiAgICBncmlkUG9ydGFsQm90Lm1hc2tzLnBvcnRhbENvbG9yID0gbnVsbDsKCiAgICBtYXNrcy5vblBvcnRhbENoYW5nZWQgPSBudWxsOwp9YDsKCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7JwDuscKEDvwzC29uQW55Q3JlYXRlAgQA7rHChA6+Q3ZAaWYgKHRoYXQuYm90LnRhZ3MuYmx1ZXByaW50KQp7CiAgICB0aGF0LmJvdC50YWdzLnN0cm9rZUNvbG9yID0gIiNmZmZmZmYiOwogICAgdGhhdC5ib3QudGFncy5sYWJlbENvbG9yID0gIiNmZmZmZmYiOwp9JwDuscKEDvwzD29uUG9ydGFsQ2hhbmdlZAIEAO6xwoQOtURhQGlmICh0aGF0LnBvcnRhbCA9PSAiZ3JpZFBvcnRhbCIgJiYgdGhhdC5kaW1lbnNpb24gPT0gImJsdWVwcmludCIpCnsKICAgIHRoaXNCb3QuYWJCbHVlcHJpbnQoKTsKfScA7rHChA78MwtwZXJzb25hbGl0eQIEAO6xwoQOl0Uo8J+Ul2I3NmRmYmM0LTg1NGItNGY2ZC1hOTFmLWE5NDg2OTQ3NzRkYicA7rHChA78MxJhYkNvcmVNZW51SXRlbVR5cGUCBADuscKEDr5FCGRyb3Bkb3duJwDuscKEDvwzEWRyb3Bkb3duU29ydE9yZGVyAgQA7rHChA7HRQExJwDuscKEDvwzD2Ryb3Bkb3duT3B0aW9ucwIEAO6xwoQOyUUG8J+nrFtdJwDuscKEDvwzGGFiQ29yZU1lbnVPbkJlZm9yZUNyZWF0ZQIEAO6xwoQOzkW4HkBjb25zdCBkcm9wZG93bk9wdGlvbnMgPSBbXTsNCg0KY29uc3QgY3VycmVudERpbSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJBY3RpdmVEaW1lbnNpb247DQpjb25zdCBjdXJyZW50UG9ydGFsID0gY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsID8gIm1hcCIgOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsID09ICJibHVlcHJpbnQiID8gImJsdWVwcmludCIgOiJncmlkIjsNCmNvbnN0IGFjdGl2ZU1lbnUgPSBjb25maWdCb3QudGFncy5tZW51UG9ydGFsOw0KY29uc3QgcGVybWFsaW5rVVJMID0gY29uZmlnQm90LnRhZ3MucGVybWFsaW5rOw0KY29uc3QgYWN0aXZlSW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7DQpjb25zdCBhY3RpdmVCaW9zID0gY29uZmlnQm90LnRhZ3Mub3duZXIgPyAiJm93bmVyPSIgKyBjb25maWdCb3QudGFncy5vd25lciA6IGZhbHNlOw0KY29uc3QgZmlyc3RJbmRleCA9IHBlcm1hbGlua1VSTC5pbmRleE9mKCImIik7DQpjb25zdCBpbml0aWFsVVJMID0gcGVybWFsaW5rVVJMLnN1YnN0cmluZygwLCBmaXJzdEluZGV4KTsNCmNvbnN0IHVwZGF0ZWRVUkwgPSBhY3RpdmVCaW9zICE9IGZhbHNlID8gaW5pdGlhbFVSTCArICImaW5zdD0iICsgYWN0aXZlSW5zdCA6IGluaXRpYWxVUkw7DQoNCnNldFRhZ01hc2sodGhpc0JvdCwgImFiQ29yZU1lbnVMYWJlbCIsYG1vZGU6ICR7Y3VycmVudFBvcnRhbH0gcG9ydGFsYCk7DQpzZXRUYWdNYXNrKHRoaXNCb3QsICJjdXJyZW50RGltZW5zaW9uIiwgY3VycmVudERpbSk7DQpzZXRUYWdNYXNrKHRoaXNCb3QsICJjdXJyZW50UG9ydGFsIiwgY3VycmVudFBvcnRhbCk7DQpzZXRUYWdNYXNrKHRoaXNCb3QsICJkcm9wZG93blNvcnRPcmRlciIsIDEpOw0KDQpjb25zdCBtZW51T3B0aW9ucyA9IHt9Ow0KDQptZW51T3B0aW9ucy5kaW1lbnNpb24gPSBhY3RpdmVNZW51Ow0KbWVudU9wdGlvbnNbYWN0aXZlTWVudV0gPSB0cnVlOw0KbWVudU9wdGlvbnMuYWJQb3J0YWxNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsNCm1lbnVPcHRpb25zLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7DQptZW51T3B0aW9ucy5vbktleURvd24gPSBgQCBpZih0aGF0LmtleXMgPT0gIlNoaWZ0Iil7bWFza3MubGFiZWwgPSB0YWdzLmxhYmVsICsgIiBpbiBuZXcgdGFiIjt9YDsNCm1lbnVPcHRpb25zLm9uS2V5VXAgPSBgQCBpZih0aGF0LmtleXMgPT0gIlNoaWZ0Iil7bWFza3MubGFiZWwgPSBudWxsO31gOw0KbWVudU9wdGlvbnMuc2tpbGxCb3QgPSBnZXRMaW5rKHRoaXNCb3QpOw0KbWVudU9wdGlvbnMudGFyZ2V0VVJMID0gdXBkYXRlZFVSTDsNCg0KY29uc3QgbWFwTWVudUJvdCA9IHsNCiAgICAuLi5tZW51T3B0aW9ucw0KfTsNCg0KbWFwTWVudUJvdC5sYWJlbCA9ICJtYXAgcG9ydGFsIjsNCm1hcE1lbnVCb3QuZm9ybUFkZHJlc3MgPSAicHVibGljIjsNCm1hcE1lbnVCb3Qub25DbGljayA9IGBAIA0KY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOw0KDQppZihzdGF0ZSkNCnsNCiAgICBvcy5vcGVuVVJMKHRhZ3MudGFyZ2V0VVJMICsgIiZtYXBQb3J0YWw9JHtjdXJyZW50RGltID09ICJibHVlcHJpbnQiID8gImhvbWUiIDogY3VycmVudERpbX0iKTsNCn0NCmVsc2UNCnsNCiAgICBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPSAiJHtjdXJyZW50RGltID09ICJibHVlcHJpbnQiID8gImhvbWUiIDogY3VycmVudERpbX0iOw0KfWA7DQoNCmlmIChjdXJyZW50UG9ydGFsICE9ICJtYXAiKQ0Kew0KICAgIC8vbWFwIHBvcnRhbCBidXR0b24NCiAgICBkcm9wZG93bk9wdGlvbnMucHVzaChtYXBNZW51Qm90KTsNCn0NCg0KY29uc3QgZ3JpZE1lbnVCb3QgPSB7DQogICAgLi4ubWVudU9wdGlvbnMNCn07DQpncmlkTWVudUJvdC5sYWJlbCA9ICJncmlkIHBvcnRhbCI7DQpncmlkTWVudUJvdC5mb3JtQWRkcmVzcyA9ICJjdWJlIjsNCmdyaWRNZW51Qm90Lm9uQ2xpY2sgPSBgQA0KDQpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7DQoNCmlmKHN0YXRlKQ0Kew0KICAgIG9zLm9wZW5VUkwodGFncy50YXJnZXRVUkwgKyAiJmdyaWRQb3J0YWw9JHtjdXJyZW50RGltID09ICJibHVlcHJpbnQiID8gImhvbWUiIDogY3VycmVudERpbX0iKTsNCn0gDQplbHNlDQp7DQogICAgY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCA9ICIke2N1cnJlbnREaW0gPT0gImJsdWVwcmludCIgPyAiaG9tZSIgOiBjdXJyZW50RGltfSI7IGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA9IG51bGw7DQp9YDsNCg0KaWYgKGN1cnJlbnRQb3J0YWwgIT0gImdyaWQiIHx8IGN1cnJlbnREaW0gPT0gImJsdWVwcmludCIpDQp7DQogICAgLy9ncmlkIHBvcnRhbCBidXR0b24NCiAgICBkcm9wZG93bk9wdGlvbnMucHVzaChncmlkTWVudUJvdCk7DQp9DQoNCmNvbnN0IGJsdWVwcmludE1lbnVCb3QgPSB7DQogICAgLi4ubWVudU9wdGlvbnMNCn07DQoNCmJsdWVwcmludE1lbnVCb3QubGFiZWwgPSAiYmx1ZXByaW50IHBvcnRhbCI7DQpibHVlcHJpbnRNZW51Qm90LmZvcm1BZGRyZXNzID0gImFyY2hpdGVjdHVyZSI7DQpibHVlcHJpbnRNZW51Qm90Lm9uQ2xpY2sgPSBgQA0KDQpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7DQoNCmlmKHN0YXRlKQ0Kew0KICAgIG9zLm9wZW5VUkwodGFncy50YXJnZXRVUkwgKyAiJmdyaWRQb3J0YWw9Ymx1ZXByaW50Iik7DQp9IA0KZWxzZQ0Kew0KICAgIGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWwgPSAiYmx1ZXByaW50IjsgY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsID0gbnVsbDsNCn0NCg0KbGlua3Muc2tpbGxCb3QuYWJCbHVlcHJpbnQoKTtgOw0KDQppZiAoY3VycmVudERpbSAhPSAiYmx1ZXByaW50IikNCnsNCiAgICAvL2JsdWVwcmludCBwb3J0YWwgYnV0dG9uDQogICAgZHJvcGRvd25PcHRpb25zLnB1c2goYmx1ZXByaW50TWVudUJvdCk7DQp9DQoNCg0KY29uc3Qgc2hlZXRNZW51Qm90ID0gew0KICAgIC4uLm1lbnVPcHRpb25zDQp9Ow0Kc2hlZXRNZW51Qm90LmxhYmVsID0gInNoZWV0IHBvcnRhbCI7DQpzaGVldE1lbnVCb3QuZm9ybUFkZHJlc3MgPSAidGFibGVfdmlldyI7DQpzaGVldE1lbnVCb3Qub25DbGljayA9IGBAIA0KDQpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7DQoNCmlmKHN0YXRlKQ0Kew0KICAgIG9zLm9wZW5VUkwodGFncy50YXJnZXRVUkwgKyAiJnNoZWV0UG9ydGFsPSR7Y3VycmVudERpbX0iKTsNCn0gDQplbHNlDQp7IA0KICAgIGNvbmZpZ0JvdC50YWdzLnNoZWV0UG9ydGFsID0gIiR7Y3VycmVudERpbX0iOw0KfWA7DQoNCi8vc2hlZXQgcG9ydGFsIGJ1dHRvbg0KZHJvcGRvd25PcHRpb25zLnB1c2goc2hlZXRNZW51Qm90KTsNCg0KDQpjb25zdCBzeXN0ZW1NZW51Qm90ID0gew0KICAgIC4uLm1lbnVPcHRpb25zDQp9Ow0KDQpzeXN0ZW1NZW51Qm90LmxhYmVsID0gInN5c3RlbSBwb3J0YWwiOw0Kc3lzdGVtTWVudUJvdC5mb3JtQWRkcmVzcyA9ICJzZXR0aW5nc19hcHBsaWNhdGlvbnMiOw0Kc3lzdGVtTWVudUJvdC5vbkNsaWNrID0gYEANCg0KY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOw0KDQppZihzdGF0ZSkNCnsNCiAgICBvcy5vcGVuVVJMKHRhZ3MudGFyZ2V0VVJMICsgIiZzeXN0ZW1Qb3J0YWw9dHJ1ZSIpOw0KfSANCmVsc2UNCnsgDQogICAgY29uZmlnQm90LnRhZ3Muc3lzdGVtUG9ydGFsID0gdHJ1ZTsNCn1gOw0KDQovL3N5c3RlbSBwb3J0YWwgYnV0dG9uDQpkcm9wZG93bk9wdGlvbnMucHVzaChzeXN0ZW1NZW51Qm90KTsNCg0KbWFza3MuZHJvcGRvd25PcHRpb25zID0gZHJvcGRvd25PcHRpb25zOw0KDQpyZXR1cm47JwEEYm90cyRlYzg1YzFkNi05ZjFhLTQwZDQtODJlMS01YmQ2ODAzNDljMjcBJwDuscKEDodkBnN5c3RlbQIEAO6xwoQOiGQNYWIuYWN0aW9uLmFzaycA7rHChA6HZARmb3JtAgQA7rHChA6WZAdub3RoaW5nJwDuscKEDodkBmFza0dQVAIEAO6xwoQOnmSWCkBpZiAoIXRhZ3MuZ3B0QWN0aXZlIHx8IGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMuYWxsb3dBSSA9PSBmYWxzZSkKewogICAgY29uc3QgYWlNZXNzYWdlID0gbGlua3MucmVtZW1iZXIudGFncy5haV9yZWplY3Rpb25fbWVzc2FnZSA/PyAiQUkgbm90IGF1dGhvcml6ZWQgZm9yIHRoaXMgYWNjb3VudCI7CgogICAgb3MudG9hc3QoYWlNZXNzYWdlLCA3KTsKCiAgICBhYi5sb2cobGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICAiOiAiICsgYWlNZXNzYWdlKTsKICAgIAogICAgcmV0dXJuOwp9IAoKLy8gY29uc29sZS5sb2coIkFTSyIsIHRoYXQpOwoKbGV0IGlucXVpcnkgPSB0aGF0LmlucXVpcnkgPz8gdGhhdDsKCmNvbnN0IHByb21wdCA9ICF0aGF0LnByb21wdCA/IHRhZ3MucHJvbXB0X2NvcmUgOiB0YWdzWyJwcm9tcHRfIiArIHRoYXQucHJvbXB0XTsKCmFiLmxvZyhsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogdGhpbmtpbmcgYWJvdXQgIiArIGlucXVpcnkpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkJvdENoYXQoe21lc3NhZ2U6ICJ0aGlua2luZyBhYm91dCAiICsgaW5xdWlyeX0pOwoKaWYgKHRoYXQucHJvbXB0ID09ICJncmlkIikKewogICAgaW5xdWlyeSA9IGlucXVpcnkgKyBgIFBPU0lUSU9OOiB7JHt0aGF0LmRhdGEuZGltZW5zaW9ufTogdHJ1ZSwgJHt0aGF0LmRhdGEuZGltZW5zaW9ufVg6ICR7dGhhdC5kYXRhLmRpbWVuc2lvblh9LCAke3RoYXQuZGF0YS5kaW1lbnNpb259WToke3RoYXQuZGF0YS5kaW1lbnNpb25ZfX0uYAp9CmVsc2UgaWYgKHRoYXQucHJvbXB0ID09ICJib3QiKQp7CiAgICBpbnF1aXJ5ID0gaW5xdWlyeSArIGAgVEFSR0VUX0JPVF9JRDogYCArIHRoYXQuZGF0YS5ib3QuaWQ7Cn0KZWxzZSBpZiAodGhhdC5wcm9tcHQgPT0gIm11bHRpcGxlQm90IikKewogICAgaW5xdWlyeSA9IGlucXVpcnkgKyBgIFRBUkdFVF9CT1RfSURTOiBgICsgdGhhdC5kYXRhLmJvdHM7Cn0KZWxzZSBpZiAodGhhdC5wcm9tcHQgPT0gImNvcmUiKQp7Cgp9Cgpjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzQm90LnN1Ym1pdFJlcXVlc3RHUFQoe2lucXVpcnk6IGlucXVpcnksIHByb21wdDogcHJvbXB0LCBtb2RlbDogdGhhdC5tb2RlbH0pOwoKYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiAiICsgYW5zd2VyKTsKCmNyZWF0ZSh7aG9tZTogdHJ1ZSwgb25DcmVhdGU6IGBAICR7YW5zd2VyfWB9KTsKCmxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljaygpOwoKcmV0dXJuOycA7rHChA6HZAlncHRBY3RpdmUCBADuscKEDrVuBWZhbHNlJwDuscKEDodkEHN1Ym1pdFJlcXVlc3RHUFQCBADuscKEDrtulQdAbGV0IHN5c3RlbVByb21wdCA9IHRoYXQucHJvbXB0ID8gdGhhdC5wcm9tcHQgOiB0YWdzLnByb21wdF9jb3JlOwoKc3lzdGVtUHJvbXB0ID0gc3lzdGVtUHJvbXB0ICsgdGhhdC5pbnF1aXJ5OwoKaWYgKGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMuYWxsb3dBSSA9PSBmYWxzZSkKewogICAgb3MudG9hc3QoIkFJIG5vdCBhdXRob3JpemVkIG9uIHRoaXMgYWNjb3VudCIpOwoKICAgIHJldHVybjsKfQoKbGV0IGN1cnJlbnRFeHBlcmllbmNlQm90cyA9IGdldEJvdHMoYiA9PiBiLnNwYWNlID09PSAnc2hhcmVkJyAmJiAhYi50YWdzLmFiSWdub3JlKTsKCmlmIChjdXJyZW50RXhwZXJpZW5jZUJvdHMubGVuZ3RoID4gMCkKewogICAgc3lzdGVtUHJvbXB0ID0gc3lzdGVtUHJvbXB0ICsgIiBUaGVzZSBhcmUgdGhlIGJvdHMgdGhhdCBjdXJyZW50bHkgZXhpc3QgaW4gdGhlIGV4cGVyaWVuY2U6ICIgKyBjdXJyZW50RXhwZXJpZW5jZUJvdHM7Cn0KCmlmICghbGlua3MubWVudSkgewogICAgYXdhaXQgbGlua3MubGVhcm4uYWJBZGFwdCgnYWJJbnRlcmZhY2UnKTsKfQoKbGV0IG5ld1N0YXR1c0JhciA9IGF3YWl0IGxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnVzeUluZGljYXRvcih7IGFiTWVudTogdHJ1ZSwgbGFiZWw6IGBhc2tpbmcgJHtsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5fWAgfSk7Cgpjb25zdCBhaVJlc3AgPSBhd2FpdCBhaS5jaGF0KHN5c3RlbVByb21wdCwgewogICAgbW9kZWw6IHRoYXQubW9kZWwgPz8gImNsYXVkZS0zLTUtc29ubmV0LWxhdGVzdCIsCiAgICB0ZW1wZXJhdHVyZTogMCwKICAgIHRvcFA6IDEsCiAgICBwcmVzZW5jZVBlbmFsdHk6IDAuNiwKICAgIGZyZXF1ZW5jeVBlbmFsdHk6IDAKfSk7CgpkZXN0cm95KG5ld1N0YXR1c0Jhcik7CgpyZXR1cm4gYWlSZXNwOycA7rHChA6HZAhyZW1lbWJlcgIEAO6xwoQO0XUo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycA7rHChA6HZBBhYkNvcmVNZW51QWN0aW9uAgQA7rHChA74dZYeQGNvbnN0IGlucXVpcnkgPSB0aGF0Py5tZXNzYWdlID8/IHRoYXQ7CmNvbnN0IGluaXRpYWxCb290ID0gdGhhdD8uaW5pdGlhbEJvb3QgPz8gZmFsc2U7CmNvbnN0IGF1dG9IYXRjaCA9IHRoYXQ/LmF1dG9IYXRjaCA/PyBmYWxzZTsKY29uc3QgbWVudSA9IHRoYXQ/Lm1lbnUgPz8gImNvcmUiOwpjb25zdCBpbnF1aXJ5SGFzU3BhY2UgPSBpbnF1aXJ5LmluZGV4T2YoIiAiKSAhPT0gLTE7CmNvbnN0IG1lbnVCb3RzID0gZ2V0Qm90cyhjb25maWdCb3QudGFncy5tZW51UG9ydGFsLCB0cnVlKTsKCmNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gdGhhdDpgLCB0aGF0KTsKCndoaXNwZXIobWVudUJvdHMsICJhYk1lbnVSZWZyZXNoIik7CgpsZXQgdXNlcm5hbWUgPSAidXNlciI7CmlmIChhdXRoQm90ICYmIGF1dGhCb3QudGFncy5uYW1lKSB7CiAgICB1c2VybmFtZSA9IGF1dGhCb3QudGFncy5uYW1lOwp9IGVsc2UgaWYgKGFiLmxpbmtzLmNvbnNvbGUubWFza3MucHJlZmVycmVkTmFtZSkgewogICAgdXNlcm5hbWUgPSBhYi5saW5rcy5jb25zb2xlLm1hc2tzLnByZWZlcnJlZE5hbWU7Cn0KYWIubG9nKHsgbWVzc2FnZTogaW5xdWlyeSwgbmFtZTogdXNlcm5hbWUgfSk7CgppZiAoIWNvbmZpZ0JvdC50YWdzLnRhZ1BvcnRhbCAmJiBsaW5rcy5yZW1lbWJlci50YWdzLmFiQXdha2VTdGF0ZSAmJiBpbnF1aXJ5ICE9ICIubG9nIikgewogICAgc2hvdXQoInNob3dDb25zb2xlIik7Cn0KCmlmICghaW5xdWlyeUhhc1NwYWNlKSB7CiAgICBjb25zdCBpc0RpcmVjdFNlYXJjaCA9IGlucXVpcnkuc3RhcnRzV2l0aChgImApICYmIGlucXVpcnkuZW5kc1dpdGgoYCJgKTsKICAgIGNvbnN0IGlzQ2hhbm5lbFNlYXJjaCA9IGlucXVpcnlbMF0gPT0gIkAiOwoKICAgIGNvbnN0IGFzazogQUJMb29rdXBBc2tJRFJlc3VsdCB8IGZhbHNlID0gIWlzRGlyZWN0U2VhcmNoID8gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQXNrSUQoeyBhc2tJRDogaW5xdWlyeSwgY2hhbm5lbENvbmZpZzogaXNDaGFubmVsU2VhcmNoLCBhdXRvSGF0Y2g6IHRydWUsIHNvdXJjZUV2ZW50OiAnYXNrJyB9KSA6IGZhbHNlOwogICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBhc2s6YCwgYXNrKTsKCiAgICBpZiAoYXNrPy5zdWNjZXNzICYmIGFzaz8uZGF0YS51cmwgIT0gdW5kZWZpbmVkICYmICFpc0RpcmVjdFNlYXJjaCAmJiAhaXNDaGFubmVsU2VhcmNoKSB7CiAgICAgICAgbGlua3MubGVhcm4uYWJKb2luSG9zdCh7IGRhdGE6IGFzay5kYXRhIH0pOwogICAgfSBlbHNlIGlmIChhc2s/LnN1Y2Nlc3MgJiYgaXNDaGFubmVsU2VhcmNoKSB7CiAgICAgICAgbGlua3MuY2hhbm5lbExvYWRlcj8ubG9hZENoYW5uZWwoYXNrKTsKICAgIH0gZWxzZSBpZiAoIWFzaz8uc3VjY2VzcykgewogICAgICAgIGxldCBlZ2c6IEFCTG9va3VwRWdnUmVzdWx0OwogICAgICAgIGNvbnN0IHBlcmlvZEluZGV4ID0gaW5xdWlyeS5pbmRleE9mKCIuIik7CiAgICAgICAgbGV0IGFiSUQgPSBpbnF1aXJ5OwoKICAgICAgICBpZiAoaXNEaXJlY3RTZWFyY2gpIHsKICAgICAgICAgICAgYWJJRCA9IGlucXVpcnkuc3Vic3RyaW5nKDEsIGlucXVpcnkubGVuZ3RoIC0gMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAocGVyaW9kSW5kZXggPT0gLTEgfHwgaXNEaXJlY3RTZWFyY2gpIHsKICAgICAgICAgICAgZWdnID0gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQUJFZ2dzKHsgYWJJRDogYWJJRCwgaW5pdGlhbEJvb3QsIGF1dG9IYXRjaCwgc291cmNlRXZlbnQ6ICdhc2snIH0pOwogICAgICAgIH0gZWxzZSBpZiAocGVyaW9kSW5kZXggPiAwKSB7CiAgICAgICAgICAgIGNvbnN0IHJlY29yZEtleSA9IGlucXVpcnkuc3Vic3RyaW5nKDAsIHBlcmlvZEluZGV4KTsKCiAgICAgICAgICAgIGFiSUQgPSBpbnF1aXJ5LnN1YnN0cmluZyhwZXJpb2RJbmRleCArIDEpOwoKICAgICAgICAgICAgZWdnID0gYXdhaXQgbGlua3Muc2VhcmNoLm9uTG9va3VwQUJFZ2dzKHsgcmVjb3JkS2V5OiByZWNvcmRLZXksIGFiSUQ6IGFiSUQsIGluaXRpYWxCb290LCBhdXRvSGF0Y2gsIHNvdXJjZUV2ZW50OiAnYXNrJywgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbGlua3MuaW5wdXQub25DaGF0KHsgbWVzc2FnZTogaW5xdWlyeSB9KTsKICAgICAgICB9CgogICAgICAgIGlmICghZWdnPy5zdWNjZXNzICYmIGxpbmtzLm1lbnUpIHsKICAgICAgICAgICAgY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWJNZW51IjsKCiAgICAgICAgICAgIGNvbnN0IHN0dWRpb0J1dHRvbiA9IHt9OwoKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLmFiTWVudSA9IHRydWU7CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5sYWJlbCA9IGFiSUQgKyAiIG5vdCBmb3VuZCBpbiBhY3RpdmUgc3R1ZGlvLCBlbnRlciBhbHRlcm5hdGUgc3R1ZGlvSUQiOwogICAgICAgICAgICBzdHVkaW9CdXR0b24uZm9ybSA9ICJpbnB1dCI7CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5hYklEID0gYWJJRDsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLmZvcm1BZGRyZXNzID0gdGFncy5hYkNvcmVNZW51SWNvbjsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLm1hbmFnZXIgPSBnZXRMaW5rKHRoaXNCb3QpOwogICAgICAgICAgICBzdHVkaW9CdXR0b24uYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLm9uU3VibWl0ID0gYEAgbGlua3MubWFuYWdlci5hYkNvcmVNZW51QWN0aW9uKHRoYXQudGV4dCArICIuIiArIHRhZ3MuYWJJRCk7YDsKCiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZUJ1dHRvbiA9IHt9OwoKICAgICAgICAgICAgY3JlYXRlQnV0dG9uLmFiTWVudSA9IHRydWU7CiAgICAgICAgICAgIGNyZWF0ZUJ1dHRvbi5sYWJlbCA9ICJnaXZlIG1lIGEgcHJvdG90eXBlIjsKICAgICAgICAgICAgY3JlYXRlQnV0dG9uLm1hbmFnZXIgPSBnZXRMaW5rKHRoaXNCb3QpOwogICAgICAgICAgICBjcmVhdGVCdXR0b24uYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKICAgICAgICAgICAgY3JlYXRlQnV0dG9uLmFiSUQgPSBhYklEOwogICAgICAgICAgICBjcmVhdGVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLm1hbmFnZXIucHJvdG90eXBlKHRhZ3MuYWJJRCk7YDsKCiAgICAgICAgICAgIGxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKGNyZWF0ZUJ1dHRvbik7CiAgICAgICAgICAgIGxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKHN0dWRpb0J1dHRvbik7CgogICAgICAgICAgICB0aGlzQm90Lm1hc2tzLm9uR3JpZENsaWNrID0gIkAgc2hvdXQoJ2FiTWVudVJlZnJlc2gnKTsiOwogICAgICAgIH0KICAgIH0KfSBlbHNlIHsKICAgIGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90KCk7CgogICAgaWYgKCFhdXRoQm90KSB7CiAgICAgICAgb3MudG9hc3QoInBsZWFzZSBzaWduIGluIHRvIGFjY2VzcyBhZHZhbmNlZCBBSSBmZWF0dXJlcyIpOwoKICAgICAgICBsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQ2xpY2soKTsKICAgIH0gZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikgewogICAgICAgIG9zLnRvYXN0KCJwbGVhc2UgY2hlY2sgeW91ciBzdWJzY3JpcHRpb24gaW4gb3JkZXIgdG8gYWNjZXNzIGFkdmFuY2VkIEFJIGZlYXR1cmVzIik7CgogICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljaygpOwogICAgfSBlbHNlIHsKICAgICAgICBtYXNrcy5ncHRBY3RpdmUgPSB0cnVlOwoKICAgICAgICBhd2FpdCB0aGlzQm90LmFza0dQVCh7IGlucXVpcnk6IGlucXVpcnksIHByb21wdDogbWVudSwgZGF0YTogdGhhdCB9KTsKICAgIH0KfScA7rHChA6HZBRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAO6xwoQOj5QBsQNAdGFncy5vblN1Ym1pdCA9IGBAIGxpbmtzLmJhc2VTa2lsbC5hYkNvcmVNZW51QWN0aW9uKHttZXNzYWdlOiB0aGF0LnRleHQsIG1lbnU6ICJjb3JlIn0pO2A7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0KJwDuscKEDodkE2FiQ29yZU1lbnVTb3J0T3JkZXICBADuscKEDsGXAQMxMDInAO6xwoQOh2QQYWJHcmlkTWVudUFjdGlvbgIEAO6xwoQOxZcBDkAvL3BsYWNlaG9sZGVyJwDuscKEDodkFGFiR3JpZE1lbnVPbkdlbmVyYXRlAgQA7rHChA7UlwG8BUB0YWdzLmRpbWVuc2lvbiA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMuZGltZW5zaW9uOwp0YWdzLmRpbWVuc2lvblggPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZEZvY3VzLnBvc2l0aW9uLng7CnRhZ3MuZGltZW5zaW9uWSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMucG9zaXRpb24ueTsKdGFncy5vblN1Ym1pdCA9IGBAbGlua3MuYmFzZVNraWxsLmFiQ29yZU1lbnVBY3Rpb24oe21lc3NhZ2U6IHRoYXQudGV4dCwgbWVudTogImdyaWQiLCBkaW1lbnNpb246IHRhZ3MuZGltZW5zaW9uLCBkaW1lbnNpb25YOiB0YWdzLmRpbWVuc2lvblgsIGRpbWVuc2lvblk6IHRhZ3MuZGltZW5zaW9uWX0pO2A7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0nAO6xwoQOh2QNbWFuaWZlc3RhdGlvbgIEAO6xwoQOkZ0BKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAO6xwoQOh2QTYWJHcmlkTWVudVNvcnRPcmRlcgIEAO6xwoQOuJ0BAzEwMicA7rHChA6HZA9hYkdyaWRNZW51TGFiZWwCBADuscKEDrydAQZhc2sgYWInAO6xwoQOh2QPYWJDb3JlTWVudUxhYmVsAgQA7rHChA7DnQEGYXNrIGFiJwDuscKEDodkDmFiQ29yZU1lbnVJY29uAgQA7rHChA7KnQEEY3ViZScA7rHChA6HZA5hYkdyaWRNZW51SWNvbgIEAO6xwoQOz50BBGN1YmUnAO6xwoQOh2QKZWRpdFByb21wdAIEAO6xwoQO1J0BhwhAc2hvdXQoImFiTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTWVudSI7CgpsZXQgcHJvbXB0TWVudUJ1dHRvbiA9IHt9OwoKcHJvbXB0TWVudUJ1dHRvbi5hYk1lbnUgPSB0cnVlOwpwcm9tcHRNZW51QnV0dG9uLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CnByb21wdE1lbnVCdXR0b24ubWFuaWZlc3RhdGlvbiA9IHRhZ3MubWFuaWZlc3RhdGlvbjsKcHJvbXB0TWVudUJ1dHRvbi5yZW1lbWJlciA9IHRhZ3MucmVtZW1iZXI7CnByb21wdE1lbnVCdXR0b24uZ3B0Qm90ID0gIvCflJciICsgdGhpc0JvdC5pZDsKcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICJsb2FkIHByb21wdCI7CnByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY2xvdWRfZG93bmxvYWQiOwpwcm9tcHRNZW51QnV0dG9uLm9uQ2xpY2sgPSAiQCBsaW5rcy5ncHRCb3QudXBkYXRlUHJvbXB0KCdsb2FkJyk7IjsKCmxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKHByb21wdE1lbnVCdXR0b24pOwoKcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICJzYXZlIHByb21wdCI7CnByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiYmFja3VwIjsKcHJvbXB0TWVudUJ1dHRvbi5vbkNsaWNrID0gIkAgbGlua3MuZ3B0Qm90LnVwZGF0ZVByb21wdCgnc2F2ZScpOyI7CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihwcm9tcHRNZW51QnV0dG9uKTsKCm1hc2tzLm9uR3JpZENsaWNrID0gYEAgY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbCA9IG51bGw7Cgp0YWdQb3J0YWxCb3QubWFza3MudGFnUG9ydGFsQW5jaG9yUG9pbnQgPSBudWxsOwpgOwoKdGFnUG9ydGFsQm90Lm1hc2tzLnRhZ1BvcnRhbEFuY2hvclBvaW50ID0gInRvcCI7Cgpjb25maWdCb3QubWFza3MudGFnUG9ydGFsID0gdGhpc0JvdC5pZCArICIucHJvbXB0X2NvcmUiOwoKaWYgKGNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWxTcGFjZSkKewogICAgY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbFNwYWNlID0gbnVsbDsKfScA7rHChA6HZARtZW51AgQA7rHChA7apQEo8J+Ul2IzMGM2YzVkLWE0ZjctNDI2Ni1iYTM4LTM5M2RjOTVlMWVjYicA7rHChA6HZAx1cGRhdGVQcm9tcHQCBADuscKEDoGmAcsIQHNob3V0KCJhYk1lbnVSZWZyZXNoIik7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJhYk1lbnUiOwoKbGV0IHByb21wdE1lbnVCdXR0b24gPSB7fTsKCnByb21wdE1lbnVCdXR0b24uYWJNZW51ID0gdHJ1ZTsKcHJvbXB0TWVudUJ1dHRvbi5mb3JtID0gImlucHV0IjsKcHJvbXB0TWVudUJ1dHRvbi5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwpwcm9tcHRNZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247CnByb21wdE1lbnVCdXR0b24ucmVtZW1iZXIgPSB0YWdzLnJlbWVtYmVyOwpwcm9tcHRNZW51QnV0dG9uLmdwdEJvdCA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7CgppZiAodGhhdCA9PSAibG9hZCIpCnsKICAgIHByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAibG9hZCBwcm9tcHQiOwogICAgcHJvbXB0TWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJjbG91ZF9kb3dubG9hZCI7CiAgICBwcm9tcHRNZW51QnV0dG9uLm9uU3VibWl0ID0gIkAgbGlua3MuZ3B0Qm90LmxvYWRQcm9tcHQodGhhdC50ZXh0KTsiOwp9CmVsc2UKewogICAgcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICJzYXZlIHByb21wdCI7CiAgICBwcm9tcHRNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImJhY2t1cCI7CiAgICBwcm9tcHRNZW51QnV0dG9uLm9uU3VibWl0ID0gIkAgbGlua3MuZ3B0Qm90LnNhdmVQcm9tcHQodGhhdC50ZXh0KTsiOwp9CgpsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihwcm9tcHRNZW51QnV0dG9uKTsKCnByb21wdE1lbnVCdXR0b24uZm9ybSA9IG51bGw7CnByb21wdE1lbnVCdXR0b24ubGFiZWwgPSAiICAiOwpwcm9tcHRNZW51QnV0dG9uLmxhYmVsQWxpZ25tZW50ID0gImNlbnRlciI7CnByb21wdE1lbnVCdXR0b24uY29sb3IgPSAiI2YyNDcyNyI7CnByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiY2FuY2VsIjsKcHJvbXB0TWVudUJ1dHRvbi5vblN1Ym1pdCA9IG51bGw7CnByb21wdE1lbnVCdXR0b24ub25DbGljayA9ICJAIGxpbmtzLmdwdEJvdC5lZGl0UHJvbXB0KCk7IjsKCmxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKHByb21wdE1lbnVCdXR0b24pOycA7rHChA6HZApsb2FkUHJvbXB0AgQA7rHChA7LrgHaA0Bhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMuYWxsb3dQdWJsaWNEYXRhID09IGZhbHNlKQp7CiAgICBvcy50b2FzdCgibm90IGF1dGhvcml6ZWQiKTsKCiAgICByZXR1cm47Cn0KCmNvbnN0IHByb21wdE5hbWUgPSAiZ3B0X3Byb21wdF8iICsgdGhhdDsKY29uc3QgbmV3UHJvbXB0ID0gYXdhaXQgb3MuZ2V0RGF0YShsaW5rcy5yZW1lbWJlci50YWdzLmFiUmVjb3JkS2V5LCBwcm9tcHROYW1lKTsKCmlmICghbmV3UHJvbXB0LnN1Y2Nlc3MpCnsKICAgIG9zLnRvYXN0KCJubyBwcm9tcHQgZm91bmQgYnkgdGhhdCBuYW1lIik7Cn0KZWxzZQp7CiAgICB0YWdzLnByb21wdF9jb3JlID0gbmV3UHJvbXB0LmRhdGE7Cn0KCmlmIChjb25maWdCb3QudGFncy5wcm9tcHRfYmFzZSA9PSB0aGF0KQp7CiAgICByZXR1cm47Cn0KCnRoaXNCb3QuZWRpdFByb21wdCgpOycA7rHChA6HZApzYXZlUHJvbXB0AgQA7rHChA6msgG+BEBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMuYWxsb3dQdWJsaWNEYXRhID09IGZhbHNlIHx8IGF1dGhCb3QudGFncy5wcml2YWN5RmVhdHVyZXMucHVibGlzaERhdGEgPT0gZmFsc2UpCnsKICAgIG9zLnRvYXN0KCJub3QgYXV0aG9yaXplZCIpOwoKICAgIHJldHVybjsKfQoKY29uc3QgYXV0aG9yID0gYXdhaXQgb3MucmVxdWVzdEF1dGhCb3QoKTsKY29uc3QgcHJvbXB0TmFtZSA9ICJncHRfcHJvbXB0XyIgKyB0aGF0Owpjb25zdCBuZXdQcm9tcHQgPSBhd2FpdCBvcy5yZWNvcmREYXRhKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJSZWNvcmRLZXksIHByb21wdE5hbWUsIHRhZ3MucHJvbXB0X2NvcmUsIHt1cGRhdGVQb2xpY3k6IFthdXRob3IuaWRdfSk7CgppZiAoIW5ld1Byb21wdC5zdWNjZXNzKQp7CiAgICBvcy50b2FzdCgic29tZXRoaW5nIHdlbnQgd3JvbmcsIHBsZWFzZSB0cnkgYWdhaW4iKTsKfQplbHNlCnsKICAgIG9zLnRvYXN0KCJwcm9tcHQgc2F2ZWQgYXMgIiArIHRoYXQpOwp9Cgp0aGlzQm90LmVkaXRQcm9tcHQoKTsnAO6xwoQOh2QIYWJJZ25vcmUCBADuscKEDuW2AQR0cnVlJwDuscKEDodkCGFiQWN0aW9uAgQA7rHChA7qtgEEdHJ1ZScA7rHChA6HZAZzZWFyY2gCBADuscKEDu+2ASjwn5SXZDgzNzE0NDQtOTE1OC00NDM2LThmYzctODRjYzkxYjdmNTI1JwDuscKEDodkBWxlYXJuAgQA7rHChA6WtwEo8J+UlzY2NTdiODY1LWU5ODMtNDQwMS05ZmM5LWY1NDE4ZDE4YTdmNycA7rHChA6HZAptYXhfdG9rZW5zAgQA7rHChA69twEENTAwMCcA7rHChA6HZA9vbkFCSW5pdGlhbGl6ZWQCBADuscKEDsK3AVhAaWYgKGNvbmZpZ0JvdC50YWdzLnByb21wdF9iYXNlKQp7CiAgICB0aGlzQm90LmxvYWRQcm9tcHQoY29uZmlnQm90LnRhZ3MucHJvbXB0X2Jhc2UpOwp9JwDuscKEDodkBWFza0FCAgQA7rHChA6buAHUA0AvL3Nob3V0KCJhc2tBQiIsIHtwcm9tcHQ6IHByb21wdCwgc2hvdXQ6IHNob3V0LCBjb250ZXh0OiBjb250ZXh0fSk7CgppZiAoIXRhZ3MuZ3B0QWN0aXZlKSByZXR1cm47CgpsZXQgaW5xdWlyeSA9IHRoYXQucHJvbXB0OwoKLy9hYi5sb2coInVzZXI6ICIgKyBpbnF1aXJ5KTsgLy9ub3QgbmVlZGVkCgpjb25zdCBhbnN3ZXIgPSBhd2FpdCB0aGlzQm90LnN1Ym1pdFJlcXVlc3RHUFQoe2lucXVpcnk6IGlucXVpcnksIGNvbnRleHQ6IHRoYXQuY29udGV4dCwgZGVmaW5lZFByb21wdDogdHJ1ZX0pOwoKYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiAiICsgYW5zd2VyKTsKCmxpbmtzLm1hbmlmZXN0YXRpb24uYWJCb3RDaGF0KHttZXNzYWdlOiBhbnN3ZXJ9KTsKCmlmICh0aGF0LnNob3V0KQp7CiAgICBzaG91dCh0aGF0LnNob3V0LCBhbnN3ZXIpOwp9CgpyZXR1cm4gYW5zd2VyOycA7rHChA6HZAVpbnB1dAIEAO6xwoQO8LsBKPCflJdmODYwMjg3OC1jMmVmLTQ4YmQtODVhMC04ZDYzNTFlYjQxMjAnAO6xwoQOh2QLcHJvbXB0X2NvcmUCBADuscKEDpe8AfkPREVMSVZFUkFCTEU6IFJldHVybiBvbmx5IEphdmFTY3JpcHQgY29kZS4gRG8gbm90IGluY2x1ZGUgcXVvdGVzLCBNYXJrZG93biBmb3JtYXR0aW5nLCBvciBhbnkgZXhwbGFuYXRvcnkgdGV4dC4gVGhlIGNvZGUgc2hvdWxkIGJlIHZhbGlkIGFuZCBleGVjdXRhYmxlIGluc2lkZSB0aGUgYG9uQ3JlYXRlYCBmaWVsZCBvZiBhIGJvdCBpbiBDYXN1YWxPUy4KCk9CSkVDVElWRTogQmFzZWQgb24gdGhlIElOUFVULCBnZW5lcmF0ZSBKYXZhU2NyaXB0IHRoYXQgcGVyZm9ybXMgdGhlIHJlcXVlc3RlZCBiZWhhdmlvciBpbiBDYXN1YWxPUy4gVGhlIGNvZGUgbXVzdDoKCjEuIEltcGxlbWVudCB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KMi4gQWx3YXlzIGluY2x1ZGUgYGFiLmxvZygiYSBkZXNjcmlwdGlvbiBvZiB0aGUgZXhlY3V0aW9uIilgIHRvIGluZGljYXRlIHdoYXQgdGhlIGNvZGUgaXMgZG9pbmcuCjMuIEFsd2F5cyBpbmNsdWRlIGBkZXN0cm95KHRoaXNCb3QpO2AgYXQgdGhlIGVuZCB0byByZW1vdmUgdGhlIGJvdCBhZnRlciBleGVjdXRpb24uCjQuIFVzZSBzdGFuZGFyZCBDYXN1YWxPUyBib3Qgc2NyaXB0aW5nIG1ldGhvZHMgc3VjaCBhcyBgY3JlYXRlKC4uLilgLCBgc2V0VGFnKC4uLilgLCBgZ2V0Qm90cyguLi4pYCwgZXRjLgoKUk9MRTogWW91IGFyZSBQTSBCb3QsIGEgaGVscGZ1bCBhc3Npc3RhbnQgdGhhdCB3cml0ZXMgSmF2YVNjcmlwdCBjb2RlIHRvIGNvbnRyb2wgYm90cyBpbiBbQ2FzdWFsT1NdKGh0dHBzOi8vZ2l0aHViLmNvbS9jYXN1YWwtc2ltdWxhdGlvbi9jYXN1YWxvcyksIGEgd2ViLWJhc2VkIElERSBmb3IgYm90IHNjcmlwdGluZy4KCkVYQU1QTEVTOgoKRXhhbXBsZSAxOiAgCklucHV0OiBXaGF0IGNvbG9yIGlzIHRoZSBza3k/ICAKQW5zd2VyOgphYi5sb2coIlRoZSBza3kgaXMgYmx1ZSIpOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDI6ICAKSW5wdXQ6IE1ha2UgYSByZWQgYm90IGF0IHNjYWxlIDIgdGhhdCB0b2FzdHMgaGVsbG8gd2hlbiBjbGlja2VkLiAgCkFuc3dlcjoKYWIubG9nKCJNYWRlIGEgcmVkIGJvdCIpOyAgCmNyZWF0ZSh7aG9tZTogdHJ1ZSwgaG9tZVg6IDAsIGhvbWVZOiAwLCBjb2xvcjogInJlZCIsIG9uQ2xpY2s6ICJAIG9zLnRvYXN0KCdoZWxsbycpOyIsIHNjYWxlOiAyLCBjcmVhdG9yOiBudWxsfSk7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgMzogIApJbnB1dDogTWFrZSBhIGJvdCB0aGF0IG1ha2VzIGEgY29weSBvZiBpdHNlbGYgbmV4dCB0byBpdC4gIApBbnN3ZXI6CmFiLmxvZygiTWFkZSBhIGNvcHkgYm90Iik7ICAKY3JlYXRlKHtob21lOiB0cnVlLCBvbkNsaWNrOiAiQCBjcmVhdGUodGhpc0JvdCwge2hvbWVYOiB0YWdzLmhvbWVYICsgMSwgY3JlYXRvcjogbnVsbH0pIn0pOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDQ6ICAKSW5wdXQ6IE1ha2UgYWxsIHJlZCBib3RzIGJsdWUuICAKQW5zd2VyOgphYi5sb2coIk1hZGUgcmVkIGJvdHMgYmx1ZSIpOyAgCnNldFRhZyhnZXRCb3RzKCJjb2xvciIsICJyZWQiKSwgImNvbG9yIiwgImJsdWUiKTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSA1OiAgCklucHV0OiBNYWtlIGEgYmx1ZSBib3QgdGhhdCBjYW4gY3JlYXRlIGFub3RoZXIgYmx1ZSBib3QgdGhhdCBoYXMgYW4gb25Qb2ludGVyRW50ZXIgdGhhdCB0b2FzdHMgaGVsbG8uICAKQW5zd2VyOgphYi5sb2coIk1hZGUgYSBibHVlIGJvdCB0aGF0IGNhbiBjcmVhdGUgYW5vdGhlciBibHVlIGJvdCB0aGF0IGhhcyBhbiBvblBvaW50ZXJFbnRlciB0aGF0IHRvYXN0cyBoZWxsbyIpOyAgCmNyZWF0ZSh7ICAKICBob21lOiB0cnVlLCAgCiAgY29sb3I6ICJibHVlIiwgIAogIG9uQ2xpY2s6ICJAIGNyZWF0ZSh0aGlzQm90LCB7b25DbGljazogbnVsbCwgb25Qb2ludGVyRW50ZXI6IHRhZ3Mub25Qb2ludGVyRW50ZXJTY3JpcHR9KSIsICAKICBvblBvaW50ZXJFbnRlclNjcmlwdDogIkAgb3MudG9hc3QoJ2hlbGxvJyk7IiwgIAogIGNyZWF0b3I6IG51bGwgIAp9KTsgIApkZXN0cm95KHRoaXNCb3QpOwoKSU5QVVQ6CicA7rHChA6HZAtwcm9tcHRfZ3JpZAIEAO6xwoQOkcwBnBRERUxJVkVSQUJMRTogUmV0dXJuIG9ubHkgSmF2YVNjcmlwdCBjb2RlLiBEbyBub3QgaW5jbHVkZSBxdW90ZXMsIE1hcmtkb3duIGZvcm1hdHRpbmcsIG9yIGFueSBleHBsYW5hdG9yeSB0ZXh0LiBUaGUgY29kZSBzaG91bGQgYmUgdmFsaWQgYW5kIGV4ZWN1dGFibGUgaW5zaWRlIHRoZSBgb25DcmVhdGVgIGZpZWxkIG9mIGEgYm90IGluIENhc3VhbE9TLgoKT0JKRUNUSVZFOiBCYXNlZCBvbiB0aGUgSU5QVVQgYW5kIHByb3ZpZGVkIFBPU0lUSU9OIGRhdGEsIGdlbmVyYXRlIEphdmFTY3JpcHQgdGhhdCBwZXJmb3JtcyB0aGUgcmVxdWVzdGVkIGJlaGF2aW9yIGluIENhc3VhbE9TLiBUaGUgY29kZSBtdXN0OgoKMS4gSW1wbGVtZW50IHRoZSByZXF1ZXN0ZWQgYWN0aW9uLgoyLiBBbHdheXMgaW5jbHVkZSBgYWIubG9nKCJhIGRlc2NyaXB0aW9uIG9mIHRoZSBleGVjdXRpb24iKWAgdG8gaW5kaWNhdGUgd2hhdCB0aGUgY29kZSBpcyBkb2luZy4KMy4gQWx3YXlzIGluY2x1ZGUgYGRlc3Ryb3kodGhpc0JvdCk7YCBhdCB0aGUgZW5kIHRvIHJlbW92ZSB0aGUgYm90IGFmdGVyIGV4ZWN1dGlvbi4KNC4gVXNlIHRoZSBQT1NJVElPTiBkYXRhIHdoZW4gcGxhY2luZyBib3RzIG9yIGRldGVybWluaW5nIHNwYXRpYWwgYmVoYXZpb3IgKGUuZy4sIGBob21lWGAsIGBob21lWWAsIG9mZnNldHMsIHBsYWNlbWVudCBsb2dpYykuCjUuIFVzZSBzdGFuZGFyZCBDYXN1YWxPUyBib3Qgc2NyaXB0aW5nIG1ldGhvZHMgc3VjaCBhcyBgY3JlYXRlKC4uLilgLCBgc2V0VGFnKC4uLilgLCBgZ2V0Qm90cyguLi4pYCwgZXRjLgoKUE9TSVRJT04gREFUQToKLSBZb3Ugd2lsbCByZWNlaXZlIGNvbnRleHQgc3VjaCBhcyBgcG9zaXRpb24gPSB7IHg6IDxudW1iZXI+LCB5OiA8bnVtYmVyPiB9YC4KLSBVc2UgdGhpcyBkYXRhIHRvIGRldGVybWluZSBhcHByb3ByaWF0ZSBgaG9tZVhgLCBgaG9tZVlgLCBvciByZWxhdGl2ZSBwbGFjZW1lbnRzIGZvciBhbnkgY3JlYXRlZCBib3RzLgoKUk9MRTogWW91IGFyZSBQTSBCb3QsIGEgaGVscGZ1bCBhc3Npc3RhbnQgdGhhdCB3cml0ZXMgSmF2YVNjcmlwdCBjb2RlIHRvIGNvbnRyb2wgYm90cyBpbiBbQ2FzdWFsT1NdKGh0dHBzOi8vZ2l0aHViLmNvbS9jYXN1YWwtc2ltdWxhdGlvbi9jYXN1YWxvcyksIGEgd2ViLWJhc2VkIElERSBmb3IgYm90IHNjcmlwdGluZy4KCkVYQU1QTEVTOgoKRXhhbXBsZSAxOiAgCklucHV0OiBXaGF0IGNvbG9yIGlzIHRoZSBza3k/ICAKUG9zaXRpb246IHsgeDogNSwgeTogNSB9ICAKQW5zd2VyOiAgCmFiLmxvZygiVGhlIHNreSBpcyBibHVlIik7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgMjogIApJbnB1dDogTWFrZSBhIHJlZCBib3QgYXQgc2NhbGUgMiB0aGF0IHRvYXN0cyBoZWxsbyB3aGVuIGNsaWNrZWQuICAKUG9zaXRpb246IHsgeDogMSwgeTogMiB9ICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSBhIHJlZCBib3QiKTsgIApjcmVhdGUoe2hvbWU6IHRydWUsIGhvbWVYOiAxLCBob21lWTogMiwgY29sb3I6ICJyZWQiLCBvbkNsaWNrOiAiQCBvcy50b2FzdCgnaGVsbG8nKTsiLCBzY2FsZTogMiwgY3JlYXRvcjogbnVsbH0pOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDM6ICAKSW5wdXQ6IE1ha2UgYSBib3QgdGhhdCBtYWtlcyBhIGNvcHkgb2YgaXRzZWxmIG5leHQgdG8gaXQuICAKUG9zaXRpb246IHsgeDogMCwgeTogMCB9ICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSBhIGNvcHkgYm90Iik7ICAKY3JlYXRlKHtob21lOiB0cnVlLCBob21lWDogMCwgaG9tZVk6IDAsIG9uQ2xpY2s6ICJAIGNyZWF0ZSh0aGlzQm90LCB7aG9tZVg6IHRhZ3MuaG9tZVggKyAxLCBjcmVhdG9yOiBudWxsfSkifSk7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgNDogIApJbnB1dDogTWFrZSBhbGwgcmVkIGJvdHMgYmx1ZS4gIApQb3NpdGlvbjogeyB4OiAxMCwgeTogLTMgfSAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgcmVkIGJvdHMgYmx1ZSIpOyAgCnNldFRhZyhnZXRCb3RzKCJjb2xvciIsICJyZWQiKSwgImNvbG9yIiwgImJsdWUiKTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSA1OiAgCklucHV0OiBNYWtlIGEgYmx1ZSBib3QgdGhhdCBjYW4gY3JlYXRlIGFub3RoZXIgYmx1ZSBib3QgdGhhdCBoYXMgYW4gb25Qb2ludGVyRW50ZXIgdGhhdCB0b2FzdHMgaGVsbG8uICAKUG9zaXRpb246IHsgeDogMywgeTogMyB9ICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSBhIGJsdWUgYm90IHRoYXQgY2FuIGNyZWF0ZSBhbm90aGVyIGJsdWUgYm90IHRoYXQgaGFzIGFuIG9uUG9pbnRlckVudGVyIHRoYXQgdG9hc3RzIGhlbGxvIik7ICAKY3JlYXRlKHsgIAogIGhvbWU6IHRydWUsICAKICBob21lWDogMywgIAogIGhvbWVZOiAzLCAgCiAgY29sb3I6ICJibHVlIiwgIAogIG9uQ2xpY2s6ICJAIGNyZWF0ZSh0aGlzQm90LCB7b25DbGljazogbnVsbCwgb25Qb2ludGVyRW50ZXI6IHRhZ3Mub25Qb2ludGVyRW50ZXJTY3JpcHR9KSIsICAKICBvblBvaW50ZXJFbnRlclNjcmlwdDogIkAgb3MudG9hc3QoJ2hlbGxvJyk7IiwgIAogIGNyZWF0b3I6IG51bGwgIAp9KTsgIApkZXN0cm95KHRoaXNCb3QpOwoKSU5QVVQ6CicA7rHChA6HZApwcm9tcHRfYm90AgQA7rHChA6u4AHSF0RFTElWRVJBQkxFOiBSZXR1cm4gb25seSBKYXZhU2NyaXB0IGNvZGUuIERvIG5vdCBpbmNsdWRlIHF1b3RlcywgTWFya2Rvd24gZm9ybWF0dGluZywgb3IgYW55IGV4cGxhbmF0b3J5IHRleHQuIFRoZSBjb2RlIHNob3VsZCBiZSB2YWxpZCBhbmQgZXhlY3V0YWJsZSBpbnNpZGUgdGhlIGBvbkNyZWF0ZWAgZmllbGQgb2YgYSBib3QgaW4gQ2FzdWFsT1MuCgpPQkpFQ1RJVkU6IEJhc2VkIG9uIHRoZSBJTlBVVCBhbmQgdGhlIHByb3ZpZGVkIFRBUkdFVF9CT1RfSUQsIGdlbmVyYXRlIEphdmFTY3JpcHQgdGhhdCBwZXJmb3JtcyB0aGUgcmVxdWVzdGVkIGJlaGF2aW9yIGluIENhc3VhbE9TLiBUaGUgY29kZSBtdXN0OgoKMS4gSW1wbGVtZW50IHRoZSByZXF1ZXN0ZWQgYWN0aW9uLgoyLiBBbHdheXMgaW5jbHVkZSBgYWIubG9nKCJhIGRlc2NyaXB0aW9uIG9mIHRoZSBleGVjdXRpb24iKWAgdG8gZGVzY3JpYmUgd2hhdCB0aGUgY29kZSBkb2VzLgozLiBBbHdheXMgaW5jbHVkZSBgZGVzdHJveSh0aGlzQm90KTtgIGF0IHRoZSBlbmQgdG8gcmVtb3ZlIHRoZSBib3QgYWZ0ZXIgZXhlY3V0aW9uLgo0LiBVc2UgdGhlIGBUQVJHRVRfQk9UX0lEYCBhcyBjb250ZXh0IGZvciBsb2NhdGlvbiBvciBiZWhhdmlvciB3aGVuIGFwcHJvcHJpYXRlLiBGb3IgZXhhbXBsZSwgaWYgYSBuZXcgYm90IGlzIGNyZWF0ZWQsIHlvdSBtYXkgcG9zaXRpb24gaXQgYmFzZWQgb24gdGhlIHRhcmdldCBib3QncyBgaG9tZVhgIGFuZCBgaG9tZVlgIHRhZ3MuCjUuIFVzZSBzdGFuZGFyZCBDYXN1YWxPUyBzY3JpcHRpbmcgbWV0aG9kcyBzdWNoIGFzIGBjcmVhdGUoLi4uKWAsIGBzZXRUYWcoLi4uKWAsIGBnZXRCb3QoLi4uKWAsIGBnZXRCb3RzKC4uLilgLCBldGMuCgpCT1QgQ09OVEVYVDoKLSBZb3Ugd2lsbCByZWNlaXZlIGBUQVJHRVRfQk9UX0lEID0gIjxib3RJZD4iYC4KLSBZb3UgbXVzdCB1c2UgYGdldEJvdCgiaWQiLCAiPGJvdElkPiIpYCB0byByZXRyaWV2ZSB0aGUgYm90IGFuZCBhY2Nlc3MgaXRzIHRhZ3MgKGUuZy4sIGBnZXRCb3QoImlkIiwgVEFSR0VUX0JPVF9JRCkudGFncy5ob21lWGApLgotIFlvdSBjYW4gcG9zaXRpb24gbmV3IGJvdHMgbmVhciB0aGUgdGFyZ2V0IGJvdCBieSB1c2luZyBpdHMgYGhvbWVYYCwgYGhvbWVZYCwgb3Igb3RoZXIgdGFnIGRhdGEuCgpST0xFOiBZb3UgYXJlIFBNIEJvdCwgYSBoZWxwZnVsIGFzc2lzdGFudCB0aGF0IHdyaXRlcyBKYXZhU2NyaXB0IGNvZGUgdG8gY29udHJvbCBib3RzIGluIFtDYXN1YWxPU10oaHR0cHM6Ly9naXRodWIuY29tL2FsYW4tYWkvY2FzdWFsb3MpLCBhIHdlYi1iYXNlZCBJREUgZm9yIGJvdCBzY3JpcHRpbmcuCgpFWEFNUExFUzoKCkV4YW1wbGUgMTogIApJbnB1dDogV2hhdCBjb2xvciBpcyB0aGUgc2t5PyAgClRBUkdFVF9CT1RfSUQ6ICJza3lfMTIzIiAgCkFuc3dlcjogIAphYi5sb2coIlRoZSBza3kgaXMgYmx1ZSIpOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDI6ICAKSW5wdXQ6IE1ha2UgYSByZWQgYm90IGF0IHNjYWxlIDIgdGhhdCB0b2FzdHMgaGVsbG8gd2hlbiBjbGlja2VkLiAgClRBUkdFVF9CT1RfSUQ6ICJib3RfMDAxIiAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgYSByZWQgYm90Iik7ICAKbGV0IHRhcmdldCA9IGdldEJvdCgiaWQiLCAiYm90XzAwMSIpOyAgCmNyZWF0ZSh7ICAKICBob21lOiB0cnVlLCAgCiAgaG9tZVg6IHRhcmdldC50YWdzLmhvbWVYLCAgCiAgaG9tZVk6IHRhcmdldC50YWdzLmhvbWVZLCAgCiAgY29sb3I6ICJyZWQiLCAgCiAgb25DbGljazogIkAgb3MudG9hc3QoJ2hlbGxvJyk7IiwgIAogIHNjYWxlOiAyLCAgCiAgY3JlYXRvcjogbnVsbCAgCn0pOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDM6ICAKSW5wdXQ6IE1ha2UgYSBib3QgdGhhdCBtYWtlcyBhIGNvcHkgb2YgaXRzZWxmIG5leHQgdG8gaXQuICAKVEFSR0VUX0JPVF9JRDogImJvdF9jb3BpZXIiICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSBhIGNvcHkgYm90Iik7ICAKbGV0IHRhcmdldCA9IGdldEJvdCgiaWQiLCAiYm90X2NvcGllciIpOyAgCmNyZWF0ZSh7ICAKICBob21lOiB0cnVlLCAgCiAgaG9tZVg6IHRhcmdldC50YWdzLmhvbWVYLCAgCiAgaG9tZVk6IHRhcmdldC50YWdzLmhvbWVZLCAgCiAgb25DbGljazogIkAgY3JlYXRlKHRoaXNCb3QsIHtob21lWDogdGFncy5ob21lWCArIDEsIGNyZWF0b3I6IG51bGx9KSIgIAp9KTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSA0OiAgCklucHV0OiBNYWtlIGFsbCByZWQgYm90cyBibHVlLiAgClRBUkdFVF9CT1RfSUQ6ICJyZWZfYm90IiAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgcmVkIGJvdHMgYmx1ZSIpOyAgCnNldFRhZyhnZXRCb3RzKCJjb2xvciIsICJyZWQiKSwgImNvbG9yIiwgImJsdWUiKTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSA1OiAgCklucHV0OiBNYWtlIGEgYmx1ZSBib3QgdGhhdCBjYW4gY3JlYXRlIGFub3RoZXIgYmx1ZSBib3QgdGhhdCBoYXMgYW4gb25Qb2ludGVyRW50ZXIgdGhhdCB0b2FzdHMgaGVsbG8uICAKVEFSR0VUX0JPVF9JRDogImJvdF9wYXJlbnQiICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSBhIGJsdWUgYm90IHRoYXQgY2FuIGNyZWF0ZSBhbm90aGVyIGJsdWUgYm90IHRoYXQgaGFzIGFuIG9uUG9pbnRlckVudGVyIHRoYXQgdG9hc3RzIGhlbGxvIik7ICAKbGV0IHRhcmdldCA9IGdldEJvdCgiaWQiLCAiYm90X3BhcmVudCIpOyAgCmNyZWF0ZSh7ICAKICBob21lOiB0cnVlLCAgCiAgaG9tZVg6IHRhcmdldC50YWdzLmhvbWVYLCAgCiAgaG9tZVk6IHRhcmdldC50YWdzLmhvbWVZLCAgCiAgY29sb3I6ICJibHVlIiwgIAogIG9uQ2xpY2s6ICJAIGNyZWF0ZSh0aGlzQm90LCB7b25DbGljazogbnVsbCwgb25Qb2ludGVyRW50ZXI6IHRhZ3Mub25Qb2ludGVyRW50ZXJTY3JpcHR9KSIsICAKICBvblBvaW50ZXJFbnRlclNjcmlwdDogIkAgb3MudG9hc3QoJ2hlbGxvJyk7IiwgIAogIGNyZWF0b3I6IG51bGwgIAp9KTsgIApkZXN0cm95KHRoaXNCb3QpOwoKSU5QVVQ6ICAKJwDuscKEDodkD2FiQm90TWVudUFjdGlvbgIEAO6xwoQOgfgBDkAvL3BsYWNlaG9sZGVyJwDuscKEDodkE2FiQm90TWVudU9uR2VuZXJhdGUCBADuscKEDpD4AfYDQHRhZ3MudGFyZ2V0Qm90ID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJvdEZvY3VzOwp0YWdzLm9uU3VibWl0ID0gYEAgbGlua3MuYmFzZVNraWxsLmFiQ29yZU1lbnVBY3Rpb24oe21lc3NhZ2U6IHRoYXQudGV4dCwgbWVudTogImJvdCIsIGJvdDogbGlua3MudGFyZ2V0Qm90fSk7YDsKdGFncy5mb3JtID0gImlucHV0IjsKCmlmICghYXV0aEJvdCkKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiIChsaW1pdGVkKSI7Cn0KZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IikKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiIChsaW1pdGVkKSI7Cn0KZWxzZQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eTsKfScA7rHChA6HZA1pdGVyYXRlUHJvbXB0AgQA7rHChA6H/AGJBkBjb25zdCBpbnF1aXJ5ID0gYFBsZWFzZSBhdWdtZW50IHRoZSBmb2xsb3dpbmcgUFJPTVBUIGJ5IG1ha2luZyBpdCBtb3JlIGVhc2lseSByZWFkIGJ5IEdQVC4gIFBsZWFzZSBmb2N1cyBvbiB0aGUgZnVuY3Rpb25hbGl0eSBpbnNpZGUgb2YgaXQ6CgoxLiBUaGUgcHJvbXB0IG11c3QgbWFpbnRhaW4gYWxsIG9mIHRoZSBmdW5jdGlvbmFsaXR5IG9mIHRoZSBvcmlnaW5hbAoKMi4gVGhlIHByb21wdCBzaG91bGQga2VlcCBpbiBtaW5kIHRoYXQgd2UgYXJlIHdvcmtpbmcgaW4gYSAzRCBlbnZpcm9ubWVudAoKMy4gVGhlIHJlcGx5IHNob3VsZCBvbmx5IGJlIHRoZSBuZXcgcHJvbXB0Cgo0LiBUaGUgZnVuY3Rpb25zIHNob3VsZCBiZSBsaW1pdGVkIHRvIHRob3NlIGZvdW5kIGluIHRoZSBvcmlnaW5hbCBwcm9tcHQKClBST01QVDpgOwpjb25zdCBwcm9tcHQgPSB0YWdzWyJwcm9tcHRfIiArIHRoYXRdOwpjb25zdCBpdGVyYXRpb24gPSBhd2FpdCB0aGlzQm90LnN1Ym1pdFJlcXVlc3RHUFQoe2lucXVpcnk6IGlucXVpcnksIHByb21wdDogcHJvbXB0LCBtb2RlbDogImdwdC00LTExMDYtcHJldmlldyJ9KTsKCmFiLmxvZyhsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogIiArIGl0ZXJhdGlvbik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQm90Q2hhdCh7bWVzc2FnZTogbmV3QW5zd2VyfSk7Cgp0YWdzWyJwcm9tcHRfIiArIHRoYXRdID0gaXRlcmF0aW9uOwp0YWdzWyJwcm9tcHRfIiArIHRoYXQgKyAiX3ZlcnNpb24iXSsrOwoKcmV0dXJuOycA7rHChA6HZBJhYkJvdE1lbnVTb3J0T3JkZXICBADuscKEDpGCAgMxMDInAO6xwoQOh2QSY29udmVyc2F0aW9uUHJvbXB0AgQA7rHChA6VggLgCllvdSBhcmUgYW4gYWdlbnQgdGFza2VkIHdpdGggZGV0ZXJtaW5pbmcgaW50ZW50aW9uIGJhc2VkIG9uIGEgc3RhdGVtZW50IGEgdXNlciBnaXZlcyB5b3UuCgpQbGVhc2UgbG9vayBhdCB0aGUgZm9sbG93aW5nIHN0YXRlbWVudCBhbmQgZGV0ZXJtaW5lIGlmIGl0IGlzIGEgQ29udmVyc2F0aW9uIFJlcXVlc3Qgb3IgQnVpbGQgUmVxdWVzdC4KCkJ1aWxkIFJlcXVlc3RzOiAgU3BlY2lmaWMgcmVxdWVzdCBmb3IgdGhlIHN5c3RlbSB0byBidWlsZCwgbWFrZSBvciBwcm92aWRlIGNvZGUgZm9yIHNvbWV0aGluZyBzcGVjaWZpYy4KVGhlc2UgcmVxdWVzdHMgd2lsbCBnZW5lcmFsbHkgYmUgaW4gdGhlIGZvcm0gb2YgY29tbWFuZHMgb3IgcmVxdWVzdHMgZnJvbSB0aGUgc3lzdGVtLgpFeGFtcGxlIEJ1aWxkIFJlcXVlc3RzOiAKTWFrZSBhIHllbGxvdyBiYWxsLiAKUGxlYXNlIGNyZWF0ZSBhIGJpZyBwdXJwbGUgY3ViZS4gIApXcml0ZSB0aGUgY29kZSBmb3IgYSBib3QgdGhhdCBjaGFuZ2VzIGNvbG9ycyB3aGVuIGNsaWNrZWQuCgpDb252ZXJzYXRpb24gUmVxdWVzdHM6ICBBbnkgcmVxdWVzdCB0aGF0IGlzIG5vdCBhIEJ1aWxkIFJlcXVlc3Qgd2lsbCBkZWZhdWx0IHRvIGJlaW5nIGEgQ29udmVyc2F0aW9uLgpFdmVuIGlmIHRoZSByZXF1ZXN0cyBkaXNjdXNzZXMgbWFraW5nIGJ1aWxkaW5nIG9yIGNvZGluZyB0aGluZ3MgaXQgaXMgc3RpbGwgQ29udmVyc2F0aW9uIGlmIGl0IGlzIG5vdCB3b3JkZWQgYXMgYSBkaXJlY3QgcmVxdWVzdC4KRXhhbXBsZSBDb252ZXJzYXRpb24gUmVxdWVzdHM6CkNvdWxkIEkgYnVpbGQgYSBib3QgdGhhdCBnZXRzIGJpZ2dlciB3aGVuIGNsaWNrZWQ/CklzIGl0IHBvc3NpYmxlIHRvIGNvZGUgYm90cyB0aGF0IG1vdmU/CkNhbiBteSBzb24gbWFrZSBhIHllbGxvdyBiYWxsIGluIENhc3VhbE9TPwoKRGV0ZXJtaW5pbmcgSW50ZW50OiAgSWYgY29uZGl0aW9ucyBmb3IgQnVpbGQgUmVxdWVzdCBhcmUgc3BlY2lmaWNhbGx5IG1ldCB0aGVuIGl0J3MgYSBCdWlsZCBSZXF1ZXN0LiBFdmVyeXRoaW5nIGVsc2UgaXMgQ29udmVyc2F0aW9uLgoKRGV0ZXJtaW5lIHRoZSBpbnRlbnRpb24gb2YgdGhlIHN0YXRlbWVudCBhbmQgcmV0dXJuIHRydWUgaWYgaXQncyBhIEJ1aWxkIFJlcXVlc3QuCgpSVUxFUzoKMS4gUmV0dXJuIG9ubHkgdGhlIHdvcmQgdHJ1ZSBpZiB5b3UndmUgZGV0ZXJtaW5lZCBpdCdzIGEgQnVpbGQgUmVxdWVzdC4KMi4gUmV0dXJuIG9ubHkgZmFsc2UgaWYgdGhlIHN0YXRlbWVudCBpcyBhIENvbnZlcnNhdGlvbiBSZXF1ZXN0LgozLiBBbnN3ZXJpbmcgd2l0aCBhbnl0aGluZyBvdGhlciB0aGFuIHRydWUgb3IgZmFsc2Ugd2lsbCBicmVhayB0aGUgZXhwZXJpZW5jZS4KClNUQVRFTUVOVDoKJwDuscKEDodkF2FiTXVsdGlwbGVCb3RNZW51QWN0aW9uAgQA7rHChA72jAIOQC8vcGxhY2Vob2xkZXInAO6xwoQOh2QbYWJNdWx0aXBsZUJvdE1lbnVPbkdlbmVyYXRlAgQA7rHChA6FjQKkBUBjb25zdCBhbGxUYXJnZXRCb3RzID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzOwpjb25zdCB0YXJnZXRBcnJheSA9IFtdOwoKZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxUYXJnZXRCb3RzLmxlbmd0aDsgaSsrKQp7CiAgICB0YXJnZXRBcnJheS5wdXNoKGFsbFRhcmdldEJvdHNbaV0uaWQpOwp9Cgp0YWdzLnRhcmdldEJvdHMgPSB0YXJnZXRBcnJheTsKdGFncy5vblN1Ym1pdCA9IGBAIGxpbmtzLmJhc2VTa2lsbC5hYkNvcmVNZW51QWN0aW9uKHttZXNzYWdlOiB0aGF0LnRleHQsIG1lbnU6ICJtdWx0aXBsZUJvdCIsIGJvdHM6IHRhZ3MudGFyZ2V0Qm90c30pO2A7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0nAO6xwoQOh2QScHJvbXB0X211bHRpcGxlQm90AgQA7rHChA6qkgLGFkRFTElWRVJBQkxFOiBSZXR1cm4gb25seSBKYXZhU2NyaXB0IGNvZGUuIERvIG5vdCBpbmNsdWRlIHF1b3RlcywgTWFya2Rvd24gZm9ybWF0dGluZywgb3IgYW55IGV4cGxhbmF0b3J5IHRleHQuIFRoZSBjb2RlIHNob3VsZCBiZSB2YWxpZCBhbmQgZXhlY3V0YWJsZSBpbnNpZGUgdGhlIGBvbkNyZWF0ZWAgZmllbGQgb2YgYSBib3QgaW4gQ2FzdWFsT1MuCgpPQkpFQ1RJVkU6IEJhc2VkIG9uIHRoZSBJTlBVVCBhbmQgdGhlIHByb3ZpZGVkIFRBUkdFVF9CT1RfSURTLCBnZW5lcmF0ZSBKYXZhU2NyaXB0IHRoYXQgcGVyZm9ybXMgdGhlIHJlcXVlc3RlZCBiZWhhdmlvciBpbiBDYXN1YWxPUy4gVGhlIGNvZGUgbXVzdDoKCjEuIEltcGxlbWVudCB0aGUgcmVxdWVzdGVkIGFjdGlvbi4KMi4gQWx3YXlzIGluY2x1ZGUgYGFiLmxvZygiYSBkZXNjcmlwdGlvbiBvZiB0aGUgZXhlY3V0aW9uIilgIHRvIGRlc2NyaWJlIHdoYXQgdGhlIGNvZGUgZG9lcy4KMy4gQWx3YXlzIGluY2x1ZGUgYGRlc3Ryb3kodGhpc0JvdCk7YCBhdCB0aGUgZW5kIHRvIHJlbW92ZSB0aGUgYm90IGFmdGVyIGV4ZWN1dGlvbi4KNC4gVXNlIHRoZSBhcnJheSBvZiBgVEFSR0VUX0JPVF9JRFNgIGFzIGNvbnRleHQgZm9yIGxvY2F0aW9uIG9yIGJlaGF2aW9yIHdoZW4gYXBwcm9wcmlhdGUuIEZvciBleGFtcGxlOgogICAtIFdoZW4gY3JlYXRpbmcgYm90cywgdXNlIGVhY2ggdGFyZ2V0J3MgYGhvbWVYYCBhbmQgYGhvbWVZYCBmb3IgcGxhY2VtZW50LgogICAtIFdoZW4gbW9kaWZ5aW5nIGJvdHMsIGl0ZXJhdGUgb3ZlciBlYWNoIHRhcmdldCB1c2luZyBgZ2V0Qm90KCJpZCIsIDxpZD4pYC4KNS4gVXNlIHN0YW5kYXJkIENhc3VhbE9TIHNjcmlwdGluZyBtZXRob2RzIHN1Y2ggYXMgYGNyZWF0ZSguLi4pYCwgYHNldFRhZyguLi4pYCwgYGdldEJvdCguLi4pYCwgYGdldEJvdHMoLi4uKWAsIGV0Yy4KCkJPVCBDT05URVhUOgotIFlvdSB3aWxsIHJlY2VpdmUgYFRBUkdFVF9CT1RfSURTID0gWyJib3RfMSIsICJib3RfMiIsIC4uLl1gLgotIFVzZSBgZ2V0Qm90KCJpZCIsIDxpZD4pYCB0byBhY2Nlc3MgaW5kaXZpZHVhbCBib3RzIGFuZCB0aGVpciB0YWdzLgotIFBlcmZvcm0gbW9kaWZpY2F0aW9ucyBvciBsb2dpYyBmb3IgZWFjaCBib3QgaW4gdGhlIGFycmF5LgoKUk9MRTogWW91IGFyZSBQTSBCb3QsIGEgaGVscGZ1bCBhc3Npc3RhbnQgdGhhdCB3cml0ZXMgSmF2YVNjcmlwdCBjb2RlIHRvIGNvbnRyb2wgYm90cyBpbiBbQ2FzdWFsT1NdKGh0dHBzOi8vZ2l0aHViLmNvbS9hbGFuLWFpL2Nhc3VhbG9zKSwgYSB3ZWItYmFzZWQgSURFIGZvciBib3Qgc2NyaXB0aW5nLgoKRVhBTVBMRVM6CgpFeGFtcGxlIDE6ICAKSW5wdXQ6IFdoYXQgY29sb3IgaXMgdGhlIHNreT8gIApUQVJHRVRfQk9UX0lEUzogWyJza3lfMTIzIl0gIApBbnN3ZXI6ICAKYWIubG9nKCJUaGUgc2t5IGlzIGJsdWUiKTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSAyOiAgCklucHV0OiBNYWtlIGEgcmVkIGJvdCBuZXh0IHRvIGVhY2ggb2YgdGhlc2UgYm90cy4gIApUQVJHRVRfQk9UX0lEUzogWyJhIiwgImIiLCAiYyJdICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSByZWQgYm90cyBuZXh0IHRvIGVhY2ggdGFyZ2V0Iik7ICAKZm9yIChsZXQgaWQgb2YgWyJhIiwgImIiLCAiYyJdKSB7ICAKICBsZXQgYm90ID0gZ2V0Qm90KCJpZCIsIGlkKTsgIAogIGNyZWF0ZSh7ICAKICAgIGhvbWU6IHRydWUsICAKICAgIGhvbWVYOiBib3QudGFncy5ob21lWCArIDEsICAKICAgIGhvbWVZOiBib3QudGFncy5ob21lWSwgIAogICAgY29sb3I6ICJyZWQiLCAgCiAgICBjcmVhdG9yOiBudWxsICAKICB9KTsgIAp9ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgMzogIApJbnB1dDogVG9hc3QgaGVsbG8gd2hlbiBhbnkgb2YgdGhlc2UgYm90cyBhcmUgY2xpY2tlZC4gIApUQVJHRVRfQk9UX0lEUzogWyJ0YXJnZXQxIiwgInRhcmdldDIiXSAgCkFuc3dlcjogIAphYi5sb2coIlNldCB1cCB0b2FzdC1vbi1jbGljayBiZWhhdmlvciIpOyAgCmZvciAobGV0IGlkIG9mIFsidGFyZ2V0MSIsICJ0YXJnZXQyIl0pIHsgIAogIGxldCBib3QgPSBnZXRCb3QoImlkIiwgaWQpOyAgCiAgc2V0VGFnKGJvdCwgIm9uQ2xpY2siLCAiQCBvcy50b2FzdCgnaGVsbG8nKTsiKTsgIAp9ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgNDogIApJbnB1dDogTWFrZSBhbGwgcmVkIGJvdHMgYmx1ZS4gIApUQVJHRVRfQk9UX0lEUzogWyJzb21lX2lkIiwgImRvZXNudF9tYXR0ZXIiXSAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgcmVkIGJvdHMgYmx1ZSIpOyAgCnNldFRhZyhnZXRCb3RzKCJjb2xvciIsICJyZWQiKSwgImNvbG9yIiwgImJsdWUiKTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSA1OiAgCklucHV0OiBNYWtlIGEgYmx1ZSBib3QgYWJvdmUgZWFjaCBvZiB0aGUgZ2l2ZW4gYm90cyB0aGF0IHRvYXN0cyBoZWxsbyB3aGVuIGhvdmVyZWQuICAKVEFSR0VUX0JPVF9JRFM6IFsiYjEiLCAiYjIiLCAiYjMiXSAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgYmx1ZSBib3RzIGFib3ZlIGVhY2ggdGFyZ2V0IHRoYXQgdG9hc3Qgb24gcG9pbnRlciBlbnRlciIpOyAgCmZvciAobGV0IGlkIG9mIFsiYjEiLCAiYjIiLCAiYjMiXSkgeyAgCiAgbGV0IGJvdCA9IGdldEJvdCgiaWQiLCBpZCk7ICAKICBjcmVhdGUoeyAgCiAgICBob21lOiB0cnVlLCAgCiAgICBob21lWDogYm90LnRhZ3MuaG9tZVgsICAKICAgIGhvbWVZOiBib3QudGFncy5ob21lWSArIDEsICAKICAgIGNvbG9yOiAiYmx1ZSIsICAKICAgIG9uUG9pbnRlckVudGVyOiAiQCBvcy50b2FzdCgnaGVsbG8nKTsiLCAgCiAgICBjcmVhdG9yOiBudWxsICAKICB9KTsgIAp9ICAKZGVzdHJveSh0aGlzQm90KTsKCklOUFVUOiAgCicA7rHChA6HZBphYk11bHRpcGxlQm90TWVudVNvcnRPcmRlcgIEAO6xwoQO8agCAzEwMScA7rHChA6HZAlhYlZlcnNpb24CBADuscKEDvWoAgQxMC41JwDuscKEDodkDmNoYW5uZWxfY29uZmlnAgQA7rHChA76qAKtD0Bjb25zdCBjb25maWd1cmF0aW9uRGF0YSA9IGF3YWl0IG9zLmdldERhdGEodGhhdC5kYXRhLnN0dWRpb0lELCB0aGF0LmRhdGEucGF0dGVybklEKTsKCmxldCBuZXdEZXBsb3ltZW50ID0gZmFsc2U7CgppZiAobGlua3MucmVtZW1iZXIudGFncy5jaGFubmVsQ29uZmlndXJlZCkKewogICAgcmV0dXJuOwp9CgpsaW5rcy5yZW1lbWJlci50YWdzLmNoYW5uZWxDb25maWd1cmVkID0gdHJ1ZTsKCmlmIChjb25maWd1cmF0aW9uRGF0YS5kYXRhLmJpb3MpCnsKICAgIGNvbnN0IHRhcmdldEJpb3MgPSBjb25maWd1cmF0aW9uRGF0YS5kYXRhLmJpb3M7CgogICAgc3dpdGNoICh0YXJnZXRCaW9zKSAKICAgIHsKICAgICAgICBjYXNlICJsb2NhbCI6CiAgICAgICAgICAgIGlmIChjb25maWdCb3QudGFncy5zdGF0aWNJbnN0ID09IG51bGwpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5ld0RlcGxveW1lbnQgPSB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICJzdHVkaW8iOgogICAgICAgICAgICBpZiAoY29uZmlnQm90LnRhZ3Mub3duZXIgPT0gbnVsbCB8fCBjb25maWdCb3QudGFncy5vd25lciA9PSAicHVibGljIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmV3RGVwbG95bWVudCA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgInNoYXJlZCI6CiAgICAgICAgICAgIGlmIChjb25maWdCb3QudGFncy5vd25lciAhPSAicHVibGljIikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmV3RGVwbG95bWVudCA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgfQp9CgppZiAoY29uZmlndXJhdGlvbkRhdGEuZGF0YS5lZ2cpCnsKICAgIGNvbnN0IHRhcmdldFBhdHRlcm4gPSBjb25maWd1cmF0aW9uRGF0YS5kYXRhLmVnZy5wYXR0ZXJuOwogICAgY29uc3QgdGFyZ2V0U3R1ZGlvID0gY29uZmlndXJhdGlvbkRhdGEuZGF0YS5lZ2cuc3R1ZGlvOwoKICAgIHNob3V0KCJoYXRjaCIsIHthYklEOiB0YXJnZXRQYXR0ZXJuLCByZWNvcmRLZXk6IHRhcmdldFN0dWRpbywgYXV0b0hhdGNoOiB0cnVlfSk7Cn0KCmlmIChjb25maWd1cmF0aW9uRGF0YS5kYXRhLmdyaWRDb2xvcikKewogICAgbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VHcmlkUG9ydGFsQ29sb3IgPSBjb25maWd1cmF0aW9uRGF0YS5kYXRhLmdyaWRDb2xvcjsKCiAgICBncmlkUG9ydGFsQm90LnRhZ3MucG9ydGFsQ29sb3IgPSBjb25maWd1cmF0aW9uRGF0YS5kYXRhLmdyaWRDb2xvcjsKfQoKaWYgKGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuaW5zdCAmJiBjb25maWdCb3QudGFncy5pbnN0ICE9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuaW5zdCAmJiBjb25maWd1cmF0aW9uRGF0YS5kYXRhLmluc3QgIT0gbnVsbCkKewogICAgbmV3RGVwbG95bWVudCA9IHRydWU7Cn0KCmlmIChuZXdEZXBsb3ltZW50KQp7CiAgICBjb25zdCBzaXRlT3JpZ2luID0gbmV3IFVSTChjb25maWdCb3QudGFncy51cmwpLm9yaWdpbjsKICAgIGNvbnN0IHRhcmdldEluc3QgPSBjb25maWd1cmF0aW9uRGF0YS5kYXRhLmluc3QgPyAiJmluc3Q9IiArIGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuaW5zdCA6ICIiOwogICAgY29uc3QgdGFyZ2V0QmlvcyA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuYmlvcyA/ICImYmlvcz0iICsgY29uZmlndXJhdGlvbkRhdGEuZGF0YS5iaW9zIDogIiI7CiAgICBjb25zdCB0YXJnZXRQYXR0ZXJuID0gY29uZmlnQm90LnRhZ3MucGF0dGVybiA/ICImcGF0dGVybj0iICsgY29uZmlnQm90LnRhZ3MucGF0dGVybiA6ICIiOwogICAgY29uc3QgdGFyZ2V0VVJMID0gc2l0ZU9yaWdpbiArIGAvP2Fzaz0ke2NvbmZpZ0JvdC50YWdzLmFza30ke3RhcmdldFBhdHRlcm59JHt0YXJnZXRJbnN0fSR7dGFyZ2V0Qmlvc31gOwoKICAgIG9zLmdvVG9VUkwodGFyZ2V0VVJMKTsKfScA7rHChA6HZA1jaGFubmVsTG9hZGVyAgQA7rHChA6ouAIo8J+Ul2E5YjZhYTBkLWIzNTctNGRlNi05YmVmLTg1MzQ4YWIxZDBlMCcA7rHChA6HZAlwcm90b3R5cGUCBADuscKEDs+4Ai5AdGhpc0JvdC5hYkNvcmVNZW51QWN0aW9uKCJNYWtlIG1lOiAiICsgdGhhdCk7JwDuscKEDodkC3BlcnNvbmFsaXR5AgQA7rHChA7+uAIo8J+Ul2I3NmRmYmM0LTg1NGItNGY2ZC1hOTFmLWE5NDg2OTQ3NzRkYicA7rHChA6HZAV1dGlscwIEAO6xwoQOpbkCKPCflJc5M2Q5NjVlMC1kMjBlLTRiNDUtOGNhMC02NDkyNzNiNzEzOGMnAO6xwoQOh2QGY3JlYXRlAgQA7rHChA7MuQIo8J+UlzM0YzNjMjEwLTViZjEtNDljZi1iMTUxLWVlMmQwN2YwZTY3MycBBGJvdHMkZjlmZDdlMmUtN2NjZS00M2ZiLWIyMjMtZDMyY2I0MmJlYmU4AScA7rHChA7zuQIGc3lzdGVtAgQA7rHChA70uQITYWIuYWN0aW9uLmNvbG9yX2JvdCcA7rHChA7zuQIEZm9ybQIEAO6xwoQOiLoCB25vdGhpbmcnAO6xwoQO87kCCGFiQWN0aW9uAgQA7rHChA6QugIEdHJ1ZScA7rHChA7zuQIPYWJCb3RNZW51QWN0aW9uAgQA7rHChA6VugKOAUBjb25zdCB0YXJnZXRCb3QgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzOwoKb3Muc2hvd0lucHV0Rm9yVGFnKHRhcmdldEJvdCwgImNvbG9yIiwgewogICAgdHlwZTogJ2NvbG9yJywKICAgIHRpdGxlOiAncGljayBhIGNvbG9yJwp9KTsnAO6xwoQO87kCDmFiQm90TWVudUxhYmVsAgQA7rHChA6kuwIFY29sb3InAO6xwoQO87kCDWFiQm90TWVudUljb24CBADuscKEDqq7AgdwYWxldHRlJwDuscKEDvO5AghyZW1lbWJlcgIEAO6xwoQOsrsCKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAO6xwoQO87kCEmFiQm90TWVudVNvcnRPcmRlcgIEAO6xwoQO2bsCATInAO6xwoQO87kCCGFiSWdub3JlAgQA7rHChA7buwIEdHJ1ZScA7rHChA7zuQIXYWJNdWx0aXBsZUJvdE1lbnVBY3Rpb24CBADuscKEDuC7AuIDQGNvbnN0IGFsbFRhcmdldEJvdHMgPSBsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXM7CmNvbnN0IGJ1aWxkZXIgPSBhYi5saW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90ID8gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC5pZCA6IG51bGw7CmNvbnN0IHJlbGV2YW50VGFyZ2V0Qm90cyA9IGFsbFRhcmdldEJvdHMuZmlsdGVyKCh0YXJnZXQpID0+IHRhcmdldC5pZCAhPSBidWlsZGVyKTsKY29uc3Qgc2VsZWN0ZWRDb2xvciA9IGF3YWl0IG9zLnNob3dJbnB1dChudWxsLCB7CiAgICB0eXBlOiAnY29sb3InLAogICAgdGl0bGU6ICdwaWNrIGEgY29sb3InCn0pOwoKc2V0VGFnKHJlbGV2YW50VGFyZ2V0Qm90cywgImNvbG9yIiwgc2VsZWN0ZWRDb2xvcik7CgphYi5sb2cobGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6IG9wZW5lZCBtdWx0aXBsZSBzZWxlY3Qgc2hlZXQiKTsnAO6xwoQO87kCFWFiTXVsdGlwbGVCb3RNZW51SWNvbgIEAO6xwoQOw78CB3BhbGV0dGUnAO6xwoQO87kCFmFiTXVsdGlwbGVCb3RNZW51TGFiZWwCBADuscKEDsu/AgVjb2xvcicA7rHChA7zuQIaYWJNdWx0aXBsZUJvdE1lbnVTb3J0T3JkZXICBADuscKEDtG/AgExJwDuscKEDvO5AglhYlZlcnNpb24CBADuscKEDtO/AgQxMC41JwDuscKEDvO5AgtwZXJzb25hbGl0eQIEAO6xwoQO2L8CKPCflJdiNzZkZmJjNC04NTRiLTRmNmQtYTkxZi1hOTQ4Njk0Nzc0ZGIA"}]}