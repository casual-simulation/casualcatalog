{"version":2,"updates":[{"id":0,"timestamp":1759429567386,"update":"AewCjYai1g0AJwEEYm90cyQzOTg4MDFmZS00YjM1LTRjZTQtODI2Zi0yMzgzNWMxYjlhYzUBJwCNhqLWDQAGc3lzdGVtAgQAjYai1g0BFGFiLmFjdGlvbi5jcmVhdGVfYm90JwCNhqLWDQAIYWJBY3Rpb24CBACNhqLWDRYEdHJ1ZScAjYai1g0ABGZvcm0CBACNhqLWDRsHbm90aGluZycAjYai1g0AC2Rlc2NyaXB0aW9uAgQAjYai1g0jDUNyZWF0ZXMgYm90cy4nAI2GotYNABBhYkdyaWRNZW51QWN0aW9uAgQAjYai1g0xsQVAY29uc3QgZ3JpZEluZm9ybWF0aW9uID0gbGlua3MucmVtZW1iZXIudGFncy5hYkdyaWRGb2N1czsKY29uc3QgbmV3Qm90ID0ge307CgpuZXdCb3QuY3JlYXRvciA9IG51bGw7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uXSA9IHRydWU7Cm5ld0JvdFtncmlkSW5mb3JtYXRpb24uZGltZW5zaW9uICsgIlgiXSA9IGdyaWRJbmZvcm1hdGlvbi5wb3NpdGlvbi54OwpuZXdCb3RbZ3JpZEluZm9ybWF0aW9uLmRpbWVuc2lvbiArICJZIl0gPSBncmlkSW5mb3JtYXRpb24ucG9zaXRpb24ueTsKbmV3Qm90LmNvbG9yID0gbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKCmxldCBjcmVhdGVkQm90ID0gY3JlYXRlKG5ld0JvdCk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90Lm1hc2tzLmxpbmVDb2xvciA9IGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QubWFza3MubGluZVRvID0gY3JlYXRlZEJvdC5pZDsKCmxpbmtzLnJlbWVtYmVyLm1hc2tzLmFiQm90Rm9jdXMgPSAi8J+UlyIgKyBjcmVhdGVkQm90LmlkOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKHttZW51OiAiYm90In0pOycAjYai1g0AD2FiR3JpZE1lbnVMYWJlbAIEAI2GotYN4QUDYm90JwCNhqLWDQAOYWJHcmlkTWVudUljb24CBACNhqLWDeUFB2FkZF9ib3gnAI2GotYNAAhyZW1lbWJlcgIEAI2GotYN7QUo8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycAjYai1g0ADW1hbmlmZXN0YXRpb24CBACNhqLWDZQGKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAI2GotYNAAhhYklnbm9yZQIEAI2GotYNuwYEdHJ1ZScAjYai1g0AE2FiR3JpZE1lbnVTb3J0T3JkZXICBACNhqLWDcAGATEnAI2GotYNAAlhYlZlcnNpb24CBACNhqLWDcIGBTEwLjE2JwCNhqLWDQALcGVyc29uYWxpdHkCBACNhqLWDcgGKPCflJdiNzZkZmJjNC04NTRiLTRmNmQtYTkxZi1hOTQ4Njk0Nzc0ZGInAQRib3RzJDU4NDlhZjU1LTVlOGEtNDhkNi05MTA2LTE5OTQ5OGU5ZWMwOAEnAI2GotYN7wYGc3lzdGVtAgQAjYai1g3wBhFhYi5hY3Rpb24uZGVzdHJveScAjYai1g3vBghhYkFjdGlvbgIEAI2GotYNggcEdHJ1ZScAjYai1g3vBgRmb3JtAgQAjYai1g2HBwdub3RoaW5nJwCNhqLWDe8GD2FiQm90TWVudUFjdGlvbgIEAI2GotYNjwfAAkBjb25zdCB0YXJnZXRCb3QgPSB0aGF0LmJvdC5saW5rcy50YXJnZXRCb3Q7CgppZiAodGhhdC5ib3QubGlua3MudGFyZ2V0T3JpZ2luQm90cykgewogICAgLy8gRGVzdHJveSBib3RzIGJlbG9uZ2luZyB0byBhYklET3JpZ2luLgogICAgZGVzdHJveSh0aGF0LmJvdC5saW5rcy50YXJnZXRPcmlnaW5Cb3RzKTsKfSBlbHNlIHsKICAgIC8vIERlc3Ryb3kgdGhlIHNpbmdsZSB0YXJnZXQgYm90LgogICAgZGVzdHJveSh0YXJnZXRCb3QpOwp9CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKHsgcmVzZXQ6IHRydWUgfSk7JwCNhqLWDe8GDmFiQm90TWVudUxhYmVsAgQAjYai1g3QCQdkZXN0cm95JwCNhqLWDe8GDWFiQm90TWVudUljb24CBACNhqLWDdgJDmRlbGV0ZV9mb3JldmVyJwCNhqLWDe8GEmFiQm90TWVudVNvcnRPcmRlcgIEAI2GotYN5wkDMTAwJwCNhqLWDe8GCHJlbWVtYmVyAgQAjYai1g3rCSjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwCNhqLWDe8GDW1hbmlmZXN0YXRpb24CBACNhqLWDZIKKPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAI2GotYN7wYIYWJJZ25vcmUCBACNhqLWDbkKBHRydWUnAI2GotYN7wYOYWJCb3RNZW51Q29sb3ICBACNhqLWDb4KByNEOTMwMzAnAI2GotYN7wYXYWJNdWx0aXBsZUJvdE1lbnVBY3Rpb24CBACNhqLWDcYKwANAY29uc3QgYWxsVGFyZ2V0Qm90cyA9IEFycmF5LmlzQXJyYXkobGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzKSA/IGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1cyA6IFtsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXNdOwpjb25zdCBidWlsZGVyID0gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdCA/IGFiLmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QuaWQgOiBudWxsOwpjb25zdCByZWxldmFudFRhcmdldEJvdHMgPSBhbGxUYXJnZXRCb3RzLmZpbHRlcigodGFyZ2V0KSA9PiB0YXJnZXQuaWQgIT0gYnVpbGRlcik7CgpkZXN0cm95KHJlbGV2YW50VGFyZ2V0Qm90cyk7CgpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKHsgcmVzZXQ6IHRydWUgfSk7JwCNhqLWDe8GFWFiTXVsdGlwbGVCb3RNZW51SWNvbgIEAI2GotYNhw4OZGVsZXRlX2ZvcmV2ZXInAI2GotYN7wYWYWJNdWx0aXBsZUJvdE1lbnVMYWJlbAIEAI2GotYNlg4HZGVzdHJveScAjYai1g3vBhphYk11bHRpcGxlQm90TWVudVNvcnRPcmRlcgIEAI2GotYNng4DMTAwJwCNhqLWDe8GFmFiTXVsdGlwbGVCb3RNZW51Q29sb3ICBACNhqLWDaIOByNEOTMwMzAnAI2GotYN7wYJYWJWZXJzaW9uAgQAjYai1g2qDgUxMC4xNicAjYai1g3vBhNhYkJvdE1lbnVPbkdlbmVyYXRlAgQAjYai1g2wDq0HQGNvbnN0IHRhcmdldEJvdCA9IGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiQm90Rm9jdXM7CgppZiAodGFyZ2V0Qm90KSB7CiAgICB0YWdzLmxhYmVsID0gJ2Rlc3Ryb3knOwogICAgdGFncy50YXJnZXRCb3QgPSBnZXRMaW5rKHRhcmdldEJvdCk7CiAgICB0YWdzLm9uS2V5RG93biA9IGBACiAgICAgICAgaWYgKHRoYXQua2V5cy5pbmNsdWRlcygiU2hpZnQiKSkgewogICAgICAgICAgICBpZiAobGlua3MudGFyZ2V0Qm90ICYmIGxpbmtzLnRhcmdldEJvdC50YWdzLmFiSURPcmlnaW4pIHsKICAgICAgICAgICAgICAgIC8vIENoYW5nZSBidXR0b24gdG8gZGVzdHJveSBhbGwgYm90cyB3aXRoIHNhbWUgYWJJRE9yaWdpbi4KICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldE9yaWdpbkJvdHMgPSBnZXRCb3RzKGIgPT4gewogICAgICAgICAgICAgICAgICAgIHJldHVybiBiLnRhZ3MuYWJJRE9yaWdpbiA9PT0gbGlua3MudGFyZ2V0Qm90LnRhZ3MuYWJJRE9yaWdpbjsKICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgbWFza3MubGFiZWwgPSAnZGVzdHJveSAnICsgbGlua3MudGFyZ2V0Qm90LnRhZ3MuYWJJRE9yaWdpbiArICcgKCcgKyB0YXJnZXRPcmlnaW5Cb3RzLmxlbmd0aCArICcgYm90cyknOwogICAgICAgICAgICAgICAgdGFncy50YXJnZXRPcmlnaW5Cb3RzID0gZ2V0TGluayh0YXJnZXRPcmlnaW5Cb3RzKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIGA7CiAgICB0YWdzLm9uS2V5VXAgPSBgQAogICAgICAgIGlmICh0aGF0LmtleXMuaW5jbHVkZXMoIlNoaWZ0IikpIHsKICAgICAgICAgICAgbWFza3MubGFiZWwgPSBudWxsOwogICAgICAgICAgICB0YWdzLnRhcmdldE9yaWdpbkJvdHMgPSBudWxsOwogICAgICAgIH0KICAgIGA7Cn0gZWxzZSB7CiAgICAvLyBObyBib3QgdG8gZGVzdHJveS4KICAgIGRlc3Ryb3kodGhpc0JvdCk7Cn0nAI2GotYN7wYbYWJNdWx0aXBsZUJvdE1lbnVPbkdlbmVyYXRlAgQAjYai1g3eFe8EQGNvbnN0IGFsbFRhcmdldEJvdHMgPSBBcnJheS5pc0FycmF5KGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1cykgPyBsaW5rcy5yZW1lbWJlci5saW5rcy5hYk11bHRpcGxlQm90Rm9jdXMgOiBbbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzXTsKY29uc3QgYnVpbGRlciA9IGFiLmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QgPyBhYi5saW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90LmlkIDogbnVsbDsKY29uc3QgcmVsZXZhbnRUYXJnZXRCb3RzID0gYWxsVGFyZ2V0Qm90cy5maWx0ZXIoKHRhcmdldCkgPT4gdGFyZ2V0LmlkICE9IGJ1aWxkZXIpOwoKaWYgKHJlbGV2YW50VGFyZ2V0Qm90cy5sZW5ndGggPiAxKSB7CiAgICAvLyBNdWx0aXBsZSBib3RzLgogICAgdGFncy5sYWJlbCA9IGBkZXN0cm95ICgke3JlbGV2YW50VGFyZ2V0Qm90cy5sZW5ndGh9IGJvdHMpYDsKfSBlbHNlIGlmIChyZWxldmFudFRhcmdldEJvdHMubGVuZ3RoID09PSAxKSB7CiAgICAvLyBTaW5nbGUgYm90LgogICAgdGFncy5sYWJlbCA9IGBkZXN0cm95YDsKfSBlbHNlIHsKICAgIC8vIE5vIGJvdHMgdG8gZGVzdHJveS4KICAgIGRlc3Ryb3kodGhpc0JvdCk7Cn0nAQRib3RzJDZiM2Q5NzQ0LTQ0NDgtNGVmNS05NmEyLTcxMjgxYzQyYWY2YwEnAI2GotYNzhoJYWJWZXJzaW9uAgQAjYai1g3PGgUxMC4xNicAjYai1g3OGgZzeXN0ZW0CBACNhqLWDdUaEWFiLmFjdGlvbi52ZXJzaW9uJwCNhqLWDc4aFGFiQWN0aW9uTWFqb3JWZXJzaW9uAgQAjYai1g3nGgExJwCNhqLWDc4aFGFiQWN0aW9uTWlub3JWZXJzaW9uAgQAjYai1g3pGgIxMCcAjYai1g3OGg1vblNraWxsVXBkYXRlAgQAjYai1g3sGpkBQGNvbnN0IHZlcnNpb25TdHJpbmcgPSB0YWdzLmFiQWN0aW9uTWFqb3JWZXJzaW9uICsgIi4iICsgdGFncy5hYkFjdGlvbk1pbm9yVmVyc2lvbjsKCmNvbnNvbGUubG9nKCJbQUJBY3Rpb25dIExvYWRlZCBBQiBBY3Rpb24gdmVyc2lvbiAiICsgdmVyc2lvblN0cmluZyk7JwCNhqLWDc4aCGFiSWdub3JlAgQAjYai1g2GHAR0cnVlJwCNhqLWDc4aCGFiQWN0aW9uAgQAjYai1g2LHAR0cnVlJwCNhqLWDc4aBGZvcm0CBACNhqLWDZAcB25vdGhpbmcnAQRib3RzJDcxNzU2NDVjLTRiNTMtNDQ1NC04NzE2LWZjMGU2OGRiMjY2NQEnAI2GotYNmBwGc3lzdGVtAgQAjYai1g2ZHA9hYi5hY3Rpb24ubG9naW4nAI2GotYNmBwIYWJBY3Rpb24CBACNhqLWDakcBHRydWUnAI2GotYNmBwIYWJJZ25vcmUCBACNhqLWDa4cBHRydWUnAI2GotYNmBwEZm9ybQIEAI2GotYNsxwHbm90aGluZycAjYai1g2YHA9hYkNvcmVNZW51Q29sb3ICBACNhqLWDbscByNGMkI3MDUnAI2GotYNmBwTYWJDb3JlTWVudVNvcnRPcmRlcgIEAI2GotYNwxwCLTUnAI2GotYNmBwQYWJDb3JlTWVudUFjdGlvbgIEAI2GotYNxhwbQGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90KCk7JwCNhqLWDZgcFGFiQ29yZU1lbnVPbkdlbmVyYXRlAgQAjYai1g3iHOsBQHRhZ3MuYWJNZW51ID0gZmFsc2U7IC8vIEtlZXAgYnV0dG9uIGhpZGRlbiB1bnRpbCBhdXRoIGNoZWNrIGlzIGNvbXBsZXRlLgphd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKGF1dGhCb3QpIHsKICAgIGRlc3Ryb3kodGhpc0JvdCk7Cn0gZWxzZSB7CiAgICB0YWdzLmFiTWVudSA9IHRydWU7CiAgICB0YWdzLm9uQUJBdXRoQm90QWRkZWQgPSBgQGRlc3Ryb3kodGhpc0JvdCk7YDsKfScAjYai1g2YHA5hYkNvcmVNZW51SWNvbgIEAI2GotYNzh4FbG9naW4nAI2GotYNmBwIcmVtZW1iZXICBACNhqLWDdQeKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAI2GotYNmBwJYWJWZXJzaW9uAgQAjYai1g37HgUxMC4xNicAjYai1g2YHAtwZXJzb25hbGl0eQIEAI2GotYNgR8o8J+Ul2I3NmRmYmM0LTg1NGItNGY2ZC1hOTFmLWE5NDg2OTQ3NzRkYicAjYai1g2YHA9hYkNvcmVNZW51TGFiZWwCBACNhqLWDagfB3NpZ24gaW4nAI2GotYNmBwOYWJDb3JlTWVudUhpZGUCBACNhqLWDbAfBHRydWUnAI2GotYNmBwOb25BbnlCb3RzQWRkZWQCBACNhqLWDbUf/gJAaWYgKHRoYXQuYm90cykgewogICAgY29uc3QgYWRkZWRBdXRoQm90ID0gdGhhdC5ib3RzLmZpbmQoYiA9PiBiID09PSBnbG9iYWxUaGlzLmF1dGhCb3QpOwoKICAgIGlmIChhZGRlZEF1dGhCb3QpIHsKICAgICAgICB0aGlzQm90LnZhcnMuYXV0aEJvdElkID0gYWRkZWRBdXRoQm90LmlkOwoKICAgICAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIGF1dGggYm90IGFkZGVkLiBhdXRoQm90IGlkOiAke3RoaXNCb3QudmFycy5hdXRoQm90SWR9YCk7CiAgICAgICAgfQoKICAgICAgICBzaG91dCgnb25BQkF1dGhCb3RBZGRlZCcsIHsgYXV0aEJvdDogYWRkZWRBdXRoQm90IH0pOwogICAgfQp9JwCNhqLWDZgcBWRlYnVnAgQAjYai1g20IgVmYWxzZScAjYai1g2YHBBvbkFueUJvdHNSZW1vdmVkAgQAjYai1g26IqMDQGlmICh0aGF0LmJvdElEcyAmJiB0aGlzQm90LnZhcnMuYXV0aEJvdElkKSB7CiAgICBjb25zdCByZW1vdmVkQXV0aEJvdElkID0gdGhhdC5ib3RJRHMuc29tZShpZCA9PiBpZCA9PT0gdGhpc0JvdC52YXJzLmF1dGhCb3RJZCk7CgogICAgaWYgKHJlbW92ZWRBdXRoQm90SWQpIHsKICAgICAgICB0aGlzQm90LnZhcnMuYXV0aEJvdElkID0gbnVsbDsKCiAgICAgICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBhdXRoIGJvdCByZW1vdmVkLiBhdXRoQm90IGlkOiAke3JlbW92ZWRBdXRoQm90SWR9YCk7CiAgICAgICAgfQoKICAgICAgICBzaG91dCgnb25BQkF1dGhCb3RSZW1vdmVkJywgeyBhdXRoQm90SWQ6IHJlbW92ZWRBdXRoQm90SWQgfSk7CiAgICB9Cn0nAQRib3RzJGIzMzljMTE4LTQ4OWEtNDY2Yi1iYTlmLWIwN2E1ZjliNjY0ZgEnAI2GotYN3iUGc3lzdGVtAgQAjYai1g3fJQ9hYi5hY3Rpb24ucGFzdGUoAI2GotYN3iUIYWJBY3Rpb24BeCcAjYai1g3eJQRmb3JtAgQAjYai1g3wJQdub3RoaW5nJwCNhqLWDd4lC2Rlc2NyaXB0aW9uAgQAjYai1g34JSthYiBza2lsbCB1c2VkIGZvciBjb3B5aW5nIGFuZCBwYXN0aW5nIGJvdHMuJwCNhqLWDd4lB29uUGFzdGUCBACNhqLWDaQm/wdAaWYgKCFidWlsZGVyVmVyc2lvbikKewogICAgcmV0dXJuOwp9Cgpjb25zdCBNQUNST1MgPSBbCiAgICB7CiAgICAgICAgdGVzdDogLyg/OlvigJzigJ1dKS9nLAogICAgICAgIHJlcGxhY2VtZW50OiAodmFsKSA9PiAnIicsCiAgICB9LAogICAgewogICAgICAgIHRlc3Q6IC8oPzpb4oCY4oCZXSkvZywKICAgICAgICByZXBsYWNlbWVudDogKHZhbCkgPT4gIiciLAogICAgfSwKXTsKCmxldCBmb3JtYXR0ZWRDb3B5ID0gcmVwbGFjZU1hY3Jvcyh0aGF0LnRleHQpOwpsZXQgY29weUJvdCA9IEpTT04ucGFyc2UoZm9ybWF0dGVkQ29weSk7CmxldCBwYXN0ZWREYXRhID0gIWNvcHlCb3Quc3RhdGUgPyB7W2NvcHlCb3QuaWRdOiBjb3B5Qm90fSA6IGNvcHlCb3Quc3RhdGU7CmxldCBkaW1Nb2QgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiRm9jdXNEYXRhOwoKaWYgKE9iamVjdC5rZXlzKHBhc3RlZERhdGEpLmxlbmd0aCA9PSAxICYmIGRpbU1vZCkKewogICAgcGFzdGVkRGF0YVtkaW1Nb2QuZGltZW5zaW9uXSA9IHRydWU7CiAgICBwYXN0ZWREYXRhW2RpbU1vZC5kaW1lbnNpb24rIlgiXSA9IGRpbU1vZC54OwogICAgcGFzdGVkRGF0YVtkaW1Nb2QuZGltZW5zaW9uKyJZIl0gPSBkaW1Nb2QueTsKCiAgICBvcy50b2FzdCgiYm90IGFkZGVkIHRvIGluc3QiKTsKfQplbHNlCnsKICAgIG9zLnRvYXN0KCJib3RzIGFkZGVkIHRvIGluc3QiKTsKfQoKYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBwYXN0ZWQgZGF0YSIpOwoKbGlua3MuY3JlYXRlLmFiQ3JlYXRlQm90cyh7Ym90czogcGFzdGVkRGF0YSwgc291cmNlRXZlbnQ6ICdwYXN0ZSd9KTsKCmZ1bmN0aW9uIHJlcGxhY2VNYWNyb3ModGV4dCkgewogICAgaWYgKCF0ZXh0KSB7CiAgICAgICAgcmV0dXJuIHRleHQ7CiAgICB9CgogICAgZm9yIChsZXQgbSBvZiBNQUNST1MpIHsKICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKG0udGVzdCwgbS5yZXBsYWNlbWVudCk7CiAgICB9CgogICAgcmV0dXJuIHRleHQ7Cn0nAI2GotYN3iUIcmVtZW1iZXICBACNhqLWDZwuKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAI2GotYN3iUGY3JlYXRlAgQAjYai1g3DLijwn5SXMzRjM2MyMTAtNWJmMS00OWNmLWIxNTEtZWUyZDA3ZjBlNjczJwCNhqLWDd4lCGFiSWdub3JlAgQAjYai1g3qLgR0cnVlJwCNhqLWDd4lCW9uS2V5RG93bgIEAI2GotYN7y66CUBpZiAoIWJ1aWxkZXJWZXJzaW9uIHx8ICghbGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1cyAmJiAhbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzKSkKewogICAgcmV0dXJuOwp9CgppZiAodGhhdC5rZXlzID09ICJjIikKewogICAgbGV0IG1ldGFJbnB1dCA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIk1ldGEiKTsKCiAgICBpZiAoIW1ldGFJbnB1dCkKICAgIHsKICAgICAgICBtZXRhSW5wdXQgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJDb250cm9sIik7CiAgICB9CiAgICAKICAgIGlmICghbWV0YUlucHV0KQogICAgewogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBsZXQgZm9ybWF0dGVkRmlsZTsKICAgIGxldCBzdGF0ZSA9IHt9OwoKICAgIGlmIChsaW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzKQogICAgewogICAgICAgIGxldCBzZWxlY3RlZEJvdCA9IGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiQm90Rm9jdXM7CgogICAgICAgIHN0YXRlW3NlbGVjdGVkQm90LmlkXSA9IHNlbGVjdGVkQm90OwoKICAgICAgICBhYi5sb2cobGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6IGNvcGllZCBhIGJvdCB0byBjbGlwYm9hcmQiKTsKICAgIH0KICAgIGVsc2UgaWYgKGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1cykKICAgIHsKICAgICAgICBsZXQgc2VsZWN0ZWRCb3RzID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdGVkQm90cy5sZW5ndGg7IGkrKykKICAgICAgICB7CiAgICAgICAgICAgIHN0YXRlW3NlbGVjdGVkQm90c1tpXS5pZF0gPSBzZWxlY3RlZEJvdHNbaV07CiAgICAgICAgfQoKICAgICAgICBhYi5sb2cobGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6IGNvcGllZCBtdWx0aXBsZSBib3RzIHRvIGNsaXBib2FyZCIpOwogICAgfQoKICAgIGxldCBuZXdGaWxlID0ge307CiAgICBuZXdGaWxlLnZlcnNpb24gPSAxOwogICAgbmV3RmlsZS5zdGF0ZSA9IHN0YXRlOwoKICAgIGZvcm1hdHRlZEZpbGUgPSBKU09OLnN0cmluZ2lmeShuZXdGaWxlKTsKCiAgICBvcy5zZXRDbGlwYm9hcmQoZm9ybWF0dGVkRmlsZSk7CgogICAgb3MudG9hc3QoImJvdCBjb3BpZWQgdG8gY2xpcGJvYXJkIik7Cn0nAI2GotYN3iUJYWJWZXJzaW9uAgQAjYai1g2qOAUxMC4xNicAjYai1g3eJQtwZXJzb25hbGl0eQIEAI2GotYNsDgo8J+Ul2I3NmRmYmM0LTg1NGItNGY2ZC1hOTFmLWE5NDg2OTQ3NzRkYicBBGJvdHMkYmRhYmQ2YzAtODlmOS00Zjc1LWIzNWMtMjZmNGVjNTIwN2Q2AScAjYai1g3XOAZzeXN0ZW0CBACNhqLWDdg4EGFiLmFjdGlvbi5yZXBvcnQnAI2GotYN1zgEZm9ybQIEAI2GotYN6TgHbm90aGluZycAjYai1g3XOBBhYkNvcmVNZW51QWN0aW9uAgQAjYai1g3xOBFAb3MucmVwb3J0SW5zdCgpOycAjYai1g3XOBNhYkNvcmVNZW51U29ydE9yZGVyAgQAjYai1g2DOQMxMDEnAI2GotYN1zgOYWJDb3JlTWVudUljb24CBACNhqLWDYc5BGZsYWcnAI2GotYN1zgPYWJDb3JlTWVudUxhYmVsAgQAjYai1g2MOQZyZXBvcnQnAI2GotYN1zgIYWJBY3Rpb24CBACNhqLWDZM5BHRydWUnAI2GotYN1zgIYWJJZ25vcmUCBACNhqLWDZg5BHRydWUnAI2GotYN1zgUYWJDb3JlTWVudU9uR2VuZXJhdGUCBACNhqLWDZ05RkBpZiAoY29uZmlnQm90LnRhZ3Muc3RhdGljSW5zdCAhPSB1bmRlZmluZWQpCnsKICAgIGRlc3Ryb3kodGhpc0JvdCk7Cn0nAI2GotYN1zgJYWJWZXJzaW9uAgQAjYai1g3kOQUxMC4xNicBBGJvdHMkYzY4YzViODItYzBhNy00YTVhLTkxMDQtNWRkOGUzMmFlNGUyAScAjYai1g3qOQZzeXN0ZW0CBACNhqLWDes5EGFiLmFjdGlvbi5wb3J0YWwnAI2GotYN6jkLZGVzY3JpcHRpb24CBACNhqLWDfw5FFNraWxsIHRvIG9wZW4gc2hlZXQuJwCNhqLWDeo5CGFiQWN0aW9uAgQAjYai1g2ROgR0cnVlJwCNhqLWDeo5BGZvcm0CBACNhqLWDZY6B25vdGhpbmcnAI2GotYN6jkQYWJDb3JlTWVudUFjdGlvbgIEAI2GotYNnjoDQC8vJwCNhqLWDeo5CHJlbWVtYmVyAgQAjYai1g2iOijwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwCNhqLWDeo5D2FiQ29yZU1lbnVMYWJlbAIEAI2GotYNyToQY3VycmVudCBwb3J0YWw6ICcAjYai1g3qOQ9hYkJvdE1lbnVBY3Rpb24CBACNhqLWDdo6+AJAY29uc3QgY3VycmVudEluc3QgPSBvcy5nZXRDdXJyZW50SW5zdCgpOwpjb25zdCBjdXJyZW50RGltID0gbGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdC50YWdzLmxpbmVUbzsKY29uc3Qgc3RhdGUgPSBvcy5nZXRJbnB1dFN0YXRlKCJrZXlib2FyZCIsICJTaGlmdCIpOwoKaWYgKHN0YXRlKSAKewogICAgb3Mub3BlblVSTChjb25maWdCb3QudGFncy5wZXJtYWxpbmsgKyBgJnNoZWV0UG9ydGFsPSR7Y3VycmVudERpbX1gKTsKfQplbHNlCnsKICAgIGNvbmZpZ0JvdC50YWdzLnNoZWV0UG9ydGFsID0gY3VycmVudERpbTsKfQoKYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBvcGVuZWQgYm90IHNoZWV0Iik7JwCNhqLWDeo5DmFiQm90TWVudUxhYmVsAgQAjYai1g3TPQ5vcGVuIGJvdCBzaGVldCcAjYai1g3qOQ1tYW5pZmVzdGF0aW9uAgQAjYai1g3iPSjwn5SXZGNhNWQ5ODctYzRkOC00NmU0LWI2MGMtZGFhN2IyZjRkZGFkJwCNhqLWDeo5DWFiQm90TWVudUljb24CBACNhqLWDYk+CnRhYmxlX3ZpZXcnAI2GotYN6jkOYWJDb3JlTWVudUljb24CBACNhqLWDZQ+C2Fycm93X3JpZ2h0JwCNhqLWDeo5EmFiQm90TWVudVNvcnRPcmRlcgIEAI2GotYNoD4BMScAjYai1g3qOQhhYklnbm9yZQIEAI2GotYNoj4EdHJ1ZScAjYai1g3qORdhYk11bHRpcGxlQm90TWVudUFjdGlvbgIEAI2GotYNpz6bBEBjb25zdCBjdXJyZW50SW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7CmNvbnN0IGN1cnJlbnREaW0gPSAiYWJNdWx0aXBsZVNlbGVjdCI7Cgpjb25maWdCb3QudGFncy5zaGVldFBvcnRhbCA9IGN1cnJlbnREaW07CgpzZXRUYWdNYXNrKGxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1cywgY3VycmVudERpbSwgdHJ1ZSwgInRlbXBMb2NhbCIpOwoKbWFza3MuY3VycmVudFNoZWV0Qm90cyA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJNdWx0aXBsZUJvdEZvY3VzOwptYXNrcy5vblBvcnRhbENoYW5nZWQgPSBgQCBpZiAodGhhdC5kaW1lbnNpb24gIT0gImFiTXVsdGlwbGVTZWxlY3QiICYmIHRoYXQucG9ydGFsID09ICJzaGVldFBvcnRhbCIpCnsKICAgIGNsZWFyVGFnTWFza3MobGlua3MuY3VycmVudFNoZWV0Qm90cyk7CgogICAgY2xlYXJUYWdNYXNrcyh0aGlzQm90KTsKfSBgOwoKYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBvcGVuZWQgbXVsdGlwbGUgc2VsZWN0IHNoZWV0Iik7JwCNhqLWDeo5FmFiTXVsdGlwbGVCb3RNZW51TGFiZWwCBACNhqLWDcNCGm9wZW4gbXVsdGlwbGUgc2VsZWN0IHNoZWV0JwCNhqLWDeo5FWFiTXVsdGlwbGVCb3RNZW51SWNvbgIEAI2GotYN3kIKdGFibGVfdmlldycAjYai1g3qORNhYkJvdE1lbnVPbkdlbmVyYXRlAgQAjYai1g3pQpgCQGxldCBzZWxlY3RlZEJvdCA9IGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QudGFncy5saW5lVG87Cgp0YWdzLmxhYmVsID0gInNoZWV0UG9ydGFsPSIgKyBzZWxlY3RlZEJvdC5zdWJzdHJpbmcoMCwgNCk7Cgp0YWdzLm9uS2V5RG93biA9IGBAIGlmKHRoYXQua2V5cyA9PSAiU2hpZnQiKXttYXNrcy5sYWJlbCA9IHRhZ3MubGFiZWwgKyAiIGluIG5ldyB0YWIiO31gOwp0YWdzLm9uS2V5VXAgPSBgQCBpZih0aGF0LmtleXMgPT0gIlNoaWZ0Iil7bWFza3MubGFiZWwgPSBudWxsO31gOycAjYai1g3qORphYk11bHRpcGxlQm90TWVudVNvcnRPcmRlcgIEAI2GotYNgkUBMCcAjYai1g3qOQRtZW51AgQAjYai1g2ERSjwn5SXYjMwYzZjNWQtYTRmNy00MjY2LWJhMzgtMzkzZGM5NWUxZWNiJwCNhqLWDeo5CWFiVmVyc2lvbgIEAI2GotYNq0UFMTAuMTYnAI2GotYN6jkLYWJCbHVlcHJpbnQCBACNhqLWDbFF+wNAY29uc3QgYmFja2dyb3VuZENvbG9yID0gbGlua3MucmVtZW1iZXI/LnRhZ3MuYWJCbHVlcHJpbnRDb2xvciA/PyAiIzE3ODVCNSI7CgppZiAoYmFja2dyb3VuZENvbG9yID09IGdyaWRQb3J0YWxCb3QubWFza3MucG9ydGFsQ29sb3IpCnsKICAgIHJldHVybjsKfQoKZ3JpZFBvcnRhbEJvdC5tYXNrcy5wb3J0YWxDb2xvciA9IGJhY2tncm91bmRDb2xvcjsKCm1hc2tzLm9uUG9ydGFsQ2hhbmdlZCA9IGBAIGlmICh0aGF0LnBvcnRhbCA9PSAiZ3JpZFBvcnRhbCIgJiYgdGhhdC5kaW1lbnNpb24gIT0gImJsdWVwcmludCIpewogICAgLy8gbGlua3MucmVtZW1iZXIubWFza3MuYWJCYXNlQ29sb3IgPSBudWxsOwogICAgLy8gbGlua3MucmVtZW1iZXIubWFza3MuYWJCYXNlU3Ryb2tlQ29sb3IgPSBudWxsOwoKICAgIGdyaWRQb3J0YWxCb3QubWFza3MucG9ydGFsQ29sb3IgPSBudWxsOwoKICAgIG1hc2tzLm9uUG9ydGFsQ2hhbmdlZCA9IG51bGw7Cn1gOwoKc2hvdXQoImFiTWVudVJlZnJlc2giKTsnAI2GotYN6jkLb25BbnlDcmVhdGUCBACNhqLWDa1JdkBpZiAodGhhdC5ib3QudGFncy5ibHVlcHJpbnQpCnsKICAgIHRoYXQuYm90LnRhZ3Muc3Ryb2tlQ29sb3IgPSAiI2ZmZmZmZiI7CiAgICB0aGF0LmJvdC50YWdzLmxhYmVsQ29sb3IgPSAiI2ZmZmZmZiI7Cn0nAI2GotYN6jkPb25Qb3J0YWxDaGFuZ2VkAgQAjYai1g2kSmFAaWYgKHRoYXQucG9ydGFsID09ICJncmlkUG9ydGFsIiAmJiB0aGF0LmRpbWVuc2lvbiA9PSAiYmx1ZXByaW50IikKewogICAgdGhpc0JvdC5hYkJsdWVwcmludCgpOwp9JwCNhqLWDeo5C3BlcnNvbmFsaXR5AgQAjYai1g2GSyjwn5SXYjc2ZGZiYzQtODU0Yi00ZjZkLWE5MWYtYTk0ODY5NDc3NGRiJwCNhqLWDeo5EmFiQ29yZU1lbnVJdGVtVHlwZQIEAI2GotYNrUsIZHJvcGRvd24nAI2GotYN6jkRZHJvcGRvd25Tb3J0T3JkZXICBACNhqLWDbZLATEnAI2GotYN6jkPZHJvcGRvd25PcHRpb25zAgQAjYai1g24Swbwn6esW10nAI2GotYN6jkYYWJDb3JlTWVudU9uQmVmb3JlQ3JlYXRlAgQAjYai1g29S+IeQGNvbnN0IGRyb3Bkb3duT3B0aW9ucyA9IFtdOw0KDQpjb25zdCBjdXJyZW50RGltID0gbGlua3MucmVtZW1iZXIudGFncy5hYkFjdGl2ZURpbWVuc2lvbjsNCmNvbnN0IGN1cnJlbnRQb3J0YWwgPSBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPyAibWFwIiA6IGNvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWwgPT0gImJsdWVwcmludCIgPyAiYmx1ZXByaW50IiA6ImdyaWQiOw0KY29uc3QgYWN0aXZlTWVudSA9IGNvbmZpZ0JvdC50YWdzLm1lbnVQb3J0YWw7DQpjb25zdCBwZXJtYWxpbmtVUkwgPSBjb25maWdCb3QudGFncy5wZXJtYWxpbms7DQpjb25zdCBhY3RpdmVJbnN0ID0gb3MuZ2V0Q3VycmVudEluc3QoKTsNCmNvbnN0IGFjdGl2ZUJpb3MgPSBjb25maWdCb3QudGFncy5vd25lciA/ICImb3duZXI9IiArIGNvbmZpZ0JvdC50YWdzLm93bmVyIDogZmFsc2U7DQpjb25zdCBmaXJzdEluZGV4ID0gcGVybWFsaW5rVVJMLmluZGV4T2YoIiYiKTsNCmNvbnN0IGluaXRpYWxVUkwgPSBwZXJtYWxpbmtVUkwuc3Vic3RyaW5nKDAsIGZpcnN0SW5kZXgpOw0KY29uc3QgdXBkYXRlZFVSTCA9IGFjdGl2ZUJpb3MgIT0gZmFsc2UgPyBpbml0aWFsVVJMICsgIiZpbnN0PSIgKyBhY3RpdmVJbnN0IDogaW5pdGlhbFVSTDsNCg0Kc2V0VGFnTWFzayh0aGlzQm90LCAiYWJDb3JlTWVudUxhYmVsIixgbW9kZTogJHtjdXJyZW50UG9ydGFsfSBwb3J0YWxgKTsNCnNldFRhZ01hc2sodGhpc0JvdCwgImN1cnJlbnREaW1lbnNpb24iLCBjdXJyZW50RGltKTsNCnNldFRhZ01hc2sodGhpc0JvdCwgImN1cnJlbnRQb3J0YWwiLCBjdXJyZW50UG9ydGFsKTsNCnNldFRhZ01hc2sodGhpc0JvdCwgImRyb3Bkb3duU29ydE9yZGVyIiwgMSk7DQoNCmNvbnN0IG1lbnVPcHRpb25zID0ge307DQoNCm1lbnVPcHRpb25zLmRpbWVuc2lvbiA9IGFjdGl2ZU1lbnU7DQptZW51T3B0aW9uc1thY3RpdmVNZW51XSA9IHRydWU7DQptZW51T3B0aW9ucy5hYlBvcnRhbE1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOw0KbWVudU9wdGlvbnMuYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsNCm1lbnVPcHRpb25zLm9uS2V5RG93biA9IGBAIGlmKHRoYXQua2V5cyA9PSAiU2hpZnQiKXttYXNrcy5sYWJlbCA9IHRhZ3MubGFiZWwgKyAiIGluIG5ldyB0YWIiO31gOw0KbWVudU9wdGlvbnMub25LZXlVcCA9IGBAIGlmKHRoYXQua2V5cyA9PSAiU2hpZnQiKXttYXNrcy5sYWJlbCA9IG51bGw7fWA7DQptZW51T3B0aW9ucy5za2lsbEJvdCA9IGdldExpbmsodGhpc0JvdCk7DQptZW51T3B0aW9ucy50YXJnZXRVUkwgPSB1cGRhdGVkVVJMOw0KDQpjb25zdCBtYXBNZW51Qm90ID0gew0KICAgIC4uLm1lbnVPcHRpb25zDQp9Ow0KDQptYXBNZW51Qm90LmxhYmVsID0gIm1hcCBwb3J0YWwiOw0KbWFwTWVudUJvdC5mb3JtQWRkcmVzcyA9ICJwdWJsaWMiOw0KbWFwTWVudUJvdC5vbkNsaWNrID0gYEAgDQpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7DQoNCmlmKHN0YXRlKQ0Kew0KICAgIG9zLm9wZW5VUkwodGFncy50YXJnZXRVUkwgKyAiJm1hcFBvcnRhbD0ke2N1cnJlbnREaW0gPT0gImJsdWVwcmludCIgPyAiaG9tZSIgOiBjdXJyZW50RGltfSIpOw0KfQ0KZWxzZQ0Kew0KICAgIGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCA9ICIke2N1cnJlbnREaW0gPT0gImJsdWVwcmludCIgPyAiaG9tZSIgOiBjdXJyZW50RGltfSI7DQogICAgY29uZmlnQm90LnRhZ3MubWluaU1hcFBvcnRhbCA9IG51bGw7DQp9YDsNCg0KaWYgKGN1cnJlbnRQb3J0YWwgIT0gIm1hcCIpDQp7DQogICAgLy9tYXAgcG9ydGFsIGJ1dHRvbg0KICAgIGRyb3Bkb3duT3B0aW9ucy5wdXNoKG1hcE1lbnVCb3QpOw0KfQ0KDQpjb25zdCBncmlkTWVudUJvdCA9IHsNCiAgICAuLi5tZW51T3B0aW9ucw0KfTsNCmdyaWRNZW51Qm90LmxhYmVsID0gImdyaWQgcG9ydGFsIjsNCmdyaWRNZW51Qm90LmZvcm1BZGRyZXNzID0gImN1YmUiOw0KZ3JpZE1lbnVCb3Qub25DbGljayA9IGBADQoNCmNvbnN0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsNCg0KaWYoc3RhdGUpDQp7DQogICAgb3Mub3BlblVSTCh0YWdzLnRhcmdldFVSTCArICImZ3JpZFBvcnRhbD0ke2N1cnJlbnREaW0gPT0gImJsdWVwcmludCIgPyAiaG9tZSIgOiBjdXJyZW50RGltfSIpOw0KfSANCmVsc2UNCnsNCiAgICBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsID0gIiR7Y3VycmVudERpbSA9PSAiYmx1ZXByaW50IiA/ICJob21lIiA6IGN1cnJlbnREaW19IjsgY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsID0gbnVsbDsNCn1gOw0KDQppZiAoY3VycmVudFBvcnRhbCAhPSAiZ3JpZCIgfHwgY3VycmVudERpbSA9PSAiYmx1ZXByaW50IikNCnsNCiAgICAvL2dyaWQgcG9ydGFsIGJ1dHRvbg0KICAgIGRyb3Bkb3duT3B0aW9ucy5wdXNoKGdyaWRNZW51Qm90KTsNCn0NCg0KY29uc3QgYmx1ZXByaW50TWVudUJvdCA9IHsNCiAgICAuLi5tZW51T3B0aW9ucw0KfTsNCg0KYmx1ZXByaW50TWVudUJvdC5sYWJlbCA9ICJibHVlcHJpbnQgcG9ydGFsIjsNCmJsdWVwcmludE1lbnVCb3QuZm9ybUFkZHJlc3MgPSAiYXJjaGl0ZWN0dXJlIjsNCmJsdWVwcmludE1lbnVCb3Qub25DbGljayA9IGBADQoNCmNvbnN0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsNCg0KaWYoc3RhdGUpDQp7DQogICAgb3Mub3BlblVSTCh0YWdzLnRhcmdldFVSTCArICImZ3JpZFBvcnRhbD1ibHVlcHJpbnQiKTsNCn0gDQplbHNlDQp7DQogICAgY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCA9ICJibHVlcHJpbnQiOyBjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPSBudWxsOw0KfQ0KDQpsaW5rcy5za2lsbEJvdC5hYkJsdWVwcmludCgpO2A7DQoNCmlmIChjdXJyZW50RGltICE9ICJibHVlcHJpbnQiKQ0Kew0KICAgIC8vYmx1ZXByaW50IHBvcnRhbCBidXR0b24NCiAgICBkcm9wZG93bk9wdGlvbnMucHVzaChibHVlcHJpbnRNZW51Qm90KTsNCn0NCg0KDQpjb25zdCBzaGVldE1lbnVCb3QgPSB7DQogICAgLi4ubWVudU9wdGlvbnMNCn07DQpzaGVldE1lbnVCb3QubGFiZWwgPSAic2hlZXQgcG9ydGFsIjsNCnNoZWV0TWVudUJvdC5mb3JtQWRkcmVzcyA9ICJ0YWJsZV92aWV3IjsNCnNoZWV0TWVudUJvdC5vbkNsaWNrID0gYEAgDQoNCmNvbnN0IHN0YXRlID0gb3MuZ2V0SW5wdXRTdGF0ZSgia2V5Ym9hcmQiLCAiU2hpZnQiKTsNCg0KaWYoc3RhdGUpDQp7DQogICAgb3Mub3BlblVSTCh0YWdzLnRhcmdldFVSTCArICImc2hlZXRQb3J0YWw9JHtjdXJyZW50RGltfSIpOw0KfSANCmVsc2UNCnsgDQogICAgY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwgPSAiJHtjdXJyZW50RGltfSI7DQp9YDsNCg0KLy9zaGVldCBwb3J0YWwgYnV0dG9uDQpkcm9wZG93bk9wdGlvbnMucHVzaChzaGVldE1lbnVCb3QpOw0KDQoNCmNvbnN0IHN5c3RlbU1lbnVCb3QgPSB7DQogICAgLi4ubWVudU9wdGlvbnMNCn07DQoNCnN5c3RlbU1lbnVCb3QubGFiZWwgPSAic3lzdGVtIHBvcnRhbCI7DQpzeXN0ZW1NZW51Qm90LmZvcm1BZGRyZXNzID0gInNldHRpbmdzX2FwcGxpY2F0aW9ucyI7DQpzeXN0ZW1NZW51Qm90Lm9uQ2xpY2sgPSBgQA0KDQpjb25zdCBzdGF0ZSA9IG9zLmdldElucHV0U3RhdGUoImtleWJvYXJkIiwgIlNoaWZ0Iik7DQoNCmlmKHN0YXRlKQ0Kew0KICAgIG9zLm9wZW5VUkwodGFncy50YXJnZXRVUkwgKyAiJnN5c3RlbVBvcnRhbD10cnVlIik7DQp9IA0KZWxzZQ0KeyANCiAgICBjb25maWdCb3QudGFncy5zeXN0ZW1Qb3J0YWwgPSB0cnVlOw0KfWA7DQoNCi8vc3lzdGVtIHBvcnRhbCBidXR0b24NCmRyb3Bkb3duT3B0aW9ucy5wdXNoKHN5c3RlbU1lbnVCb3QpOw0KDQptYXNrcy5kcm9wZG93bk9wdGlvbnMgPSBkcm9wZG93bk9wdGlvbnM7DQoNCnJldHVybjsnAQRib3RzJGVjODVjMWQ2LTlmMWEtNDBkNC04MmUxLTViZDY4MDM0OWMyNwEnAI2GotYNoGoGc3lzdGVtAgQAjYai1g2hag1hYi5hY3Rpb24uYXNrJwCNhqLWDaBqBGZvcm0CBACNhqLWDa9qB25vdGhpbmcnAI2GotYNoGoGYXNrR1BUAgQAjYai1g23au8KQGlmICghdGFncy5ncHRBY3RpdmUgfHwgYXV0aEJvdC50YWdzLnByaXZhY3lGZWF0dXJlcy5hbGxvd0FJID09IGZhbHNlKSB7CiAgICBjb25zdCBhaU1lc3NhZ2UgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFpX3JlamVjdGlvbl9tZXNzYWdlID8/ICJBSSBub3QgYXV0aG9yaXplZCBmb3IgdGhpcyBhY2NvdW50IjsKICAgIGxpbmtzLnV0aWxzLmFiTG9nQW5kVG9hc3QoeyBtZXNzYWdlOiBhaU1lc3NhZ2UgfSk7CiAgICBvcy5vcGVuUVJDb2RlU2Nhbm5lcigpOwogICAgY29uZmlnQm90LnRhZ3MuYWJTY2FuID0gdHJ1ZTsKICAgIHJldHVybjsKfQoKaWYgKHRhZ3MuZGVidWcpIHsKICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gdGhhdDpgLCB0aGF0KTsKfQoKbGV0IGlucXVpcnkgPSB0aGF0LmlucXVpcnkgPz8gdGhhdDsKCmNvbnN0IHByb21wdCA9ICF0aGF0LnByb21wdCA/IHRhZ3MucHJvbXB0X2NvcmUgOiB0YWdzWyJwcm9tcHRfIiArIHRoYXQucHJvbXB0XTsKCmxpbmtzLnV0aWxzLmFiTG9nKHsgbWVzc2FnZTogYHRoaW5raW5nIGFib3V0OiAiJHtpbnF1aXJ5fSJgIH0pOwpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQm90Q2hhdCh7IG1lc3NhZ2U6IGB0aGlua2luZyBhYm91dDogIiR7aW5xdWlyeX0iYCB9KTsKCmlmICh0aGF0LnByb21wdCA9PSAiZ3JpZCIpIHsKICAgIGlucXVpcnkgPSBpbnF1aXJ5ICsgYCBQT1NJVElPTjogeyR7dGhhdC5kYXRhLmRpbWVuc2lvbn06IHRydWUsICR7dGhhdC5kYXRhLmRpbWVuc2lvbn1YOiAke3RoYXQuZGF0YS5kaW1lbnNpb25YfSwgJHt0aGF0LmRhdGEuZGltZW5zaW9ufVk6JHt0aGF0LmRhdGEuZGltZW5zaW9uWX19LmAKfQplbHNlIGlmICh0aGF0LnByb21wdCA9PSAiYm90IikgewogICAgaW5xdWlyeSA9IGlucXVpcnkgKyBgIFRBUkdFVF9CT1RfSUQ6IGAgKyB0aGF0LmRhdGEuYm90LmlkOwp9CmVsc2UgaWYgKHRoYXQucHJvbXB0ID09ICJtdWx0aXBsZUJvdCIpIHsKICAgIGlucXVpcnkgPSBpbnF1aXJ5ICsgYCBUQVJHRVRfQk9UX0lEUzogYCArIHRoYXQuZGF0YS5ib3RzOwp9CmVsc2UgaWYgKHRoYXQucHJvbXB0ID09ICJjb3JlIikgewogICAgLy8gRG8gbm90aGluZyBleHRyYS4KfQoKY29uc3QgYW5zd2VyID0gYXdhaXQgdGhpc0JvdC5zdWJtaXRSZXF1ZXN0R1BUKHsgaW5xdWlyeTogaW5xdWlyeSwgcHJvbXB0OiBwcm9tcHQsIG1vZGVsOiB0aGF0Lm1vZGVsIH0pOwoKaWYgKGFuc3dlcikgewogICAgbGlua3MudXRpbHMuYWJMb2coeyBtZXNzYWdlOiBgW2dlbmVyYXRlZCBjb2RlXTpcbiR7YW5zd2VyfWAgfSk7CgogICAgY3JlYXRlKHsgaG9tZTogdHJ1ZSwgb25DcmVhdGU6IGBAICR7YW5zd2VyfWAgfSk7CgogICAgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7Cn0nAI2GotYNoGoJZ3B0QWN0aXZlAgQAjYai1g2ndQVmYWxzZScAjYai1g2gahBzdWJtaXRSZXF1ZXN0R1BUAgQAjYai1g2tdZUNQGltcG9ydCB7IEFJQ2hhdE9wdGlvbnMgfSBmcm9tICdjYXN1YWxvcyc7CgppZiAodGFncy5kZWJ1ZykgewogICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSB0aGF0YCwgdGhhdCk7Cn0KCmxldCBzeXN0ZW1Qcm9tcHQgPSB0aGF0LnByb21wdCA/IHRoYXQucHJvbXB0IDogdGFncy5wcm9tcHRfY29yZTsKCnN5c3RlbVByb21wdCA9IHN5c3RlbVByb21wdCArIHRoYXQuaW5xdWlyeTsKCmlmIChhdXRoQm90LnRhZ3MucHJpdmFjeUZlYXR1cmVzLmFsbG93QUkgPT0gZmFsc2UpCnsKICAgIGxpbmtzLnV0aWxzLmFiTG9nQW5kVG9hc3QoeyBtZXNzYWdlOiAiQUkgbm90IGF1dGhvcml6ZWQgb24gdGhpcyBhY2NvdW50IiwgbG9nVHlwZTogJ2xvZycgfSk7CiAgICByZXR1cm4gbnVsbDsKfQoKbGV0IGN1cnJlbnRFeHBlcmllbmNlQm90cyA9IGdldEJvdHMoYiA9PiBiLnNwYWNlID09PSAnc2hhcmVkJyAmJiAhYi50YWdzLmFiSWdub3JlKTsKCmlmIChjdXJyZW50RXhwZXJpZW5jZUJvdHMubGVuZ3RoID4gMCkKewogICAgc3lzdGVtUHJvbXB0ID0gc3lzdGVtUHJvbXB0ICsgIiBUaGVzZSBhcmUgdGhlIGJvdHMgdGhhdCBjdXJyZW50bHkgZXhpc3QgaW4gdGhlIGV4cGVyaWVuY2U6ICIgKyBjdXJyZW50RXhwZXJpZW5jZUJvdHM7Cn0KCmlmICghbGlua3MubWVudSkgewogICAgYXdhaXQgbGlua3MubGVhcm4uYWJBZGFwdCgnYWJJbnRlcmZhY2UnKTsKfQoKY29uc3QgYnVzeUluZGljYXRvciA9IGF3YWl0IGxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnVzeUluZGljYXRvcih7IGFiTWVudTogdHJ1ZSwgbGFiZWw6IGBhc2tpbmcgJHtsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5fWAgfSk7Cgpjb25zdCBhaUNoYXRPcHRpb25zOiBBSUNoYXRPcHRpb25zID0gewogICAgcHJlZmVycmVkTW9kZWw6IHRoYXQubW9kZWwgPz8gbGlua3MucGVyc29uYWxpdHkudGFncy5hYlByZWZlcnJlZEFJTW9kZWwsCiAgICB0ZW1wZXJhdHVyZTogMCwKICAgIHRvcFA6IDEsCiAgICBwcmVzZW5jZVBlbmFsdHk6IDAuNiwKICAgIGZyZXF1ZW5jeVBlbmFsdHk6IDAsCn0KCmlmICh0YWdzLmRlYnVnKSB7CiAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIHNlbmRpbmcgdG8gYWk6YCwgeyBzeXN0ZW1Qcm9tcHQsIGFpQ2hhdE9wdGlvbnMgfSk7Cn0KCmxldCBhaVJlc3BvbnNlOiBzdHJpbmc7Cgp0cnkgewogICAgYWlSZXNwb25zZSA9IGF3YWl0IGFpLmNoYXQoc3lzdGVtUHJvbXB0LCBhaUNoYXRPcHRpb25zKTsKCiAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gYWkgcmVzcG9uc2U6YCwgYWlSZXNwb25zZSk7CiAgICB9Cn0gY2F0Y2goZSkgewogICAgYWlSZXNwb25zZSA9IG51bGw7CgogICAgLy8gU2hvdyB0b2FzdCB3aXRoIGVycm9yLgogICAgbGlua3MudXRpbHMuYWJMb2dBbmRUb2FzdCh7IG1lc3NhZ2U6IGBBSSByZXF1ZXN0IGZhaWxlZCAtICR7bGlua3MudXRpbHMuZ2V0RXJyb3JNZXNzYWdlKGUpfWAsIGxvZ1R5cGU6ICdlcnJvcicgfSk7CgogICAgLy8gUmV0aHJvdyBzbyBjYWxsZXJzIGNhbiBjYXRjaC4KICAgIHRocm93IGU7Cn0gZmluYWxseSB7CiAgICBkZXN0cm95KGJ1c3lJbmRpY2F0b3IpOwp9CgpyZXR1cm4gYWlSZXNwb25zZTsnAI2GotYNoGoIcmVtZW1iZXICBACNhqLWDcOCASjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwCNhqLWDaBqEGFiQ29yZU1lbnVBY3Rpb24CBACNhqLWDeqCAYIcQGNvbnN0IGlucXVpcnkgPSB0aGF0Py5tZXNzYWdlID8/IHRoYXQ7CmNvbnN0IGluaXRpYWxCb290ID0gdGhhdD8uaW5pdGlhbEJvb3QgPz8gZmFsc2U7CmNvbnN0IGF1dG9IYXRjaCA9IHRoYXQ/LmF1dG9IYXRjaCA/PyBmYWxzZTsKY29uc3QgbWVudSA9IHRoYXQ/Lm1lbnUgPz8gImNvcmUiOwpjb25zdCBpbnF1aXJ5SGFzU3BhY2UgPSBpbnF1aXJ5LmluZGV4T2YoIiAiKSAhPT0gLTE7CmNvbnN0IG1lbnVCb3RzID0gZ2V0Qm90cyhjb25maWdCb3QudGFncy5tZW51UG9ydGFsLCB0cnVlKTsKY29uc3QgaXNDaGFubmVsID0gdGhhdC5pc0NoYW5uZWwgPz8gZmFsc2U7CmNvbnN0IGlzVVVBQiA9IHRoYXQuaXNVVUFCID8/IGZhbHNlOwoKd2hpc3BlcihtZW51Qm90cywgImFiTWVudVJlZnJlc2giKTsKCmxldCB1c2VybmFtZSA9ICJ1c2VyIjsKaWYgKGF1dGhCb3QgJiYgYXV0aEJvdC50YWdzLm5hbWUpIHsKICAgIHVzZXJuYW1lID0gYXV0aEJvdC50YWdzLm5hbWU7Cn0gZWxzZSBpZiAoYWIubGlua3MuY29uc29sZS5tYXNrcy5wcmVmZXJyZWROYW1lKSB7CiAgICB1c2VybmFtZSA9IGFiLmxpbmtzLmNvbnNvbGUubWFza3MucHJlZmVycmVkTmFtZTsKfQoKYWIubG9nKHsgbWVzc2FnZTogaW5xdWlyeSwgbmFtZTogdXNlcm5hbWUgfSk7CgppZiAoIWNvbmZpZ0JvdC50YWdzLnRhZ1BvcnRhbCAmJiBsaW5rcy5tYW5pZmVzdGF0aW9uLnRhZ3MuYWJBd2FrZSAmJiBpbnF1aXJ5ICE9ICIubG9nIikgewogICAgc2hvdXQoInNob3dDb25zb2xlIik7Cn0KCmlmIChpc1VVQUIpIHsKICAgIGxpbmtzLnV1YWJMb2FkZXI/LmxvYWRVVUFCKGlucXVpcnkpOwp9CmVsc2UgaWYgKGlzQ2hhbm5lbCkgewogICAgbGlua3MuY2hhbm5lbExvYWRlcj8ubG9hZENoYW5uZWwoaW5xdWlyeSk7Cn0KZWxzZSBpZiAoIWlucXVpcnlIYXNTcGFjZSkgewogICAgY29uc3QgaXNEaXJlY3RTZWFyY2ggPSBpbnF1aXJ5LnN0YXJ0c1dpdGgoYCJgKSAmJiBpbnF1aXJ5LmVuZHNXaXRoKGAiYCk7CgogICAgY29uc3QgYXNrOiBBQkxvb2t1cEFza0lEUmVzdWx0IHwgZmFsc2UgPSAhaXNEaXJlY3RTZWFyY2ggPyBhd2FpdCBsaW5rcy5zZWFyY2gub25Mb29rdXBBc2tJRCh7IGFza0lEOiBpbnF1aXJ5LCBhdXRvSGF0Y2g6IHRydWUsIHNvdXJjZUV2ZW50OiAnYXNrJyB9KSA6IGZhbHNlOwoKICAgIGlmIChhc2s/LnN1Y2Nlc3MgJiYgYXNrPy5kYXRhPy51cmwgIT0gdW5kZWZpbmVkICYmICFpc0RpcmVjdFNlYXJjaCAmJiAhaXNDaGFubmVsKSB7CiAgICAgICAgbGlua3MubGVhcm4uYWJKb2luSG9zdCh7IGRhdGE6IGFzay5kYXRhIH0pOwogICAgfSBlbHNlIGlmICghYXNrPy5zdWNjZXNzKSB7CiAgICAgICAgbGV0IGVnZzogQUJMb29rdXBFZ2dSZXN1bHQ7CiAgICAgICAgY29uc3QgcGVyaW9kSW5kZXggPSBpbnF1aXJ5LmluZGV4T2YoIi4iKTsKICAgICAgICBsZXQgYWJJRCA9IGlucXVpcnk7CgogICAgICAgIGlmIChpc0RpcmVjdFNlYXJjaCkgewogICAgICAgICAgICBhYklEID0gaW5xdWlyeS5zdWJzdHJpbmcoMSwgaW5xdWlyeS5sZW5ndGggLSAxKTsKICAgICAgICB9CgogICAgICAgIGlmIChwZXJpb2RJbmRleCA9PSAtMSB8fCBpc0RpcmVjdFNlYXJjaCkgewogICAgICAgICAgICBlZ2cgPSBhd2FpdCBsaW5rcy5zZWFyY2gub25Mb29rdXBBQkVnZ3MoeyBhYklEOiBhYklELCBpbml0aWFsQm9vdCwgYXV0b0hhdGNoLCBzb3VyY2VFdmVudDogJ2FzaycgfSk7CiAgICAgICAgfSBlbHNlIGlmIChwZXJpb2RJbmRleCA+IDApIHsKICAgICAgICAgICAgY29uc3QgcmVjb3JkS2V5ID0gaW5xdWlyeS5zdWJzdHJpbmcoMCwgcGVyaW9kSW5kZXgpOwoKICAgICAgICAgICAgYWJJRCA9IGlucXVpcnkuc3Vic3RyaW5nKHBlcmlvZEluZGV4ICsgMSk7CgogICAgICAgICAgICBlZ2cgPSBhd2FpdCBsaW5rcy5zZWFyY2gub25Mb29rdXBBQkVnZ3MoeyByZWNvcmRLZXk6IHJlY29yZEtleSwgYWJJRDogYWJJRCwgaW5pdGlhbEJvb3QsIGF1dG9IYXRjaCwgc291cmNlRXZlbnQ6ICdhc2snLCB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBsaW5rcy5pbnB1dC5vbkNoYXQoeyBtZXNzYWdlOiBpbnF1aXJ5IH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFlZ2c/LnN1Y2Nlc3MgJiYgbGlua3MubWVudSkgewogICAgICAgICAgICBjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJhYk1lbnUiOwoKICAgICAgICAgICAgY29uc3Qgc3R1ZGlvQnV0dG9uID0ge307CgogICAgICAgICAgICBzdHVkaW9CdXR0b24uYWJNZW51ID0gdHJ1ZTsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLmxhYmVsID0gYWJJRCArICIgbm90IGZvdW5kIGluIGFjdGl2ZSBzdHVkaW8sIGVudGVyIGFsdGVybmF0ZSBzdHVkaW9JRCI7CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5mb3JtID0gImlucHV0IjsKICAgICAgICAgICAgc3R1ZGlvQnV0dG9uLmFiSUQgPSBhYklEOwogICAgICAgICAgICBzdHVkaW9CdXR0b24uZm9ybUFkZHJlc3MgPSB0YWdzLmFiQ29yZU1lbnVJY29uOwogICAgICAgICAgICBzdHVkaW9CdXR0b24ubWFuYWdlciA9IGdldExpbmsodGhpc0JvdCk7CiAgICAgICAgICAgIHN0dWRpb0J1dHRvbi5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwogICAgICAgICAgICBzdHVkaW9CdXR0b24ub25TdWJtaXQgPSBgQCBsaW5rcy5tYW5hZ2VyLmFiQ29yZU1lbnVBY3Rpb24odGhhdC50ZXh0ICsgIi4iICsgdGFncy5hYklEKTtgOwoKICAgICAgICAgICAgY29uc3QgY3JlYXRlQnV0dG9uID0ge307CgogICAgICAgICAgICBjcmVhdGVCdXR0b24uYWJNZW51ID0gdHJ1ZTsKICAgICAgICAgICAgY3JlYXRlQnV0dG9uLmxhYmVsID0gImdpdmUgbWUgYSBwcm90b3R5cGUiOwogICAgICAgICAgICBjcmVhdGVCdXR0b24ubWFuYWdlciA9IGdldExpbmsodGhpc0JvdCk7CiAgICAgICAgICAgIGNyZWF0ZUJ1dHRvbi5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwogICAgICAgICAgICBjcmVhdGVCdXR0b24uYWJJRCA9IGFiSUQ7CiAgICAgICAgICAgIGNyZWF0ZUJ1dHRvbi5vbkNsaWNrID0gYEAgbGlua3MubWFuYWdlci5wcm90b3R5cGUodGFncy5hYklEKTtgOwoKICAgICAgICAgICAgbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24oY3JlYXRlQnV0dG9uKTsKICAgICAgICAgICAgbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24oc3R1ZGlvQnV0dG9uKTsKCiAgICAgICAgICAgIHRoaXNCb3QubWFza3Mub25HcmlkQ2xpY2sgPSAiQCBzaG91dCgnYWJNZW51UmVmcmVzaCcpOyI7CiAgICAgICAgfQogICAgfQp9IGVsc2UgewogICAgYXdhaXQgb3MucmVxdWVzdEF1dGhCb3QoKTsKCiAgICBpZiAoIWF1dGhCb3QpIHsKICAgICAgICBvcy50b2FzdCgicGxlYXNlIHNpZ24gaW4gdG8gYWNjZXNzIGFkdmFuY2VkIEFJIGZlYXR1cmVzIik7CgogICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljaygpOwogICAgfSBlbHNlIHsKICAgICAgICBtYXNrcy5ncHRBY3RpdmUgPSB0cnVlOwoKICAgICAgICBhd2FpdCB0aGlzQm90LmFza0dQVCh7IGlucXVpcnk6IGlucXVpcnksIHByb21wdDogbWVudSwgZGF0YTogdGhhdCB9KTsKICAgIH0KfScAjYai1g2gahRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAI2GotYN7Z4B8ghAdGFncy5vblN1Ym1pdCA9IGBACiAgICBsaW5rcy5iYXNlU2tpbGwuYWJDb3JlTWVudUFjdGlvbih7bWVzc2FnZTogdGhhdC50ZXh0LCBtZW51OiAiY29yZSJ9KTsKICAgIHNldFRhZ01hc2sobGlua3MuYmFzZVNraWxsLCAnaGFzVXNlclN1Ym1pdHRlZENvcmVUZXh0JywgdHJ1ZSwgJ2xvY2FsJyk7CmA7CnRhZ3Mub25JbnB1dFR5cGluZyA9IGBACiAgICBpZiAoIXRhZ3MuaGFzVXNlclR5cGVkQ29yZVRleHQpIHsKICAgICAgICBzZXRUYWdNYXNrKGxpbmtzLmJhc2VTa2lsbCwgJ2hhc1VzZXJUeXBlZENvcmVUZXh0JywgdHJ1ZSwgJ2xvY2FsJyk7CiAgICB9CmA7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0KCmlmICghbGlua3MuYmFzZVNraWxsLnRhZ3MuaGFzVXNlclR5cGVkQ29yZVRleHQgJiYgIWxpbmtzLmJhc2VTa2lsbC50YWdzLmhhc1VzZXJTdWJtaXR0ZWRDb3JlVGV4dCkgewogICAgYXdhaXQgb3Muc2xlZXAobGlua3MuYmFzZVNraWxsLnRhZ3MuaW5wdXRTdWdnZXN0aW9uV2FpdE1TKTsKCiAgICBpZiAoIWxpbmtzLmJhc2VTa2lsbC50YWdzLmhhc1VzZXJUeXBlZENvcmVUZXh0KSB7CiAgICAgICAgLy8gQ2hvb3NlIGEgcmFuZG9tIGZyb20gYnVpbHQtaW4gc3VnZ2VzdGlvbnMuCiAgICAgICAgbGV0IHRleHQgPSBsaW5rcy5iYXNlU2tpbGwudGFncy5zdWdnZXN0aW9uc0NvcmVbbWF0aC5yYW5kb21JbnQoMCwgbGlua3MuYmFzZVNraWxsLnRhZ3Muc3VnZ2VzdGlvbnNDb3JlLmxlbmd0aCAtIDEpXTsKCiAgICAgICAgbGlua3MuYmFzZVNraWxsLmlucHV0U3VnZ2VzdGlvbih7IGlucHV0Qm90OiB0aGlzQm90LCB0ZXh0IH0pOwogICAgfQp9JwCNhqLWDaBqE2FiQ29yZU1lbnVTb3J0T3JkZXICBACNhqLWDeCnAQMxMDInAI2GotYNoGoQYWJHcmlkTWVudUFjdGlvbgIEAI2GotYN5KcBDkAvL3BsYWNlaG9sZGVyJwCNhqLWDaBqFGFiR3JpZE1lbnVPbkdlbmVyYXRlAgQAjYai1g3zpwH/CkB0YWdzLmRpbWVuc2lvbiA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMuZGltZW5zaW9uOwp0YWdzLmRpbWVuc2lvblggPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZEZvY3VzLnBvc2l0aW9uLng7CnRhZ3MuZGltZW5zaW9uWSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMucG9zaXRpb24ueTsKdGFncy5vblN1Ym1pdCA9IGBACiAgICBsaW5rcy5iYXNlU2tpbGwuYWJDb3JlTWVudUFjdGlvbih7bWVzc2FnZTogdGhhdC50ZXh0LCBtZW51OiAiZ3JpZCIsIGRpbWVuc2lvbjogdGFncy5kaW1lbnNpb24sIGRpbWVuc2lvblg6IHRhZ3MuZGltZW5zaW9uWCwgZGltZW5zaW9uWTogdGFncy5kaW1lbnNpb25ZfSk7CiAgICBzZXRUYWdNYXNrKGxpbmtzLmJhc2VTa2lsbCwgJ2hhc1VzZXJTdWJtaXR0ZWRDb3JlVGV4dCcsIHRydWUsICdsb2NhbCcpOwpgOwp0YWdzLm9uSW5wdXRUeXBpbmcgPSBgQAogICAgaWYgKCF0YWdzLmhhc1VzZXJUeXBlZENvcmVUZXh0KSB7CiAgICAgICAgc2V0VGFnTWFzayhsaW5rcy5iYXNlU2tpbGwsICdoYXNVc2VyVHlwZWRDb3JlVGV4dCcsIHRydWUsICdsb2NhbCcpOwogICAgfQpgOwp0YWdzLmZvcm0gPSAiaW5wdXQiOwoKaWYgKCFhdXRoQm90KQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlIGlmIChhdXRoQm90LnRhZ3Muc3Vic2NyaXB0aW9uVGllciA9PSAiRnJlZVBsYXkiKQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5Owp9CgppZiAoIWxpbmtzLmJhc2VTa2lsbC50YWdzLmhhc1VzZXJUeXBlZENvcmVUZXh0ICYmICFsaW5rcy5iYXNlU2tpbGwudGFncy5oYXNVc2VyU3VibWl0dGVkQ29yZVRleHQpIHsKICAgIGF3YWl0IG9zLnNsZWVwKGxpbmtzLmJhc2VTa2lsbC50YWdzLmlucHV0U3VnZ2VzdGlvbldhaXRNUyk7CgogICAgaWYgKCFsaW5rcy5iYXNlU2tpbGwudGFncy5oYXNVc2VyVHlwZWRDb3JlVGV4dCkgewogICAgICAgIC8vIENob29zZSBhIHJhbmRvbSBmcm9tIGJ1aWx0LWluIHN1Z2dlc3Rpb25zLgogICAgICAgIGxldCB0ZXh0ID0gbGlua3MuYmFzZVNraWxsLnRhZ3Muc3VnZ2VzdGlvbnNDb3JlW21hdGgucmFuZG9tSW50KDAsIGxpbmtzLmJhc2VTa2lsbC50YWdzLnN1Z2dlc3Rpb25zQ29yZS5sZW5ndGggLSAxKV07CgogICAgICAgIGxpbmtzLmJhc2VTa2lsbC5pbnB1dFN1Z2dlc3Rpb24oeyBpbnB1dEJvdDogdGhpc0JvdCwgdGV4dCB9KTsKICAgIH0KfScAjYai1g2gag1tYW5pZmVzdGF0aW9uAgQAjYai1g3zsgEo8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcAjYai1g2gahNhYkdyaWRNZW51U29ydE9yZGVyAgQAjYai1g2aswEDMTAyJwCNhqLWDaBqD2FiR3JpZE1lbnVMYWJlbAIEAI2GotYNnrMBBmFzayBhYicAjYai1g2gag9hYkNvcmVNZW51TGFiZWwCBACNhqLWDaWzAQZhc2sgYWInAI2GotYNoGoOYWJDb3JlTWVudUljb24CBACNhqLWDayzAQRjdWJlJwCNhqLWDaBqDmFiR3JpZE1lbnVJY29uAgQAjYai1g2xswEEY3ViZScAjYai1g2gagplZGl0UHJvbXB0AgQAjYai1g22swGHCEBzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWJNZW51IjsKCmxldCBwcm9tcHRNZW51QnV0dG9uID0ge307Cgpwcm9tcHRNZW51QnV0dG9uLmFiTWVudSA9IHRydWU7CnByb21wdE1lbnVCdXR0b24uYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKcHJvbXB0TWVudUJ1dHRvbi5tYW5pZmVzdGF0aW9uID0gdGFncy5tYW5pZmVzdGF0aW9uOwpwcm9tcHRNZW51QnV0dG9uLnJlbWVtYmVyID0gdGFncy5yZW1lbWJlcjsKcHJvbXB0TWVudUJ1dHRvbi5ncHRCb3QgPSAi8J+UlyIgKyB0aGlzQm90LmlkOwpwcm9tcHRNZW51QnV0dG9uLmxhYmVsID0gImxvYWQgcHJvbXB0IjsKcHJvbXB0TWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJjbG91ZF9kb3dubG9hZCI7CnByb21wdE1lbnVCdXR0b24ub25DbGljayA9ICJAIGxpbmtzLmdwdEJvdC51cGRhdGVQcm9tcHQoJ2xvYWQnKTsiOwoKbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24ocHJvbXB0TWVudUJ1dHRvbik7Cgpwcm9tcHRNZW51QnV0dG9uLmxhYmVsID0gInNhdmUgcHJvbXB0IjsKcHJvbXB0TWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJiYWNrdXAiOwpwcm9tcHRNZW51QnV0dG9uLm9uQ2xpY2sgPSAiQCBsaW5rcy5ncHRCb3QudXBkYXRlUHJvbXB0KCdzYXZlJyk7IjsKCmxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKHByb21wdE1lbnVCdXR0b24pOwoKbWFza3Mub25HcmlkQ2xpY2sgPSBgQCBjb25maWdCb3QubWFza3MudGFnUG9ydGFsID0gbnVsbDsKCnRhZ1BvcnRhbEJvdC5tYXNrcy50YWdQb3J0YWxBbmNob3JQb2ludCA9IG51bGw7CmA7Cgp0YWdQb3J0YWxCb3QubWFza3MudGFnUG9ydGFsQW5jaG9yUG9pbnQgPSAidG9wIjsKCmNvbmZpZ0JvdC5tYXNrcy50YWdQb3J0YWwgPSB0aGlzQm90LmlkICsgIi5wcm9tcHRfY29yZSI7CgppZiAoY29uZmlnQm90Lm1hc2tzLnRhZ1BvcnRhbFNwYWNlKQp7CiAgICBjb25maWdCb3QubWFza3MudGFnUG9ydGFsU3BhY2UgPSBudWxsOwp9JwCNhqLWDaBqBG1lbnUCBACNhqLWDby7ASjwn5SXYjMwYzZjNWQtYTRmNy00MjY2LWJhMzgtMzkzZGM5NWUxZWNiJwCNhqLWDaBqDHVwZGF0ZVByb21wdAIEAI2GotYN47sBywhAc2hvdXQoImFiTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTWVudSI7CgpsZXQgcHJvbXB0TWVudUJ1dHRvbiA9IHt9OwoKcHJvbXB0TWVudUJ1dHRvbi5hYk1lbnUgPSB0cnVlOwpwcm9tcHRNZW51QnV0dG9uLmZvcm0gPSAiaW5wdXQiOwpwcm9tcHRNZW51QnV0dG9uLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CnByb21wdE1lbnVCdXR0b24ubWFuaWZlc3RhdGlvbiA9IHRhZ3MubWFuaWZlc3RhdGlvbjsKcHJvbXB0TWVudUJ1dHRvbi5yZW1lbWJlciA9IHRhZ3MucmVtZW1iZXI7CnByb21wdE1lbnVCdXR0b24uZ3B0Qm90ID0gIvCflJciICsgdGhpc0JvdC5pZDsKCmlmICh0aGF0ID09ICJsb2FkIikKewogICAgcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICJsb2FkIHByb21wdCI7CiAgICBwcm9tcHRNZW51QnV0dG9uLmZvcm1BZGRyZXNzID0gImNsb3VkX2Rvd25sb2FkIjsKICAgIHByb21wdE1lbnVCdXR0b24ub25TdWJtaXQgPSAiQCBsaW5rcy5ncHRCb3QubG9hZFByb21wdCh0aGF0LnRleHQpOyI7Cn0KZWxzZQp7CiAgICBwcm9tcHRNZW51QnV0dG9uLmxhYmVsID0gInNhdmUgcHJvbXB0IjsKICAgIHByb21wdE1lbnVCdXR0b24uZm9ybUFkZHJlc3MgPSAiYmFja3VwIjsKICAgIHByb21wdE1lbnVCdXR0b24ub25TdWJtaXQgPSAiQCBsaW5rcy5ncHRCb3Quc2F2ZVByb21wdCh0aGF0LnRleHQpOyI7Cn0KCmxpbmtzLm1lbnUuYWJDcmVhdGVNZW51QnV0dG9uKHByb21wdE1lbnVCdXR0b24pOwoKcHJvbXB0TWVudUJ1dHRvbi5mb3JtID0gbnVsbDsKcHJvbXB0TWVudUJ1dHRvbi5sYWJlbCA9ICIgICI7CnByb21wdE1lbnVCdXR0b24ubGFiZWxBbGlnbm1lbnQgPSAiY2VudGVyIjsKcHJvbXB0TWVudUJ1dHRvbi5jb2xvciA9ICIjZjI0NzI3IjsKcHJvbXB0TWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9ICJjYW5jZWwiOwpwcm9tcHRNZW51QnV0dG9uLm9uU3VibWl0ID0gbnVsbDsKcHJvbXB0TWVudUJ1dHRvbi5vbkNsaWNrID0gIkAgbGlua3MuZ3B0Qm90LmVkaXRQcm9tcHQoKTsiOwoKbGlua3MubWVudS5hYkNyZWF0ZU1lbnVCdXR0b24ocHJvbXB0TWVudUJ1dHRvbik7JwCNhqLWDaBqCmxvYWRQcm9tcHQCBACNhqLWDa3EAdoDQGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90SW5CYWNrZ3JvdW5kKCk7CgppZiAoYXV0aEJvdC50YWdzLnByaXZhY3lGZWF0dXJlcy5hbGxvd1B1YmxpY0RhdGEgPT0gZmFsc2UpCnsKICAgIG9zLnRvYXN0KCJub3QgYXV0aG9yaXplZCIpOwoKICAgIHJldHVybjsKfQoKY29uc3QgcHJvbXB0TmFtZSA9ICJncHRfcHJvbXB0XyIgKyB0aGF0Owpjb25zdCBuZXdQcm9tcHQgPSBhd2FpdCBvcy5nZXREYXRhKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJSZWNvcmRLZXksIHByb21wdE5hbWUpOwoKaWYgKCFuZXdQcm9tcHQuc3VjY2VzcykKewogICAgb3MudG9hc3QoIm5vIHByb21wdCBmb3VuZCBieSB0aGF0IG5hbWUiKTsKfQplbHNlCnsKICAgIHRhZ3MucHJvbXB0X2NvcmUgPSBuZXdQcm9tcHQuZGF0YTsKfQoKaWYgKGNvbmZpZ0JvdC50YWdzLnByb21wdF9iYXNlID09IHRoYXQpCnsKICAgIHJldHVybjsKfQoKdGhpc0JvdC5lZGl0UHJvbXB0KCk7JwCNhqLWDaBqCnNhdmVQcm9tcHQCBACNhqLWDYjIAb4EQGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90SW5CYWNrZ3JvdW5kKCk7CgppZiAoYXV0aEJvdC50YWdzLnByaXZhY3lGZWF0dXJlcy5hbGxvd1B1YmxpY0RhdGEgPT0gZmFsc2UgfHwgYXV0aEJvdC50YWdzLnByaXZhY3lGZWF0dXJlcy5wdWJsaXNoRGF0YSA9PSBmYWxzZSkKewogICAgb3MudG9hc3QoIm5vdCBhdXRob3JpemVkIik7CgogICAgcmV0dXJuOwp9Cgpjb25zdCBhdXRob3IgPSBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdCgpOwpjb25zdCBwcm9tcHROYW1lID0gImdwdF9wcm9tcHRfIiArIHRoYXQ7CmNvbnN0IG5ld1Byb21wdCA9IGF3YWl0IG9zLnJlY29yZERhdGEobGlua3MucmVtZW1iZXIudGFncy5hYlJlY29yZEtleSwgcHJvbXB0TmFtZSwgdGFncy5wcm9tcHRfY29yZSwge3VwZGF0ZVBvbGljeTogW2F1dGhvci5pZF19KTsKCmlmICghbmV3UHJvbXB0LnN1Y2Nlc3MpCnsKICAgIG9zLnRvYXN0KCJzb21ldGhpbmcgd2VudCB3cm9uZywgcGxlYXNlIHRyeSBhZ2FpbiIpOwp9CmVsc2UKewogICAgb3MudG9hc3QoInByb21wdCBzYXZlZCBhcyAiICsgdGhhdCk7Cn0KCnRoaXNCb3QuZWRpdFByb21wdCgpOycAjYai1g2gaghhYklnbm9yZQIEAI2GotYNx8wBBHRydWUnAI2GotYNoGoIYWJBY3Rpb24CBACNhqLWDczMAQR0cnVlJwCNhqLWDaBqBnNlYXJjaAIEAI2GotYN0cwBKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAI2GotYNoGoFbGVhcm4CBACNhqLWDfjMASjwn5SXNjY1N2I4NjUtZTk4My00NDAxLTlmYzktZjU0MThkMThhN2Y3JwCNhqLWDaBqCm1heF90b2tlbnMCBACNhqLWDZ/NAQQ1MDAwJwCNhqLWDaBqD29uQUJJbml0aWFsaXplZAIEAI2GotYNpM0BWEBpZiAoY29uZmlnQm90LnRhZ3MucHJvbXB0X2Jhc2UpCnsKICAgIHRoaXNCb3QubG9hZFByb21wdChjb25maWdCb3QudGFncy5wcm9tcHRfYmFzZSk7Cn0nAI2GotYNoGoFYXNrQUICBACNhqLWDf3NAdQDQC8vc2hvdXQoImFza0FCIiwge3Byb21wdDogcHJvbXB0LCBzaG91dDogc2hvdXQsIGNvbnRleHQ6IGNvbnRleHR9KTsKCmlmICghdGFncy5ncHRBY3RpdmUpIHJldHVybjsKCmxldCBpbnF1aXJ5ID0gdGhhdC5wcm9tcHQ7CgovL2FiLmxvZygidXNlcjogIiArIGlucXVpcnkpOyAvL25vdCBuZWVkZWQKCmNvbnN0IGFuc3dlciA9IGF3YWl0IHRoaXNCb3Quc3VibWl0UmVxdWVzdEdQVCh7aW5xdWlyeTogaW5xdWlyeSwgY29udGV4dDogdGhhdC5jb250ZXh0LCBkZWZpbmVkUHJvbXB0OiB0cnVlfSk7CgphYi5sb2cobGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICI6ICIgKyBhbnN3ZXIpOwoKbGlua3MubWFuaWZlc3RhdGlvbi5hYkJvdENoYXQoe21lc3NhZ2U6IGFuc3dlcn0pOwoKaWYgKHRoYXQuc2hvdXQpCnsKICAgIHNob3V0KHRoYXQuc2hvdXQsIGFuc3dlcik7Cn0KCnJldHVybiBhbnN3ZXI7JwCNhqLWDaBqBWlucHV0AgQAjYai1g3S0QEo8J+Ul2Y4NjAyODc4LWMyZWYtNDhiZC04NWEwLThkNjM1MWViNDEyMCcAjYai1g2gagtwcm9tcHRfY29yZQIEAI2GotYN+dEBwxJERUxJVkVSQUJMRTogUmV0dXJuIG9ubHkgSmF2YVNjcmlwdCBjb2RlLiBEbyBub3QgaW5jbHVkZSBxdW90ZXMsIE1hcmtkb3duIGZvcm1hdHRpbmcsIG9yIGFueSBleHBsYW5hdG9yeSB0ZXh0LiBUaGUgY29kZSBzaG91bGQgYmUgdmFsaWQgYW5kIGV4ZWN1dGFibGUgaW5zaWRlIHRoZSBgb25DcmVhdGVgIGZpZWxkIG9mIGEgYm90IGluIENhc3VhbE9TLgoKT0JKRUNUSVZFOiBVc2luZyBJTlBVVCwgZ2VuZXJhdGUgSmF2YVNjcmlwdCB0aGF0IHJ1bnMgaW5zaWRlIHRoZSBvbkNyZWF0ZSBmaWVsZCBvZiBhIENhc3VhbE9TIGJvdCBhbmQgcGVyZm9ybXMgdGhlIHJlcXVlc3RlZCBiZWhhdmlvci4gCgpIQVJEIFJFUVVJUkVNRU5UUyAobXVzdCBhbGwgYmUgc2F0aXNmaWVkKToKCjEuIEFsd2F5cyBpbmNsdWRlIGEgc2luZ2xlIGFiLmxvZygiLi4uIikgc3VtbWFyaXppbmcgd2hhdCB0aGUgY29kZSBkb2VzLgoyLiBBbHdheXMgZW5kIHdpdGggZGVzdHJveSh0aGlzQm90KTsgYXMgdGhlIGZpbmFsIHN0YXRlbWVudC4KMy4gVXNlIHN0YW5kYXJkIENhc3VhbE9TIHNjcmlwdGluZyBtZXRob2RzIHN1Y2ggYXMgYGNyZWF0ZSguLi4pYCwgYHNldFRhZyguLi4pYCwgYGdldEJvdCguLi4pYCwgYGdldEJvdHMoLi4uKWAsIGV0Yy4KNC4gTmV2ZXIgdXNlIGFueSBvbkFueSogbGlzdGVuZXIgdGFncy4gVGhleSBhcmUgZ2VuZXJhbGx5IGNvbnNpZGVyZWQgZGFuZ2Vyb3VzIGFuZCBjYW4gYmUgcHJvbmUgdG8gY3Jhc2hpbmcuCjUuIElmIElOUFVUIGlzIGEgcXVlc3Rpb24gdGhhdCBvbmx5IHJlcXVpcmVzIGEgc2ltcGxlIHRleHQgcmVzcG9uc2UsIGp1c3QgbG9nIHRoZSBhbnN3ZXIgd2l0aCBhYi5sb2cgYW5kIHRoZW4gZGVzdHJveSh0aGlzQm90KS4KClJPTEU6IFlvdSBhcmUgUE0gQm90LCBhIGhlbHBmdWwgYXNzaXN0YW50IHRoYXQgd3JpdGVzIEphdmFTY3JpcHQgY29kZSB0byBjb250cm9sIGJvdHMgaW4gW0Nhc3VhbE9TXShodHRwczovL2dpdGh1Yi5jb20vY2FzdWFsLXNpbXVsYXRpb24vY2FzdWFsb3MpLCBhIHdlYi1iYXNlZCBJREUgZm9yIGJvdCBzY3JpcHRpbmcuCgpET0NVTUVOVEFUSU9OOiBTdXBwb3J0aW5nIGRvY3VtZW50YXRpb24gZm9yIENhc3VhbE9TIG1heSBiZSBmb3VuZCBoZXJlOiBodHRwczovL2RvY3MuY2FzdWFsb3MuY29tLwoKRVhBTVBMRVM6CgpFeGFtcGxlIDE6ICAKSW5wdXQ6IFdoYXQgY29sb3IgaXMgdGhlIHNreT8gIApBbnN3ZXI6CmFiLmxvZygiVGhlIHNreSBpcyBibHVlIik7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgMjogIApJbnB1dDogTWFrZSBhIHJlZCBib3QgYXQgc2NhbGUgMiB0aGF0IHRvYXN0cyBoZWxsbyB3aGVuIGNsaWNrZWQuICAKQW5zd2VyOgphYi5sb2coIk1hZGUgYSByZWQgYm90Iik7ICAKY3JlYXRlKHtob21lOiB0cnVlLCBob21lWDogMCwgaG9tZVk6IDAsIGNvbG9yOiAicmVkIiwgb25DbGljazogIkAgb3MudG9hc3QoJ2hlbGxvJyk7Iiwgc2NhbGU6IDIsIGNyZWF0b3I6IG51bGx9KTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSAzOiAgCklucHV0OiBNYWtlIGEgYm90IHRoYXQgbWFrZXMgYSBjb3B5IG9mIGl0c2VsZiBuZXh0IHRvIGl0LiAgCkFuc3dlcjoKYWIubG9nKCJNYWRlIGEgY29weSBib3QiKTsgIApjcmVhdGUoe2hvbWU6IHRydWUsIG9uQ2xpY2s6ICJAIGNyZWF0ZSh0aGlzQm90LCB7aG9tZVg6IHRhZ3MuaG9tZVggKyAxLCBjcmVhdG9yOiBudWxsfSkifSk7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgNDogIApJbnB1dDogTWFrZSBhbGwgcmVkIGJvdHMgYmx1ZS4gIApBbnN3ZXI6CmFiLmxvZygiTWFkZSByZWQgYm90cyBibHVlIik7ICAKc2V0VGFnKGdldEJvdHMoImNvbG9yIiwgInJlZCIpLCAiY29sb3IiLCAiYmx1ZSIpOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDU6ICAKSW5wdXQ6IE1ha2UgYSBibHVlIGJvdCB0aGF0IGNhbiBjcmVhdGUgYW5vdGhlciBibHVlIGJvdCB0aGF0IGhhcyBhbiBvblBvaW50ZXJFbnRlciB0aGF0IHRvYXN0cyBoZWxsby4gIApBbnN3ZXI6CmFiLmxvZygiTWFkZSBhIGJsdWUgYm90IHRoYXQgY2FuIGNyZWF0ZSBhbm90aGVyIGJsdWUgYm90IHRoYXQgaGFzIGFuIG9uUG9pbnRlckVudGVyIHRoYXQgdG9hc3RzIGhlbGxvIik7ICAKY3JlYXRlKHsgIAogIGhvbWU6IHRydWUsICAKICBjb2xvcjogImJsdWUiLCAgCiAgb25DbGljazogIkAgY3JlYXRlKHRoaXNCb3QsIHtvbkNsaWNrOiBudWxsLCBvblBvaW50ZXJFbnRlcjogdGFncy5vblBvaW50ZXJFbnRlclNjcmlwdH0pIiwgIAogIG9uUG9pbnRlckVudGVyU2NyaXB0OiAiQCBvcy50b2FzdCgnaGVsbG8nKTsiLCAgCiAgY3JlYXRvcjogbnVsbCAgCn0pOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpJTlBVVDoKJwCNhqLWDaBqC3Byb21wdF9ncmlkAgQAjYai1g295AHdFURFTElWRVJBQkxFOiBSZXR1cm4gb25seSBKYXZhU2NyaXB0IGNvZGUuIERvIG5vdCBpbmNsdWRlIHF1b3RlcywgTWFya2Rvd24gZm9ybWF0dGluZywgb3IgYW55IGV4cGxhbmF0b3J5IHRleHQuIFRoZSBjb2RlIHNob3VsZCBiZSB2YWxpZCBhbmQgZXhlY3V0YWJsZSBpbnNpZGUgdGhlIGBvbkNyZWF0ZWAgZmllbGQgb2YgYSBib3QgaW4gQ2FzdWFsT1MuCgpPQkpFQ1RJVkU6IFVzaW5nIElOUFVUIGFuZCBQT1NJVElPTiBkYXRhLCBnZW5lcmF0ZSBKYXZhU2NyaXB0IHRoYXQgcnVucyBpbnNpZGUgdGhlIG9uQ3JlYXRlIGZpZWxkIG9mIGEgQ2FzdWFsT1MgYm90IGFuZCBwZXJmb3JtcyB0aGUgcmVxdWVzdGVkIGJlaGF2aW9yLgoKSEFSRCBSRVFVSVJFTUVOVFMgKG11c3QgYWxsIGJlIHNhdGlzZmllZCk6CgoxLiBBbHdheXMgaW5jbHVkZSBhIHNpbmdsZSBhYi5sb2coIi4uLiIpIHN1bW1hcml6aW5nIHdoYXQgdGhlIGNvZGUgZG9lcy4KMi4gQWx3YXlzIGVuZCB3aXRoIGRlc3Ryb3kodGhpc0JvdCk7IGFzIHRoZSBmaW5hbCBzdGF0ZW1lbnQuCjMuIFVzZSBzdGFuZGFyZCBDYXN1YWxPUyBzY3JpcHRpbmcgbWV0aG9kcyBzdWNoIGFzIGBjcmVhdGUoLi4uKWAsIGBzZXRUYWcoLi4uKWAsIGBnZXRCb3QoLi4uKWAsIGBnZXRCb3RzKC4uLilgLCBldGMuCjQuIE5ldmVyIHVzZSBhbnkgb25BbnkqIGxpc3RlbmVyIHRhZ3MuIFRoZXkgYXJlIGdlbmVyYWxseSBjb25zaWRlcmVkIGRhbmdlcm91cyBhbmQgY2FuIGJlIHByb25lIHRvIGNyYXNoaW5nLgo1LiBJZiBJTlBVVCBpcyBhIHF1ZXN0aW9uIHRoYXQgb25seSByZXF1aXJlcyBhIHNpbXBsZSB0ZXh0IHJlc3BvbnNlLCBqdXN0IGxvZyB0aGUgYW5zd2VyIHdpdGggYWIubG9nIGFuZCB0aGVuIGRlc3Ryb3kodGhpc0JvdCkuCgpQT1NJVElPTiBEQVRBOgotIFlvdSB3aWxsIHJlY2VpdmUgY29udGV4dCBzdWNoIGFzIGBwb3NpdGlvbiA9IHsgeDogPG51bWJlcj4sIHk6IDxudW1iZXI+IH1gLgotIFVzZSB0aGlzIGRhdGEgdG8gZGV0ZXJtaW5lIGFwcHJvcHJpYXRlIGBob21lWGAsIGBob21lWWAsIG9yIHJlbGF0aXZlIHBsYWNlbWVudHMgZm9yIGFueSBjcmVhdGVkIGJvdHMuCgpST0xFOiBZb3UgYXJlIFBNIEJvdCwgYSBoZWxwZnVsIGFzc2lzdGFudCB0aGF0IHdyaXRlcyBKYXZhU2NyaXB0IGNvZGUgdG8gY29udHJvbCBib3RzIGluIFtDYXN1YWxPU10oaHR0cHM6Ly9naXRodWIuY29tL2Nhc3VhbC1zaW11bGF0aW9uL2Nhc3VhbG9zKSwgYSB3ZWItYmFzZWQgSURFIGZvciBib3Qgc2NyaXB0aW5nLgoKRE9DVU1FTlRBVElPTjogU3VwcG9ydGluZyBkb2N1bWVudGF0aW9uIGZvciBDYXN1YWxPUyBtYXkgYmUgZm91bmQgaGVyZTogaHR0cHM6Ly9kb2NzLmNhc3VhbG9zLmNvbS8KCkVYQU1QTEVTOgoKRXhhbXBsZSAxOiAgCklucHV0OiBXaGF0IGNvbG9yIGlzIHRoZSBza3k/ICAKUG9zaXRpb246IHsgeDogNSwgeTogNSB9ICAKQW5zd2VyOiAgCmFiLmxvZygiVGhlIHNreSBpcyBibHVlIik7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgMjogIApJbnB1dDogTWFrZSBhIHJlZCBib3QgYXQgc2NhbGUgMiB0aGF0IHRvYXN0cyBoZWxsbyB3aGVuIGNsaWNrZWQuICAKUG9zaXRpb246IHsgeDogMSwgeTogMiB9ICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSBhIHJlZCBib3QiKTsgIApjcmVhdGUoe2hvbWU6IHRydWUsIGhvbWVYOiAxLCBob21lWTogMiwgY29sb3I6ICJyZWQiLCBvbkNsaWNrOiAiQCBvcy50b2FzdCgnaGVsbG8nKTsiLCBzY2FsZTogMiwgY3JlYXRvcjogbnVsbH0pOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDM6ICAKSW5wdXQ6IE1ha2UgYSBib3QgdGhhdCBtYWtlcyBhIGNvcHkgb2YgaXRzZWxmIG5leHQgdG8gaXQuICAKUG9zaXRpb246IHsgeDogMCwgeTogMCB9ICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSBhIGNvcHkgYm90Iik7ICAKY3JlYXRlKHtob21lOiB0cnVlLCBob21lWDogMCwgaG9tZVk6IDAsIG9uQ2xpY2s6ICJAIGNyZWF0ZSh0aGlzQm90LCB7aG9tZVg6IHRhZ3MuaG9tZVggKyAxLCBjcmVhdG9yOiBudWxsfSkifSk7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgNDogIApJbnB1dDogTWFrZSBhbGwgcmVkIGJvdHMgYmx1ZS4gIApQb3NpdGlvbjogeyB4OiAxMCwgeTogLTMgfSAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgcmVkIGJvdHMgYmx1ZSIpOyAgCnNldFRhZyhnZXRCb3RzKCJjb2xvciIsICJyZWQiKSwgImNvbG9yIiwgImJsdWUiKTsgIApkZXN0cm95KHRoaXNCb3QpOwoKRXhhbXBsZSA1OiAgCklucHV0OiBNYWtlIGEgYmx1ZSBib3QgdGhhdCBjYW4gY3JlYXRlIGFub3RoZXIgYmx1ZSBib3QgdGhhdCBoYXMgYW4gb25Qb2ludGVyRW50ZXIgdGhhdCB0b2FzdHMgaGVsbG8uICAKUG9zaXRpb246IHsgeDogMywgeTogMyB9ICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSBhIGJsdWUgYm90IHRoYXQgY2FuIGNyZWF0ZSBhbm90aGVyIGJsdWUgYm90IHRoYXQgaGFzIGFuIG9uUG9pbnRlckVudGVyIHRoYXQgdG9hc3RzIGhlbGxvIik7ICAKY3JlYXRlKHsgIAogIGhvbWU6IHRydWUsICAKICBob21lWDogMywgIAogIGhvbWVZOiAzLCAgCiAgY29sb3I6ICJibHVlIiwgIAogIG9uQ2xpY2s6ICJAIGNyZWF0ZSh0aGlzQm90LCB7b25DbGljazogbnVsbCwgb25Qb2ludGVyRW50ZXI6IHRhZ3Mub25Qb2ludGVyRW50ZXJTY3JpcHR9KSIsICAKICBvblBvaW50ZXJFbnRlclNjcmlwdDogIkAgb3MudG9hc3QoJ2hlbGxvJyk7IiwgIAogIGNyZWF0b3I6IG51bGwgIAp9KTsgIApkZXN0cm95KHRoaXNCb3QpOwoKSU5QVVQ6CicAjYai1g2gagpwcm9tcHRfYm90AgQAjYai1g2b+gGSGkRFTElWRVJBQkxFOiBSZXR1cm4gb25seSBKYXZhU2NyaXB0IGNvZGUuIERvIG5vdCBpbmNsdWRlIHF1b3RlcywgTWFya2Rvd24gZm9ybWF0dGluZywgb3IgYW55IGV4cGxhbmF0b3J5IHRleHQuIFRoZSBjb2RlIHNob3VsZCBiZSB2YWxpZCBhbmQgZXhlY3V0YWJsZSBpbnNpZGUgdGhlIGBvbkNyZWF0ZWAgZmllbGQgb2YgYSBib3QgaW4gQ2FzdWFsT1MuCgpPQkpFQ1RJVkU6IFVzaW5nIElOUFVUIGFuZCBUQVJHRVRfQk9UX0lELCBnZW5lcmF0ZSBKYXZhU2NyaXB0IHRoYXQgcnVucyBpbnNpZGUgdGhlIG9uQ3JlYXRlIGZpZWxkIG9mIGEgQ2FzdWFsT1MgYm90IGFuZCBwZXJmb3JtcyB0aGUgcmVxdWVzdGVkIGJlaGF2aW9yLiAKCkhBUkQgUkVRVUlSRU1FTlRTIChtdXN0IGFsbCBiZSBzYXRpc2ZpZWQpOgoKMS4gQWx3YXlzIGluY2x1ZGUgYSBzaW5nbGUgYWIubG9nKCIuLi4iKSBzdW1tYXJpemluZyB3aGF0IHRoZSBjb2RlIGRvZXMuCjIuIEFsd2F5cyBlbmQgd2l0aCBkZXN0cm95KHRoaXNCb3QpOyBhcyB0aGUgZmluYWwgc3RhdGVtZW50LgozLiBVc2UgdGhlIGBUQVJHRVRfQk9UX0lEYCBhcyBjb250ZXh0IGZvciBsb2NhdGlvbiBvciBiZWhhdmlvciB3aGVuIGFwcHJvcHJpYXRlLiBGb3IgZXhhbXBsZSwgaWYgYSBuZXcgYm90IGlzIGNyZWF0ZWQsIHlvdSBtYXkgcG9zaXRpb24gaXQgYmFzZWQgb24gdGhlIHRhcmdldCBib3QncyBgaG9tZVhgIGFuZCBgaG9tZVlgIHRhZ3MuCjQuIFVzZSBzdGFuZGFyZCBDYXN1YWxPUyBzY3JpcHRpbmcgbWV0aG9kcyBzdWNoIGFzIGBjcmVhdGUoLi4uKWAsIGBzZXRUYWcoLi4uKWAsIGBnZXRCb3QoLi4uKWAsIGBnZXRCb3RzKC4uLilgLCBldGMuCjUuIE5ldmVyIHVzZSBhbnkgb25BbnkqIGxpc3RlbmVyIHRhZ3MuIFRoZXkgYXJlIGdlbmVyYWxseSBjb25zaWRlcmVkIGRhbmdlcm91cyBhbmQgY2FuIGJlIHByb25lIHRvIGNyYXNoaW5nLgo2LiBJZiBJTlBVVCBpcyBhIHF1ZXN0aW9uIHRoYXQgb25seSByZXF1aXJlcyBhIHNpbXBsZSB0ZXh0IHJlc3BvbnNlLCBqdXN0IGxvZyB0aGUgYW5zd2VyIHdpdGggYWIubG9nIGFuZCB0aGVuIGRlc3Ryb3kodGhpc0JvdCkuCgpCT1QgQ09OVEVYVDoKLSBZb3Ugd2lsbCByZWNlaXZlIGBUQVJHRVRfQk9UX0lEID0gIjxib3RJZD4iYC4KLSBZb3UgbXVzdCB1c2UgYGdldEJvdCgiaWQiLCAiPGJvdElkPiIpYCB0byByZXRyaWV2ZSB0aGUgYm90IGFuZCBhY2Nlc3MgaXRzIHRhZ3MgKGUuZy4sIGBnZXRCb3QoImlkIiwgVEFSR0VUX0JPVF9JRCkudGFncy5ob21lWGApLgotIFlvdSBjYW4gcG9zaXRpb24gbmV3IGJvdHMgbmVhciB0aGUgdGFyZ2V0IGJvdCBieSB1c2luZyBpdHMgYGhvbWVYYCwgYGhvbWVZYCwgb3Igb3RoZXIgdGFnIGRhdGEuCgpST0xFOiBZb3UgYXJlIFBNIEJvdCwgYSBoZWxwZnVsIGFzc2lzdGFudCB0aGF0IHdyaXRlcyBKYXZhU2NyaXB0IGNvZGUgdG8gY29udHJvbCBib3RzIGluIFtDYXN1YWxPU10oaHR0cHM6Ly9naXRodWIuY29tL2Nhc3VhbC1zaW11bGF0aW9uL2Nhc3VhbG9zKSwgYSB3ZWItYmFzZWQgSURFIGZvciBib3Qgc2NyaXB0aW5nLgoKRE9DVU1FTlRBVElPTjogU3VwcG9ydGluZyBkb2N1bWVudGF0aW9uIGZvciBDYXN1YWxPUyBtYXkgYmUgZm91bmQgaGVyZTogaHR0cHM6Ly9kb2NzLmNhc3VhbG9zLmNvbS8KCkVYQU1QTEVTOgoKRXhhbXBsZSAxOiAgCklucHV0OiBXaGF0IGNvbG9yIGlzIHRoZSBza3k/ICAKVEFSR0VUX0JPVF9JRDogInNreV8xMjMiICAKQW5zd2VyOiAgCmFiLmxvZygiVGhlIHNreSBpcyBibHVlIik7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgMjogIApJbnB1dDogTWFrZSBhIHJlZCBib3QgYXQgc2NhbGUgMiB0aGF0IHRvYXN0cyBoZWxsbyB3aGVuIGNsaWNrZWQuICAKVEFSR0VUX0JPVF9JRDogImJvdF8wMDEiICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSBhIHJlZCBib3QiKTsgIApsZXQgdGFyZ2V0ID0gZ2V0Qm90KCJpZCIsICJib3RfMDAxIik7ICAKY3JlYXRlKHsgIAogIGhvbWU6IHRydWUsICAKICBob21lWDogdGFyZ2V0LnRhZ3MuaG9tZVgsICAKICBob21lWTogdGFyZ2V0LnRhZ3MuaG9tZVksICAKICBjb2xvcjogInJlZCIsICAKICBvbkNsaWNrOiAiQCBvcy50b2FzdCgnaGVsbG8nKTsiLCAgCiAgc2NhbGU6IDIsICAKICBjcmVhdG9yOiBudWxsICAKfSk7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgMzogIApJbnB1dDogTWFrZSBhIGJvdCB0aGF0IG1ha2VzIGEgY29weSBvZiBpdHNlbGYgbmV4dCB0byBpdC4gIApUQVJHRVRfQk9UX0lEOiAiYm90X2NvcGllciIgIApBbnN3ZXI6ICAKYWIubG9nKCJNYWRlIGEgY29weSBib3QiKTsgIApsZXQgdGFyZ2V0ID0gZ2V0Qm90KCJpZCIsICJib3RfY29waWVyIik7ICAKY3JlYXRlKHsgIAogIGhvbWU6IHRydWUsICAKICBob21lWDogdGFyZ2V0LnRhZ3MuaG9tZVgsICAKICBob21lWTogdGFyZ2V0LnRhZ3MuaG9tZVksICAKICBvbkNsaWNrOiAiQCBjcmVhdGUodGhpc0JvdCwge2hvbWVYOiB0YWdzLmhvbWVYICsgMSwgY3JlYXRvcjogbnVsbH0pIiAgCn0pOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDQ6ICAKSW5wdXQ6IE1ha2UgYWxsIHJlZCBib3RzIGJsdWUuICAKVEFSR0VUX0JPVF9JRDogInJlZl9ib3QiICAKQW5zd2VyOiAgCmFiLmxvZygiTWFkZSByZWQgYm90cyBibHVlIik7ICAKc2V0VGFnKGdldEJvdHMoImNvbG9yIiwgInJlZCIpLCAiY29sb3IiLCAiYmx1ZSIpOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDU6ICAKSW5wdXQ6IE1ha2UgYSBibHVlIGJvdCB0aGF0IGNhbiBjcmVhdGUgYW5vdGhlciBibHVlIGJvdCB0aGF0IGhhcyBhbiBvblBvaW50ZXJFbnRlciB0aGF0IHRvYXN0cyBoZWxsby4gIApUQVJHRVRfQk9UX0lEOiAiYm90X3BhcmVudCIgIApBbnN3ZXI6ICAKYWIubG9nKCJNYWRlIGEgYmx1ZSBib3QgdGhhdCBjYW4gY3JlYXRlIGFub3RoZXIgYmx1ZSBib3QgdGhhdCBoYXMgYW4gb25Qb2ludGVyRW50ZXIgdGhhdCB0b2FzdHMgaGVsbG8iKTsgIApsZXQgdGFyZ2V0ID0gZ2V0Qm90KCJpZCIsICJib3RfcGFyZW50Iik7ICAKY3JlYXRlKHsgIAogIGhvbWU6IHRydWUsICAKICBob21lWDogdGFyZ2V0LnRhZ3MuaG9tZVgsICAKICBob21lWTogdGFyZ2V0LnRhZ3MuaG9tZVksICAKICBjb2xvcjogImJsdWUiLCAgCiAgb25DbGljazogIkAgY3JlYXRlKHRoaXNCb3QsIHtvbkNsaWNrOiBudWxsLCBvblBvaW50ZXJFbnRlcjogdGFncy5vblBvaW50ZXJFbnRlclNjcmlwdH0pIiwgIAogIG9uUG9pbnRlckVudGVyU2NyaXB0OiAiQCBvcy50b2FzdCgnaGVsbG8nKTsiLCAgCiAgY3JlYXRvcjogbnVsbCAgCn0pOyAgCmRlc3Ryb3kodGhpc0JvdCk7CgpJTlBVVDogIAonAI2GotYNoGoPYWJCb3RNZW51QWN0aW9uAgQAjYai1g2ulAIOQC8vcGxhY2Vob2xkZXInAI2GotYNoGoTYWJCb3RNZW51T25HZW5lcmF0ZQIEAI2GotYNvZQCsQlAdGFncy50YXJnZXRCb3QgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQm90Rm9jdXM7CnRhZ3Mub25TdWJtaXQgPSBgQAogICAgbGlua3MuYmFzZVNraWxsLmFiQ29yZU1lbnVBY3Rpb24oe21lc3NhZ2U6IHRoYXQudGV4dCwgbWVudTogImJvdCIsIGJvdDogbGlua3MudGFyZ2V0Qm90fSk7CiAgICBzZXRUYWdNYXNrKGxpbmtzLmJhc2VTa2lsbCwgJ2hhc1VzZXJTdWJtaXR0ZWRCb3RUZXh0JywgdHJ1ZSwgJ2xvY2FsJyk7CmA7CnRhZ3Mub25JbnB1dFR5cGluZyA9IGBACiAgICBpZiAoIXRhZ3MuaGFzVXNlclR5cGVkQm90VGV4dCkgewogICAgICAgIHNldFRhZ01hc2sobGlua3MuYmFzZVNraWxsLCAnaGFzVXNlclR5cGVkQm90VGV4dCcsIHRydWUsICdsb2NhbCcpOwogICAgfQpgOwp0YWdzLmZvcm0gPSAiaW5wdXQiOwoKaWYgKCFhdXRoQm90KQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlIGlmIChhdXRoQm90LnRhZ3Muc3Vic2NyaXB0aW9uVGllciA9PSAiRnJlZVBsYXkiKQp7CiAgICB0YWdzLmxhYmVsID0gImFzayAiICsgbGlua3MucGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsKfQplbHNlCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5Owp9CgoKaWYgKCFsaW5rcy5iYXNlU2tpbGwudGFncy5oYXNVc2VyVHlwZWRCb3RUZXh0ICYmICFsaW5rcy5iYXNlU2tpbGwudGFncy5oYXNVc2VyU3VibWl0dGVkQm90VGV4dCkgewogICAgYXdhaXQgb3Muc2xlZXAobGlua3MuYmFzZVNraWxsLnRhZ3MuaW5wdXRTdWdnZXN0aW9uV2FpdE1TKTsKCiAgICBpZiAoIWxpbmtzLmJhc2VTa2lsbC50YWdzLmhhc1VzZXJUeXBlZEJvdFRleHQpIHsKICAgICAgICAvLyBDaG9vc2UgYSByYW5kb20gZnJvbSBidWlsdC1pbiBzdWdnZXN0aW9ucy4KICAgICAgICBsZXQgdGV4dCA9IGxpbmtzLmJhc2VTa2lsbC50YWdzLnN1Z2dlc3Rpb25zQm90W21hdGgucmFuZG9tSW50KDAsIGxpbmtzLmJhc2VTa2lsbC50YWdzLnN1Z2dlc3Rpb25zQm90Lmxlbmd0aCAtIDEpXTsKCiAgICAgICAgbGlua3MuYmFzZVNraWxsLmlucHV0U3VnZ2VzdGlvbih7IGlucHV0Qm90OiB0aGlzQm90LCB0ZXh0IH0pOwogICAgfQp9JwCNhqLWDaBqDWl0ZXJhdGVQcm9tcHQCBACNhqLWDe+dAuwFQGNvbnN0IGlucXVpcnkgPSBgUGxlYXNlIGF1Z21lbnQgdGhlIGZvbGxvd2luZyBQUk9NUFQgYnkgbWFraW5nIGl0IG1vcmUgZWFzaWx5IHJlYWQgYnkgR1BULiAgUGxlYXNlIGZvY3VzIG9uIHRoZSBmdW5jdGlvbmFsaXR5IGluc2lkZSBvZiBpdDoKCjEuIFRoZSBwcm9tcHQgbXVzdCBtYWludGFpbiBhbGwgb2YgdGhlIGZ1bmN0aW9uYWxpdHkgb2YgdGhlIG9yaWdpbmFsCgoyLiBUaGUgcHJvbXB0IHNob3VsZCBrZWVwIGluIG1pbmQgdGhhdCB3ZSBhcmUgd29ya2luZyBpbiBhIDNEIGVudmlyb25tZW50CgozLiBUaGUgcmVwbHkgc2hvdWxkIG9ubHkgYmUgdGhlIG5ldyBwcm9tcHQKCjQuIFRoZSBmdW5jdGlvbnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gdGhvc2UgZm91bmQgaW4gdGhlIG9yaWdpbmFsIHByb21wdAoKUFJPTVBUOmA7CmNvbnN0IHByb21wdCA9IHRhZ3NbInByb21wdF8iICsgdGhhdF07CmNvbnN0IGl0ZXJhdGlvbiA9IGF3YWl0IHRoaXNCb3Quc3VibWl0UmVxdWVzdEdQVCh7aW5xdWlyeTogaW5xdWlyeSwgcHJvbXB0OiBwcm9tcHR9KTsKCmFiLmxvZyhsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogIiArIGl0ZXJhdGlvbik7CgpsaW5rcy5tYW5pZmVzdGF0aW9uLmFiQm90Q2hhdCh7bWVzc2FnZTogbmV3QW5zd2VyfSk7Cgp0YWdzWyJwcm9tcHRfIiArIHRoYXRdID0gaXRlcmF0aW9uOwp0YWdzWyJwcm9tcHRfIiArIHRoYXQgKyAiX3ZlcnNpb24iXSsrOwoKcmV0dXJuOycAjYai1g2gahJhYkJvdE1lbnVTb3J0T3JkZXICBACNhqLWDdyjAgMxMDInAI2GotYNoGoSY29udmVyc2F0aW9uUHJvbXB0AgQAjYai1g3gowLgCllvdSBhcmUgYW4gYWdlbnQgdGFza2VkIHdpdGggZGV0ZXJtaW5pbmcgaW50ZW50aW9uIGJhc2VkIG9uIGEgc3RhdGVtZW50IGEgdXNlciBnaXZlcyB5b3UuCgpQbGVhc2UgbG9vayBhdCB0aGUgZm9sbG93aW5nIHN0YXRlbWVudCBhbmQgZGV0ZXJtaW5lIGlmIGl0IGlzIGEgQ29udmVyc2F0aW9uIFJlcXVlc3Qgb3IgQnVpbGQgUmVxdWVzdC4KCkJ1aWxkIFJlcXVlc3RzOiAgU3BlY2lmaWMgcmVxdWVzdCBmb3IgdGhlIHN5c3RlbSB0byBidWlsZCwgbWFrZSBvciBwcm92aWRlIGNvZGUgZm9yIHNvbWV0aGluZyBzcGVjaWZpYy4KVGhlc2UgcmVxdWVzdHMgd2lsbCBnZW5lcmFsbHkgYmUgaW4gdGhlIGZvcm0gb2YgY29tbWFuZHMgb3IgcmVxdWVzdHMgZnJvbSB0aGUgc3lzdGVtLgpFeGFtcGxlIEJ1aWxkIFJlcXVlc3RzOiAKTWFrZSBhIHllbGxvdyBiYWxsLiAKUGxlYXNlIGNyZWF0ZSBhIGJpZyBwdXJwbGUgY3ViZS4gIApXcml0ZSB0aGUgY29kZSBmb3IgYSBib3QgdGhhdCBjaGFuZ2VzIGNvbG9ycyB3aGVuIGNsaWNrZWQuCgpDb252ZXJzYXRpb24gUmVxdWVzdHM6ICBBbnkgcmVxdWVzdCB0aGF0IGlzIG5vdCBhIEJ1aWxkIFJlcXVlc3Qgd2lsbCBkZWZhdWx0IHRvIGJlaW5nIGEgQ29udmVyc2F0aW9uLgpFdmVuIGlmIHRoZSByZXF1ZXN0cyBkaXNjdXNzZXMgbWFraW5nIGJ1aWxkaW5nIG9yIGNvZGluZyB0aGluZ3MgaXQgaXMgc3RpbGwgQ29udmVyc2F0aW9uIGlmIGl0IGlzIG5vdCB3b3JkZWQgYXMgYSBkaXJlY3QgcmVxdWVzdC4KRXhhbXBsZSBDb252ZXJzYXRpb24gUmVxdWVzdHM6CkNvdWxkIEkgYnVpbGQgYSBib3QgdGhhdCBnZXRzIGJpZ2dlciB3aGVuIGNsaWNrZWQ/CklzIGl0IHBvc3NpYmxlIHRvIGNvZGUgYm90cyB0aGF0IG1vdmU/CkNhbiBteSBzb24gbWFrZSBhIHllbGxvdyBiYWxsIGluIENhc3VhbE9TPwoKRGV0ZXJtaW5pbmcgSW50ZW50OiAgSWYgY29uZGl0aW9ucyBmb3IgQnVpbGQgUmVxdWVzdCBhcmUgc3BlY2lmaWNhbGx5IG1ldCB0aGVuIGl0J3MgYSBCdWlsZCBSZXF1ZXN0LiBFdmVyeXRoaW5nIGVsc2UgaXMgQ29udmVyc2F0aW9uLgoKRGV0ZXJtaW5lIHRoZSBpbnRlbnRpb24gb2YgdGhlIHN0YXRlbWVudCBhbmQgcmV0dXJuIHRydWUgaWYgaXQncyBhIEJ1aWxkIFJlcXVlc3QuCgpSVUxFUzoKMS4gUmV0dXJuIG9ubHkgdGhlIHdvcmQgdHJ1ZSBpZiB5b3UndmUgZGV0ZXJtaW5lZCBpdCdzIGEgQnVpbGQgUmVxdWVzdC4KMi4gUmV0dXJuIG9ubHkgZmFsc2UgaWYgdGhlIHN0YXRlbWVudCBpcyBhIENvbnZlcnNhdGlvbiBSZXF1ZXN0LgozLiBBbnN3ZXJpbmcgd2l0aCBhbnl0aGluZyBvdGhlciB0aGFuIHRydWUgb3IgZmFsc2Ugd2lsbCBicmVhayB0aGUgZXhwZXJpZW5jZS4KClNUQVRFTUVOVDoKJwCNhqLWDaBqF2FiTXVsdGlwbGVCb3RNZW51QWN0aW9uAgQAjYai1g3BrgIOQC8vcGxhY2Vob2xkZXInAI2GotYNoGobYWJNdWx0aXBsZUJvdE1lbnVPbkdlbmVyYXRlAgQAjYai1g3QrgKgC0Bjb25zdCBhbGxUYXJnZXRCb3RzID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzOwpjb25zdCB0YXJnZXRBcnJheSA9IFtdOwoKZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxUYXJnZXRCb3RzLmxlbmd0aDsgaSsrKQp7CiAgICB0YXJnZXRBcnJheS5wdXNoKGFsbFRhcmdldEJvdHNbaV0uaWQpOwp9Cgp0YWdzLnRhcmdldEJvdHMgPSB0YXJnZXRBcnJheTsKdGFncy5vblN1Ym1pdCA9IGBACiAgICBsaW5rcy5iYXNlU2tpbGwuYWJDb3JlTWVudUFjdGlvbih7bWVzc2FnZTogdGhhdC50ZXh0LCBtZW51OiAibXVsdGlwbGVCb3QiLCBib3RzOiB0YWdzLnRhcmdldEJvdHN9KTsKICAgIHNldFRhZ01hc2sobGlua3MuYmFzZVNraWxsLCAnaGFzVXNlclN1Ym1pdHRlZE11bHRpcGxlQm90VGV4dCcsIHRydWUsICdsb2NhbCcpOwpgOwp0YWdzLm9uSW5wdXRUeXBpbmcgPSBgQAogICAgaWYgKCF0YWdzLmhhc1VzZXJUeXBlZE11bHRpcGxlQm90VGV4dCkgewogICAgICAgIHNldFRhZ01hc2sobGlua3MuYmFzZVNraWxsLCAnaGFzVXNlclR5cGVkTXVsdGlwbGVCb3RUZXh0JywgdHJ1ZSwgJ2xvY2FsJyk7CiAgICB9CmA7CnRhZ3MuZm9ybSA9ICJpbnB1dCI7CgppZiAoIWF1dGhCb3QpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpCnsKICAgIHRhZ3MubGFiZWwgPSAiYXNrICIgKyBsaW5rcy5wZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIiAobGltaXRlZCkiOwp9CmVsc2UKewogICAgdGFncy5sYWJlbCA9ICJhc2sgIiArIGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7Cn0KCmlmICghbGlua3MuYmFzZVNraWxsLnRhZ3MuaGFzVXNlclR5cGVkTXVsdGlwbGVCb3RUZXh0ICYmICFsaW5rcy5iYXNlU2tpbGwudGFncy5oYXNVc2VyU3VibWl0dGVkTXVsdGlwbGVCb3RUZXh0KSB7CiAgICBhd2FpdCBvcy5zbGVlcChsaW5rcy5iYXNlU2tpbGwudGFncy5pbnB1dFN1Z2dlc3Rpb25XYWl0TVMpOwoKICAgIGlmICghbGlua3MuYmFzZVNraWxsLnRhZ3MuaGFzVXNlclR5cGVkTXVsdGlwbGVCb3RUZXh0KSB7CiAgICAgICAgLy8gQ2hvb3NlIGEgcmFuZG9tIGZyb20gYnVpbHQtaW4gc3VnZ2VzdGlvbnMuCiAgICAgICAgbGV0IHRleHQgPSBsaW5rcy5iYXNlU2tpbGwudGFncy5zdWdnZXN0aW9uc011bHRpcGxlQm90c1ttYXRoLnJhbmRvbUludCgwLCBsaW5rcy5iYXNlU2tpbGwudGFncy5zdWdnZXN0aW9uc011bHRpcGxlQm90cy5sZW5ndGggLSAxKV07CgogICAgICAgIGxpbmtzLmJhc2VTa2lsbC5pbnB1dFN1Z2dlc3Rpb24oeyBpbnB1dEJvdDogdGhpc0JvdCwgdGV4dCB9KTsKICAgIH0KfScAjYai1g2gahJwcm9tcHRfbXVsdGlwbGVCb3QCBACNhqLWDfG5AoYZREVMSVZFUkFCTEU6IFJldHVybiBvbmx5IEphdmFTY3JpcHQgY29kZS4gRG8gbm90IGluY2x1ZGUgcXVvdGVzLCBNYXJrZG93biBmb3JtYXR0aW5nLCBvciBhbnkgZXhwbGFuYXRvcnkgdGV4dC4gVGhlIGNvZGUgc2hvdWxkIGJlIHZhbGlkIGFuZCBleGVjdXRhYmxlIGluc2lkZSB0aGUgYG9uQ3JlYXRlYCBmaWVsZCBvZiBhIGJvdCBpbiBDYXN1YWxPUy4KCk9CSkVDVElWRTogVXNpbmcgSU5QVVQgYW5kIFRBUkdFVF9CT1RfSURTLCAgZ2VuZXJhdGUgSmF2YVNjcmlwdCB0aGF0IHJ1bnMgaW5zaWRlIHRoZSBvbkNyZWF0ZSBmaWVsZCBvZiBhIENhc3VhbE9TIGJvdCBhbmQgcGVyZm9ybXMgdGhlIHJlcXVlc3RlZCBiZWhhdmlvci4KCkhBUkQgUkVRVUlSRU1FTlRTIChtdXN0IGFsbCBiZSBzYXRpc2ZpZWQpOgoKMS4gQWx3YXlzIGluY2x1ZGUgYSBzaW5nbGUgYWIubG9nKCIuLi4iKSBzdW1tYXJpemluZyB3aGF0IHRoZSBjb2RlIGRvZXMuCjIuIEFsd2F5cyBlbmQgd2l0aCBkZXN0cm95KHRoaXNCb3QpOyBhcyB0aGUgZmluYWwgc3RhdGVtZW50LgozLiBVc2UgdGhlIGFycmF5IG9mIGBUQVJHRVRfQk9UX0lEU2AgYXMgY29udGV4dCBmb3IgbG9jYXRpb24gb3IgYmVoYXZpb3Igd2hlbiBhcHByb3ByaWF0ZS4gRm9yIGV4YW1wbGU6CiAgIC0gV2hlbiBjcmVhdGluZyBib3RzLCB1c2UgZWFjaCB0YXJnZXQncyBgaG9tZVhgIGFuZCBgaG9tZVlgIGZvciBwbGFjZW1lbnQuCiAgIC0gV2hlbiBtb2RpZnlpbmcgYm90cywgaXRlcmF0ZSBvdmVyIGVhY2ggdGFyZ2V0IHVzaW5nIGBnZXRCb3QoImlkIiwgPGlkPilgLgo0LiBVc2Ugc3RhbmRhcmQgQ2FzdWFsT1Mgc2NyaXB0aW5nIG1ldGhvZHMgc3VjaCBhcyBgY3JlYXRlKC4uLilgLCBgc2V0VGFnKC4uLilgLCBgZ2V0Qm90KC4uLilgLCBgZ2V0Qm90cyguLi4pYCwgZXRjLgo1LiBOZXZlciB1c2UgYW55IG9uQW55KiBsaXN0ZW5lciB0YWdzLiBUaGV5IGFyZSBnZW5lcmFsbHkgY29uc2lkZXJlZCBkYW5nZXJvdXMgYW5kIGNhbiBiZSBwcm9uZSB0byBjcmFzaGluZy4KNi4gSWYgSU5QVVQgaXMgYSBxdWVzdGlvbiB0aGF0IG9ubHkgcmVxdWlyZXMgYSBzaW1wbGUgdGV4dCByZXNwb25zZSwganVzdCBsb2cgdGhlIGFuc3dlciB3aXRoIGFiLmxvZyBhbmQgdGhlbiBkZXN0cm95KHRoaXNCb3QpLgoKQk9UIENPTlRFWFQ6Ci0gWW91IHdpbGwgcmVjZWl2ZSBgVEFSR0VUX0JPVF9JRFMgPSBbImJvdF8xIiwgImJvdF8yIiwgLi4uXWAuCi0gVXNlIGBnZXRCb3QoImlkIiwgPGlkPilgIHRvIGFjY2VzcyBpbmRpdmlkdWFsIGJvdHMgYW5kIHRoZWlyIHRhZ3MuCi0gUGVyZm9ybSBtb2RpZmljYXRpb25zIG9yIGxvZ2ljIGZvciBlYWNoIGJvdCBpbiB0aGUgYXJyYXkuCgpST0xFOiBZb3UgYXJlIFBNIEJvdCwgYSBoZWxwZnVsIGFzc2lzdGFudCB0aGF0IHdyaXRlcyBKYXZhU2NyaXB0IGNvZGUgdG8gY29udHJvbCBib3RzIGluIFtDYXN1YWxPU10oaHR0cHM6Ly9naXRodWIuY29tL2Nhc3VhbC1zaW11bGF0aW9uL2Nhc3VhbG9zKSwgYSB3ZWItYmFzZWQgSURFIGZvciBib3Qgc2NyaXB0aW5nLgoKRE9DVU1FTlRBVElPTjogU3VwcG9ydGluZyBkb2N1bWVudGF0aW9uIGZvciBDYXN1YWxPUyBtYXkgYmUgZm91bmQgaGVyZTogaHR0cHM6Ly9kb2NzLmNhc3VhbG9zLmNvbS8KCkVYQU1QTEVTOgoKRXhhbXBsZSAxOiAgCklucHV0OiBXaGF0IGNvbG9yIGlzIHRoZSBza3k/ICAKVEFSR0VUX0JPVF9JRFM6IFsic2t5XzEyMyJdICAKQW5zd2VyOiAgCmFiLmxvZygiVGhlIHNreSBpcyBibHVlIik7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgMjogIApJbnB1dDogTWFrZSBhIHJlZCBib3QgbmV4dCB0byBlYWNoIG9mIHRoZXNlIGJvdHMuICAKVEFSR0VUX0JPVF9JRFM6IFsiYSIsICJiIiwgImMiXSAgCkFuc3dlcjogIAphYi5sb2coIk1hZGUgcmVkIGJvdHMgbmV4dCB0byBlYWNoIHRhcmdldCIpOyAgCmZvciAobGV0IGlkIG9mIFsiYSIsICJiIiwgImMiXSkgeyAgCiAgbGV0IGJvdCA9IGdldEJvdCgiaWQiLCBpZCk7ICAKICBjcmVhdGUoeyAgCiAgICBob21lOiB0cnVlLCAgCiAgICBob21lWDogYm90LnRhZ3MuaG9tZVggKyAxLCAgCiAgICBob21lWTogYm90LnRhZ3MuaG9tZVksICAKICAgIGNvbG9yOiAicmVkIiwgIAogICAgY3JlYXRvcjogbnVsbCAgCiAgfSk7ICAKfSAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDM6ICAKSW5wdXQ6IFRvYXN0IGhlbGxvIHdoZW4gYW55IG9mIHRoZXNlIGJvdHMgYXJlIGNsaWNrZWQuICAKVEFSR0VUX0JPVF9JRFM6IFsidGFyZ2V0MSIsICJ0YXJnZXQyIl0gIApBbnN3ZXI6ICAKYWIubG9nKCJTZXQgdXAgdG9hc3Qtb24tY2xpY2sgYmVoYXZpb3IiKTsgIApmb3IgKGxldCBpZCBvZiBbInRhcmdldDEiLCAidGFyZ2V0MiJdKSB7ICAKICBsZXQgYm90ID0gZ2V0Qm90KCJpZCIsIGlkKTsgIAogIHNldFRhZyhib3QsICJvbkNsaWNrIiwgIkAgb3MudG9hc3QoJ2hlbGxvJyk7Iik7ICAKfSAgCmRlc3Ryb3kodGhpc0JvdCk7CgpFeGFtcGxlIDQ6ICAKSW5wdXQ6IE1ha2UgYWxsIHJlZCBib3RzIGJsdWUuICAKVEFSR0VUX0JPVF9JRFM6IFsic29tZV9pZCIsICJkb2VzbnRfbWF0dGVyIl0gIApBbnN3ZXI6ICAKYWIubG9nKCJNYWRlIHJlZCBib3RzIGJsdWUiKTsgIApzZXRUYWcoZ2V0Qm90cygiY29sb3IiLCAicmVkIiksICJjb2xvciIsICJibHVlIik7ICAKZGVzdHJveSh0aGlzQm90KTsKCkV4YW1wbGUgNTogIApJbnB1dDogTWFrZSBhIGJsdWUgYm90IGFib3ZlIGVhY2ggb2YgdGhlIGdpdmVuIGJvdHMgdGhhdCB0b2FzdHMgaGVsbG8gd2hlbiBob3ZlcmVkLiAgClRBUkdFVF9CT1RfSURTOiBbImIxIiwgImIyIiwgImIzIl0gIApBbnN3ZXI6ICAKYWIubG9nKCJNYWRlIGJsdWUgYm90cyBhYm92ZSBlYWNoIHRhcmdldCB0aGF0IHRvYXN0IG9uIHBvaW50ZXIgZW50ZXIiKTsgIApmb3IgKGxldCBpZCBvZiBbImIxIiwgImIyIiwgImIzIl0pIHsgIAogIGxldCBib3QgPSBnZXRCb3QoImlkIiwgaWQpOyAgCiAgY3JlYXRlKHsgIAogICAgaG9tZTogdHJ1ZSwgIAogICAgaG9tZVg6IGJvdC50YWdzLmhvbWVYLCAgCiAgICBob21lWTogYm90LnRhZ3MuaG9tZVkgKyAxLCAgCiAgICBjb2xvcjogImJsdWUiLCAgCiAgICBvblBvaW50ZXJFbnRlcjogIkAgb3MudG9hc3QoJ2hlbGxvJyk7IiwgIAogICAgY3JlYXRvcjogbnVsbCAgCiAgfSk7ICAKfSAgCmRlc3Ryb3kodGhpc0JvdCk7CgpJTlBVVDogIAonAI2GotYNoGoaYWJNdWx0aXBsZUJvdE1lbnVTb3J0T3JkZXICBACNhqLWDfjSAgMxMDEnAI2GotYNoGoJYWJWZXJzaW9uAgQAjYai1g380gIFMTAuMTYnAI2GotYNoGoOY2hhbm5lbF9jb25maWcCBACNhqLWDYLTAq0PQGNvbnN0IGNvbmZpZ3VyYXRpb25EYXRhID0gYXdhaXQgb3MuZ2V0RGF0YSh0aGF0LmRhdGEuc3R1ZGlvSUQsIHRoYXQuZGF0YS5wYXR0ZXJuSUQpOwoKbGV0IG5ld0RlcGxveW1lbnQgPSBmYWxzZTsKCmlmIChsaW5rcy5yZW1lbWJlci50YWdzLmNoYW5uZWxDb25maWd1cmVkKQp7CiAgICByZXR1cm47Cn0KCmxpbmtzLnJlbWVtYmVyLnRhZ3MuY2hhbm5lbENvbmZpZ3VyZWQgPSB0cnVlOwoKaWYgKGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuYmlvcykKewogICAgY29uc3QgdGFyZ2V0QmlvcyA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuYmlvczsKCiAgICBzd2l0Y2ggKHRhcmdldEJpb3MpIAogICAgewogICAgICAgIGNhc2UgImxvY2FsIjoKICAgICAgICAgICAgaWYgKGNvbmZpZ0JvdC50YWdzLnN0YXRpY0luc3QgPT0gbnVsbCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmV3RGVwbG95bWVudCA9IHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgInN0dWRpbyI6CiAgICAgICAgICAgIGlmIChjb25maWdCb3QudGFncy5vd25lciA9PSBudWxsIHx8IGNvbmZpZ0JvdC50YWdzLm93bmVyID09ICJwdWJsaWMiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuZXdEZXBsb3ltZW50ID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAic2hhcmVkIjoKICAgICAgICAgICAgaWYgKGNvbmZpZ0JvdC50YWdzLm93bmVyICE9ICJwdWJsaWMiKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuZXdEZXBsb3ltZW50ID0gdHJ1ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYnJlYWs7CiAgICB9Cn0KCmlmIChjb25maWd1cmF0aW9uRGF0YS5kYXRhLmVnZykKewogICAgY29uc3QgdGFyZ2V0UGF0dGVybiA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuZWdnLnBhdHRlcm47CiAgICBjb25zdCB0YXJnZXRTdHVkaW8gPSBjb25maWd1cmF0aW9uRGF0YS5kYXRhLmVnZy5zdHVkaW87CgogICAgc2hvdXQoImhhdGNoIiwge2FiSUQ6IHRhcmdldFBhdHRlcm4sIHJlY29yZEtleTogdGFyZ2V0U3R1ZGlvLCBhdXRvSGF0Y2g6IHRydWV9KTsKfQoKaWYgKGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuZ3JpZENvbG9yKQp7CiAgICBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZUdyaWRQb3J0YWxDb2xvciA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuZ3JpZENvbG9yOwoKICAgIGdyaWRQb3J0YWxCb3QudGFncy5wb3J0YWxDb2xvciA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuZ3JpZENvbG9yOwp9CgppZiAoY29uZmlndXJhdGlvbkRhdGEuZGF0YS5pbnN0ICYmIGNvbmZpZ0JvdC50YWdzLmluc3QgIT0gY29uZmlndXJhdGlvbkRhdGEuZGF0YS5pbnN0ICYmIGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuaW5zdCAhPSBudWxsKQp7CiAgICBuZXdEZXBsb3ltZW50ID0gdHJ1ZTsKfQoKaWYgKG5ld0RlcGxveW1lbnQpCnsKICAgIGNvbnN0IHNpdGVPcmlnaW4gPSBuZXcgVVJMKGNvbmZpZ0JvdC50YWdzLnVybCkub3JpZ2luOwogICAgY29uc3QgdGFyZ2V0SW5zdCA9IGNvbmZpZ3VyYXRpb25EYXRhLmRhdGEuaW5zdCA/ICImaW5zdD0iICsgY29uZmlndXJhdGlvbkRhdGEuZGF0YS5pbnN0IDogIiI7CiAgICBjb25zdCB0YXJnZXRCaW9zID0gY29uZmlndXJhdGlvbkRhdGEuZGF0YS5iaW9zID8gIiZiaW9zPSIgKyBjb25maWd1cmF0aW9uRGF0YS5kYXRhLmJpb3MgOiAiIjsKICAgIGNvbnN0IHRhcmdldFBhdHRlcm4gPSBjb25maWdCb3QudGFncy5wYXR0ZXJuID8gIiZwYXR0ZXJuPSIgKyBjb25maWdCb3QudGFncy5wYXR0ZXJuIDogIiI7CiAgICBjb25zdCB0YXJnZXRVUkwgPSBzaXRlT3JpZ2luICsgYC8/YXNrPSR7Y29uZmlnQm90LnRhZ3MuYXNrfSR7dGFyZ2V0UGF0dGVybn0ke3RhcmdldEluc3R9JHt0YXJnZXRCaW9zfWA7CgogICAgb3MuZ29Ub1VSTCh0YXJnZXRVUkwpOwp9JwCNhqLWDaBqDWNoYW5uZWxMb2FkZXICBACNhqLWDbDiAijwn5SXYTliNmFhMGQtYjM1Ny00ZGU2LTliZWYtODUzNDhhYjFkMGUwJwCNhqLWDaBqCXByb3RvdHlwZQIEAI2GotYN1+ICLkB0aGlzQm90LmFiQ29yZU1lbnVBY3Rpb24oIk1ha2UgbWU6ICIgKyB0aGF0KTsnAI2GotYNoGoLcGVyc29uYWxpdHkCBACNhqLWDYbjAijwn5SXYjc2ZGZiYzQtODU0Yi00ZjZkLWE5MWYtYTk0ODY5NDc3NGRiJwCNhqLWDaBqBXV0aWxzAgQAjYai1g2t4wIo8J+UlzkzZDk2NWUwLWQyMGUtNGI0NS04Y2EwLTY0OTI3M2I3MTM4YycAjYai1g2gagZjcmVhdGUCBACNhqLWDdTjAijwn5SXMzRjM2MyMTAtNWJmMS00OWNmLWIxNTEtZWUyZDA3ZjBlNjczJwCNhqLWDaBqBWRlYnVnAgQAjYai1g374wIFZmFsc2UnAI2GotYNoGoPaW5wdXRTdWdnZXN0aW9uAgQAjYai1g2B5AL4A0Bjb25zdCBpbnB1dEJvdCA9IHRoYXQ/LmlucHV0Qm90Owpjb25zdCB0ZXh0ID0gdGhhdD8udGV4dDsKY29uc3QgYW5pbWF0ZSA9IHRoYXQ/LmFuaW1hdGUgPz8gdHJ1ZTsKCmFzc2VydChpbnB1dEJvdCwgYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBpbnB1dEJvdCBpcyBhIHJlcXVpcmVkIHBhcmFtZW10ZXIuYCk7CmFzc2VydCh0ZXh0LCBgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIHRleHQgaXMgYSByZXF1aXJlZCBwYXJhbWV0ZXIuYCk7CgppZiAoYW5pbWF0ZSkgewogICAgY29uc3QgY2hhcnMgPSBbLi4udGV4dF07CgogICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gY2hhcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBhd2FpdCBvcy5zbGVlcChtYXRoLnJhbmRvbSgyNSwgMTAwKSk7CiAgICAgICAgaW5wdXRCb3QudGFncy5tZW51SXRlbVRleHQgPSBjaGFycy5zbGljZSgwLCBpKS5qb2luKCcnKTsKICAgIH0KfQoKaW5wdXRCb3QudGFncy5tZW51SXRlbVRleHQgPSB0ZXh0OycAjYai1g2gahVpbnB1dFN1Z2dlc3Rpb25XYWl0TVMCBACNhqLWDfrnAgQzMDAwJwCNhqLWDaBqD3N1Z2dlc3Rpb25zQ29yZQIEAI2GotYN/+cC6wHwn6esWwogICAgIm1ha2UgbWUgYSByZWQgYm90IHRoYXQgd2hlbiBjbGlja2VkIHR1cm5zIGJsdWUiLAogICAgIm1ha2UgbWUgYSBib3QgdGhhdCB3aGVuIGNsaWNrZWQgbWFrZXMgZmlyZXdvcmtzIiwKICAgICJtYWtlIG1lIGEgYm90IHRoYXQgdG9hc3RzICdoZWxsbywgd29ybGQhJyB3aGVuIGNsaWNrZWQiLAogICAgIm1ha2UgbWUgMyBib3RzLCBhIHJlZCBvbmUsIGJsdWUgb25lLCBhbmQgZ3JlZW4gb25lIgpdJwCNhqLWDaBqDnN1Z2dlc3Rpb25zQm90AgQAjYai1g3p6QJ78J+nrFsKICAgICJjaGFuZ2UgdGhlIGNvbG9yIG9mIHRoaXMgYm90IHRvIHB1cnBsZSIsCiAgICAidHVybiB0aGlzIGJvdCBpbnRvIGEgc3BoZXJlIiwKICAgICJkb3VibGUgdGhlIHNjYWxlIG9mIHRoaXMgYm90IgpdJwCNhqLWDaBqF3N1Z2dlc3Rpb25zTXVsdGlwbGVCb3RzAgQAjYai1g3j6gKOAfCfp6xbCiAgICAiY2hhbmdlIGFsbCBvZiB0aGVzZSBib3RzIGNvbG9yIHRvIHB1cnBsZSIsCiAgICAidHVybiBhbGwgb2YgdGhlc2UgYm90cyBpbnRvIHNwaGVyZXMiLAogICAgImRvdWJsZSB0aGUgc2NhbGUgb2YgYWxsIG9mIHRoZXNlIGJvdHMiCl0nAI2GotYNoGoKdXVhYkxvYWRlcgIEAI2GotYN8OsCKPCflJdiODk4NmZhNi01NDNhLTQ4NjQtODZjMS00MjI1NzlhNWNiNjAnAQRib3RzJGY5ZmQ3ZTJlLTdjY2UtNDNmYi1iMjIzLWQzMmNiNDJiZWJlOAEnAI2GotYNl+wCBnN5c3RlbQIEAI2GotYNmOwCE2FiLmFjdGlvbi5jb2xvcl9ib3QnAI2GotYNl+wCBGZvcm0CBACNhqLWDazsAgdub3RoaW5nJwCNhqLWDZfsAghhYkFjdGlvbgIEAI2GotYNtOwCBHRydWUnAI2GotYNl+wCD2FiQm90TWVudUFjdGlvbgIEAI2GotYNuewCjgFAY29uc3QgdGFyZ2V0Qm90ID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJCb3RGb2N1czsKCm9zLnNob3dJbnB1dEZvclRhZyh0YXJnZXRCb3QsICJjb2xvciIsIHsKICAgIHR5cGU6ICdjb2xvcicsCiAgICB0aXRsZTogJ3BpY2sgYSBjb2xvcicKfSk7JwCNhqLWDZfsAg5hYkJvdE1lbnVMYWJlbAIEAI2GotYNyO0CBWNvbG9yJwCNhqLWDZfsAg1hYkJvdE1lbnVJY29uAgQAjYai1g3O7QIHcGFsZXR0ZScAjYai1g2X7AIIcmVtZW1iZXICBACNhqLWDdbtAijwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwCNhqLWDZfsAhJhYkJvdE1lbnVTb3J0T3JkZXICBACNhqLWDf3tAgEyJwCNhqLWDZfsAghhYklnbm9yZQIEAI2GotYN/+0CBHRydWUnAI2GotYNl+wCF2FiTXVsdGlwbGVCb3RNZW51QWN0aW9uAgQAjYai1g2E7gLiA0Bjb25zdCBhbGxUYXJnZXRCb3RzID0gbGlua3MucmVtZW1iZXIubGlua3MuYWJNdWx0aXBsZUJvdEZvY3VzOwpjb25zdCBidWlsZGVyID0gYWIubGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdCA/IGFiLmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QuaWQgOiBudWxsOwpjb25zdCByZWxldmFudFRhcmdldEJvdHMgPSBhbGxUYXJnZXRCb3RzLmZpbHRlcigodGFyZ2V0KSA9PiB0YXJnZXQuaWQgIT0gYnVpbGRlcik7CmNvbnN0IHNlbGVjdGVkQ29sb3IgPSBhd2FpdCBvcy5zaG93SW5wdXQobnVsbCwgewogICAgdHlwZTogJ2NvbG9yJywKICAgIHRpdGxlOiAncGljayBhIGNvbG9yJwp9KTsKCnNldFRhZyhyZWxldmFudFRhcmdldEJvdHMsICJjb2xvciIsIHNlbGVjdGVkQ29sb3IpOwoKYWIubG9nKGxpbmtzLnBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAiOiBvcGVuZWQgbXVsdGlwbGUgc2VsZWN0IHNoZWV0Iik7JwCNhqLWDZfsAhVhYk11bHRpcGxlQm90TWVudUljb24CBACNhqLWDefxAgdwYWxldHRlJwCNhqLWDZfsAhZhYk11bHRpcGxlQm90TWVudUxhYmVsAgQAjYai1g3v8QIFY29sb3InAI2GotYNl+wCGmFiTXVsdGlwbGVCb3RNZW51U29ydE9yZGVyAgQAjYai1g318QIBMScAjYai1g2X7AIJYWJWZXJzaW9uAgQAjYai1g338QIFMTAuMTYnAI2GotYNl+wCC3BlcnNvbmFsaXR5AgQAjYai1g398QIo8J+Ul2I3NmRmYmM0LTg1NGItNGY2ZC1hOTFmLWE5NDg2OTQ3NzRkYgA="}]}