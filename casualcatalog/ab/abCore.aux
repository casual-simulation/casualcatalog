{"version":2,"updates":[{"id":0,"timestamp":1752173845427,"update":"AUaxtIXoBQAnAQRib3RzJDY2NTdiODY1LWU5ODMtNDQwMS05ZmM5LWY1NDE4ZDE4YTdmNwEnALG0hegFABJhYkNvcmVNYWpvclZlcnNpb24CBACxtIXoBQECMTAnALG0hegFABJhYkNvcmVNaW5vclZlcnNpb24CBACxtIXoBQQBNCcAsbSF6AUABnN5c3RlbQIEALG0hegFBg1hYi5jb3JlLmxlYXJuJwCxtIXoBQAEYWJJRAIEALG0hegFFAVsZWFybicAsbSF6AUABGZvcm0CBACxtIXoBRoHbm90aGluZycAsbSF6AUABmFiQm9vdAIEALG0hegFIrIqQC8qKgoqIE1JVCBMaWNlbnNlCioKKiBDb3B5cmlnaHQgKGMpIDIwMTkgQ2FzdWFsIFNpbXVsYXRpb24sIEluYy4KKgoqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAoqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCiogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCiogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKgoqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbAoqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCioKKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgoqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAoqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRQoqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLAoqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFCiogU09GVFdBUkUuCiogQGxpY2Vuc2UgTUlUCiovCgovL2luc3QgbW9kZSAocGxheWVyIG9yIGJ1aWxkZXIpCmxldCBpbnN0TW9kZUNoZWNrID0gYXdhaXQgb3MudmVyc2lvbigpLnBsYXllck1vZGU7Ci8vY2hlY2sgc2VsZiBmb3IgaW5pdGlhbCBib290IGRhdGEKbGV0IGluaXRpYWxCb290ID0gbGlua3MucmVtZW1iZXIudGFncy5pbml0aWFsQm9vdCA/IHRydWUgOiBmYWxzZTsKLy9jaGVjayB1cmwgZm9yIHBvc3NpYmxlIGFiJ3MgdG8gbG9hZApsZXQgYm9vdEZsYWcgPSBjb25maWdCb3QudGFncy5wYXR0ZXJuID8gY29uZmlnQm90LnRhZ3MucGF0dGVybiA6IGNvbmZpZ0JvdC50YWdzLmFiOwovL2NoZWNrIGZvciBhc2sKbGV0IGFzayA9IGNvbmZpZ0JvdC50YWdzLmFzazsKLy9sb2dpbgpsZXQgc3RhdHVzID0gYXdhaXQgdGhpc0JvdC5sb2FkaW5nU3RhdHVzKCk7Ci8vc2VlZCAobm90IGFjdGl2ZWx5IHVzZWQgaGVyZSkKbGV0IHNlZWQgPSBjb25maWdCb3QudGFncy5zZWVkOwovL3Byb21wdApsZXQgcHJvbXB0ID0gY29uZmlnQm90LnRhZ3MucHJvbXB0OwovL2NoYW5uZWwKbGV0IGNoYW5uZWwgPSBjb25maWdCb3QudGFncy5jaGFubmVsOwovL3JlcXVlc3QgYXV0aCBib3QKYXdhaXQgb3MucmVxdWVzdEF1dGhCb3RJbkJhY2tncm91bmQoKTsKCi8vcmVkaXJlY3QgaWYgaW4gVVJMCmlmIChjb25maWdCb3QudGFncy5qb2luQ29kZSkgewogICAgdGhpc0JvdC5hYkpvaW5Ib3N0KHsgdGV4dDogY29uZmlnQm90LnRhZ3Muam9pbkNvZGUgfSk7Cn0KCi8vc3RhdHVzIGNsZWFuIHVwCmRlc3Ryb3koc3RhdHVzKTsKCi8vY2hlY2sgdGltZSBpZiBuZWVkZWQKaWYgKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJDb25kaXRpb24pIHsKICAgIGF3YWl0IGxpbmtzLnJlbWVtYmVyLmFiQ29uZGl0aW9uKCk7Cn0KCi8vaWYgbm8gc3R1ZGlvLCBzZXQgc3R1ZGlvCmlmIChhdXRoQm90ICYmICFjb25maWdCb3QudGFncy5zdHVkaW8pIHsKICAgIGNvbmZpZ0JvdC50YWdzLnN0dWRpbyA9IGF1dGhCb3QuaWQ7Cn0KCmlmIChhdXRoQm90KSB7CiAgICB0aGlzQm90LmFiTG9hZFN0dWRpb3MoKTsKfQoKLy9pbml0aWFsaXplIHJlbWVtYmVyIGdsb2JhbHMKZ2xvYmFsVGhpcy5hYkluc3RNZW1vcnkgPSBsaW5rcy5yZW1lbWJlcjsKZ2xvYmFsVGhpcy5hYlJlbWVtYmVyID0gbGlua3MucmVtZW1iZXI7Cmdsb2JhbFRoaXMuYWJQZXJzb25hbGl0eSA9IGxpbmtzLnBlcnNvbmFsaXR5OwoKaWYgKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlR3JpZFBvcnRhbENvbG9yKSB7CiAgICBncmlkUG9ydGFsQm90LnRhZ3MucG9ydGFsQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZUdyaWRQb3J0YWxDb2xvcjsKfQoKLy9UaGlzIGNoZWNrcyBmb3IgdGhlIGFwcHJvcHJpYXRlIGFycmF5IG9mIHNraWxscyBhbmQgaW5pdGlhbGl6ZXMgdGhlbQphd2FpdCB0aGlzQm90LmFiU2tpbGxJbml0aWFsaXphdGlvbihpbnN0TW9kZUNoZWNrKTsKCi8vaW5pdGlhbGl6aW5nIG9mIGdsb2JhbCB2YXJpYWJsZXMKZ2xvYmFsVGhpcy5idWlsZGVyVmVyc2lvbiA9IGluc3RNb2RlQ2hlY2sgPT0gImJ1aWxkZXIiID8gdHJ1ZSA6IGZhbHNlOwpnbG9iYWxUaGlzLmFiTG9uZ1Rlcm1NZW1vcnlTZWFyY2ggPSBsaW5rcy5zZWFyY2g7Cmdsb2JhbFRoaXMuYWJTZWFyY2ggPSBsaW5rcy5zZWFyY2g7Cmdsb2JhbFRoaXMuYWJQdWJsaXNoID0gbGlua3Muc3RvcmU7Cmdsb2JhbFRoaXMuYWJTdG9yZSA9IGxpbmtzLnN0b3JlOwpnbG9iYWxUaGlzLmFiID0gdGhpc0JvdDsKCi8vcG9wdWxhdGUgYm9vdGZsYWcgYWIKaWYgKGluaXRpYWxCb290ICYmIGJvb3RGbGFnKSB7CiAgICBhd2FpdCBsaW5rcy5zZWFyY2gub25Mb29rdXBBQkVnZ3MoeyBhYklEOiBib290RmxhZywgaW5pdGlhbEJvb3Q6IHRydWUsIGF1dG9IYXRjaDogdHJ1ZSB9KTsKfQoKY29uc3QgcGxheVN1YnNjcmlwdGlvbiA9ICFhdXRoQm90ID8gdHJ1ZSA6IGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIgPyB0cnVlIDogZmFsc2U7CgovL2xvb2t1cCBhc2tJRCBpZiBhdmFpbGFibGUKaWYgKGluaXRpYWxCb290ICYmIGFzaykgewogICAgaWYgKGFzayA9PSAiZWdnQ2FydG9uIiB8fCBhc2sgPT0gImNhc3VhbFR1dG9yaWFsIikgewogICAgICAgIGF3YWl0IHRoaXNCb3QuYWJBZGFwdChhc2spOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgYXdhaXQgdGhpc0JvdC5hYkFkYXB0KCJhYkFjdGlvbiIpOwoKICAgICAgICBsaW5rcy5hc2suYWJDb3JlTWVudUFjdGlvbihhc2spOwogICAgfQp9CgovL2NoZWNrIGZvciBjaGFubmVsIGlmIGNoYW5uZWxzIGFsbG93ZWQKaWYgKGluaXRpYWxCb290ICYmIGNoYW5uZWwgJiYgbGlua3MucmVtZW1iZXIudGFncy5hbGxvd0NoYW5uZWxzKSB7CiAgICBhd2FpdCB0aGlzQm90LmFiQWRhcHQoImFiQWN0aW9uIik7CgogICAgbGlua3MuYXNrLmFiQ29yZU1lbnVBY3Rpb24oIkAiICsgY2hhbm5lbCk7Cn0KCi8vbG9hZCBwZXJzb25hbCBjaGFubmVsIGJ5IGRlZmF1bHQgaWYgY2hhbm5lbHMgYWxsb3dlZCBhbmQgbm8gb3RoZXIgZmxhZ3MgcHJlc2VudAppZiAoaW5pdGlhbEJvb3QgJiYgIWNoYW5uZWwgJiYgIWFzayAmJiAhYm9vdEZsYWcgJiYgbGlua3MucmVtZW1iZXIudGFncy5hbGxvd0NoYW5uZWxzKSB7CiAgICBhd2FpdCB0aGlzQm90LmFiQWRhcHQoImFiQ2hhbm5lbCIpOwoKICAgIGF3YWl0IGxpbmtzLmNoYW5uZWwubG9hZFBlcnNvbmFsQ2hhbm5lbCgpOwp9CgovL2NoZWNrIGZvciBhcnRpZmFjdCBGSVgKaWYgKGNvbmZpZ0JvdC50YWdzLmFydGlmYWN0ICYmIGluaXRpYWxCb290ICYmICFhc2sgJiYgIWJvb3RGbGFnKSB7CiAgICBjb25zdCBhcnRpZmFjdCA9IGNvbmZpZ0JvdC50YWdzLmFydGlmYWN0OwogICAgY29uc3QgYXJ0SW5kZXggPSBhcnRpZmFjdC5pbmRleE9mKCJfYXJ0XyIpOwogICAgY29uc3Qgc3R1ZGlvID0gYXJ0aWZhY3Quc3Vic3RyaW5nKDAsIGFydEluZGV4KTsKICAgIGNvbnN0IHJlY29yZEFkZHJlc3MgPSBhcnRpZmFjdC5zdWJzdHJpbmcoYXJ0SW5kZXgpOwogICAgY29uc3QgcmVjb3JkRGF0YSA9IGF3YWl0IG9zLmdldERhdGEoc3R1ZGlvLCByZWNvcmRBZGRyZXNzKTsKICAgIGNvbnN0IGFza0lEID0gcmVjb3JkRGF0YS5kYXRhLnBhdHRlcm47CgogICAgYXdhaXQgdGhpc0JvdC5hYkFkYXB0KCJhYkFjdGlvbiIpOwoKICAgIGxpbmtzLmFzay5hYkNvcmVNZW51QWN0aW9uKGFza0lEKTsKfQoKLy93YWtlIHVwIGJ1aWxkZXIgaWYgc3Vic2NyaXB0aW9uIGlzIHJpZ2h0CmlmICgoaW5pdGlhbEJvb3QgJiYgIWJvb3RGbGFnICYmICFwbGF5U3Vic2NyaXB0aW9uICYmICFhc2spICYmICFjb25maWdCb3QudGFncy5hYlNsZWVwKSB7CiAgICBpZiAobGlua3MubWFuaWZlc3RhdGlvbikgewogICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24uYWJJbml0aWFsTWFuaWZlc3QoKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIGxpbmtzLmlucHV0Lm9uQ2hhdCh7IG1lc3NhZ2U6ICIuLiIgfSk7CiAgICB9Cn0KZWxzZSBpZiAobGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSA9PSAiYWItMSIgJiYgIWNvbmZpZ0JvdC50YWdzLmFiU2xlZXApIHsKICAgIGxpbmtzLmlucHV0Lm9uQ2hhdCh7IG1lc3NhZ2U6ICIuLiIgfSk7Cn0KCi8vc2V0IGluaXRpYWwgYm9vdCBkYXRhCmlmIChpbml0aWFsQm9vdCkgewogICAgc2V0VGFnTWFzayhsaW5rcy5yZW1lbWJlciwgJ2luaXRpYWxCb290JywgZmFsc2UsICdzaGFyZWQnKTsKCiAgICBpZiAobGlua3MucmVtZW1iZXIudGFncy5hYkluaXRpYWxpemF0aW9uQ29uZmlndXJhdGlvbikgewogICAgICAgIGxpbmtzLnJlbWVtYmVyLmFiSW5pdGlhbGl6YXRpb25Db25maWd1cmF0aW9uKCk7CiAgICB9Cn0KCi8vY2xlYW4gdXAgVVJMIHdpdGggdGFnUG9ydGFsCmlmIChjb25maWdCb3QudGFncy50YWdQb3J0YWwgJiYgIWNvbmZpZ0JvdC50YWdzLnRhZ1BvcnRhbEFuY2hvclBvaW50ICYmIGJ1aWxkZXJWZXJzaW9uKSB7CiAgICBjb25maWdCb3QudGFncy50YWdQb3J0YWwgPSBudWxsOwogICAgY29uZmlnQm90LnRhZ3MudGFnUG9ydGFsU3BhY2UgPSBudWxsOwp9CgovL3BhdXNlIGZvciBhYiBsb2FkaW5nCmF3YWl0IG9zLnNsZWVwKDUwMCk7CgovL2luaXRpYWxpemUgdGltZSBib3QKdGhpc0JvdC5hYlRpbWVyKCk7Cgphd2FpdCBhYlBlcnNvbmFsaXR5LnVwZGF0ZVBlcnNvbmFsaXR5KCk7Ci8vYXdhaXQgdGhpc0JvdC5idWlsZGVySWRlbnRpdHlfdXBkYXRlKCk7CgovL2luaXRpYWxpemF0aW9uIHNob3V0CnN1cGVyU2hvdXQoIm9uQUJJbml0aWFsaXplZCIsIHRhZ3MuYWJJbnN0KTsoALG0hegFAAZhYkNvcmUBeCcAsbSF6AUAB2FiQWRhcHQCBACxtIXoBdYq/gxAbGV0IHNraWxsTmFtZTsKbGV0IHNraWxsRGF0YTsKCmlmICh0eXBlb2YgdGhhdCA9PT0gJ3N0cmluZycpIHsKICAgIHNraWxsTmFtZSA9IHRoYXQ7CiAgICBza2lsbERhdGEgPSBudWxsOwp9IGVsc2UgaWYgKHR5cGVvZiB0aGF0ID09PSAnb2JqZWN0JykgewogICAgaWYgKHRoYXQuc3lzdGVtSUQpIHsKICAgICAgICBza2lsbE5hbWUgPSB0aGF0LnN5c3RlbUlEOwogICAgfSBlbHNlIGlmICh0aGF0LnNraWxsTmFtZSkgewogICAgICAgIHNraWxsTmFtZSA9IHRoYXQuc2tpbGxOYW1lOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gc2tpbGxOYW1lIGlzIGEgcmVxdWlyZWQgcGFyYW1ldGVyLmApOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBza2lsbERhdGEgPSB0aGF0LmRhdGEgPz8gbnVsbDsKfQoKdHJ5IHsKICAgIGNvbnN0IHVybCA9IHRoaXNCb3QuYWJCdWlsZENhc3VhbENhdGFsb2dVUkwoYC9hYi8ke3NraWxsTmFtZX0uYXV4YCk7CiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHdlYi5ob29rKHsgbWV0aG9kOiAiR0VUIiwgdXJsIH0pOwoKICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gQ291bGQgbm90IGRvd25sb2FkICR7c2tpbGxOYW1lfS4gUmVzcG9uc2U6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgbGV0IGJvdElkczsKCiAgICBpZiAocmVzcG9uc2UuZGF0YS52ZXJzaW9uID09PSAyKSB7CiAgICAgICAgLy8gQVVYIEZvcm1hdCBWZXJzaW9uIDIuCiAgICAgICAgY29uc3QgdXBkYXRlcyA9IHJlc3BvbnNlLmRhdGEudXBkYXRlczsKICAgICAgICBjb25zdCBzdGF0ZSA9IGF3YWl0IG9zLmdldEluc3RTdGF0ZUZyb21VcGRhdGVzKHVwZGF0ZXMpOwogICAgICAgIGF3YWl0IG9zLmFwcGx5VXBkYXRlc1RvSW5zdCh1cGRhdGVzKTsKCiAgICAgICAgYm90SWRzID0gT2JqZWN0LmtleXMoc3RhdGUpOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gQVVYIGZvcm1hdCB2ZXJzaW9uICR7cmVzcG9uc2UuZGF0YS52ZXJzaW9ufSBpcyBub3Qgc3VwcG9ydGVkLmApOwogICAgfQoKICAgIGlmIChib3RJZHMgJiYgYm90SWRzLmxlbmd0aCA+IDApIHsKICAgICAgICB3aGlzcGVyKGJvdElkcywgdGFnTmFtZSwgY29uZmlnQm90LnRhZ3MuaW5zdCk7CiAgICAgICAgd2hpc3Blcihib3RJZHMsICJvblNraWxsVXBkYXRlIiwgeyBkYXRhOiBza2lsbERhdGEgfSk7CiAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUuZXJyb3IoYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBObyBib3RzIGFwcGVhciB0byBoYXZlIGJlZW4gbG9hZGVkIHdpdGggJHtza2lsbE5hbWV9LmApOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKfSBjYXRjaCAoZSkgewogICAgY29uc29sZS5lcnJvcihlKTsKICAgIGNvbnNvbGUuZXJyb3IoYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBGYWlsZWQgdG8gZG93bmxvYWQgJHtza2lsbE5hbWV9LiBTZWUgYWJvdmUgZXJyb3IuYCk7CiAgICByZXR1cm4gZmFsc2U7Cn0nALG0hegFAAtkZXNjcmlwdGlvbgIEALG0hegF1TdPVGhpcyBza2lsbCBpcyBkZXNpZ25lZCB0byBoYW5kbGUgYm90aCByZWNvbmZpZ3VyYXRpb24gb2YgYWIgYW5kIGluaXRpYWxpemF0aW9uLicAsbSF6AUACm9uQm90QWRkZWQCBACxtIXoBaU42AFAY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBhYkNvcmUgU1RBUlQgVVBgKTsKCmlmICghbGlua3MucmVtZW1iZXIpIHsKICAgIGNvbnNvbGUuZXJyb3IoYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBDb3VsZCBub3QgZmluZCBhYkNvbmZpZyByZW1lbWJlciBib3QuYCk7Cn0KCnNldFRpbWVvdXQoKCkgPT4gdGhpc0JvdC5hYkJvb3QoKSwgNTAwKTsnALG0hegFAAhyZW1lbWJlcgIEALG0hegF/jko8J+Ul2U1MzgwYTZiLThiNGQtNGE4Yi04YjA0LTU4ZTFlYjAzZTVlNycAsbSF6AUAA2xvZwIEALG0hegFpTpsQC8vcGFzcyB0aHJvdWdoIGxvZyBkYXRhCmlmIChsaW5rcy5jb25zb2xlKSB7CiAgICBsaW5rcy5jb25zb2xlLmxvZyh0aGF0KTsKfQplbHNlIHsKICAgIGNvbnNvbGUubG9nKHRoYXQpOwp9JwCxtIXoBQANbWFuaWZlc3RhdGlvbgIEALG0hegFkjso8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcAsbSF6AUADGFiQ3JlYXRlSG9zdAIEALG0hegFuTuWCkBjb25zdCBzaXRlT3JpZ2luID0gbmV3IFVSTChjb25maWdCb3QudGFncy51cmwpLm9yaWdpbjsKCi8vdGhpcyBmdW5jdGlvbiBoYW5kbGVzIGNyZWF0aW5nIGEgZmlsZSBmb3Igam9pbiBjb2RlcwppZiAobGlua3MucmVtZW1iZXIudGFncy5ob3N0SUQpIHsKICAgIG9zLnRvYXN0KCJ1cmwgY29waWVkIHRvIGNsaXBib2FyZCIpOwoKICAgIG9zLnNldENsaXBib2FyZChzaXRlT3JpZ2luICsgIi8/am9pbkNvZGU9IiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuaG9zdElELnN1YnN0cmluZygwLCAzKSArICItIiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuaG9zdElELnN1YnN0cmluZygzKSk7CgogICAgcmV0dXJuOwp9CgppZiAoIWF1dGhCb3QpIHsKICAgIGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90KCk7Cn0KCmlmICghYXV0aEJvdCkgewogICAgb3MudG9hc3QoInBsZWFzZSBsb2cgaW4gdG8gZ2VuZXJhdGUgYSBqb2luIGNvZGUiKTsKICAgIHJldHVybjsKfQoKY29uc3QgbmV3SG9zdElEID0gdXVpZCgpLnJlcGxhY2VBbGwoIi0iLCAiIikuc3Vic3RyaW5nKDAsIDYpOwpjb25zdCBkYXRlID0gRGF0ZVRpbWUubm93KCkudG9NaWxsaXMoKTsKY29uc3QgcmVjb3JkS2V5ID0gbGlua3MucmVtZW1iZXIudGFncy5hYlJlY29yZEtleTsKY29uc3QgcmVjb3JkRGF0YSA9IGF3YWl0IG9zLnJlY29yZERhdGEocmVjb3JkS2V5LCBuZXdIb3N0SUQsIHsgdXJsOiBjb25maWdCb3QudGFncy51cmwsIGRhdGU6IGRhdGUsIG1hcmtlcnM6IFsicHVibGljUmVhZCJdIH0pOwoKaWYgKHJlY29yZERhdGEuc3VjY2VzcykgewogICAgc2V0VGFnTWFzayhsaW5rcy5yZW1lbWJlciwgJ2hvc3RJRCcsIG5ld0hvc3RJRC5zdWJzdHJpbmcoMCwgMykgKyAiLSIgKyBuZXdIb3N0SUQuc3Vic3RyaW5nKDMpLCAnc2hhcmVkJyk7CgogICAgY29uc3Qgam9pblVSTCA9IHNpdGVPcmlnaW4gKyAiLz9qb2luQ29kZT0iICsgbGlua3MucmVtZW1iZXIudGFncy5ob3N0SUQ7CgogICAgb3Muc2V0Q2xpcGJvYXJkKGpvaW5VUkwpOwoKICAgIHRoYXQudGFncy5sYWJlbCA9ICJqb2luIGNvZGU6ICIgKyBuZXdIb3N0SUQuc3Vic3RyaW5nKDAsIDMpICsgIi0iICsgbmV3SG9zdElELnN1YnN0cmluZygzKTsKCiAgICBvcy5zaG93UVJDb2RlKGpvaW5VUkwpOwoKICAgIG9zLnRvYXN0KCJob3N0IGdlbmVyYXRlZCwgdXJsIGNvcGllZCB0byBjbGlwYm9hcmQ6ICIgKyBuZXdIb3N0SUQpOwp9CmVsc2UgewogICAgb3MudG9hc3QoInNvbWV0aGluZyB3ZW50IHdyb25nLCBwbGVhc2UgdHJ5IGFnYWluIik7CgogICAgc2hvdXQoImFiTWVudVJlZnJlc2giKTsKfScAsbSF6AUACmFiSm9pbkhvc3QCBACxtIXoBdBF7gZALy9sb2dpYyBmb3IgdXNpbmcgYSBqb2luIGNvZGUgKGNoZWNrcyBmb3IgZXhpc3RpbmcgZmlsZXMpCnNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgpsZXQgZ2V0UmVjb3JkOwoKaWYgKHRoYXQuZGF0YSkgewogICAgZ2V0UmVjb3JkID0geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiB0aGF0LmRhdGEgfTsKfQplbHNlIHsKICAgIGNvbnN0IGpvaW5Db2RlID0gdGhhdC50ZXh0LnJlcGxhY2VBbGwoIi0iLCAiIik7CiAgICBjb25zdCByZWNvcmRLZXkgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiUmVjb3JkS2V5OwogICAgY29uc29sZS5sb2coIkpPSU5DT0RFIiwgam9pbkNvZGUpCiAgICBnZXRSZWNvcmQgPSBhd2FpdCBvcy5nZXREYXRhKHJlY29yZEtleSwgam9pbkNvZGUpOwp9CgppZiAoZ2V0UmVjb3JkLnN1Y2Nlc3MpIHsKICAgIGNvbnN0IGRhdGUgPSBEYXRlVGltZS5ub3coKTsKICAgIGxldCBjcmVhdGVEYXRlID0gRGF0ZVRpbWUuZnJvbU1pbGxpcyhnZXRSZWNvcmQuZGF0YS5kYXRlKTsKICAgIGxldCBkaWZmZXJlbmNlID0gZGF0ZS5kaWZmKGNyZWF0ZURhdGUsICJkYXlzIikudG9PYmplY3QoKTsKCiAgICBkaWZmZXJlbmNlID0gTWF0aC5mbG9vcihkaWZmZXJlbmNlLmRheXMpOwoKICAgIGlmIChkaWZmZXJlbmNlIDwgOCkgewogICAgICAgIG9zLnRvYXN0KCJqb2luaW5nIGhvc3Qgbm93Iik7CgogICAgICAgIG9zLmdvVG9VUkwoZ2V0UmVjb3JkLmRhdGEudXJsKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIG9zLnRvYXN0KCJqb2luIGNvZGUgb3V0IG9mIGRhdGUsIHBsZWFzZSBnZW5lcmF0ZSBhIG5ldyBqb2luIGNvZGUiKTsKICAgIH0KfQplbHNlIHsKICAgIG9zLnRvYXN0KCJjb2RlL2FiIGludmFsaWQsIHBsZWFzZSB0cnkgYWdhaW4iKTsKfScAsbSF6AUABnNlYXJjaAIEALG0hegFv0wo8J+Ul2Q4MzcxNDQ0LTkxNTgtNDQzNi04ZmM3LTg0Y2M5MWI3ZjUyNScAsbSF6AUACGFiSWdub3JlAgQAsbSF6AXmTAR0cnVlJwCxtIXoBQAEbWVudQIEALG0hegF60wo8J+Ul2IzMGM2YzVkLWE0ZjctNDI2Ni1iYTM4LTM5M2RjOTVlMWVjYicAsbSF6AUAFWFiU2tpbGxJbml0aWFsaXphdGlvbgIEALG0hegFkk3QAUAvL0ZpbmQgdGhlIGFwcHJvcHJpYXRlIGFycmF5IGFuZCBwb3B1bGF0ZSBza2lsbHMKbGV0IHNraWxsQXJyYXkgPSBsaW5rcy5yZW1lbWJlci50YWdzW3RoYXQgKyAiU2tpbGxBcnJheSJdOwoKZm9yIChsZXQgaSA9IDA7IGkgPCBza2lsbEFycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICBhd2FpdCB0aGlzQm90LmFiQWRhcHQoc2tpbGxBcnJheVtpXSk7Cn0KCnJldHVybjsnALG0hegFAAZiYW5uZXICBACxtIXoBeNOKPCflJdiNTUyZWFmOS1hOWQ2LTQxYzgtODUxNS1jYmQyYWJlYWFlNzMnALG0hegFAAVpbnB1dAIEALG0hegFik8o8J+Ul2Y4NjAyODc4LWMyZWYtNDhiZC04NWEwLThkNjM1MWViNDEyMCcAsbSF6AUADWxvYWRpbmdTdGF0dXMCBACxtIXoBbFPxgdAY29uZmlnQm90Lm1hc2tzLm1lbnVQb3J0YWwgPSAiYWJMb2FkU3RhdHVzIjsKCmxldCBzdGF0dXNCb3QgPSB7fTsKCnN0YXR1c0JvdC5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwpzdGF0dXNCb3QubGFiZWwgPSAidmVyaWZ5aW5nIGF1dGhCb3QiOwpzdGF0dXNCb3QubGFiZWxDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3I7CnN0YXR1c0JvdC5hYkxvYWRTdGF0dXMgPSB0cnVlOwpzdGF0dXNCb3QubWVudUl0ZW1TdHlsZSA9IHsgImJhY2tncm91bmQiOiAibm9uZSIgfTsKc3RhdHVzQm90LnRyYWNrTnVtID0gMDsKc3RhdHVzQm90Lm9uQ3JlYXRlID0gYEAKICAgIGlmICh0YWdzLnRyYWNrTnVtID09IDIpIHsKICAgICAgICB0YWdzLnRyYWNrTnVtID0gMDsKICAgIH0KICAgIGVsc2UgewogICAgICAgIHRhZ3MudHJhY2tOdW0rKzsKICAgIH0KCiAgICB0YWdzLmxhYmVsID0gdGFnc1sibGFiZWwiK3RhZ3MudHJhY2tOdW1dOwogICAgdGFncy5mb3JtQWRkcmVzcyA9IHRhZ3NbImZvcm0iK3RhZ3MudHJhY2tOdW1dOwoKICAgIHNldFRpbWVvdXQoKCkgPT4gd2hpc3Blcih0aGlzQm90LCAib25DcmVhdGUiKSwgNTAwKTtgOwpzdGF0dXNCb3QubGFiZWwwID0gInZlcmlmeWluZyBhdXRoQm90LiI7CnN0YXR1c0JvdC5sYWJlbDEgPSAidmVyaWZ5aW5nIGF1dGhCb3QuLiI7CnN0YXR1c0JvdC5sYWJlbDIgPSAidmVyaWZ5aW5nIGF1dGhCb3QuLi4iOwpzdGF0dXNCb3QuZm9ybTAgPSAiaG91cmdsYXNzX2JvdHRvbSI7CnN0YXR1c0JvdC5mb3JtMSA9ICJob3VyZ2xhc3NfdG9wIjsKc3RhdHVzQm90LmZvcm0yID0gImhvdXJnbGFzc19ib3R0b20iOwpzdGF0dXNCb3Qub25EZXN0cm95ID0gYEAKICAgIGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gbnVsbDsKYDsKCmxldCBjcmVhdGVkU3RhdHVzQm90ID0gY3JlYXRlKHN0YXR1c0JvdCk7CgpyZXR1cm4gY3JlYXRlZFN0YXR1c0JvdDsnALG0hegFAANhc2sCBACxtIXoBfhWKPCflJdlYzg1YzFkNi05ZjFhLTQwZDQtODJlMS01YmQ2ODAzNDljMjcnALG0hegFAA1hYkxvYWRTdHVkaW9zAgQAsbSF6AWfV1tAY29uc3QgdXNlclN0dWRpb3MgPSBhd2FpdCBvcy5saXN0VXNlclN0dWRpb3MoKTsKY29uZmlnQm90LnRhZ3MudXNlcl9zdHVkaW9zID0gdXNlclN0dWRpb3M7JwCxtIXoBQAHYWJUaW1lcgIEALG0hegF+1fBBkBpZiAoZ2V0Qm90KCJhYlRpbWVyIiwgdHJ1ZSkpIHsKICAgIHJldHVybjsKfQoKaWYgKCF0YWdzLmFiWFApIHsKICAgIHNldFRhZ01hc2sodGhpc0JvdCwgImFiWFAiLCAiMCIsICJsb2NhbCIpOwp9CgpsZXQgdGltZXJCb3QgPSB7fTsKCnRpbWVyQm90LnNwYWNlID0gInRlbXBMb2NhbCI7CnRpbWVyQm90Lm1hbmFnZXIgPSBnZXRMaW5rKHRoaXNCb3QpOwp0aW1lckJvdC5vbkNyZWF0ZSA9IGBACiAgICBtYXNrcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHRoaXNCb3Qub25UaW1lQ2hlY2soKSwgNjAwMDApOwpgOwp0aW1lckJvdC5hYlRpbWVyID0gdHJ1ZTsKdGltZXJCb3Qub25UaW1lQ2hlY2sgPSBgQAogICAgaWYgKHRhZ3Mubm90SWRsZSkgewogICAgICAgIHRhZ3Mubm90SWRsZSA9IGZhbHNlOwoKICAgICAgICAvL2NvbnNvbGUubG9nKCJYUCIsIGxpbmtzLm1hbmFnZXIudGFncy5hYlhQKTsKCiAgICAgICAgY29uc3QgdG90YWxYUCA9IGxpbmtzLm1hbmFnZXIudGFncy5hYlhQICsgMTsKCiAgICAgICAgc2V0VGFnTWFzayhsaW5rcy5tYW5hZ2VyLCAiYWJYUCIsIHRvdGFsWFAsICJsb2NhbCIpOwogICAgfQpgOwp0aW1lckJvdC5ub3RJZGxlID0gZmFsc2U7CnRpbWVyQm90Lm9uQW55QWN0aW9uID0gYEAKICAgIGlmICghdGFncy5ub3RJZGxlKSB7CiAgICAgICAgaWYgKHRoYXQuYWN0aW9uLmlkID09IGdyaWRQb3J0YWxCb3QuaWQpCiAgICAgICAgewogICAgICAgICAgICB0YWdzLm5vdElkbGUgPSB0cnVlOwogICAgICAgIH0KICAgIH0KYDsKCmxldCBhYlRpbWVyID0gY3JlYXRlKHRpbWVyQm90KTsKCmdsb2JhbFRoaXMuYWJUaW1lciA9IGFiVGltZXI7JwCxtIXoBQAFc3RvcmUCBACxtIXoBb1eKPCflJc3NmFmMDQ5MS0zOTE5LTQ5ODQtYWE4Mi0yMmM3NDJmNDI2M2YnALG0hegFAAxvbkluc3RKb2luZWQCBACxtIXoBeRe+QFAaWYgKCF0YWdzLmFiSW5zdCkgewogICAgY29uc3QgYWxsSW5zdHMgPSBjb25maWdCb3QudGFncy5pbnN0OwoKICAgIGxldCBhY3RpdmVJbnN0ID0gdGhhdC5pbnN0OwoKICAgIGlmIChBcnJheS5pc0FycmF5KGFsbEluc3RzKSkgewogICAgICAgIGFjdGl2ZUluc3QgPSBhbGxJbnN0c1thbGxJbnN0cy5sZW5ndGggLSAxXTsKICAgIH0KCiAgICBzZXRUYWdNYXNrKHRoaXNCb3QsICdhYkluc3QnLCBhY3RpdmVJbnN0LCAnc2hhcmVkJyk7Cn0nALG0hegFAAdjb25zb2xlAgQAsbSF6AXeYCjwn5SXMjRiN2U2NmYtMGQ1Yi00MDY0LWJmNDgtYjU2MmI5ZTZlM2ViJwCxtIXoBQAJYWJWZXJzaW9uAgQAsbSF6AWFYQQxMC40JwCxtIXoBQAUYnVpbGRlcklkZW50aXR5X3NhdmUCBACxtIXoBYphmwVAYXdhaXQgb3MucmVxdWVzdEF1dGhCb3QoKTsKCmNvbnN0IG5hbWUgPSB0aGF0Lm5hbWU7CmNvbnN0IHVzZXJSZWNvcmQgPSBhdXRoQm90LmlkOwpjb25zdCBlbmRwb2ludCA9IHRoYXQuZW5kcG9pbnQgPyB0aGF0LmVuZHBvaW50IDogbGlua3MucmVtZW1iZXIudGFncy5hYkVuZHBvaW50Owpjb25zdCByZWNvcmREYXRhID0geyBuYW1lOiBuYW1lIH07CmNvbnN0IHJlY29yZE5hbWUgPSAiYWJfbmFtZSI7CgpsZXQgaWRlbnRpdHlSZWNvcmRVcGRhdGUgPSBhd2FpdCBvcy5yZWNvcmREYXRhKHVzZXJSZWNvcmQsIHJlY29yZE5hbWUsIHJlY29yZERhdGEsIHsgZW5kcG9pbnQ6IGVuZHBvaW50IH0pOwoKaWYgKCFpZGVudGl0eVJlY29yZFVwZGF0ZS5zdWNjZXNzKSB7CiAgICBhd2FpdCBvcy5ncmFudEluc3RBZG1pblBlcm1pc3Npb24odXNlclJlY29yZCk7CgogICAgaWRlbnRpdHlSZWNvcmRVcGRhdGUgPSBhd2FpdCBvcy5yZWNvcmREYXRhKHVzZXJSZWNvcmQsIHJlY29yZE5hbWUsIHJlY29yZERhdGEsIHsgZW5kcG9pbnQ6IGVuZHBvaW50IH0pOwp9CgppZiAoIWlkZW50aXR5UmVjb3JkVXBkYXRlLnN1Y2Nlc3MpIHsKICAgIG9zLnRvYXN0KCJzb21ldGhpbmcgd2VudCB3cm9uZyB1cGRhdGluZyB0aGUgYnVpbGRlciBuYW1lIHJlY29yZCwgcGxlYXNlIHRyeSBhZ2FpbiIpOwp9JwCxtIXoBQAWYnVpbGRlcklkZW50aXR5X3VwZGF0ZQIEALG0hegFpmbqAUBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdEluQmFja2dyb3VuZCgpOwoKaWYgKCFhdXRoQm90Py5pZCkgcmV0dXJuOwoKY29uc3QgbmFtZURhdGEgPSBhd2FpdCBvcy5nZXREYXRhKGF1dGhCb3QuaWQsICJhYl9uYW1lIik7CgppZiAobmFtZURhdGEuc3VjY2VzcykgewogICAgc2V0VGFnTWFzayhsaW5rcy5yZW1lbWJlciwgJ2FiQnVpbGRlcklkZW50aXR5JywgbmFtZURhdGEuZGF0YS5uYW1lLCAnbG9jYWwnKTsKfScAsbSF6AUADGFiTG9hZENvbmZpZwIEALG0hegFkWiaBkBjb25zdCB1cmwgPSBuZXcgVVJMKG9zLmdldEFCMUJvb3RzdHJhcFVSTCgpKTsKdXJsLnBhdGhuYW1lID0gdXJsLnBhdGhuYW1lLnJlcGxhY2UoJ2FiMS5hdXgnLCAnYWJDb25maWcuYXV4Jyk7Cgp0cnkgewogICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB3ZWIuaG9vayh7IG1ldGhvZDogIkdFVCIsIHVybDogdXJsLmhyZWYgfSk7CgogICAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBDb3VsZCBub3QgZG93bmxvYWQgYWJDb25maWcuIFJlc3BvbnNlOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHVwZGF0ZXMgPSByZXNwb25zZS5kYXRhLnVwZGF0ZXM7CiAgICBhd2FpdCBvcy5hcHBseVVwZGF0ZXNUb0luc3QodXBkYXRlcyk7CgogICAgaWYgKGxpbmtzLnJlbWVtYmVyKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUuZXJyb3IoYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBMb2FkZWQgYWJDb25maWcgYXV4IGJ1dCBjb3VsZCBub3QgZmluZCByZW1lbWJlciBib3QuYCk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQp9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlLmVycm9yKGUpOwogICAgY29uc29sZS5lcnJvcihgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIEZhaWxlZCB0byBkb3dubG9hZCBhYkNvbmZpZy4gU2VlIGFib3ZlIGVycm9yLmApOwogICAgcmV0dXJuIGZhbHNlOwp9JwCxtIXoBQAXYWJCdWlsZENhc3VhbENhdGFsb2dVUkwCBACxtIXoBaxu/wFAY29uc3QgcmVsYXRpdmVQYXRoID0gdGhhdDsKCmNvbnN0IHVybCA9IG5ldyBVUkwobGlua3MucmVtZW1iZXIudGFncy5jYXN1YWxDYXRhbG9nVVJMKTsKY29uc3QgZW52ID0gbGlua3MucmVtZW1iZXIudGFncy5jYXN1YWxDYXRhbG9nRW52OwoKdXJsLnBhdGhuYW1lID0gcmVsYXRpdmVQYXRoOwoKaWYgKGVudiAmJiBlbnYgIT09ICdwcm9kJykgewogICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoJ2VudicsIGVudik7Cn0KCnJldHVybiB1cmwuaHJlZjsnALG0hegFAAdjaGFubmVsAgQAsbSF6AWscCjwn5SXYTE2ZDNhNDYtOWIwNy00ZDZiLTk4MmUtMTlmZGM5NTNkYjI1JwCxtIXoBQALcGVyc29uYWxpdHkCBACxtIXoBdNwKPCflJdiNzZkZmJjNC04NTRiLTRmNmQtYTkxZi1hOTQ4Njk0Nzc0ZGIA"}]}