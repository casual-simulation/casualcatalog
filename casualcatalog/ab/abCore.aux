{"version":2,"updates":[{"id":0,"timestamp":1751566579774,"update":"AUSpvNCiCQAnAQRib3RzJDY2NTdiODY1LWU5ODMtNDQwMS05ZmM5LWY1NDE4ZDE4YTdmNwEnAKm80KIJABJhYkNvcmVNYWpvclZlcnNpb24CBACpvNCiCQECMTAnAKm80KIJABJhYkNvcmVNaW5vclZlcnNpb24CBACpvNCiCQQBNCcAqbzQogkABnN5c3RlbQIEAKm80KIJBg1hYi5jb3JlLmxlYXJuJwCpvNCiCQAEYWJJRAIEAKm80KIJFAVsZWFybicAqbzQogkABGZvcm0CBACpvNCiCRoHbm90aGluZycAqbzQogkABmFiQm9vdAIEAKm80KIJItkpQC8qKgoqIE1JVCBMaWNlbnNlCioKKiBDb3B5cmlnaHQgKGMpIDIwMTkgQ2FzdWFsIFNpbXVsYXRpb24sIEluYy4KKgoqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAoqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCiogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCiogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKgoqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbAoqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCioKKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgoqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAoqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRQoqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLAoqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFCiogU09GVFdBUkUuCiogQGxpY2Vuc2UgTUlUCiovCgovL2luc3QgbW9kZSAocGxheWVyIG9yIGJ1aWxkZXIpCmxldCBpbnN0TW9kZUNoZWNrID0gYXdhaXQgb3MudmVyc2lvbigpLnBsYXllck1vZGU7Ci8vY2hlY2sgc2VsZiBmb3IgaW5pdGlhbCBib290IGRhdGEKbGV0IGluaXRpYWxCb290ID0gbGlua3MucmVtZW1iZXIudGFncy5pbml0aWFsQm9vdCA/IHRydWUgOiBmYWxzZTsKLy9jaGVjayB1cmwgZm9yIHBvc3NpYmxlIGFiJ3MgdG8gbG9hZApsZXQgYm9vdEZsYWcgPSBjb25maWdCb3QudGFncy5wYXR0ZXJuID8gY29uZmlnQm90LnRhZ3MucGF0dGVybiA6IGNvbmZpZ0JvdC50YWdzLmFiOwovL2NoZWNrIGZvciBhc2sKbGV0IGFzayA9IGNvbmZpZ0JvdC50YWdzLmFzazsKLy9sb2dpbgpsZXQgc3RhdHVzID0gYXdhaXQgdGhpc0JvdC5sb2FkaW5nU3RhdHVzKCk7Ci8vc2VlZCAobm90IGFjdGl2ZWx5IHVzZWQgaGVyZSkKbGV0IHNlZWQgPSBjb25maWdCb3QudGFncy5zZWVkOwovL3Byb21wdApsZXQgcHJvbXB0ID0gY29uZmlnQm90LnRhZ3MucHJvbXB0OwovL2NoYW5uZWwKbGV0IGNoYW5uZWwgPSBjb25maWdCb3QudGFncy5jaGFubmVsOwovL3JlcXVlc3QgYXV0aCBib3QKYXdhaXQgb3MucmVxdWVzdEF1dGhCb3RJbkJhY2tncm91bmQoKTsKCi8vcmVkaXJlY3QgaWYgaW4gVVJMCmlmIChjb25maWdCb3QudGFncy5qb2luQ29kZSkgewogICAgdGhpc0JvdC5hYkpvaW5Ib3N0KHsgdGV4dDogY29uZmlnQm90LnRhZ3Muam9pbkNvZGUgfSk7Cn0KCi8vc3RhdHVzIGNsZWFuIHVwCmRlc3Ryb3koc3RhdHVzKTsKCi8vY2hlY2sgdGltZSBpZiBuZWVkZWQKaWYgKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJDb25kaXRpb24pIHsKICAgIGF3YWl0IGxpbmtzLnJlbWVtYmVyLmFiQ29uZGl0aW9uKCk7Cn0KCi8vaWYgbm8gc3R1ZGlvLCBzZXQgc3R1ZGlvCmlmIChhdXRoQm90ICYmICFjb25maWdCb3QudGFncy5zdHVkaW8pIHsKICAgIGNvbmZpZ0JvdC50YWdzLnN0dWRpbyA9IGF1dGhCb3QuaWQ7Cn0KCmlmIChhdXRoQm90KSB7CiAgICB0aGlzQm90LmFiTG9hZFN0dWRpb3MoKTsKfQoKLy9pbml0aWFsaXplIHJlbWVtYmVyIGdsb2JhbHMKZ2xvYmFsVGhpcy5hYkluc3RNZW1vcnkgPSBsaW5rcy5yZW1lbWJlcjsKZ2xvYmFsVGhpcy5hYlJlbWVtYmVyID0gbGlua3MucmVtZW1iZXI7CgppZiAobGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VHcmlkUG9ydGFsQ29sb3IpIHsKICAgIGdyaWRQb3J0YWxCb3QudGFncy5wb3J0YWxDb2xvciA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlR3JpZFBvcnRhbENvbG9yOwp9CgovL1RoaXMgY2hlY2tzIGZvciB0aGUgYXBwcm9wcmlhdGUgYXJyYXkgb2Ygc2tpbGxzIGFuZCBpbml0aWFsaXplcyB0aGVtCmF3YWl0IHRoaXNCb3QuYWJTa2lsbEluaXRpYWxpemF0aW9uKGluc3RNb2RlQ2hlY2spOwoKLy9pbml0aWFsaXppbmcgb2YgZ2xvYmFsIHZhcmlhYmxlcwpnbG9iYWxUaGlzLmJ1aWxkZXJWZXJzaW9uID0gaW5zdE1vZGVDaGVjayA9PSAiYnVpbGRlciIgPyB0cnVlIDogZmFsc2U7Cmdsb2JhbFRoaXMuYWJMb25nVGVybU1lbW9yeVNlYXJjaCA9IGxpbmtzLnNlYXJjaDsKZ2xvYmFsVGhpcy5hYlNlYXJjaCA9IGxpbmtzLnNlYXJjaDsKZ2xvYmFsVGhpcy5hYlB1Ymxpc2ggPSBsaW5rcy5zdG9yZTsKZ2xvYmFsVGhpcy5hYlN0b3JlID0gbGlua3Muc3RvcmU7Cmdsb2JhbFRoaXMuYWIgPSB0aGlzQm90OwoKLy9wb3B1bGF0ZSBib290ZmxhZyBhYgppZiAoaW5pdGlhbEJvb3QgJiYgYm9vdEZsYWcpIHsKICAgIGF3YWl0IGxpbmtzLnNlYXJjaC5vbkxvb2t1cEFCRWdncyh7IGFiSUQ6IGJvb3RGbGFnLCBpbml0aWFsQm9vdDogdHJ1ZSwgYXV0b0hhdGNoOiB0cnVlIH0pOwp9Cgpjb25zdCBwbGF5U3Vic2NyaXB0aW9uID0gIWF1dGhCb3QgPyB0cnVlIDogYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gIkZyZWVQbGF5IiA/IHRydWUgOiBmYWxzZTsKCi8vbG9va3VwIGFza0lEIGlmIGF2YWlsYWJsZQppZiAoaW5pdGlhbEJvb3QgJiYgYXNrKSB7CiAgICBpZiAoYXNrID09ICJlZ2dDYXJ0b24iIHx8IGFzayA9PSAiY2FzdWFsVHV0b3JpYWwiKSB7CiAgICAgICAgYXdhaXQgdGhpc0JvdC5hYkFkYXB0KGFzayk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBhd2FpdCB0aGlzQm90LmFiQWRhcHQoImFiQWN0aW9uIik7CgogICAgICAgIGxpbmtzLmFzay5hYkNvcmVNZW51QWN0aW9uKGFzayk7CiAgICB9Cn0KCi8vY2hlY2sgZm9yIGNoYW5uZWwgaWYgY2hhbm5lbHMgYWxsb3dlZAppZiAoaW5pdGlhbEJvb3QgJiYgY2hhbm5lbCAmJiBsaW5rcy5yZW1lbWJlci50YWdzLmFsbG93Q2hhbm5lbHMpIHsKICAgIGF3YWl0IHRoaXNCb3QuYWJBZGFwdCgiYWJBY3Rpb24iKTsKCiAgICBsaW5rcy5hc2suYWJDb3JlTWVudUFjdGlvbigiQCIgKyBjaGFubmVsKTsKfQoKLy9sb2FkIHBlcnNvbmFsIGNoYW5uZWwgYnkgZGVmYXVsdCBpZiBjaGFubmVscyBhbGxvd2VkIGFuZCBubyBvdGhlciBmbGFncyBwcmVzZW50CmlmIChpbml0aWFsQm9vdCAmJiAhY2hhbm5lbCAmJiAhYXNrICYmICFib290RmxhZyAmJiBsaW5rcy5yZW1lbWJlci50YWdzLmFsbG93Q2hhbm5lbHMpIHsKICAgIGF3YWl0IHRoaXNCb3QuYWJBZGFwdCgiYWJDaGFubmVsIik7CgogICAgYXdhaXQgbGlua3MuY2hhbm5lbC5sb2FkUGVyc29uYWxDaGFubmVsKCk7Cn0KCi8vY2hlY2sgZm9yIGFydGlmYWN0IEZJWAppZiAoY29uZmlnQm90LnRhZ3MuYXJ0aWZhY3QgJiYgaW5pdGlhbEJvb3QgJiYgIWFzayAmJiAhYm9vdEZsYWcpIHsKICAgIGNvbnN0IGFydGlmYWN0ID0gY29uZmlnQm90LnRhZ3MuYXJ0aWZhY3Q7CiAgICBjb25zdCBhcnRJbmRleCA9IGFydGlmYWN0LmluZGV4T2YoIl9hcnRfIik7CiAgICBjb25zdCBzdHVkaW8gPSBhcnRpZmFjdC5zdWJzdHJpbmcoMCwgYXJ0SW5kZXgpOwogICAgY29uc3QgcmVjb3JkQWRkcmVzcyA9IGFydGlmYWN0LnN1YnN0cmluZyhhcnRJbmRleCk7CiAgICBjb25zdCByZWNvcmREYXRhID0gYXdhaXQgb3MuZ2V0RGF0YShzdHVkaW8sIHJlY29yZEFkZHJlc3MpOwogICAgY29uc3QgYXNrSUQgPSByZWNvcmREYXRhLmRhdGEucGF0dGVybjsKCiAgICBhd2FpdCB0aGlzQm90LmFiQWRhcHQoImFiQWN0aW9uIik7CgogICAgbGlua3MuYXNrLmFiQ29yZU1lbnVBY3Rpb24oYXNrSUQpOwp9CgovL3dha2UgdXAgYnVpbGRlciBpZiBzdWJzY3JpcHRpb24gaXMgcmlnaHQKaWYgKChpbml0aWFsQm9vdCAmJiAhYm9vdEZsYWcgJiYgIXBsYXlTdWJzY3JpcHRpb24gJiYgIWFzaykgJiYgIWNvbmZpZ0JvdC50YWdzLmFiU2xlZXApIHsKICAgIGlmIChsaW5rcy5tYW5pZmVzdGF0aW9uKSB7CiAgICAgICAgbGlua3MubWFuaWZlc3RhdGlvbi5hYkluaXRpYWxNYW5pZmVzdCgpOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgbGlua3MuaW5wdXQub25DaGF0KHsgbWVzc2FnZTogIi4uIiB9KTsKICAgIH0KfQplbHNlIGlmIChsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ID09ICJhYi0xIiAmJiAhY29uZmlnQm90LnRhZ3MuYWJTbGVlcCkgewogICAgbGlua3MuaW5wdXQub25DaGF0KHsgbWVzc2FnZTogIi4uIiB9KTsKfQoKLy9zZXQgaW5pdGlhbCBib290IGRhdGEKaWYgKGluaXRpYWxCb290KSB7CiAgICBzZXRUYWdNYXNrKGxpbmtzLnJlbWVtYmVyLCAnaW5pdGlhbEJvb3QnLCBmYWxzZSwgJ3NoYXJlZCcpOwoKICAgIGlmIChsaW5rcy5yZW1lbWJlci50YWdzLmFiSW5pdGlhbGl6YXRpb25Db25maWd1cmF0aW9uKSB7CiAgICAgICAgbGlua3MucmVtZW1iZXIuYWJJbml0aWFsaXphdGlvbkNvbmZpZ3VyYXRpb24oKTsKICAgIH0KfQoKLy9jbGVhbiB1cCBVUkwgd2l0aCB0YWdQb3J0YWwKaWYgKGNvbmZpZ0JvdC50YWdzLnRhZ1BvcnRhbCAmJiAhY29uZmlnQm90LnRhZ3MudGFnUG9ydGFsQW5jaG9yUG9pbnQgJiYgYnVpbGRlclZlcnNpb24pIHsKICAgIGNvbmZpZ0JvdC50YWdzLnRhZ1BvcnRhbCA9IG51bGw7CiAgICBjb25maWdCb3QudGFncy50YWdQb3J0YWxTcGFjZSA9IG51bGw7Cn0KCi8vcGF1c2UgZm9yIGFiIGxvYWRpbmcKYXdhaXQgb3Muc2xlZXAoNTAwKTsKCi8vaW5pdGlhbGl6ZSB0aW1lIGJvdAp0aGlzQm90LmFiVGltZXIoKTsKCmF3YWl0IHRoaXNCb3QuYnVpbGRlcklkZW50aXR5X3VwZGF0ZSgpOwoKLy9pbml0aWFsaXphdGlvbiBzaG91dApzdXBlclNob3V0KCJvbkFCSW5pdGlhbGl6ZWQiLCB0YWdzLmFiSW5zdCk7KACpvNCiCQAGYWJDb3JlAXgnAKm80KIJAAdhYkFkYXB0AgQAqbzQogn9Kf4MQGxldCBza2lsbE5hbWU7CmxldCBza2lsbERhdGE7CgppZiAodHlwZW9mIHRoYXQgPT09ICdzdHJpbmcnKSB7CiAgICBza2lsbE5hbWUgPSB0aGF0OwogICAgc2tpbGxEYXRhID0gbnVsbDsKfSBlbHNlIGlmICh0eXBlb2YgdGhhdCA9PT0gJ29iamVjdCcpIHsKICAgIGlmICh0aGF0LnN5c3RlbUlEKSB7CiAgICAgICAgc2tpbGxOYW1lID0gdGhhdC5zeXN0ZW1JRDsKICAgIH0gZWxzZSBpZiAodGhhdC5za2lsbE5hbWUpIHsKICAgICAgICBza2lsbE5hbWUgPSB0aGF0LnNraWxsTmFtZTsKICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5lcnJvcihgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIHNraWxsTmFtZSBpcyBhIHJlcXVpcmVkIHBhcmFtZXRlci5gKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgc2tpbGxEYXRhID0gdGhhdC5kYXRhID8/IG51bGw7Cn0KCnRyeSB7CiAgICBjb25zdCB1cmwgPSB0aGlzQm90LmFiQnVpbGRDYXN1YWxDYXRhbG9nVVJMKGAvYWIvJHtza2lsbE5hbWV9LmF1eGApOwogICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB3ZWIuaG9vayh7IG1ldGhvZDogIkdFVCIsIHVybCB9KTsKCiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIENvdWxkIG5vdCBkb3dubG9hZCAke3NraWxsTmFtZX0uIFJlc3BvbnNlOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBib3RJZHM7CgogICAgaWYgKHJlc3BvbnNlLmRhdGEudmVyc2lvbiA9PT0gMikgewogICAgICAgIC8vIEFVWCBGb3JtYXQgVmVyc2lvbiAyLgogICAgICAgIGNvbnN0IHVwZGF0ZXMgPSByZXNwb25zZS5kYXRhLnVwZGF0ZXM7CiAgICAgICAgY29uc3Qgc3RhdGUgPSBhd2FpdCBvcy5nZXRJbnN0U3RhdGVGcm9tVXBkYXRlcyh1cGRhdGVzKTsKICAgICAgICBhd2FpdCBvcy5hcHBseVVwZGF0ZXNUb0luc3QodXBkYXRlcyk7CgogICAgICAgIGJvdElkcyA9IE9iamVjdC5rZXlzKHN0YXRlKTsKICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5lcnJvcihgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIEFVWCBmb3JtYXQgdmVyc2lvbiAke3Jlc3BvbnNlLmRhdGEudmVyc2lvbn0gaXMgbm90IHN1cHBvcnRlZC5gKTsKICAgIH0KCiAgICBpZiAoYm90SWRzICYmIGJvdElkcy5sZW5ndGggPiAwKSB7CiAgICAgICAgd2hpc3Blcihib3RJZHMsIHRhZ05hbWUsIGNvbmZpZ0JvdC50YWdzLmluc3QpOwogICAgICAgIHdoaXNwZXIoYm90SWRzLCAib25Ta2lsbFVwZGF0ZSIsIHsgZGF0YTogc2tpbGxEYXRhIH0pOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gTm8gYm90cyBhcHBlYXIgdG8gaGF2ZSBiZWVuIGxvYWRlZCB3aXRoICR7c2tpbGxOYW1lfS5gKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcmV0dXJuIHRydWU7Cn0gY2F0Y2ggKGUpIHsKICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICBjb25zb2xlLmVycm9yKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gRmFpbGVkIHRvIGRvd25sb2FkICR7c2tpbGxOYW1lfS4gU2VlIGFib3ZlIGVycm9yLmApOwogICAgcmV0dXJuIGZhbHNlOwp9JwCpvNCiCQALZGVzY3JpcHRpb24CBACpvNCiCfw2T1RoaXMgc2tpbGwgaXMgZGVzaWduZWQgdG8gaGFuZGxlIGJvdGggcmVjb25maWd1cmF0aW9uIG9mIGFiIGFuZCBpbml0aWFsaXphdGlvbi4nAKm80KIJAApvbkJvdEFkZGVkAgQAqbzQognMN9gBQGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gYWJDb3JlIFNUQVJUIFVQYCk7CgppZiAoIWxpbmtzLnJlbWVtYmVyKSB7CiAgICBjb25zb2xlLmVycm9yKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gQ291bGQgbm90IGZpbmQgYWJDb25maWcgcmVtZW1iZXIgYm90LmApOwp9CgpzZXRUaW1lb3V0KCgpID0+IHRoaXNCb3QuYWJCb290KCksIDUwMCk7JwCpvNCiCQAIcmVtZW1iZXICBACpvNCiCaU5KPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAKm80KIJAANsb2cCBACpvNCiCcw5bEAvL3Bhc3MgdGhyb3VnaCBsb2cgZGF0YQppZiAobGlua3MuY29uc29sZSkgewogICAgbGlua3MuY29uc29sZS5sb2codGhhdCk7Cn0KZWxzZSB7CiAgICBjb25zb2xlLmxvZyh0aGF0KTsKfScAqbzQogkADW1hbmlmZXN0YXRpb24CBACpvNCiCbk6KPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAKm80KIJAAxhYkNyZWF0ZUhvc3QCBACpvNCiCeA6lgpAY29uc3Qgc2l0ZU9yaWdpbiA9IG5ldyBVUkwoY29uZmlnQm90LnRhZ3MudXJsKS5vcmlnaW47CgovL3RoaXMgZnVuY3Rpb24gaGFuZGxlcyBjcmVhdGluZyBhIGZpbGUgZm9yIGpvaW4gY29kZXMKaWYgKGxpbmtzLnJlbWVtYmVyLnRhZ3MuaG9zdElEKSB7CiAgICBvcy50b2FzdCgidXJsIGNvcGllZCB0byBjbGlwYm9hcmQiKTsKCiAgICBvcy5zZXRDbGlwYm9hcmQoc2l0ZU9yaWdpbiArICIvP2pvaW5Db2RlPSIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmhvc3RJRC5zdWJzdHJpbmcoMCwgMykgKyAiLSIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmhvc3RJRC5zdWJzdHJpbmcoMykpOwoKICAgIHJldHVybjsKfQoKaWYgKCFhdXRoQm90KSB7CiAgICBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdCgpOwp9CgppZiAoIWF1dGhCb3QpIHsKICAgIG9zLnRvYXN0KCJwbGVhc2UgbG9nIGluIHRvIGdlbmVyYXRlIGEgam9pbiBjb2RlIik7CiAgICByZXR1cm47Cn0KCmNvbnN0IG5ld0hvc3RJRCA9IHV1aWQoKS5yZXBsYWNlQWxsKCItIiwgIiIpLnN1YnN0cmluZygwLCA2KTsKY29uc3QgZGF0ZSA9IERhdGVUaW1lLm5vdygpLnRvTWlsbGlzKCk7CmNvbnN0IHJlY29yZEtleSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJSZWNvcmRLZXk7CmNvbnN0IHJlY29yZERhdGEgPSBhd2FpdCBvcy5yZWNvcmREYXRhKHJlY29yZEtleSwgbmV3SG9zdElELCB7IHVybDogY29uZmlnQm90LnRhZ3MudXJsLCBkYXRlOiBkYXRlLCBtYXJrZXJzOiBbInB1YmxpY1JlYWQiXSB9KTsKCmlmIChyZWNvcmREYXRhLnN1Y2Nlc3MpIHsKICAgIHNldFRhZ01hc2sobGlua3MucmVtZW1iZXIsICdob3N0SUQnLCBuZXdIb3N0SUQuc3Vic3RyaW5nKDAsIDMpICsgIi0iICsgbmV3SG9zdElELnN1YnN0cmluZygzKSwgJ3NoYXJlZCcpOwoKICAgIGNvbnN0IGpvaW5VUkwgPSBzaXRlT3JpZ2luICsgIi8/am9pbkNvZGU9IiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuaG9zdElEOwoKICAgIG9zLnNldENsaXBib2FyZChqb2luVVJMKTsKCiAgICB0aGF0LnRhZ3MubGFiZWwgPSAiam9pbiBjb2RlOiAiICsgbmV3SG9zdElELnN1YnN0cmluZygwLCAzKSArICItIiArIG5ld0hvc3RJRC5zdWJzdHJpbmcoMyk7CgogICAgb3Muc2hvd1FSQ29kZShqb2luVVJMKTsKCiAgICBvcy50b2FzdCgiaG9zdCBnZW5lcmF0ZWQsIHVybCBjb3BpZWQgdG8gY2xpcGJvYXJkOiAiICsgbmV3SG9zdElEKTsKfQplbHNlIHsKICAgIG9zLnRvYXN0KCJzb21ldGhpbmcgd2VudCB3cm9uZywgcGxlYXNlIHRyeSBhZ2FpbiIpOwoKICAgIHNob3V0KCJhYk1lbnVSZWZyZXNoIik7Cn0nAKm80KIJAAphYkpvaW5Ib3N0AgQAqbzQogn3RO4GQC8vbG9naWMgZm9yIHVzaW5nIGEgam9pbiBjb2RlIChjaGVja3MgZm9yIGV4aXN0aW5nIGZpbGVzKQpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGV0IGdldFJlY29yZDsKCmlmICh0aGF0LmRhdGEpIHsKICAgIGdldFJlY29yZCA9IHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogdGhhdC5kYXRhIH07Cn0KZWxzZSB7CiAgICBjb25zdCBqb2luQ29kZSA9IHRoYXQudGV4dC5yZXBsYWNlQWxsKCItIiwgIiIpOwogICAgY29uc3QgcmVjb3JkS2V5ID0gbGlua3MucmVtZW1iZXIudGFncy5hYlJlY29yZEtleTsKICAgIGNvbnNvbGUubG9nKCJKT0lOQ09ERSIsIGpvaW5Db2RlKQogICAgZ2V0UmVjb3JkID0gYXdhaXQgb3MuZ2V0RGF0YShyZWNvcmRLZXksIGpvaW5Db2RlKTsKfQoKaWYgKGdldFJlY29yZC5zdWNjZXNzKSB7CiAgICBjb25zdCBkYXRlID0gRGF0ZVRpbWUubm93KCk7CiAgICBsZXQgY3JlYXRlRGF0ZSA9IERhdGVUaW1lLmZyb21NaWxsaXMoZ2V0UmVjb3JkLmRhdGEuZGF0ZSk7CiAgICBsZXQgZGlmZmVyZW5jZSA9IGRhdGUuZGlmZihjcmVhdGVEYXRlLCAiZGF5cyIpLnRvT2JqZWN0KCk7CgogICAgZGlmZmVyZW5jZSA9IE1hdGguZmxvb3IoZGlmZmVyZW5jZS5kYXlzKTsKCiAgICBpZiAoZGlmZmVyZW5jZSA8IDgpIHsKICAgICAgICBvcy50b2FzdCgiam9pbmluZyBob3N0IG5vdyIpOwoKICAgICAgICBvcy5nb1RvVVJMKGdldFJlY29yZC5kYXRhLnVybCk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvcy50b2FzdCgiam9pbiBjb2RlIG91dCBvZiBkYXRlLCBwbGVhc2UgZ2VuZXJhdGUgYSBuZXcgam9pbiBjb2RlIik7CiAgICB9Cn0KZWxzZSB7CiAgICBvcy50b2FzdCgiY29kZS9hYiBpbnZhbGlkLCBwbGVhc2UgdHJ5IGFnYWluIik7Cn0nAKm80KIJAAZzZWFyY2gCBACpvNCiCeZLKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAKm80KIJAAhhYklnbm9yZQIEAKm80KIJjUwEdHJ1ZScAqbzQogkABG1lbnUCBACpvNCiCZJMKPCflJdiMzBjNmM1ZC1hNGY3LTQyNjYtYmEzOC0zOTNkYzk1ZTFlY2InAKm80KIJABVhYlNraWxsSW5pdGlhbGl6YXRpb24CBACpvNCiCblM0AFALy9GaW5kIHRoZSBhcHByb3ByaWF0ZSBhcnJheSBhbmQgcG9wdWxhdGUgc2tpbGxzCmxldCBza2lsbEFycmF5ID0gbGlua3MucmVtZW1iZXIudGFnc1t0aGF0ICsgIlNraWxsQXJyYXkiXTsKCmZvciAobGV0IGkgPSAwOyBpIDwgc2tpbGxBcnJheS5sZW5ndGg7IGkrKykgewogICAgYXdhaXQgdGhpc0JvdC5hYkFkYXB0KHNraWxsQXJyYXlbaV0pOwp9CgpyZXR1cm47JwCpvNCiCQAGYmFubmVyAgQAqbzQogmKTijwn5SXYjU1MmVhZjktYTlkNi00MWM4LTg1MTUtY2JkMmFiZWFhZTczJwCpvNCiCQAFaW5wdXQCBACpvNCiCbFOKPCflJdmODYwMjg3OC1jMmVmLTQ4YmQtODVhMC04ZDYzNTFlYjQxMjAnAKm80KIJAA1sb2FkaW5nU3RhdHVzAgQAqbzQognYTsYHQGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTG9hZFN0YXR1cyI7CgpsZXQgc3RhdHVzQm90ID0ge307CgpzdGF0dXNCb3Quc3BhY2UgPSAidGVtcExvY2FsIjsKc3RhdHVzQm90LmxhYmVsID0gInZlcmlmeWluZyBhdXRoQm90IjsKc3RhdHVzQm90LmxhYmVsQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwpzdGF0dXNCb3QuYWJMb2FkU3RhdHVzID0gdHJ1ZTsKc3RhdHVzQm90Lm1lbnVJdGVtU3R5bGUgPSB7ICJiYWNrZ3JvdW5kIjogIm5vbmUiIH07CnN0YXR1c0JvdC50cmFja051bSA9IDA7CnN0YXR1c0JvdC5vbkNyZWF0ZSA9IGBACiAgICBpZiAodGFncy50cmFja051bSA9PSAyKSB7CiAgICAgICAgdGFncy50cmFja051bSA9IDA7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICB0YWdzLnRyYWNrTnVtKys7CiAgICB9CgogICAgdGFncy5sYWJlbCA9IHRhZ3NbImxhYmVsIit0YWdzLnRyYWNrTnVtXTsKICAgIHRhZ3MuZm9ybUFkZHJlc3MgPSB0YWdzWyJmb3JtIit0YWdzLnRyYWNrTnVtXTsKCiAgICBzZXRUaW1lb3V0KCgpID0+IHdoaXNwZXIodGhpc0JvdCwgIm9uQ3JlYXRlIiksIDUwMCk7YDsKc3RhdHVzQm90LmxhYmVsMCA9ICJ2ZXJpZnlpbmcgYXV0aEJvdC4iOwpzdGF0dXNCb3QubGFiZWwxID0gInZlcmlmeWluZyBhdXRoQm90Li4iOwpzdGF0dXNCb3QubGFiZWwyID0gInZlcmlmeWluZyBhdXRoQm90Li4uIjsKc3RhdHVzQm90LmZvcm0wID0gImhvdXJnbGFzc19ib3R0b20iOwpzdGF0dXNCb3QuZm9ybTEgPSAiaG91cmdsYXNzX3RvcCI7CnN0YXR1c0JvdC5mb3JtMiA9ICJob3VyZ2xhc3NfYm90dG9tIjsKc3RhdHVzQm90Lm9uRGVzdHJveSA9IGBACiAgICBjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9IG51bGw7CmA7CgpsZXQgY3JlYXRlZFN0YXR1c0JvdCA9IGNyZWF0ZShzdGF0dXNCb3QpOwoKcmV0dXJuIGNyZWF0ZWRTdGF0dXNCb3Q7JwCpvNCiCQADYXNrAgQAqbzQogmfVijwn5SXZWM4NWMxZDYtOWYxYS00MGQ0LTgyZTEtNWJkNjgwMzQ5YzI3JwCpvNCiCQANYWJMb2FkU3R1ZGlvcwIEAKm80KIJxlZbQGNvbnN0IHVzZXJTdHVkaW9zID0gYXdhaXQgb3MubGlzdFVzZXJTdHVkaW9zKCk7CmNvbmZpZ0JvdC50YWdzLnVzZXJfc3R1ZGlvcyA9IHVzZXJTdHVkaW9zOycAqbzQogkAB2FiVGltZXICBACpvNCiCaJXwQZAaWYgKGdldEJvdCgiYWJUaW1lciIsIHRydWUpKSB7CiAgICByZXR1cm47Cn0KCmlmICghdGFncy5hYlhQKSB7CiAgICBzZXRUYWdNYXNrKHRoaXNCb3QsICJhYlhQIiwgIjAiLCAibG9jYWwiKTsKfQoKbGV0IHRpbWVyQm90ID0ge307Cgp0aW1lckJvdC5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwp0aW1lckJvdC5tYW5hZ2VyID0gZ2V0TGluayh0aGlzQm90KTsKdGltZXJCb3Qub25DcmVhdGUgPSBgQAogICAgbWFza3MuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB0aGlzQm90Lm9uVGltZUNoZWNrKCksIDYwMDAwKTsKYDsKdGltZXJCb3QuYWJUaW1lciA9IHRydWU7CnRpbWVyQm90Lm9uVGltZUNoZWNrID0gYEAKICAgIGlmICh0YWdzLm5vdElkbGUpIHsKICAgICAgICB0YWdzLm5vdElkbGUgPSBmYWxzZTsKCiAgICAgICAgLy9jb25zb2xlLmxvZygiWFAiLCBsaW5rcy5tYW5hZ2VyLnRhZ3MuYWJYUCk7CgogICAgICAgIGNvbnN0IHRvdGFsWFAgPSBsaW5rcy5tYW5hZ2VyLnRhZ3MuYWJYUCArIDE7CgogICAgICAgIHNldFRhZ01hc2sobGlua3MubWFuYWdlciwgImFiWFAiLCB0b3RhbFhQLCAibG9jYWwiKTsKICAgIH0KYDsKdGltZXJCb3Qubm90SWRsZSA9IGZhbHNlOwp0aW1lckJvdC5vbkFueUFjdGlvbiA9IGBACiAgICBpZiAoIXRhZ3Mubm90SWRsZSkgewogICAgICAgIGlmICh0aGF0LmFjdGlvbi5pZCA9PSBncmlkUG9ydGFsQm90LmlkKQogICAgICAgIHsKICAgICAgICAgICAgdGFncy5ub3RJZGxlID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CmA7CgpsZXQgYWJUaW1lciA9IGNyZWF0ZSh0aW1lckJvdCk7CgpnbG9iYWxUaGlzLmFiVGltZXIgPSBhYlRpbWVyOycAqbzQogkABXN0b3JlAgQAqbzQognkXSjwn5SXNzZhZjA0OTEtMzkxOS00OTg0LWFhODItMjJjNzQyZjQyNjNmJwCpvNCiCQAMb25JbnN0Sm9pbmVkAgQAqbzQogmLXvkBQGlmICghdGFncy5hYkluc3QpIHsKICAgIGNvbnN0IGFsbEluc3RzID0gY29uZmlnQm90LnRhZ3MuaW5zdDsKCiAgICBsZXQgYWN0aXZlSW5zdCA9IHRoYXQuaW5zdDsKCiAgICBpZiAoQXJyYXkuaXNBcnJheShhbGxJbnN0cykpIHsKICAgICAgICBhY3RpdmVJbnN0ID0gYWxsSW5zdHNbYWxsSW5zdHMubGVuZ3RoIC0gMV07CiAgICB9CgogICAgc2V0VGFnTWFzayh0aGlzQm90LCAnYWJJbnN0JywgYWN0aXZlSW5zdCwgJ3NoYXJlZCcpOwp9JwCpvNCiCQAHY29uc29sZQIEAKm80KIJhWAo8J+UlzI0YjdlNjZmLTBkNWItNDA2NC1iZjQ4LWI1NjJiOWU2ZTNlYicAqbzQogkACWFiVmVyc2lvbgIEAKm80KIJrGAEMTAuNCcAqbzQogkAFGJ1aWxkZXJJZGVudGl0eV9zYXZlAgQAqbzQogmxYJsFQGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90KCk7Cgpjb25zdCBuYW1lID0gdGhhdC5uYW1lOwpjb25zdCB1c2VyUmVjb3JkID0gYXV0aEJvdC5pZDsKY29uc3QgZW5kcG9pbnQgPSB0aGF0LmVuZHBvaW50ID8gdGhhdC5lbmRwb2ludCA6IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJFbmRwb2ludDsKY29uc3QgcmVjb3JkRGF0YSA9IHsgbmFtZTogbmFtZSB9Owpjb25zdCByZWNvcmROYW1lID0gImFiX25hbWUiOwoKbGV0IGlkZW50aXR5UmVjb3JkVXBkYXRlID0gYXdhaXQgb3MucmVjb3JkRGF0YSh1c2VyUmVjb3JkLCByZWNvcmROYW1lLCByZWNvcmREYXRhLCB7IGVuZHBvaW50OiBlbmRwb2ludCB9KTsKCmlmICghaWRlbnRpdHlSZWNvcmRVcGRhdGUuc3VjY2VzcykgewogICAgYXdhaXQgb3MuZ3JhbnRJbnN0QWRtaW5QZXJtaXNzaW9uKHVzZXJSZWNvcmQpOwoKICAgIGlkZW50aXR5UmVjb3JkVXBkYXRlID0gYXdhaXQgb3MucmVjb3JkRGF0YSh1c2VyUmVjb3JkLCByZWNvcmROYW1lLCByZWNvcmREYXRhLCB7IGVuZHBvaW50OiBlbmRwb2ludCB9KTsKfQoKaWYgKCFpZGVudGl0eVJlY29yZFVwZGF0ZS5zdWNjZXNzKSB7CiAgICBvcy50b2FzdCgic29tZXRoaW5nIHdlbnQgd3JvbmcgdXBkYXRpbmcgdGhlIGJ1aWxkZXIgbmFtZSByZWNvcmQsIHBsZWFzZSB0cnkgYWdhaW4iKTsKfScAqbzQogkAFmJ1aWxkZXJJZGVudGl0eV91cGRhdGUCBACpvNCiCc1l6gFAYXdhaXQgb3MucmVxdWVzdEF1dGhCb3RJbkJhY2tncm91bmQoKTsKCmlmICghYXV0aEJvdD8uaWQpIHJldHVybjsKCmNvbnN0IG5hbWVEYXRhID0gYXdhaXQgb3MuZ2V0RGF0YShhdXRoQm90LmlkLCAiYWJfbmFtZSIpOwoKaWYgKG5hbWVEYXRhLnN1Y2Nlc3MpIHsKICAgIHNldFRhZ01hc2sobGlua3MucmVtZW1iZXIsICdhYkJ1aWxkZXJJZGVudGl0eScsIG5hbWVEYXRhLmRhdGEubmFtZSwgJ2xvY2FsJyk7Cn0nAKm80KIJAAxhYkxvYWRDb25maWcCBACpvNCiCbhnmgZAY29uc3QgdXJsID0gbmV3IFVSTChvcy5nZXRBQjFCb290c3RyYXBVUkwoKSk7CnVybC5wYXRobmFtZSA9IHVybC5wYXRobmFtZS5yZXBsYWNlKCdhYjEuYXV4JywgJ2FiQ29uZmlnLmF1eCcpOwoKdHJ5IHsKICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgd2ViLmhvb2soeyBtZXRob2Q6ICJHRVQiLCB1cmw6IHVybC5ocmVmIH0pOwoKICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gQ291bGQgbm90IGRvd25sb2FkIGFiQ29uZmlnLiBSZXNwb25zZTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCB1cGRhdGVzID0gcmVzcG9uc2UuZGF0YS51cGRhdGVzOwogICAgYXdhaXQgb3MuYXBwbHlVcGRhdGVzVG9JbnN0KHVwZGF0ZXMpOwoKICAgIGlmIChsaW5rcy5yZW1lbWJlcikgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gTG9hZGVkIGFiQ29uZmlnIGF1eCBidXQgY291bGQgbm90IGZpbmQgcmVtZW1iZXIgYm90LmApOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfSBjYXRjaCAoZSkgewogICAgY29uc29sZS5lcnJvcihlKTsKICAgIGNvbnNvbGUuZXJyb3IoYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBGYWlsZWQgdG8gZG93bmxvYWQgYWJDb25maWcuIFNlZSBhYm92ZSBlcnJvci5gKTsKICAgIHJldHVybiBmYWxzZTsKfScAqbzQogkAF2FiQnVpbGRDYXN1YWxDYXRhbG9nVVJMAgQAqbzQognTbf8BQGNvbnN0IHJlbGF0aXZlUGF0aCA9IHRoYXQ7Cgpjb25zdCB1cmwgPSBuZXcgVVJMKGxpbmtzLnJlbWVtYmVyLnRhZ3MuY2FzdWFsQ2F0YWxvZ1VSTCk7CmNvbnN0IGVudiA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuY2FzdWFsQ2F0YWxvZ0VudjsKCnVybC5wYXRobmFtZSA9IHJlbGF0aXZlUGF0aDsKCmlmIChlbnYgJiYgZW52ICE9PSAncHJvZCcpIHsKICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KCdlbnYnLCBlbnYpOwp9CgpyZXR1cm4gdXJsLmhyZWY7JwCpvNCiCQAHY2hhbm5lbAIEAKm80KIJ028o8J+Ul2ExNmQzYTQ2LTliMDctNGQ2Yi05ODJlLTE5ZmRjOTUzZGIyNQA="}]}