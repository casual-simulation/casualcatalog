{"version":2,"updates":[{"id":0,"timestamp":1752178524139,"update":"AUa91/v3BQAnAQRib3RzJDY2NTdiODY1LWU5ODMtNDQwMS05ZmM5LWY1NDE4ZDE4YTdmNwEnAL3X+/cFABJhYkNvcmVNYWpvclZlcnNpb24CBAC91/v3BQECMTAnAL3X+/cFABJhYkNvcmVNaW5vclZlcnNpb24CBAC91/v3BQQBNCcAvdf79wUABnN5c3RlbQIEAL3X+/cFBg1hYi5jb3JlLmxlYXJuJwC91/v3BQAEYWJJRAIEAL3X+/cFFAVsZWFybicAvdf79wUABGZvcm0CBAC91/v3BRoHbm90aGluZycAvdf79wUABmFiQm9vdAIEAL3X+/cFIokqQC8qKgoqIE1JVCBMaWNlbnNlCioKKiBDb3B5cmlnaHQgKGMpIDIwMTkgQ2FzdWFsIFNpbXVsYXRpb24sIEluYy4KKgoqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAoqIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCiogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCiogZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKKgoqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbAoqIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCioKKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgoqIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAoqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRQoqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKKiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLAoqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFCiogU09GVFdBUkUuCiogQGxpY2Vuc2UgTUlUCiovCgovL2luc3QgbW9kZSAocGxheWVyIG9yIGJ1aWxkZXIpCmxldCBpbnN0TW9kZUNoZWNrID0gYXdhaXQgb3MudmVyc2lvbigpLnBsYXllck1vZGU7Ci8vY2hlY2sgc2VsZiBmb3IgaW5pdGlhbCBib290IGRhdGEKbGV0IGluaXRpYWxCb290ID0gbGlua3MucmVtZW1iZXIudGFncy5pbml0aWFsQm9vdCA/IHRydWUgOiBmYWxzZTsKLy9jaGVjayB1cmwgZm9yIHBvc3NpYmxlIGFiJ3MgdG8gbG9hZApsZXQgYm9vdEZsYWcgPSBjb25maWdCb3QudGFncy5wYXR0ZXJuID8gY29uZmlnQm90LnRhZ3MucGF0dGVybiA6IGNvbmZpZ0JvdC50YWdzLmFiOwovL2NoZWNrIGZvciBhc2sKbGV0IGFzayA9IGNvbmZpZ0JvdC50YWdzLmFzazsKLy9sb2dpbgpsZXQgc3RhdHVzID0gYXdhaXQgdGhpc0JvdC5sb2FkaW5nU3RhdHVzKCk7Ci8vc2VlZCAobm90IGFjdGl2ZWx5IHVzZWQgaGVyZSkKbGV0IHNlZWQgPSBjb25maWdCb3QudGFncy5zZWVkOwovL3Byb21wdApsZXQgcHJvbXB0ID0gY29uZmlnQm90LnRhZ3MucHJvbXB0OwovL2NoYW5uZWwKbGV0IGNoYW5uZWwgPSBjb25maWdCb3QudGFncy5jaGFubmVsOwovL3JlcXVlc3QgYXV0aCBib3QKYXdhaXQgb3MucmVxdWVzdEF1dGhCb3RJbkJhY2tncm91bmQoKTsKCi8vcmVkaXJlY3QgaWYgaW4gVVJMCmlmIChjb25maWdCb3QudGFncy5qb2luQ29kZSkgewogICAgdGhpc0JvdC5hYkpvaW5Ib3N0KHsgdGV4dDogY29uZmlnQm90LnRhZ3Muam9pbkNvZGUgfSk7Cn0KCi8vc3RhdHVzIGNsZWFuIHVwCmRlc3Ryb3koc3RhdHVzKTsKCi8vY2hlY2sgdGltZSBpZiBuZWVkZWQKaWYgKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJDb25kaXRpb24pIHsKICAgIGF3YWl0IGxpbmtzLnJlbWVtYmVyLmFiQ29uZGl0aW9uKCk7Cn0KCi8vaWYgbm8gc3R1ZGlvLCBzZXQgc3R1ZGlvCmlmIChhdXRoQm90ICYmICFjb25maWdCb3QudGFncy5zdHVkaW8pIHsKICAgIGNvbmZpZ0JvdC50YWdzLnN0dWRpbyA9IGF1dGhCb3QuaWQ7Cn0KCmlmIChhdXRoQm90KSB7CiAgICB0aGlzQm90LmFiTG9hZFN0dWRpb3MoKTsKfQoKLy9pbml0aWFsaXplIHJlbWVtYmVyIGdsb2JhbHMKZ2xvYmFsVGhpcy5hYkluc3RNZW1vcnkgPSBsaW5rcy5yZW1lbWJlcjsKZ2xvYmFsVGhpcy5hYlJlbWVtYmVyID0gbGlua3MucmVtZW1iZXI7Cmdsb2JhbFRoaXMuYWJQZXJzb25hbGl0eSA9IGxpbmtzLnBlcnNvbmFsaXR5OwoKaWYgKGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlR3JpZFBvcnRhbENvbG9yKSB7CiAgICBncmlkUG9ydGFsQm90LnRhZ3MucG9ydGFsQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZUdyaWRQb3J0YWxDb2xvcjsKfQoKLy9UaGlzIGNoZWNrcyBmb3IgdGhlIGFwcHJvcHJpYXRlIGFycmF5IG9mIHNraWxscyBhbmQgaW5pdGlhbGl6ZXMgdGhlbQphd2FpdCB0aGlzQm90LmFiU2tpbGxJbml0aWFsaXphdGlvbihpbnN0TW9kZUNoZWNrKTsKCi8vaW5pdGlhbGl6aW5nIG9mIGdsb2JhbCB2YXJpYWJsZXMKZ2xvYmFsVGhpcy5idWlsZGVyVmVyc2lvbiA9IGluc3RNb2RlQ2hlY2sgPT0gImJ1aWxkZXIiID8gdHJ1ZSA6IGZhbHNlOwpnbG9iYWxUaGlzLmFiTG9uZ1Rlcm1NZW1vcnlTZWFyY2ggPSBsaW5rcy5zZWFyY2g7Cmdsb2JhbFRoaXMuYWJTZWFyY2ggPSBsaW5rcy5zZWFyY2g7Cmdsb2JhbFRoaXMuYWJQdWJsaXNoID0gbGlua3Muc3RvcmU7Cmdsb2JhbFRoaXMuYWJTdG9yZSA9IGxpbmtzLnN0b3JlOwpnbG9iYWxUaGlzLmFiID0gdGhpc0JvdDsKCi8vcG9wdWxhdGUgYm9vdGZsYWcgYWIKaWYgKGluaXRpYWxCb290ICYmIGJvb3RGbGFnKSB7CiAgICBhd2FpdCBsaW5rcy5zZWFyY2gub25Mb29rdXBBQkVnZ3MoeyBhYklEOiBib290RmxhZywgaW5pdGlhbEJvb3Q6IHRydWUsIGF1dG9IYXRjaDogdHJ1ZSB9KTsKfQoKY29uc3QgcGxheVN1YnNjcmlwdGlvbiA9ICFhdXRoQm90ID8gdHJ1ZSA6IGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIgPyB0cnVlIDogZmFsc2U7CgovL2xvb2t1cCBhc2tJRCBpZiBhdmFpbGFibGUKaWYgKGluaXRpYWxCb290ICYmIGFzaykgewogICAgaWYgKGFzayA9PSAiZWdnQ2FydG9uIiB8fCBhc2sgPT0gImNhc3VhbFR1dG9yaWFsIikgewogICAgICAgIGF3YWl0IHRoaXNCb3QuYWJBZGFwdChhc2spOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgYXdhaXQgdGhpc0JvdC5hYkFkYXB0KCJhYkFjdGlvbiIpOwoKICAgICAgICBsaW5rcy5hc2suYWJDb3JlTWVudUFjdGlvbihhc2spOwogICAgfQp9CgovL2NoZWNrIGZvciBjaGFubmVsIGlmIGNoYW5uZWxzIGFsbG93ZWQKaWYgKGluaXRpYWxCb290ICYmIGNoYW5uZWwgJiYgbGlua3MucmVtZW1iZXIudGFncy5hbGxvd0NoYW5uZWxzKSB7CiAgICBhd2FpdCB0aGlzQm90LmFiQWRhcHQoImFiQWN0aW9uIik7CgogICAgbGlua3MuYXNrLmFiQ29yZU1lbnVBY3Rpb24oIkAiICsgY2hhbm5lbCk7Cn0KCi8vbG9hZCBwZXJzb25hbCBjaGFubmVsIGJ5IGRlZmF1bHQgaWYgY2hhbm5lbHMgYWxsb3dlZCBhbmQgbm8gb3RoZXIgZmxhZ3MgcHJlc2VudAppZiAoaW5pdGlhbEJvb3QgJiYgIWNoYW5uZWwgJiYgIWFzayAmJiAhYm9vdEZsYWcgJiYgbGlua3MucmVtZW1iZXIudGFncy5hbGxvd0NoYW5uZWxzKSB7CiAgICBhd2FpdCB0aGlzQm90LmFiQWRhcHQoImFiQ2hhbm5lbCIpOwoKICAgIGF3YWl0IGxpbmtzLmNoYW5uZWwubG9hZFBlcnNvbmFsQ2hhbm5lbCgpOwp9CgovL2NoZWNrIGZvciBhcnRpZmFjdCBGSVgKaWYgKGNvbmZpZ0JvdC50YWdzLmFydGlmYWN0ICYmIGluaXRpYWxCb290ICYmICFhc2sgJiYgIWJvb3RGbGFnKSB7CiAgICBjb25zdCBhcnRpZmFjdCA9IGNvbmZpZ0JvdC50YWdzLmFydGlmYWN0OwogICAgY29uc3QgYXJ0SW5kZXggPSBhcnRpZmFjdC5pbmRleE9mKCJfYXJ0XyIpOwogICAgY29uc3Qgc3R1ZGlvID0gYXJ0aWZhY3Quc3Vic3RyaW5nKDAsIGFydEluZGV4KTsKICAgIGNvbnN0IHJlY29yZEFkZHJlc3MgPSBhcnRpZmFjdC5zdWJzdHJpbmcoYXJ0SW5kZXgpOwogICAgY29uc3QgcmVjb3JkRGF0YSA9IGF3YWl0IG9zLmdldERhdGEoc3R1ZGlvLCByZWNvcmRBZGRyZXNzKTsKICAgIGNvbnN0IGFza0lEID0gcmVjb3JkRGF0YS5kYXRhLnBhdHRlcm47CgogICAgYXdhaXQgdGhpc0JvdC5hYkFkYXB0KCJhYkFjdGlvbiIpOwoKICAgIGxpbmtzLmFzay5hYkNvcmVNZW51QWN0aW9uKGFza0lEKTsKfQoKLy93YWtlIHVwIGJ1aWxkZXIgaWYgc3Vic2NyaXB0aW9uIGlzIHJpZ2h0CmlmICgoaW5pdGlhbEJvb3QgJiYgIWJvb3RGbGFnICYmICFwbGF5U3Vic2NyaXB0aW9uICYmICFhc2spICYmICFjb25maWdCb3QudGFncy5hYlNsZWVwKSB7CiAgICBpZiAobGlua3MubWFuaWZlc3RhdGlvbikgewogICAgICAgIGxpbmtzLm1hbmlmZXN0YXRpb24uYWJJbml0aWFsTWFuaWZlc3QoKTsKICAgIH0KICAgIGVsc2UgewogICAgICAgIGxpbmtzLmlucHV0Lm9uQ2hhdCh7IG1lc3NhZ2U6ICIuLiIgfSk7CiAgICB9Cn0KZWxzZSBpZiAobGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSA9PSAiYWItMSIgJiYgIWNvbmZpZ0JvdC50YWdzLmFiU2xlZXApIHsKICAgIGxpbmtzLmlucHV0Lm9uQ2hhdCh7IG1lc3NhZ2U6ICIuLiIgfSk7Cn0KCi8vc2V0IGluaXRpYWwgYm9vdCBkYXRhCmlmIChpbml0aWFsQm9vdCkgewogICAgc2V0VGFnTWFzayhsaW5rcy5yZW1lbWJlciwgJ2luaXRpYWxCb290JywgZmFsc2UsICdzaGFyZWQnKTsKCiAgICBpZiAobGlua3MucmVtZW1iZXIudGFncy5hYkluaXRpYWxpemF0aW9uQ29uZmlndXJhdGlvbikgewogICAgICAgIGxpbmtzLnJlbWVtYmVyLmFiSW5pdGlhbGl6YXRpb25Db25maWd1cmF0aW9uKCk7CiAgICB9Cn0KCi8vY2xlYW4gdXAgVVJMIHdpdGggdGFnUG9ydGFsCmlmIChjb25maWdCb3QudGFncy50YWdQb3J0YWwgJiYgIWNvbmZpZ0JvdC50YWdzLnRhZ1BvcnRhbEFuY2hvclBvaW50ICYmIGJ1aWxkZXJWZXJzaW9uKSB7CiAgICBjb25maWdCb3QudGFncy50YWdQb3J0YWwgPSBudWxsOwogICAgY29uZmlnQm90LnRhZ3MudGFnUG9ydGFsU3BhY2UgPSBudWxsOwp9CgovL3BhdXNlIGZvciBhYiBsb2FkaW5nCmF3YWl0IG9zLnNsZWVwKDUwMCk7CgovL2luaXRpYWxpemUgdGltZSBib3QKdGhpc0JvdC5hYlRpbWVyKCk7CgovL2F3YWl0IHRoaXNCb3QuYnVpbGRlcklkZW50aXR5X3VwZGF0ZSgpOwoKLy9pbml0aWFsaXphdGlvbiBzaG91dApzdXBlclNob3V0KCJvbkFCSW5pdGlhbGl6ZWQiLCB0YWdzLmFiSW5zdCk7KAC91/v3BQAGYWJDb3JlAXgnAL3X+/cFAAdhYkFkYXB0AgQAvdf79wWtKv4MQGxldCBza2lsbE5hbWU7CmxldCBza2lsbERhdGE7CgppZiAodHlwZW9mIHRoYXQgPT09ICdzdHJpbmcnKSB7CiAgICBza2lsbE5hbWUgPSB0aGF0OwogICAgc2tpbGxEYXRhID0gbnVsbDsKfSBlbHNlIGlmICh0eXBlb2YgdGhhdCA9PT0gJ29iamVjdCcpIHsKICAgIGlmICh0aGF0LnN5c3RlbUlEKSB7CiAgICAgICAgc2tpbGxOYW1lID0gdGhhdC5zeXN0ZW1JRDsKICAgIH0gZWxzZSBpZiAodGhhdC5za2lsbE5hbWUpIHsKICAgICAgICBza2lsbE5hbWUgPSB0aGF0LnNraWxsTmFtZTsKICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5lcnJvcihgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIHNraWxsTmFtZSBpcyBhIHJlcXVpcmVkIHBhcmFtZXRlci5gKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgc2tpbGxEYXRhID0gdGhhdC5kYXRhID8/IG51bGw7Cn0KCnRyeSB7CiAgICBjb25zdCB1cmwgPSB0aGlzQm90LmFiQnVpbGRDYXN1YWxDYXRhbG9nVVJMKGAvYWIvJHtza2lsbE5hbWV9LmF1eGApOwogICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB3ZWIuaG9vayh7IG1ldGhvZDogIkdFVCIsIHVybCB9KTsKCiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIENvdWxkIG5vdCBkb3dubG9hZCAke3NraWxsTmFtZX0uIFJlc3BvbnNlOiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBib3RJZHM7CgogICAgaWYgKHJlc3BvbnNlLmRhdGEudmVyc2lvbiA9PT0gMikgewogICAgICAgIC8vIEFVWCBGb3JtYXQgVmVyc2lvbiAyLgogICAgICAgIGNvbnN0IHVwZGF0ZXMgPSByZXNwb25zZS5kYXRhLnVwZGF0ZXM7CiAgICAgICAgY29uc3Qgc3RhdGUgPSBhd2FpdCBvcy5nZXRJbnN0U3RhdGVGcm9tVXBkYXRlcyh1cGRhdGVzKTsKICAgICAgICBhd2FpdCBvcy5hcHBseVVwZGF0ZXNUb0luc3QodXBkYXRlcyk7CgogICAgICAgIGJvdElkcyA9IE9iamVjdC5rZXlzKHN0YXRlKTsKICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5lcnJvcihgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIEFVWCBmb3JtYXQgdmVyc2lvbiAke3Jlc3BvbnNlLmRhdGEudmVyc2lvbn0gaXMgbm90IHN1cHBvcnRlZC5gKTsKICAgIH0KCiAgICBpZiAoYm90SWRzICYmIGJvdElkcy5sZW5ndGggPiAwKSB7CiAgICAgICAgd2hpc3Blcihib3RJZHMsIHRhZ05hbWUsIGNvbmZpZ0JvdC50YWdzLmluc3QpOwogICAgICAgIHdoaXNwZXIoYm90SWRzLCAib25Ta2lsbFVwZGF0ZSIsIHsgZGF0YTogc2tpbGxEYXRhIH0pOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gTm8gYm90cyBhcHBlYXIgdG8gaGF2ZSBiZWVuIGxvYWRlZCB3aXRoICR7c2tpbGxOYW1lfS5gKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcmV0dXJuIHRydWU7Cn0gY2F0Y2ggKGUpIHsKICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICBjb25zb2xlLmVycm9yKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gRmFpbGVkIHRvIGRvd25sb2FkICR7c2tpbGxOYW1lfS4gU2VlIGFib3ZlIGVycm9yLmApOwogICAgcmV0dXJuIGZhbHNlOwp9JwC91/v3BQALZGVzY3JpcHRpb24CBAC91/v3Baw3T1RoaXMgc2tpbGwgaXMgZGVzaWduZWQgdG8gaGFuZGxlIGJvdGggcmVjb25maWd1cmF0aW9uIG9mIGFiIGFuZCBpbml0aWFsaXphdGlvbi4nAL3X+/cFAApvbkJvdEFkZGVkAgQAvdf79wX8N9gBQGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gYWJDb3JlIFNUQVJUIFVQYCk7CgppZiAoIWxpbmtzLnJlbWVtYmVyKSB7CiAgICBjb25zb2xlLmVycm9yKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gQ291bGQgbm90IGZpbmQgYWJDb25maWcgcmVtZW1iZXIgYm90LmApOwp9CgpzZXRUaW1lb3V0KCgpID0+IHRoaXNCb3QuYWJCb290KCksIDUwMCk7JwC91/v3BQAIcmVtZW1iZXICBAC91/v3BdU5KPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAL3X+/cFAANsb2cCBAC91/v3Bfw5bEAvL3Bhc3MgdGhyb3VnaCBsb2cgZGF0YQppZiAobGlua3MuY29uc29sZSkgewogICAgbGlua3MuY29uc29sZS5sb2codGhhdCk7Cn0KZWxzZSB7CiAgICBjb25zb2xlLmxvZyh0aGF0KTsKfScAvdf79wUADW1hbmlmZXN0YXRpb24CBAC91/v3Bek6KPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAL3X+/cFAAxhYkNyZWF0ZUhvc3QCBAC91/v3BZA7lgpAY29uc3Qgc2l0ZU9yaWdpbiA9IG5ldyBVUkwoY29uZmlnQm90LnRhZ3MudXJsKS5vcmlnaW47CgovL3RoaXMgZnVuY3Rpb24gaGFuZGxlcyBjcmVhdGluZyBhIGZpbGUgZm9yIGpvaW4gY29kZXMKaWYgKGxpbmtzLnJlbWVtYmVyLnRhZ3MuaG9zdElEKSB7CiAgICBvcy50b2FzdCgidXJsIGNvcGllZCB0byBjbGlwYm9hcmQiKTsKCiAgICBvcy5zZXRDbGlwYm9hcmQoc2l0ZU9yaWdpbiArICIvP2pvaW5Db2RlPSIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmhvc3RJRC5zdWJzdHJpbmcoMCwgMykgKyAiLSIgKyBsaW5rcy5yZW1lbWJlci50YWdzLmhvc3RJRC5zdWJzdHJpbmcoMykpOwoKICAgIHJldHVybjsKfQoKaWYgKCFhdXRoQm90KSB7CiAgICBhd2FpdCBvcy5yZXF1ZXN0QXV0aEJvdCgpOwp9CgppZiAoIWF1dGhCb3QpIHsKICAgIG9zLnRvYXN0KCJwbGVhc2UgbG9nIGluIHRvIGdlbmVyYXRlIGEgam9pbiBjb2RlIik7CiAgICByZXR1cm47Cn0KCmNvbnN0IG5ld0hvc3RJRCA9IHV1aWQoKS5yZXBsYWNlQWxsKCItIiwgIiIpLnN1YnN0cmluZygwLCA2KTsKY29uc3QgZGF0ZSA9IERhdGVUaW1lLm5vdygpLnRvTWlsbGlzKCk7CmNvbnN0IHJlY29yZEtleSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJSZWNvcmRLZXk7CmNvbnN0IHJlY29yZERhdGEgPSBhd2FpdCBvcy5yZWNvcmREYXRhKHJlY29yZEtleSwgbmV3SG9zdElELCB7IHVybDogY29uZmlnQm90LnRhZ3MudXJsLCBkYXRlOiBkYXRlLCBtYXJrZXJzOiBbInB1YmxpY1JlYWQiXSB9KTsKCmlmIChyZWNvcmREYXRhLnN1Y2Nlc3MpIHsKICAgIHNldFRhZ01hc2sobGlua3MucmVtZW1iZXIsICdob3N0SUQnLCBuZXdIb3N0SUQuc3Vic3RyaW5nKDAsIDMpICsgIi0iICsgbmV3SG9zdElELnN1YnN0cmluZygzKSwgJ3NoYXJlZCcpOwoKICAgIGNvbnN0IGpvaW5VUkwgPSBzaXRlT3JpZ2luICsgIi8/am9pbkNvZGU9IiArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuaG9zdElEOwoKICAgIG9zLnNldENsaXBib2FyZChqb2luVVJMKTsKCiAgICB0aGF0LnRhZ3MubGFiZWwgPSAiam9pbiBjb2RlOiAiICsgbmV3SG9zdElELnN1YnN0cmluZygwLCAzKSArICItIiArIG5ld0hvc3RJRC5zdWJzdHJpbmcoMyk7CgogICAgb3Muc2hvd1FSQ29kZShqb2luVVJMKTsKCiAgICBvcy50b2FzdCgiaG9zdCBnZW5lcmF0ZWQsIHVybCBjb3BpZWQgdG8gY2xpcGJvYXJkOiAiICsgbmV3SG9zdElEKTsKfQplbHNlIHsKICAgIG9zLnRvYXN0KCJzb21ldGhpbmcgd2VudCB3cm9uZywgcGxlYXNlIHRyeSBhZ2FpbiIpOwoKICAgIHNob3V0KCJhYk1lbnVSZWZyZXNoIik7Cn0nAL3X+/cFAAphYkpvaW5Ib3N0AgQAvdf79wWnRe4GQC8vbG9naWMgZm9yIHVzaW5nIGEgam9pbiBjb2RlIChjaGVja3MgZm9yIGV4aXN0aW5nIGZpbGVzKQpzaG91dCgiYWJNZW51UmVmcmVzaCIpOwoKbGV0IGdldFJlY29yZDsKCmlmICh0aGF0LmRhdGEpIHsKICAgIGdldFJlY29yZCA9IHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogdGhhdC5kYXRhIH07Cn0KZWxzZSB7CiAgICBjb25zdCBqb2luQ29kZSA9IHRoYXQudGV4dC5yZXBsYWNlQWxsKCItIiwgIiIpOwogICAgY29uc3QgcmVjb3JkS2V5ID0gbGlua3MucmVtZW1iZXIudGFncy5hYlJlY29yZEtleTsKICAgIGNvbnNvbGUubG9nKCJKT0lOQ09ERSIsIGpvaW5Db2RlKQogICAgZ2V0UmVjb3JkID0gYXdhaXQgb3MuZ2V0RGF0YShyZWNvcmRLZXksIGpvaW5Db2RlKTsKfQoKaWYgKGdldFJlY29yZC5zdWNjZXNzKSB7CiAgICBjb25zdCBkYXRlID0gRGF0ZVRpbWUubm93KCk7CiAgICBsZXQgY3JlYXRlRGF0ZSA9IERhdGVUaW1lLmZyb21NaWxsaXMoZ2V0UmVjb3JkLmRhdGEuZGF0ZSk7CiAgICBsZXQgZGlmZmVyZW5jZSA9IGRhdGUuZGlmZihjcmVhdGVEYXRlLCAiZGF5cyIpLnRvT2JqZWN0KCk7CgogICAgZGlmZmVyZW5jZSA9IE1hdGguZmxvb3IoZGlmZmVyZW5jZS5kYXlzKTsKCiAgICBpZiAoZGlmZmVyZW5jZSA8IDgpIHsKICAgICAgICBvcy50b2FzdCgiam9pbmluZyBob3N0IG5vdyIpOwoKICAgICAgICBvcy5nb1RvVVJMKGdldFJlY29yZC5kYXRhLnVybCk7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBvcy50b2FzdCgiam9pbiBjb2RlIG91dCBvZiBkYXRlLCBwbGVhc2UgZ2VuZXJhdGUgYSBuZXcgam9pbiBjb2RlIik7CiAgICB9Cn0KZWxzZSB7CiAgICBvcy50b2FzdCgiY29kZS9hYiBpbnZhbGlkLCBwbGVhc2UgdHJ5IGFnYWluIik7Cn0nAL3X+/cFAAZzZWFyY2gCBAC91/v3BZZMKPCflJdkODM3MTQ0NC05MTU4LTQ0MzYtOGZjNy04NGNjOTFiN2Y1MjUnAL3X+/cFAAhhYklnbm9yZQIEAL3X+/cFvUwEdHJ1ZScAvdf79wUABG1lbnUCBAC91/v3BcJMKPCflJdiMzBjNmM1ZC1hNGY3LTQyNjYtYmEzOC0zOTNkYzk1ZTFlY2InAL3X+/cFABVhYlNraWxsSW5pdGlhbGl6YXRpb24CBAC91/v3BelM0AFALy9GaW5kIHRoZSBhcHByb3ByaWF0ZSBhcnJheSBhbmQgcG9wdWxhdGUgc2tpbGxzCmxldCBza2lsbEFycmF5ID0gbGlua3MucmVtZW1iZXIudGFnc1t0aGF0ICsgIlNraWxsQXJyYXkiXTsKCmZvciAobGV0IGkgPSAwOyBpIDwgc2tpbGxBcnJheS5sZW5ndGg7IGkrKykgewogICAgYXdhaXQgdGhpc0JvdC5hYkFkYXB0KHNraWxsQXJyYXlbaV0pOwp9CgpyZXR1cm47JwC91/v3BQAGYmFubmVyAgQAvdf79wW6Tijwn5SXYjU1MmVhZjktYTlkNi00MWM4LTg1MTUtY2JkMmFiZWFhZTczJwC91/v3BQAFaW5wdXQCBAC91/v3BeFOKPCflJdmODYwMjg3OC1jMmVmLTQ4YmQtODVhMC04ZDYzNTFlYjQxMjAnAL3X+/cFAA1sb2FkaW5nU3RhdHVzAgQAvdf79wWIT8YHQGNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTG9hZFN0YXR1cyI7CgpsZXQgc3RhdHVzQm90ID0ge307CgpzdGF0dXNCb3Quc3BhY2UgPSAidGVtcExvY2FsIjsKc3RhdHVzQm90LmxhYmVsID0gInZlcmlmeWluZyBhdXRoQm90IjsKc3RhdHVzQm90LmxhYmVsQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwpzdGF0dXNCb3QuYWJMb2FkU3RhdHVzID0gdHJ1ZTsKc3RhdHVzQm90Lm1lbnVJdGVtU3R5bGUgPSB7ICJiYWNrZ3JvdW5kIjogIm5vbmUiIH07CnN0YXR1c0JvdC50cmFja051bSA9IDA7CnN0YXR1c0JvdC5vbkNyZWF0ZSA9IGBACiAgICBpZiAodGFncy50cmFja051bSA9PSAyKSB7CiAgICAgICAgdGFncy50cmFja051bSA9IDA7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICB0YWdzLnRyYWNrTnVtKys7CiAgICB9CgogICAgdGFncy5sYWJlbCA9IHRhZ3NbImxhYmVsIit0YWdzLnRyYWNrTnVtXTsKICAgIHRhZ3MuZm9ybUFkZHJlc3MgPSB0YWdzWyJmb3JtIit0YWdzLnRyYWNrTnVtXTsKCiAgICBzZXRUaW1lb3V0KCgpID0+IHdoaXNwZXIodGhpc0JvdCwgIm9uQ3JlYXRlIiksIDUwMCk7YDsKc3RhdHVzQm90LmxhYmVsMCA9ICJ2ZXJpZnlpbmcgYXV0aEJvdC4iOwpzdGF0dXNCb3QubGFiZWwxID0gInZlcmlmeWluZyBhdXRoQm90Li4iOwpzdGF0dXNCb3QubGFiZWwyID0gInZlcmlmeWluZyBhdXRoQm90Li4uIjsKc3RhdHVzQm90LmZvcm0wID0gImhvdXJnbGFzc19ib3R0b20iOwpzdGF0dXNCb3QuZm9ybTEgPSAiaG91cmdsYXNzX3RvcCI7CnN0YXR1c0JvdC5mb3JtMiA9ICJob3VyZ2xhc3NfYm90dG9tIjsKc3RhdHVzQm90Lm9uRGVzdHJveSA9IGBACiAgICBjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9IG51bGw7CmA7CgpsZXQgY3JlYXRlZFN0YXR1c0JvdCA9IGNyZWF0ZShzdGF0dXNCb3QpOwoKcmV0dXJuIGNyZWF0ZWRTdGF0dXNCb3Q7JwC91/v3BQADYXNrAgQAvdf79wXPVijwn5SXZWM4NWMxZDYtOWYxYS00MGQ0LTgyZTEtNWJkNjgwMzQ5YzI3JwC91/v3BQANYWJMb2FkU3R1ZGlvcwIEAL3X+/cF9lZbQGNvbnN0IHVzZXJTdHVkaW9zID0gYXdhaXQgb3MubGlzdFVzZXJTdHVkaW9zKCk7CmNvbmZpZ0JvdC50YWdzLnVzZXJfc3R1ZGlvcyA9IHVzZXJTdHVkaW9zOycAvdf79wUAB2FiVGltZXICBAC91/v3BdJXwQZAaWYgKGdldEJvdCgiYWJUaW1lciIsIHRydWUpKSB7CiAgICByZXR1cm47Cn0KCmlmICghdGFncy5hYlhQKSB7CiAgICBzZXRUYWdNYXNrKHRoaXNCb3QsICJhYlhQIiwgIjAiLCAibG9jYWwiKTsKfQoKbGV0IHRpbWVyQm90ID0ge307Cgp0aW1lckJvdC5zcGFjZSA9ICJ0ZW1wTG9jYWwiOwp0aW1lckJvdC5tYW5hZ2VyID0gZ2V0TGluayh0aGlzQm90KTsKdGltZXJCb3Qub25DcmVhdGUgPSBgQAogICAgbWFza3MuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB0aGlzQm90Lm9uVGltZUNoZWNrKCksIDYwMDAwKTsKYDsKdGltZXJCb3QuYWJUaW1lciA9IHRydWU7CnRpbWVyQm90Lm9uVGltZUNoZWNrID0gYEAKICAgIGlmICh0YWdzLm5vdElkbGUpIHsKICAgICAgICB0YWdzLm5vdElkbGUgPSBmYWxzZTsKCiAgICAgICAgLy9jb25zb2xlLmxvZygiWFAiLCBsaW5rcy5tYW5hZ2VyLnRhZ3MuYWJYUCk7CgogICAgICAgIGNvbnN0IHRvdGFsWFAgPSBsaW5rcy5tYW5hZ2VyLnRhZ3MuYWJYUCArIDE7CgogICAgICAgIHNldFRhZ01hc2sobGlua3MubWFuYWdlciwgImFiWFAiLCB0b3RhbFhQLCAibG9jYWwiKTsKICAgIH0KYDsKdGltZXJCb3Qubm90SWRsZSA9IGZhbHNlOwp0aW1lckJvdC5vbkFueUFjdGlvbiA9IGBACiAgICBpZiAoIXRhZ3Mubm90SWRsZSkgewogICAgICAgIGlmICh0aGF0LmFjdGlvbi5pZCA9PSBncmlkUG9ydGFsQm90LmlkKQogICAgICAgIHsKICAgICAgICAgICAgdGFncy5ub3RJZGxlID0gdHJ1ZTsKICAgICAgICB9CiAgICB9CmA7CgpsZXQgYWJUaW1lciA9IGNyZWF0ZSh0aW1lckJvdCk7CgpnbG9iYWxUaGlzLmFiVGltZXIgPSBhYlRpbWVyOycAvdf79wUABXN0b3JlAgQAvdf79wWUXijwn5SXNzZhZjA0OTEtMzkxOS00OTg0LWFhODItMjJjNzQyZjQyNjNmJwC91/v3BQAMb25JbnN0Sm9pbmVkAgQAvdf79wW7XvkBQGlmICghdGFncy5hYkluc3QpIHsKICAgIGNvbnN0IGFsbEluc3RzID0gY29uZmlnQm90LnRhZ3MuaW5zdDsKCiAgICBsZXQgYWN0aXZlSW5zdCA9IHRoYXQuaW5zdDsKCiAgICBpZiAoQXJyYXkuaXNBcnJheShhbGxJbnN0cykpIHsKICAgICAgICBhY3RpdmVJbnN0ID0gYWxsSW5zdHNbYWxsSW5zdHMubGVuZ3RoIC0gMV07CiAgICB9CgogICAgc2V0VGFnTWFzayh0aGlzQm90LCAnYWJJbnN0JywgYWN0aXZlSW5zdCwgJ3NoYXJlZCcpOwp9JwC91/v3BQAHY29uc29sZQIEAL3X+/cFtWAo8J+UlzI0YjdlNjZmLTBkNWItNDA2NC1iZjQ4LWI1NjJiOWU2ZTNlYicAvdf79wUACWFiVmVyc2lvbgIEAL3X+/cF3GAEMTAuNCcAvdf79wUAFGJ1aWxkZXJJZGVudGl0eV9zYXZlAgQAvdf79wXhYJsFQGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90KCk7Cgpjb25zdCBuYW1lID0gdGhhdC5uYW1lOwpjb25zdCB1c2VyUmVjb3JkID0gYXV0aEJvdC5pZDsKY29uc3QgZW5kcG9pbnQgPSB0aGF0LmVuZHBvaW50ID8gdGhhdC5lbmRwb2ludCA6IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJFbmRwb2ludDsKY29uc3QgcmVjb3JkRGF0YSA9IHsgbmFtZTogbmFtZSB9Owpjb25zdCByZWNvcmROYW1lID0gImFiX25hbWUiOwoKbGV0IGlkZW50aXR5UmVjb3JkVXBkYXRlID0gYXdhaXQgb3MucmVjb3JkRGF0YSh1c2VyUmVjb3JkLCByZWNvcmROYW1lLCByZWNvcmREYXRhLCB7IGVuZHBvaW50OiBlbmRwb2ludCB9KTsKCmlmICghaWRlbnRpdHlSZWNvcmRVcGRhdGUuc3VjY2VzcykgewogICAgYXdhaXQgb3MuZ3JhbnRJbnN0QWRtaW5QZXJtaXNzaW9uKHVzZXJSZWNvcmQpOwoKICAgIGlkZW50aXR5UmVjb3JkVXBkYXRlID0gYXdhaXQgb3MucmVjb3JkRGF0YSh1c2VyUmVjb3JkLCByZWNvcmROYW1lLCByZWNvcmREYXRhLCB7IGVuZHBvaW50OiBlbmRwb2ludCB9KTsKfQoKaWYgKCFpZGVudGl0eVJlY29yZFVwZGF0ZS5zdWNjZXNzKSB7CiAgICBvcy50b2FzdCgic29tZXRoaW5nIHdlbnQgd3JvbmcgdXBkYXRpbmcgdGhlIGJ1aWxkZXIgbmFtZSByZWNvcmQsIHBsZWFzZSB0cnkgYWdhaW4iKTsKfScAvdf79wUAFmJ1aWxkZXJJZGVudGl0eV91cGRhdGUCBAC91/v3Bf1l6gFAYXdhaXQgb3MucmVxdWVzdEF1dGhCb3RJbkJhY2tncm91bmQoKTsKCmlmICghYXV0aEJvdD8uaWQpIHJldHVybjsKCmNvbnN0IG5hbWVEYXRhID0gYXdhaXQgb3MuZ2V0RGF0YShhdXRoQm90LmlkLCAiYWJfbmFtZSIpOwoKaWYgKG5hbWVEYXRhLnN1Y2Nlc3MpIHsKICAgIHNldFRhZ01hc2sobGlua3MucmVtZW1iZXIsICdhYkJ1aWxkZXJJZGVudGl0eScsIG5hbWVEYXRhLmRhdGEubmFtZSwgJ2xvY2FsJyk7Cn0nAL3X+/cFAAxhYkxvYWRDb25maWcCBAC91/v3BehnmgZAY29uc3QgdXJsID0gbmV3IFVSTChvcy5nZXRBQjFCb290c3RyYXBVUkwoKSk7CnVybC5wYXRobmFtZSA9IHVybC5wYXRobmFtZS5yZXBsYWNlKCdhYjEuYXV4JywgJ2FiQ29uZmlnLmF1eCcpOwoKdHJ5IHsKICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgd2ViLmhvb2soeyBtZXRob2Q6ICJHRVQiLCB1cmw6IHVybC5ocmVmIH0pOwoKICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gQ291bGQgbm90IGRvd25sb2FkIGFiQ29uZmlnLiBSZXNwb25zZTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCB1cGRhdGVzID0gcmVzcG9uc2UuZGF0YS51cGRhdGVzOwogICAgYXdhaXQgb3MuYXBwbHlVcGRhdGVzVG9JbnN0KHVwZGF0ZXMpOwoKICAgIGlmIChsaW5rcy5yZW1lbWJlcikgewogICAgICAgIHJldHVybiB0cnVlOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gTG9hZGVkIGFiQ29uZmlnIGF1eCBidXQgY291bGQgbm90IGZpbmQgcmVtZW1iZXIgYm90LmApOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KfSBjYXRjaCAoZSkgewogICAgY29uc29sZS5lcnJvcihlKTsKICAgIGNvbnNvbGUuZXJyb3IoYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBGYWlsZWQgdG8gZG93bmxvYWQgYWJDb25maWcuIFNlZSBhYm92ZSBlcnJvci5gKTsKICAgIHJldHVybiBmYWxzZTsKfScAvdf79wUAF2FiQnVpbGRDYXN1YWxDYXRhbG9nVVJMAgQAvdf79wWDbv8BQGNvbnN0IHJlbGF0aXZlUGF0aCA9IHRoYXQ7Cgpjb25zdCB1cmwgPSBuZXcgVVJMKGxpbmtzLnJlbWVtYmVyLnRhZ3MuY2FzdWFsQ2F0YWxvZ1VSTCk7CmNvbnN0IGVudiA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuY2FzdWFsQ2F0YWxvZ0VudjsKCnVybC5wYXRobmFtZSA9IHJlbGF0aXZlUGF0aDsKCmlmIChlbnYgJiYgZW52ICE9PSAncHJvZCcpIHsKICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KCdlbnYnLCBlbnYpOwp9CgpyZXR1cm4gdXJsLmhyZWY7JwC91/v3BQAHY2hhbm5lbAIEAL3X+/cFg3Ao8J+Ul2ExNmQzYTQ2LTliMDctNGQ2Yi05ODJlLTE5ZmRjOTUzZGIyNScAvdf79wUAC3BlcnNvbmFsaXR5AgQAvdf79wWqcCjwn5SXYjc2ZGZiYzQtODU0Yi00ZjZkLWE5MWYtYTk0ODY5NDc3NGRiAA=="}]}