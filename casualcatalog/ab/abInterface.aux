{"version":2,"updates":[{"id":0,"timestamp":1752006517238,"update":"AbABhNma/gkAJwEEYm90cyQxM2YzM2E1MS1jMmZhLTQ2ZGEtYTg4ZS1lNWMwNjc1NTZkMDIBJwCE2Zr+CQAKYWJJRE9yaWdpbgIEAITZmv4JAQ10b29sYm94X3NraWxsJwCE2Zr+CQALYWJJbnRlcmZhY2UCBACE2Zr+CQ8EdHJ1ZScAhNma/gkAC2Rlc2NyaXB0aW9uAgQAhNma/gkUKVRoaXMgc2tpbGwgaXMgYW4gaW50ZXJmYWNlIGZvciB0b29sYm94ZXMuJwCE2Zr+CQAEZm9ybQIEAITZmv4JPgdub3RoaW5nJwCE2Zr+CQAEbWVudQIEAITZmv4JRijwn5SXYjMwYzZjNWQtYTRmNy00MjY2LWJhMzgtMzkzZGM5NWUxZWNiJwCE2Zr+CQAGc3lzdGVtAgQAhNma/gltFGFiLmludGVyZmFjZS50b29sYm94JwCE2Zr+CQAKYWJJRFN0dWRpbwIEAITZmv4JggEkZTkxZWFiMGQtNmE3NS00YWI5LThhMGUtNTBhNGNjMGMxZDM0JwCE2Zr+CQAIcmVtZW1iZXICBACE2Zr+CacBKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAITZmv4JAAt0b29sYm94X2FkZAIEAITZmv4JzgHlBkBjb25zdCB0b29sYm94RGF0YSA9IHRoYXQudG9vbGJveERhdGE7CmNvbnN0IHRvb2xib3hUaXRsZSA9IHRvb2xib3hEYXRhLnRpdGxlOwpjb25zdCB0b29sYm94TmFtZSA9IHRvb2xib3hEYXRhLm5hbWU7CmNvbnN0IHRvb2xib3hTdHVkaW8gPSB0b29sYm94RGF0YS5zdHVkaW87CmNvbnN0IGdyaWREYXRhID0gdGhhdC5ncmlkRGF0YTsKCi8vTE9BRElORyBCQVI/CgppZiAodG9vbGJveFN0dWRpbyA9PSBmYWxzZSkKewogICAgYXdhaXQgbGlua3MubGVhcm4uYWJBZGFwdCh0b29sYm94TmFtZSk7CgogICAgb3MudG9hc3QoImtpdCBsb2FkZWQiKTsKfQplbHNlCnsKICAgIGNvbnN0IHRvb2xib3hMb29rdXAgPSBhd2FpdCBsaW5rcy5zZWFyY2guaGF0Y2goe2FiSUQ6IHRvb2xib3hOYW1lLCByZWNvcmRLZXk6IHRvb2xib3hTdHVkaW8sIGF1dG9IYXRjaDogdHJ1ZX0pOwoKICAgIGlmICh0b29sYm94TG9va3VwLnN1Y2Nlc3MpCiAgICB7CiAgICAgICAgb3MudG9hc3QoImtpdCBsb2FkZWQiKTsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBvcy50b2FzdCgiaXNzdWUgbG9hZGluZyBraXQsIHBsZWFzZSB0cnkgYWdhaW4iKTsKICAgIH0KfQoKY29uc3QgYWN0aXZlVG9vbGJveCA9IGdldEJvdCgic3lzdGVtIiwgYGFiLnRvb2xib3guJHt0b29sYm94VGl0bGUgPz8gdG9vbGJveE5hbWV9YCk7CgppZiAoYWN0aXZlVG9vbGJveC50YWdzLmFiR3JpZE1lbnVBY3Rpb24pCnsKICAgIGFjdGl2ZVRvb2xib3guYWJHcmlkTWVudUFjdGlvbih7Z3JpZEluZm9ybWF0aW9uOiBncmlkRGF0YX0pOwp9CmVsc2UgaWYgKGFjdGl2ZVRvb2xib3gudGFncy5hYkNvcmVNZW51QWN0aW9uKQp7CiAgICAvL1JFRlJFU0ggQU5EIFRIRU4gT1BFTj8/Pwp9JwCE2Zr+CQAFbGVhcm4CBACE2Zr+CbQIKPCflJc2NjU3Yjg2NS1lOTgzLTQ0MDEtOWZjOS1mNTQxOGQxOGE3ZjcnAITZmv4JAAVzdG9yZQIEAITZmv4J2wgo8J+Ulzc2YWYwNDkxLTM5MTktNDk4NC1hYTgyLTIyYzc0MmY0MjYzZicAhNma/gkABnNlYXJjaAIEAITZmv4Jggko8J+Ul2Q4MzcxNDQ0LTkxNTgtNDQzNi04ZmM3LTg0Y2M5MWI3ZjUyNScAhNma/gkACGFiSWdub3JlAgQAhNma/gmpCQR0cnVlJwCE2Zr+CQAJYWJWZXJzaW9uAgQAhNma/gmuCQQxMC40JwCE2Zr+CQANbWFuaWZlc3RhdGlvbgIEAITZmv4Jswko8J+Ul2RjYTVkOTg3LWM0ZDgtNDZlNC1iNjBjLWRhYTdiMmY0ZGRhZCcAhNma/gkAEGFiR3JpZE1lbnVBY3Rpb24CBACE2Zr+CdoJ+wdAc2hvdXQoImFiTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTWVudSI7CgpsaW5rcy5tZW51Lm1hc2tzLm9uR3JpZENsaWNrID0gIkAgc2hvdXQoJ2FiTWVudVJlZnJlc2gnKTsgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7IjsKCmNvbnN0IHBvc3NpYmxlVG9vbGJveGVzID0gbGlua3MucmVtZW1iZXIudGFncy50b29sYm94X2FycmF5Owpjb25zdCBtZW51Qm90ID0ge307CgptZW51Qm90LmFiTWVudSA9IHRydWU7Cm1lbnVCb3QuYWJNZW51UmVmcmVzaCA9ICJAIGRlc3Ryb3kodGhpc0JvdCk7IjsKbWVudUJvdC5ncmlkRGF0YSA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXM7Cm1lbnVCb3QubWFuYWdlciA9IGdldExpbmsodGhpc0JvdCk7Cm1lbnVCb3QuZm9ybUFkZHJlc3MgPSAiYWRkX2JveCI7Cm1lbnVCb3QubWFuaWZlc3RhdGlvbiA9IHRhZ3MubWFuaWZlc3RhdGlvbjsKbWVudUJvdC5vbkNsaWNrID0gYEAgbGlua3MubWFuYWdlci50b29sYm94X2FkZCh7dG9vbGJveERhdGE6IHRhZ3MudG9vbGJveF9kYXRhLCBncmlkRGF0YTogdGFncy5ncmlkRGF0YX0pOyBzaG91dCgiYWJNZW51UmVmcmVzaCIpO2A7Cgpmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlVG9vbGJveGVzLmxlbmd0aDsgaSsrKQp7CiAgICBjb25zdCBhY3RpdmVUb29sYm94ID0gcG9zc2libGVUb29sYm94ZXNbaV07CiAgICBjb25zdCBleHRhbnRCb3QgPSBhY3RpdmVUb29sYm94LnN0dWRpbyA/IGdldEJvdCgiYWJJRE9yaWdpbiIsIGFjdGl2ZVRvb2xib3gubmFtZSk6IGdldEJvdChhY3RpdmVUb29sYm94Lm5hbWUsIHRydWUpOwoKICAgIG1lbnVCb3QudG9vbGJveF9kYXRhID0gYWN0aXZlVG9vbGJveDsKICAgIG1lbnVCb3QubGFiZWwgPSBhY3RpdmVUb29sYm94LnRpdGxlID8/IGFjdGl2ZVRvb2xib3gubmFtZTsKCiAgICBpZiAoIWV4dGFudEJvdCkKICAgIHsKICAgICAgICBsaW5rcy5tZW51LmFiQ3JlYXRlTWVudUJ1dHRvbihtZW51Qm90KTsKICAgIH0KfScAhNma/gkAFGFiR3JpZE1lbnVPbkdlbmVyYXRlAgQAhNma/gnWEeICQGNvbnN0IHRvb2xib3hBcnJheSA9IGFiUmVtZW1iZXIudGFncy50b29sYm94X2FycmF5OwoKbGV0IGFsbFRvb2xzTG9hZGVkID0gdHJ1ZTsKCmZvciAobGV0IGkgPSAwOyBpIDwgdG9vbGJveEFycmF5Lmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBjdXJyZW50VG9vbCA9IHRvb2xib3hBcnJheVtpXS5uYW1lOwoKICAgIGlmICghZ2V0Qm90KCJhYklET3JpZ2luIiwgY3VycmVudFRvb2wpICYmICFnZXRCb3QoY3VycmVudFRvb2wsIHRydWUpKSB7CiAgICAgICAgYWxsVG9vbHNMb2FkZWQgPSBmYWxzZTsKICAgICAgICBicmVhazsKICAgIH0KfQoKaWYgKGFsbFRvb2xzTG9hZGVkKSB7CiAgICBkZXN0cm95KHRoaXNCb3QpOwp9JwCE2Zr+CQAOYWJHcmlkTWVudUljb24CBACE2Zr+CbkUCmxvY2FsX21hbGwnAITZmv4JAA9hYkdyaWRNZW51TGFiZWwCBACE2Zr+CcQUDmNhc3VhbCBjYXRhbG9nJwCE2Zr+CQATYWJHcmlkTWVudVNvcnRPcmRlcgIEAITZmv4J0xQBMycAhNma/gkAD29uQUJJbml0aWFsaXplZAIEAITZmv4J1RQqQC8vIGxpbmtzLmxlYXJuLmFiQWRhcHQoImNhc3VhbF90b29sYm94Iik7JwCE2Zr+CQANb25Ta2lsbFVwZGF0ZQIEAITZmv4JgBVXQGxpbmtzLmxlYXJuLmFiQWRhcHQoImNhc3VhbF90b29sYm94Iik7DQoNCmNvbnNvbGUubG9nKCJbVG9vbGJveF0gTG9hZGluZyBjYXN1YWwga2l0Iik7JwEEYm90cyQxNzQxMGQ4My03ZWVlLTRhMWUtYjYzOC02NTQ2Mzc0ZDE3YzMBJwCE2Zr+CdgVBnN5c3RlbQIEAITZmv4J2RURYWIuaW50ZXJmYWNlLnNjYW4nAITZmv4J2BUEZm9ybQIEAITZmv4J6xUHbm90aGluZycAhNma/gnYFQthYkludGVyZmFjZQIEAITZmv4J8xUEdHJ1ZScAhNma/gnYFQhhYklnbm9yZQIEAITZmv4J+BUEdHJ1ZScAhNma/gnYFQ9vblFSQ29kZVNjYW5uZWQCBACE2Zr+Cf0VxgxAaWYgKCFidWlsZGVyVmVyc2lvbikKewogICAgcmV0dXJuOwp9CgphYi5sb2coYWJSZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgIjogc2Nhbm5lZCAiICsgdGhhdCk7CgppZiAoY29uZmlnQm90LnRhZ3MucHVibGlzaFNjYW4pCnsKICAgIG9zLmNsb3NlUVJDb2RlU2Nhbm5lcigpOwoKICAgIGxpbmtzLnN0b3JlLmFiUVJQdWJsaXNoKHRoYXQpOwp9CmVsc2UgaWYgKGNvbmZpZ0JvdC50YWdzLnByYWN0aWNlUGVybWl0U2NhbikKewogICAgbGV0IHNjYW5uZWRVUkw7CgogICAgY29uZmlnQm90LnRhZ3MucHJhY3RpY2VQZXJtaXRTY2FuID0gbnVsbDsKCiAgICBvcy5jbG9zZVFSQ29kZVNjYW5uZXIoKTsKCiAgICB0cnkKICAgIHsKICAgICAgICBzY2FubmVkVVJMID0gbmV3IFVSTCh0aGF0KTsKICAgIH0KICAgIGNhdGNoIChlKQogICAgewogICAgICAgIG9zLnRvYXN0KCJub3QgYSByZWNvZ25pemVkIHByYWN0aWNlIHBlcm1pdCIpOwoKICAgICAgICBjb25zb2xlLmxvZyhlKTsKCiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxldCBwaENoZWNrID0gc2Nhbm5lZFVSTC5zZWFyY2hQYXJhbXMuaGFzKCJwaCIpOwogICAgbGV0IGluc3RDaGVjayA9IHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmhhcygiaW5zdCIpOwogICAgbGV0IGFiQ2hlY2sgPSBzY2FubmVkVVJMLnNlYXJjaFBhcmFtcy5oYXMoImFiIik7CiAgICBsZXQgY3dDaGVjayA9IHNjYW5uZWRVUkwuc2VhcmNoUGFyYW1zLmhhcygiY3ciKTsKCiAgICBpZiAocGhDaGVjayAmJiBpbnN0Q2hlY2sgJiYgYWJDaGVjayAmJiBjd0NoZWNrKQogICAgewogICAgICAgIG9zLmdvVG9VUkwodGhhdCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgb3MudG9hc3QoIm5vdCBhIHJlY29nbml6ZWQgcHJhY3RpY2UgcGVybWl0Iik7CiAgICB9CgogICAgc2hvdXQoImFiTWVudVJlZnJlc2giKTsKfQplbHNlIGlmIChjb25maWdCb3QudGFncy5hYlNjYW4pCnsKICAgIHNob3V0KCJhYk1lbnVSZWZyZXNoIik7CgogICAgY29uZmlnQm90LnRhZ3MuYWJTY2FuID0gbnVsbDsKICAgIAogICAgb3MuY2xvc2VRUkNvZGVTY2FubmVyKCk7CgogICAgbGV0IHNjYW5uZWRVUkw7CgogICAgdHJ5IAogICAgewogICAgICAgIHNjYW5uZWRVUkwgPSBuZXcgVVJMKHRoYXQpOwogICAgfQogICAgY2F0Y2ggKGUpIAogICAgewogICAgICAgIGxpbmtzLnNlYXJjaC5hYkxUTVNlYXJjaCh7YWJJRDogdGhhdH0pOwoKICAgICAgICByZXR1cm47CiAgICB9CgogICAgaWYoc2Nhbm5lZFVSTC5zZWFyY2hQYXJhbXMuZ2V0KCJhYiIpID09ICJlZ2dDYXJ0b24iKQogICAgewogICAgICAgIG9zLmdvVG9VUkwodGhhdCk7CiAgICB9CiAgICBlbHNlCiAgICB7CiAgICAgICAgc2Nhbm5lZFVSTC5zZWFyY2hQYXJhbXMuZm9yRWFjaCgodmFsdWUsIGtleSkgPT4gewogICAgICAgICAgICBsZXQgbmV3VGFnID0ga2V5OwogICAgICAgICAgICBsZXQgbmV3VmFsdWUgPSB2YWx1ZTsKCiAgICAgICAgICAgIGNvbmZpZ0JvdC50YWdzW25ld1RhZ10gPSBuZXdWYWx1ZTsKICAgICAgICB9KTsKCiAgICAgICAgbGlua3Muc2VhcmNoLmFiTFRNU2VhcmNoKHthYklEOiBjb25maWdCb3QudGFncy5hYn0pOwogICAgfQp9JwCE2Zr+CdgVBXN0b3JlAgQAhNma/gnEIijwn5SXNzZhZjA0OTEtMzkxOS00OTg0LWFhODItMjJjNzQyZjQyNjNmJwCE2Zr+CdgVBnNlYXJjaAIEAITZmv4J6yIo8J+Ul2Q4MzcxNDQ0LTkxNTgtNDQzNi04ZmM3LTg0Y2M5MWI3ZjUyNScAhNma/gnYFRBhYkNvcmVNZW51QWN0aW9uAgQAhNma/gmSIzdAb3Mub3BlblFSQ29kZVNjYW5uZXIoKTsKCmNvbmZpZ0JvdC50YWdzLmFiU2NhbiA9IHRydWU7JwCE2Zr+CdgVD2FiQ29yZU1lbnVMYWJlbAIEAITZmv4JyiMEc2NhbicAhNma/gnYFQ5hYkNvcmVNZW51SWNvbgIEAITZmv4JzyMPcXJfY29kZV9zY2FubmVyJwCE2Zr+CdgVE2FiQ29yZU1lbnVTb3J0T3JkZXICBACE2Zr+Cd8jATMnAITZmv4J2BUJYWJWZXJzaW9uAgQAhNma/gnhIwQxMC40JwEEYm90cyQ0OTNmZmE0ZC00NmQ0LTRhOTgtYWU5Yy0xMjEyZDY1MTEzM2YBJwCE2Zr+CeYjBnN5c3RlbQIEAITZmv4J5yMUYWIuaW50ZXJmYWNlLnZlcnNpb24nAITZmv4J5iMNb25Ta2lsbFVwZGF0ZQIEAITZmv4J/COnAUBjb25zdCB2ZXJzaW9uU3RyaW5nID0gdGFncy5hYkludGVyZmFjZU1ham9yVmVyc2lvbiArICIuIiArIHRhZ3MuYWJJbnRlcmZhY2VNaW5vclZlcnNpb247DQoNCmNvbnNvbGUubG9nKCJbQUJJbnRlcmZhY2VdIExvYWRlZCBBQiBJbnRlcmZhY2UgdmVyc2lvbiAiICsgdmVyc2lvblN0cmluZyk7JwCE2Zr+CeYjF2FiSW50ZXJmYWNlTWFqb3JWZXJzaW9uAgQAhNma/gmkJQExJwCE2Zr+CeYjF2FiSW50ZXJmYWNlTWlub3JWZXJzaW9uAgQAhNma/gmmJQEyJwCE2Zr+CeYjCGFiSWdub3JlAgQAhNma/gmoJQR0cnVlJwCE2Zr+CeYjBGZvcm0CBACE2Zr+Ca0lB25vdGhpbmcnAITZmv4J5iMLYWJJbnRlcmZhY2UCBACE2Zr+CbUlBHRydWUnAITZmv4J5iMJYWJWZXJzaW9uAgQAhNma/gm6JQQxMC40JwEEYm90cyQ0YWFmNjk5ZS1hYmJmLTQ0YTgtODVlMS02OGNiYjVkZjBlMWYBJwCE2Zr+Cb8lBnN5c3RlbQIEAITZmv4JwCUTYWIuaW50ZXJmYWNlLm51Z2dldCcAhNma/gm/JQRmb3JtAgQAhNma/gnUJQdub3RoaW5nJwCE2Zr+Cb8lC2FiSW50ZXJmYWNlAgQAhNma/gncJQR0cnVlJwCE2Zr+Cb8lCGFiSWdub3JlAgQAhNma/gnhJQR0cnVlJwCE2Zr+Cb8lDGFiTG9hZE51Z2dldAIEAITZmv4J5iWYAkBsZXQgbnVnZ2V0TmFtZSA9IHRoYXQubnVnZ2V0TmFtZTsKbGV0IGZvcm1hdHRlZE51Z2dldEFCID0gIm51Z18iK251Z2dldE5hbWU7CmxldCBsb2FkZWROdWdnZXQgPSBhd2FpdCBsaW5rcy5zZWFyY2gub25Mb29rdXBBQkVnZ3Moe2FiSUQ6IGZvcm1hdHRlZE51Z2dldEFCLCBhYlZlcnNpb246IHRoYXQudmVyc2lvbiwgcmV0dXJuVHlwZTogImRhdGEifSk7Cgpsb2FkZWROdWdnZXQgPSBsb2FkZWROdWdnZXQuc3RhdGVbbnVnZ2V0TmFtZV0ubnVnZ2V0OwoKcmV0dXJuIGxvYWRlZE51Z2dldDsnAITZmv4JvyUPYWJQdWJsaXNoTnVnZ2V0AgQAhNma/gn/J+0CQC8vc2hvdXQoImFiUHVibGlzaE51Z2dldCIsIHtudWc6ICJudWdOYW1lIiwgZGF0YTogZGF0YX0pOyAgQUREIEVHRyBJRCBFVkVOVFVBTExZCmxldCB0ZXN0TnVnZ2V0ID0gdGhhdC5kYXRhOwpsZXQgZm9ybWF0dGVkTnVnZ2V0ID0ge2lkOiB0aGF0Lm51ZywgbnVnZ2V0OiB0ZXN0TnVnZ2V0fTsKbGV0IHRlc3ROdWdnZXROYW1lID0gdGhhdC5udWc7CmxldCBmb3JtYXR0ZWROdWdnZXRBQiA9ICJudWdfIit0ZXN0TnVnZ2V0TmFtZTsKCm1hc2tzLm51Z2dldFRvUHVibGlzaCA9IGZvcm1hdHRlZE51Z2dldEFCOwoKbGlua3Muc3RvcmUuYWJQdWJsaXNoQUIoe2FiOiBmb3JtYXR0ZWROdWdnZXRBQiwgdGFyZ2V0OiBmb3JtYXR0ZWROdWdnZXR9KTsnAITZmv4JvyUPaW1wbGVtZW50TnVnZ2V0AgQAhNma/gntKrEHQGxldCBudWdnZXROYW1lID0gdGhhdC5udWdnZXQ7CmxldCBudWdnZXRWZXJzaW9uQ2hlY2sgPSBudWdnZXROYW1lLmluZGV4T2YoIi52Iik7CmxldCB2ZXJzaW9uOwoKaWYgKG51Z2dldFZlcnNpb25DaGVjayAhPSAtMSkKewogICAgbnVnZ2V0TmFtZSA9IG51Z2dldE5hbWUuc3Vic3RyaW5nKDAsIG51Z2dldFZlcnNpb25DaGVjayk7CgogICAgbGV0IHZlcnNpb25DaGVjayA9IHRoYXQubnVnZ2V0LnN1YnN0cmluZyhudWdnZXRWZXJzaW9uQ2hlY2sgKyAyKTsKCiAgICBpZiAoaXNOYU4odmVyc2lvbkNoZWNrKSkKICAgIHsKICAgICAgICBjb25zb2xlLmxvZyh2ZXJzaW9uQ2hlY2ssICJ2ZXJzaW9uIGlzIG5vdCBhIG51bWJlciIpOwogICAgfQogICAgZWxzZQogICAgewogICAgICAgIHZlcnNpb24gPSBOdW1iZXIodmVyc2lvbkNoZWNrKTsKICAgIH0KfQpjb25zb2xlLmxvZyhudWdnZXROYW1lLCB2ZXJzaW9uKTsKbGV0IG51Z0RhdGEgPSBhd2FpdCB0aGlzQm90LmFiTG9hZE51Z2dldCh7bnVnZ2V0TmFtZTogbnVnZ2V0TmFtZSwgdmVyc2lvbjogdmVyc2lvbn0pOwoKaWYgKG51Z0RhdGEgPT0gImFiSUQgbm90IGZvdW5kIikKewogICAgb3MudG9hc3QoIm51Z2dldCBub3QgZm91bmQiKTsKfQplbHNlCnsKICAgIGxldCB0YXJnZXRCb3QgPSBnZXRCb3QoImlkIiwgdGhhdC5ib3QpOwogICAgbGV0IHRhcmdldFRhZyA9IHRhcmdldEJvdC5yYXdbdGhhdC50YWddLnRvU3RyaW5nKCk7CiAgICBsZXQgdGFyZ2V0TnVnID0gInsiICsgdGhhdC5udWdnZXQgKyAifSI7IAogICAgbGV0IG51Z1BvcyA9IHRhcmdldFRhZy5pbmRleE9mKHRhcmdldE51Zyk7CgogICAgZGVsZXRlVGFnVGV4dCh0YXJnZXRCb3QsIHRoYXQudGFnLCBudWdQb3MsIHRhcmdldE51Zy5sZW5ndGgpOwogICAgaW5zZXJ0VGFnVGV4dCh0YXJnZXRCb3QsIHRoYXQudGFnLCBudWdQb3MsIG51Z0RhdGEpOwp9JwCE2Zr+Cb8lDG51Z2dldEJ1dHRvbgIEAITZmv4JnzL1DEBsZXQgdGFnVmFsdWUgPSB0aGF0LnRhZ1ZhbHVlOwpsZXQgcmVnZXggPSAvXG4vZ2k7CmxldCBicmVha0NoZWNrOwpsZXQgYnJlYWtBcnJheSA9IFswXTsKLy9sZXQgY3JlYXRlZEJ1dHRvbnMgPSBbXTsKCndoaWxlIChicmVha0NoZWNrID0gcmVnZXguZXhlYyh0YWdWYWx1ZSkpCnsKICAgIGJyZWFrQXJyYXkucHVzaChicmVha0NoZWNrLmluZGV4KTsKfQoKbGV0IG5ld051Z2dldEJ1dHRvbiA9IHt9OwoKbmV3TnVnZ2V0QnV0dG9uLnNwYWNlID0gInRlbXBMb2NhbCI7Cm5ld051Z2dldEJ1dHRvbi5mb3JtID0gImNvZGVCdXR0b24iOwpuZXdOdWdnZXRCdXR0b24udGFyZ2V0Qm90ID0gdGhhdC5ib3QuaWQ7Cm5ld051Z2dldEJ1dHRvbi50YXJnZXRUYWcgPSB0aGF0LnRhZzsKbmV3TnVnZ2V0QnV0dG9uLmxhYmVsID0gImxvYWQgbnVnZ2V0IjsKbmV3TnVnZ2V0QnV0dG9uLm51Z2dldFJlc2V0ID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwpuZXdOdWdnZXRCdXR0b25bdGhhdC5ib3QuaWQgKyAiLiIgKyB0aGF0LnRhZ10gPSB0cnVlOwpuZXdOdWdnZXRCdXR0b24ubnVnZ2V0TWFuYWdlciA9ICLwn5SXIiArIHRoaXNCb3QuaWQ7Cm5ld051Z2dldEJ1dHRvbi5vbkNsaWNrID0gYEAgbGlua3MubnVnZ2V0TWFuYWdlci5pbXBsZW1lbnROdWdnZXQoe2JvdDogdGFncy50YXJnZXRCb3QsIG51Z2dldDogdGFncy50YXJnZXROdWdnZXQsIHRhZzogdGFncy50YXJnZXRUYWd9KTsKCmRlc3Ryb3kodGhpc0JvdCk7YDsKCmZvciAobGV0IG51Z3MgPSAwOyBudWdzIDwgdGhhdC5udWdnZXQubGVuZ3RoOyBudWdzKyspCnsKICAgIGxldCBjdXJyZW50TnVnZ2V0ID0gdGhhdC5udWdnZXRbbnVnc107CiAgICAvL2xldCBidXR0b25DaGVjayA9IGNyZWF0ZWRCdXR0b25zLmluZGV4T2YoY3VycmVudE51Z2dldC5udWdOYW1lKTsKCiAgICBpZiAoIWN1cnJlbnROdWdnZXQgfHwgY3VycmVudE51Z2dldCA9PSB1bmRlZmluZWQpIC8vfHwgYnV0dG9uQ2hlY2sgIT0gLTEKICAgIHsKICAgICAgICBjb250aW51ZTsKICAgIH0KCiAgICBpZiAoY3VycmVudE51Z2dldC5udWdQdWJsaXNoKQogICAgewogICAgICAgIG5ld051Z2dldEJ1dHRvbi5vbkNsaWNrID0gYEAgbGlua3MubnVnZ2V0TWFuYWdlci5wYWNrYWdlTnVnZ2V0KHtib3Q6IHRhZ3MudGFyZ2V0Qm90LCBudWdnZXQ6IHRhZ3MudGFyZ2V0TnVnZ2V0LCB0YWc6IHRhZ3MudGFyZ2V0VGFnfSk7CgogICAgICAgIGRlc3Ryb3kodGhpc0JvdCk7YDsKCiAgICAgICAgbmV3TnVnZ2V0QnV0dG9uLmxhYmVsID0gInB1Ymxpc2ggIiArIGN1cnJlbnROdWdnZXQubnVnTmFtZSArICIgbnVnZ2V0IjsKICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBuZXdOdWdnZXRCdXR0b24ubGFiZWwgPSAibG9hZCAiICsgY3VycmVudE51Z2dldC5udWdOYW1lICsgIiBudWdnZXQiOwogICAgfQoKICAgIG5ld051Z2dldEJ1dHRvbi50YXJnZXROdWdnZXQgPSBjdXJyZW50TnVnZ2V0Lm51Z05hbWU7CiAgICBuZXdOdWdnZXRCdXR0b25bdGhhdC5ib3QuaWQgKyAiLiIgKyB0aGF0LnRhZyArICJTdGFydCJdID0gY3VycmVudE51Z2dldC5udWdTdGFydDsKCiAgICBjcmVhdGUobmV3TnVnZ2V0QnV0dG9uKTsKCiAgICAvL2NyZWF0ZWRCdXR0b25zLnB1c2goY3VycmVudE51Z2dldC5udWdOYW1lKTsKfQoKcmV0dXJuOycAhNma/gm/JQtudWdnZXRQYXJzZQIEAITZmv4Jkz+nD0Bjb25zdCBvcmlnaW5hbFRhZ1ZhbHVlID0gdGhhdC5lZGl0ZWRCb3QucmF3W3RoYXQuZWRpdGVkVGFnXTsKbGV0IHRhZ1ZhbHVlID0gb3JpZ2luYWxUYWdWYWx1ZTsKCmlmICghdGFnVmFsdWUpIAp7CiAgICByZXR1cm47Cn0KZWxzZSBpZiAodHlwZW9mIHRhZ1ZhbHVlICE9PSAic3RyaW5nIikgCnsKICAgIHRhZ1ZhbHVlID0gdGFnVmFsdWUudG9TdHJpbmcoKTsKfQoKbGV0IGluaXRpYWxQb3NzaWJsZU51Z1BvcyA9IDA7CgppZiAoaW5pdGlhbFBvc3NpYmxlTnVnUG9zID09IC0xKSAKewogICAgcmV0dXJuOwp9CmVsc2UKewogICAgdGFnVmFsdWUgPSB0YWdWYWx1ZS5zdWJzdHJpbmcoaW5pdGlhbFBvc3NpYmxlTnVnUG9zKTsKfQoKbGV0IHBvc3NpYmxlTnVncyA9IG9yaWdpbmFsVGFnVmFsdWUucmVwbGFjZSgvW157XS9nLCAiIikubGVuZ3RoOwpsZXQgdG90YWxOdWdCcmVha3MgPSBvcmlnaW5hbFRhZ1ZhbHVlLnJlcGxhY2UoL1teXG5dL2csICIiKS5sZW5ndGg7CmxldCBicmVha0xldmVsID0gMDsKbGV0IG51Z3NUb0NoZWNrID0gW107Cgpmb3IgKGxldCBpID0gMDsgaSA8IHBvc3NpYmxlTnVnczsgaSsrKQp7CiAgICBsZXQgaW5pdGlhbE51Z1BvcyA9IHRhZ1ZhbHVlLmluZGV4T2YoInsiKSArIDE7CiAgICBsZXQgcG9zc2libGVOdWdFbmQgPSB0YWdWYWx1ZS5pbmRleE9mKCJ9Iik7CiAgICBsZXQgcG9zc2libGVOdWcgPSB0YWdWYWx1ZS5zdWJzdHJpbmcoaW5pdGlhbE51Z1BvcywgcG9zc2libGVOdWdFbmQpOwoKICAgIGlmIChwb3NzaWJsZU51Zy5pbmRleE9mKCIgIikgPT0gLTEgJiYgL1xuL2cudGVzdChwb3NzaWJsZU51ZykgIT0gdHJ1ZSAmJiBwb3NzaWJsZU51Zy5sZW5ndGggPiAwICYmIHBvc3NpYmxlTnVnLmluZGV4T2YoIjoiKSA9PSAtMSkKICAgIHsKICAgICAgICBsZXQgbnVnQnJlYWtzID0gdGFnVmFsdWUuc3Vic3RyaW5nKDAsIHRhZ1ZhbHVlLmluZGV4T2YoInsiK3Bvc3NpYmxlTnVnKyJ9IikpLnJlcGxhY2UoL1teXG5dL2csICIiKS5sZW5ndGg7CiAgICAgICAgbGV0IHB1Ymxpc2hDaGVjayA9IHRhZ1ZhbHVlLnN1YnN0cmluZyhpbml0aWFsTnVnUG9zIC0gNiwgaW5pdGlhbE51Z1BvcyAtIDIpOwogICAgICAgIGxldCBudWdQdWJsaXNoID0gbnVsbDsKCiAgICAgICAgaWYgKHB1Ymxpc2hDaGVjayA9PSAiLm51ZyIpCiAgICAgICAgewogICAgICAgICAgICBudWdQdWJsaXNoID0gdHJ1ZTsKICAgICAgICB9CgogICAgICAgIGJyZWFrTGV2ZWwgKz0gbnVnQnJlYWtzOwoKICAgICAgICBudWdCcmVha3MgPSB0b3RhbE51Z0JyZWFrcyAtICh0b3RhbE51Z0JyZWFrcyAtIGJyZWFrTGV2ZWwpOwogICAgICAgIAogICAgICAgIC8vQ0hFQ0sgSUYgJCBiZWZvcmUgbnVnZ2V0CiAgICAgICAgaWYgKHRhZ1ZhbHVlLnN1YnN0cmluZyhpbml0aWFsTnVnUG9zIC0gMiwgaW5pdGlhbE51Z1BvcyAtIDEpICE9ICIkIikKICAgICAgICB7CiAgICAgICAgICAgIG51Z3NUb0NoZWNrLnB1c2goe251Z05hbWU6IHBvc3NpYmxlTnVnLCBudWdTdGFydDogbnVnQnJlYWtzICsgMSwgbnVnUHVibGlzaDogbnVnUHVibGlzaH0pOwogICAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgICBsZXQgbnVnQnJlYWtzID0gdGFnVmFsdWUuc3Vic3RyaW5nKDAsIHRhZ1ZhbHVlLmluZGV4T2YoIn0iKSkucmVwbGFjZSgvW15cbl0vZywgIiIpLmxlbmd0aDsKCiAgICAgICAgYnJlYWtMZXZlbCArPSBudWdCcmVha3M7CgogICAgICAgIG51Z0JyZWFrcyA9IHRvdGFsTnVnQnJlYWtzIC0gKHRvdGFsTnVnQnJlYWtzIC0gYnJlYWtMZXZlbCk7CiAgICB9CgogICAgdGFnVmFsdWUgPSB0YWdWYWx1ZS5zdWJzdHJpbmcocG9zc2libGVOdWdFbmQgKyAxKTsKfQoKdGhpc0JvdC5udWdnZXRCdXR0b24oeyBudWdnZXQ6IG51Z3NUb0NoZWNrLCBib3Q6IHRoYXQuZWRpdGVkQm90LCB0YWc6IHRoYXQuZWRpdGVkVGFnLCB0YWdWYWx1ZTogb3JpZ2luYWxUYWdWYWx1ZX0pOycAhNma/gm/JQ1vbkFCUHVibGlzaGVkAgQAhNma/gm7TsEBQGNvbnNvbGUubG9nKHRoYXQuYWIsIHRhZ3MubnVnZ2V0VG9QdWJsaXNoKQoKaWYgKHRoYXQuYWIgPT0gdGFncy5udWdnZXRUb1B1Ymxpc2gpCnsKICAgIG9zLnRvYXN0KCJudWdnZXQgcHVibGlzaGVkIik7CgogICAgbWFza3MubnVnZ2V0VG9QdWJsaXNoID0gbnVsbDsKCiAgICBjb25maWdCb3QubWFza3MuYWJWZXJzaW9uID0gbnVsbDsKfScAhNma/gm/JRBvbkFueUJvdHNDaGFuZ2VkAgQAhNma/gn9T7cEQGlmIChjb25maWdCb3QgJiYgdGhhdFswXS5ib3QuaWQgIT0gdGhpc0JvdC5pZCkgCnsKICAgIGlmICghY29uZmlnQm90LnRhZ3MuZWRpdGluZ0JvdCkgcmV0dXJuOyAvLyBJZ25vcmUgaWYgdGhlIGNvbmZpZ0JvdCBpc24ndCByZWFkeSB5ZXQuCgogICAgY29uc3QgZWRpdGVkQm90SUQgPSBjb25maWdCb3QudGFncy5lZGl0aW5nQm90LnJlcGxhY2UoIvCflJciLCAiIik7CgogICAgaWYgKCF0aGF0LmZpbmQoeCA9PiB4LmJvdC5pZCA9PSBlZGl0ZWRCb3RJRCkpIHJldHVybjsgLy8gSWYgdGhlIGJvdCBjaGFuZ2VkIHdhc24ndCBiZWluZyBlZGl0ZWQgYnkgdGhlIHVzZXIgaWdub3JlIGl0LgoKICAgIGNvbnN0IGVkaXRlZFRhZyA9IGNvbmZpZ0JvdC50YWdzLmVkaXRpbmdUYWc7CiAgICBjb25zdCBlZGl0ZWRCb3QgPSBnZXRCb3QoImlkIiwgZWRpdGVkQm90SUQpOwoKICAgIGlmIChlZGl0ZWRCb3QgJiYgZWRpdGVkVGFnKSAKICAgIHsKICAgICAgICBzaG91dCgibnVnZ2V0UmVzZXQiKTsKCiAgICAgICAgdGhpc0JvdC5udWdnZXRQYXJzZSh7IGVkaXRlZEJvdCwgZWRpdGVkVGFnIH0pOwogICAgfQp9JwCE2Zr+Cb8lCG9uQ3JlYXRlAgQAhNma/gmzVExAdGFncy5saXN0ZW5pbmcgPSBmYWxzZTsKCi8vc2V0VGFnTWFzayh0aGlzQm90LCAibGlzdGVuaW5nIiwgdHJ1ZSwgImxvY2FsIik7JwCE2Zr+Cb8lDXBhY2thZ2VOdWdnZXQCBACE2Zr+CYBV+AZAY29uc3QgdGFyZ2V0Qm90ID0gZ2V0Qm90KCJpZCIsIHRoYXQuYm90KTsKY29uc3QgdGFnVGV4dCA9IHRhcmdldEJvdC5yYXdbdGhhdC50YWddOwoKaWYgKGNvbmZpZ0JvdC50YWdzLmN1cnNvclN0YXJ0SW5kZXggfHwgY29uZmlnQm90LnRhZ3MuY3Vyc29yRW5kSW5kZXgpCnsKICAgIGxldCBzdGFydFBvcyA9IGNvbmZpZ0JvdC50YWdzLmN1cnNvclN0YXJ0SW5kZXg7CiAgICBsZXQgZW5kUG9zID0gY29uZmlnQm90LnRhZ3MuY3Vyc29yRW5kSW5kZXg7CgogICAgaWYgKHN0YXJ0UG9zID09IGVuZFBvcykKICAgIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBlbHNlIGlmIChzdGFydFBvcyA+IGVuZFBvcykKICAgIHsKICAgICAgICBsZXQgbmV3U3RhcnRQb3MgPSBlbmRQb3M7CiAgICAgICAgbGV0IG5ld0VuZFBvcyA9IHN0YXJ0UG9zOwoKICAgICAgICBzdGFydFBvcyA9IG5ld1N0YXJ0UG9zOwogICAgICAgIGVuZFBvcyA9IG5ld0VuZFBvczsKICAgIH0KCiAgICBsZXQgZGF0YSA9IHRhZ1RleHQuc3Vic3RyaW5nKHN0YXJ0UG9zLCBlbmRQb3MgKyAxKTsKCiAgICBzaG91dCgiYWJQdWJsaXNoTnVnZ2V0Iiwge251ZzogdGhhdC5udWdnZXQsIGRhdGE6IGRhdGF9KTsKCiAgICBvcy50b2FzdCgibnVnIGlzIHB1Ymxpc2hpbmciLCAxMCk7CgogICAgbGV0IHRhcmdldE51ZyA9ICIubnVnIHsiICsgdGhhdC5udWdnZXQgKyAifSI7IAogICAgbGV0IG51Z1BvcyA9IHRhcmdldEJvdC5yYXdbdGhhdC50YWddLmluZGV4T2YodGFyZ2V0TnVnKTsKCiAgICBkZWxldGVUYWdUZXh0KHRhcmdldEJvdCwgdGhhdC50YWcsIG51Z1BvcywgdGFyZ2V0TnVnLmxlbmd0aCk7Cn0KZWxzZQp7CiAgICBvcy50b2FzdCgiY2Fubm90IHJlYWQgbnVnZ2V0IHRvIGJlIHB1Ymxpc2hlZCIpCn0nAITZmv4JvyUIcmVtZW1iZXICBACE2Zr+CflbKPCflJdlNTM4MGE2Yi04YjRkLTRhOGItOGIwNC01OGUxZWIwM2U1ZTcnAITZmv4JvyUGc2VhcmNoAgQAhNma/gmgXCjwn5SXZDgzNzE0NDQtOTE1OC00NDM2LThmYzctODRjYzkxYjdmNTI1JwCE2Zr+Cb8lBXN0b3JlAgQAhNma/gnHXCjwn5SXNzZhZjA0OTEtMzkxOS00OTg0LWFhODItMjJjNzQyZjQyNjNmJwCE2Zr+Cb8lCWxpc3RlbmluZwIEAITZmv4J7lwFZmFsc2UnAITZmv4JvyUJYWJWZXJzaW9uAgQAhNma/gn0XAQxMC40JwEEYm90cyRiMzBjNmM1ZC1hNGY3LTQyNjYtYmEzOC0zOTNkYzk1ZTFlY2IBJwCE2Zr+CflcBnN5c3RlbQIEAITZmv4J+lwRYWIuaW50ZXJmYWNlLm1lbnUnAITZmv4J+VwEZm9ybQIEAITZmv4JjF0Hbm90aGluZycAhNma/gn5XAtkZXNjcmlwdGlvbgIEAITZmv4JlF0mVGhpcyBza2lsbCBpcyBkZXNpZ25lZCBmb3IgbWVudSBzdHVmZi4oAITZmv4J+VwLYWJJbnRlcmZhY2UBeCcAhNma/gn5XAphYk9wZW5NZW51AgQAhNma/gm8XekKQGF3YWl0IG9zLnJlcXVlc3RBdXRoQm90SW5CYWNrZ3JvdW5kKCk7Cgpjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9ICJhYk1lbnUiOwoKbGV0IG1lbnVUeXBlID0gdGhhdCA/ICJhYiIgKyB0aGF0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGhhdC5zbGljZSgxKSArICJNZW51IjogImFiQ29yZU1lbnUiOyAvL3NldCB1cCBhIGNoZWNrIHRvIHNlZSB3aGF0IHR5cGUgb2YgbWVudSBzaG91bGQgYmUgb2NjdXJpbmcgW2NvcmUsIGJvdCwgZ3JpZCwgaW5zdF0KbGV0IG1lbnVTa2lsbHMgPSBnZXRCb3RzKG1lbnVUeXBlICsgIkFjdGlvbiIpOwpsZXQgbWF4T3B0aW9ucyA9IG1lbnVUeXBlID09ICJpbnN0IiA/IDcgOiA1OwpsZXQgYWJNZW51QnV0dG9uID0ge307CgphYk1lbnVCdXR0b24uYWJNZW51ID0gdHJ1ZTsKYWJNZW51QnV0dG9uLnJlbWVtYmVyID0gdGFncy5yZW1lbWJlcjsKYWJNZW51QnV0dG9uLm1hbmlmZXN0YXRpb24gPSB0YWdzLm1hbmlmZXN0YXRpb247CmFiTWVudUJ1dHRvbi5hYk1lbnVSZWZyZXNoID0gIkAgZGVzdHJveSh0aGlzQm90KTsiOwphYk1lbnVCdXR0b24ub25DbGljayA9IGBAIGxpbmtzLmJhc2VTa2lsbC4ke21lbnVUeXBlICsgIkFjdGlvbiJ9KHtib3Q6IHRoaXNCb3R9KTtgOwoKZm9yIChsZXQgaSA9IDA7IGkgPCBtZW51U2tpbGxzLmxlbmd0aDsgaSsrKS8vQUREIExPR0lDIEZPUiBNT1JFIE9QVElPTlMgVEhBTiA1IDogbWF4T3B0aW9ucwp7CiAgICBsZXQgY3VycmVudFNraWxsID0gbWVudVNraWxsc1tpXTsKCiAgICBhYk1lbnVCdXR0b24uYmFzZVNraWxsID0gIvCflJciICsgY3VycmVudFNraWxsLmlkOwogICAgYWJNZW51QnV0dG9uLmxhYmVsID0gY3VycmVudFNraWxsLnRhZ3NbbWVudVR5cGUgKyAiTGFiZWwiXTsKICAgIGFiTWVudUJ1dHRvbi5mb3JtQWRkcmVzcyA9IGN1cnJlbnRTa2lsbC50YWdzW21lbnVUeXBlICsgIkljb24iXTsKICAgIGFiTWVudUJ1dHRvbi5vbkNyZWF0ZSA9IGN1cnJlbnRTa2lsbC50YWdzW21lbnVUeXBlICsgIk9uR2VuZXJhdGUiXTsKICAgIGFiTWVudUJ1dHRvbi5hYk1lbnVTb3J0T3JkZXIgPSBjdXJyZW50U2tpbGwudGFnc1ttZW51VHlwZSArICJTb3J0T3JkZXIiXTsKICAgIGFiTWVudUJ1dHRvbi5jb2xvciA9IGN1cnJlbnRTa2lsbC50YWdzW21lbnVUeXBlICsgIkNvbG9yIl0gPyBjdXJyZW50U2tpbGwudGFnc1ttZW51VHlwZSArICJDb2xvciJdIDogbGlua3MucmVtZW1iZXIudGFncy5hYkJhc2VTdHJva2VDb2xvcjsKCiAgICB0aGlzQm90LmFiQ3JlYXRlTWVudUJ1dHRvbihhYk1lbnVCdXR0b24pOwp9Cgp0aGlzQm90Lm1hc2tzLm9uR3JpZENsaWNrID0gIkAgc2hvdXQoJ2FiTWVudVJlZnJlc2gnKTsgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7IjsnAITZmv4J+VwSYWJDcmVhdGVNZW51QnV0dG9uAgQAhNma/gmkaPENQGxldCBuZXdNZW51QnV0dG9uID0ge307CgpsZXQgewogICAgbWVudUl0ZW1TdHlsZSA9IHt9LAogICAgLi4uYWRkaXRpb25hbFRhZ3MKfSA9IHRoYXQgPz8ge30KCmlmICh0eXBlb2YgbWVudUl0ZW1TdHlsZSA9PSAnc3RyaW5nJykgewogICAgbWVudUl0ZW1TdHlsZSA9IG1lbnVJdGVtU3R5bGUucmVwbGFjZSgvXHV7MUY5RUN9L3UsICcnKTsgCiAgICBtZW51SXRlbVN0eWxlID0gSlNPTi5wYXJzZShtZW51SXRlbVN0eWxlKTsKfQoKZnVuY3Rpb24gaGFzQm9yZGVyU3R5bGUoKSB7CiAgICBpZiAobWVudUl0ZW1TdHlsZVsiYm9yZGVyLXRvcC1zdHlsZSJdIAogICAgICAgIHx8IG1lbnVJdGVtU3R5bGVbImJvcmRlci1sZWZ0LXN0eWxlIl0gCiAgICAgICAgfHwgbWVudUl0ZW1TdHlsZVsiYm9yZGVyLWJvdHRvbS1zdHlsZSJdIAogICAgICAgIHx8IG1lbnVJdGVtU3R5bGVbImJvcmRlci1yaWdodC1zdHlsZSJdKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgcmV0dXJuIGZhbHNlOwp9CgppZiAoYWRkaXRpb25hbFRhZ3NbY29uZmlnQm90LnRhZ3MubWVudVBvcnRhbF0pIHsKICAgIGlmIChhZGRpdGlvbmFsVGFnc1tjb25maWdCb3QudGFncy5tZW51UG9ydGFsICsgIk1lbnVHcm91cCJdKSB7CgogICAgfQp9CgpuZXdNZW51QnV0dG9uLnNwYWNlID0gInRlbXBMb2NhbCI7Cm5ld01lbnVCdXR0b24uY29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yOwpuZXdNZW51QnV0dG9uLmxhYmVsQ29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZUxhYmVsQ29sb3IgPz8gIiMwMDAiOwpuZXdNZW51QnV0dG9uLmxhYmVsQWxpZ25tZW50ID0gImxlZnQiOwpuZXdNZW51QnV0dG9uLnNoYWRvd0NvbG9yID0gdGhhdC5zaGFkb3dDb2xvciA/PyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVNoYWRvd0NvbG9yID8/ICIjMDAwIjsKbmV3TWVudUJ1dHRvbi5zY2FsZVkgPSAxOwoKY29uc3QgbWVudVN0eWxpbmcgPSB7CiAgICAiYm9yZGVyLXJhZGl1cyI6IjhweCIsCiAgICAibWFyZ2luLXRvcCI6ICI4cHgiLAogICAgImJveC1zaGFkb3ciOiBgM3B4IDRweCAke25ld01lbnVCdXR0b24uc2hhZG93Q29sb3J9YCwKICAgICJtaW4taGVpZ2h0IjogIjQ0cHgiLAogICAgImJvcmRlciI6IGhhc0JvcmRlclN0eWxlKCkgPyAiIiA6IGAycHggc29saWQgJHtuZXdNZW51QnV0dG9uLnNoYWRvd0NvbG9yfWAsCiAgICAid2lkdGgiOiAiY2FsYygxMDAlIC0gNXB4KSIsCiAgICAuLi5tZW51SXRlbVN0eWxlCn0KCm5ld01lbnVCdXR0b24ubWVudUl0ZW1TdHlsZSA9IG1lbnVTdHlsaW5nOwoKY29uc3QgY2xpY2tlZFN0eWxpbmcgPSB7CiAgICAuLi5tZW51U3R5bGluZywKICAgICJmaWx0ZXIiOiAiYnJpZ2h0bmVzcyg2MCUpIgp9CmNvbnN0IGJhc2VTdHlsZSA9IGBAIG1hc2tzLm1lbnVJdGVtU3R5bGUgPSAn8J+nrCAke0pTT04uc3RyaW5naWZ5KGNsaWNrZWRTdHlsaW5nKX0nYAoKbmV3TWVudUJ1dHRvbi5vblBvaW50ZXJEb3duID0gbWVudUl0ZW1TdHlsZT8uWyJtYXJnaW4tdG9wIl0gIT0gIjBweCIgPyBiYXNlU3R5bGUgOiAiQCAvLyI7Cm5ld01lbnVCdXR0b24ub25Qb2ludGVyVXAgPSBgQCBtYXNrcy5tZW51SXRlbVN0eWxlID0gbnVsbGA7Cgpmb3IgKGNvbnN0IHRhZyBpbiBhZGRpdGlvbmFsVGFncykKewogICAgbmV3TWVudUJ1dHRvblt0YWddID0gYWRkaXRpb25hbFRhZ3NbdGFnXTsKfQoKbmV3TWVudUJ1dHRvbiA9IGNyZWF0ZShuZXdNZW51QnV0dG9uKTsKCnJldHVybiBuZXdNZW51QnV0dG9uOycAhNma/gn5XA1hYk1lbnVSZWZyZXNoAgQAhNma/gmUdoEBQGlmIChjb25maWdCb3QudGFncy5tZW51UG9ydGFsPy5zdWJzdHJpbmcoMCwyKSA9PSAiYWIiKQp7CiAgICBjb25maWdCb3QubWFza3MubWVudVBvcnRhbCA9IG51bGw7CgogICAgbWFza3Mub25HcmlkQ2xpY2sgPSBudWxsOwp9JwCE2Zr+CflcCHJlbWVtYmVyAgQAhNma/gmWdyjwn5SXZTUzODBhNmItOGI0ZC00YThiLThiMDQtNThlMWViMDNlNWU3JwCE2Zr+CflcDW1hbmlmZXN0YXRpb24CBACE2Zr+Cb13KPCflJdkY2E1ZDk4Ny1jNGQ4LTQ2ZTQtYjYwYy1kYWE3YjJmNGRkYWQnAITZmv4J+VwRYWJFbnZpcm9ubWVudE1lbnUCBACE2Zr+CeR36w1Ac2hvdXQoImFiTWVudVJlZnJlc2giKTsKCmNvbmZpZ0JvdC5tYXNrcy5tZW51UG9ydGFsID0gImFiTWVudSI7CgpsZXQgYWJNZW51QnV0dG9uID0ge307CgphYk1lbnVCdXR0b24uYWJNZW51ID0gdHJ1ZTsKYWJNZW51QnV0dG9uLmFiTWVudVJlZnJlc2ggPSAiQCBkZXN0cm95KHRoaXNCb3QpOyI7CmFiTWVudUJ1dHRvbi5tYW5pZmVzdGF0aW9uID0gdGFncy5tYW5pZmVzdGF0aW9uOwphYk1lbnVCdXR0b24ucmVtZW1iZXIgPSB0YWdzLnJlbWVtYmVyOwphYk1lbnVCdXR0b24ubGVhcm4gPSB0YWdzLmxlYXJuOwoKYnV0dG9uTG9vcDoKZm9yIChsZXQgaSA9IDA7IGkgPCB0YWdzLmFiRW52aXJvbm1lbnRBcnJheS5sZW5ndGg7IGkrKykKewogICAgbGV0IGFjdGl2ZUJ1dHRvbiA9IHRhZ3MuYWJFbnZpcm9ubWVudEFycmF5W2ldOwoKICAgIGFiTWVudUJ1dHRvbi5hYk1lbnVTb3J0T3JkZXIgPSBhY3RpdmVCdXR0b24uYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXI7CgogICAgaWYgKGFjdGl2ZUJ1dHRvbi5hYkVudmlyb25tZW50R2F0ZSkKICAgIHsKICAgICAgICBpZiAoIWxpbmtzW2FjdGl2ZUJ1dHRvbi5hYkVudmlyb25tZW50R2F0ZV0pCiAgICAgICAgewogICAgICAgICAgICBjb250aW51ZSBidXR0b25Mb29wOwogICAgICAgIH0KICAgIH0KCiAgICBsZXQgbmV3QnV0dG9uRGF0YSA9IHsuLi5hYk1lbnVCdXR0b24sIC4uLmFjdGl2ZUJ1dHRvbn07CgogICAgdGhpc0JvdC5hYkNyZWF0ZU1lbnVCdXR0b24obmV3QnV0dG9uRGF0YSk7Cn0KCmNvbnN0IGFiUGVyc29uYWxpdHlDb25maWdCdXR0b24gPSB7CiAgICBsYWJlbDogImN1c3RvbWl6ZTogYWIgcGVyc29uYWxpdHkiLAogICAgLi4uYWJNZW51QnV0dG9uLAogICAgYWJNZW51U29ydE9yZGVyOiAxLAogICAgZHJvcGRvd25Tb3J0T3JkZXI6IDEsCiAgICBkcm9wZG93bk9wdGlvbnM6IFsKICAgICAgICB7CiAgICAgICAgICAgICJsYWJlbCI6ICJuYW1lIiwKICAgICAgICAgICAgImZvcm1BZGRyZXNzIjogImN1YmUiLAogICAgICAgICAgICAib25DbGljayI6ICJAIGNvbnN0IG5hbWUgPSBhd2FpdCBvcy5zaG93SW5wdXQobGlua3MucmVtZW1iZXIudGFncy5hYkJ1aWxkZXJJZGVudGl0eSwge3RpdGxlOiAnd2hhdCB3b3VsZCB5b3UgbGlrZSB0byBjYWxsIG1lPyd9KTsgc2V0VGFnTWFzayhsaW5rcy5yZW1lbWJlciwgJ2FiQnVpbGRlcklkZW50aXR5JywgbmFtZSwgJ2xvY2FsJyk7IHNob3V0KCdidWlsZGVySWRlbnRpdHlfc2F2ZScsIHtuYW1lOiBuYW1lfSk7IGRlc3Ryb3kobGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdCk7IiwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbGFiZWw6ICJjb2xvciIsCiAgICAgICAgICAgIG9uQ2xpY2s6IGBAYCwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbGFiZWw6ICJtZW51IGNvbG9yIiwKICAgICAgICAgICAgb25DbGljazogYEBgLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBsYWJlbDogInByb21wdCIsCiAgICAgICAgICAgIG9uQ2xpY2s6IGBAYCwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbGFiZWw6ICJmb3JtIiwKICAgICAgICAgICAgb25DbGljazogYEBgLAogICAgICAgIH0KICAgIF0KfQoKLy90aGlzQm90LmFiQ3JlYXRlTWVudURyb3Bkb3duKGFiUGVyc29uYWxpdHlDb25maWdCdXR0b24pOwoKdGhpc0JvdC5tYXNrcy5vbkdyaWRDbGljayA9ICJAIHNob3V0KCdhYk1lbnVSZWZyZXNoJyk7IGxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljaygpOyI7JwCE2Zr+CflcBWxlYXJuAgQAhNma/gnQhQEo8J+UlzY2NTdiODY1LWU5ODMtNDQwMS05ZmM5LWY1NDE4ZDE4YTdmNycAhNma/gn5XANncHQCBACE2Zr+CfeFASjwn5SXZWM4NWMxZDYtOWYxYS00MGQ0LTgyZTEtNWJkNjgwMzQ5YzI3JwCE2Zr+CflcCGFiSWdub3JlAgQAhNma/gmehgEEdHJ1ZScAhNma/gn5XAZzZWFyY2gCBACE2Zr+CaOGASjwn5SXZDgzNzE0NDQtOTE1OC00NDM2LThmYzctODRjYzkxYjdmNTI1JwCE2Zr+CflcBm51Z2dldAIEAITZmv4JyoYBKPCflJc0YWFmNjk5ZS1hYmJmLTQ0YTgtODVlMS02OGNiYjVkZjBlMWYnAITZmv4J+VwFdGVzdHMCBACE2Zr+CfGGASjwn5SXYjgzZDk3MmItMDUzNS00MDUxLWI1ODktNDFjZWRhODUzNWYxJwCE2Zr+CflcD29uUG9ydGFsQ2hhbmdlZAIEAITZmv4JmIcBbkBpZiAodGhhdC5wb3J0YWwgPT0gInN5c3RlbVBvcnRhbCIgJiYgIXRoYXQuZGltZW5zaW9uICYmICFsaW5rcy50ZXN0cykKewogICAgbGlua3MubGVhcm4uYWJBZGFwdCgiYWJUZXN0cyIpOwp9JwCE2Zr+CflcA2FzawIEAITZmv4Jh4gBKPCflJdlYzg1YzFkNi05ZjFhLTQwZDQtODJlMS01YmQ2ODAzNDljMjcnAITZmv4J+VwSYWJFbnZpcm9ubWVudEFycmF5AgQAhNma/gmuiAHjJ/Cfp6xbCiAgICB7CiAgICAgICAgImxhYmVsIjogImhpZGUiLAogICAgICAgICJmb3JtQWRkcmVzcyI6ICJ2aXNpYmlsaXR5X29mZiIsCiAgICAgICAgIm9uQ2xpY2siOiAiQCBkZXN0cm95KGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QpOyIsCiAgICAgICAgImFiRW52aXJvbm1lbnRNZW51U29ydE9yZGVyIjogMAogICAgfSwKICAgIHsKICAgICAgICAibGFiZWwiOiAib3B0aW1pemUgbW9kZSIsCiAgICAgICAgIm9uQ3JlYXRlIjogIkAgY29uZmlnQm90LnRhZ3MuYWJPcHRpbWl6ZWQgPyB0YWdzLmZvcm1BZGRyZXNzID0gJ2NoZWNrX2JveCcgOiB0YWdzLmZvcm1BZGRyZXNzID0gJ2NoZWNrX2JveF9vdXRsaW5lX2JsYW5rJzsiLAogICAgICAgICJvbkNsaWNrIjogIkAgY29uZmlnQm90LnRhZ3MuYWJPcHRpbWl6ZWQgPyBjb25maWdCb3QudGFncy5hYk9wdGltaXplZCA9IGZhbHNlIDogY29uZmlnQm90LnRhZ3MuYWJPcHRpbWl6ZWQgPSB0cnVlOyB0aGlzQm90Lm9uQ3JlYXRlKCk7IiwKICAgICAgICAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiAxCiAgICB9LAogICAgewogICAgICAgICJsYWJlbCI6ICJuYW1lIiwKICAgICAgICAiZm9ybUFkZHJlc3MiOiAiY3ViZSIsCiAgICAgICAgIm9uQ2xpY2siOiAiQCBjb25zdCBuYW1lID0gYXdhaXQgb3Muc2hvd0lucHV0KGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHksIHt0aXRsZTogJ3doYXQgd291bGQgeW91IGxpa2UgdG8gY2FsbCBtZT8nfSk7IHNldFRhZ01hc2sobGlua3MucmVtZW1iZXIsICdhYkJ1aWxkZXJJZGVudGl0eScsIG5hbWUsICdsb2NhbCcpOyBzaG91dCgnYnVpbGRlcklkZW50aXR5X3NhdmUnLCB7bmFtZTogbmFtZX0pOyBkZXN0cm95KGxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3QpOyIsCiAgICAgICAgIm9uQ3JlYXRlIjogIkAiLAogICAgICAgICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDEuNQogICAgfSwKICAgIHsKICAgICAgICAibGFiZWwiOiAiY29sb3IiLAogICAgICAgICJmb3JtQWRkcmVzcyI6ICJwYWxldHRlIiwKICAgICAgICAib25DbGljayI6ICJAIGNvbnN0IGNvbG9yID0gYXdhaXQgb3Muc2hvd0lucHV0KGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlU3Ryb2tlQ29sb3IsIHt0eXBlOiAnY29sb3InLHRpdGxlOiAncGljayBhIGNvbG9yJ30pOyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZVN0cm9rZUNvbG9yID0gY29sb3I7IGlmIChsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZUNvbG9yICE9ICdjbGVhcicpe2xpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCYXNlQ29sb3IgPSBjb2xvcn07IGRlc3Ryb3kobGlua3MubWFuaWZlc3RhdGlvbi5saW5rcy5hYkJvdCk7IiwKICAgICAgICAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiAyCiAgICB9LAogICAgewogICAgICAgICJsYWJlbCI6ICJzbGVlcCIsCiAgICAgICAgImZvcm1BZGRyZXNzIjogIm5pZ2h0c19zdGF5IiwKICAgICAgICAib25DbGljayI6ICJAZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90KTsgbGlua3MucmVtZW1iZXIudGFncy5hYkF3YWtlU3RhdGUgPSBmYWxzZTsiLAogICAgICAgICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDMKICAgIH0sCiAgICB7CiAgICAgICAgImxhYmVsIjogImNoYXQiLAogICAgICAgICJmb3JtQWRkcmVzcyI6ICJjaGF0IiwKICAgICAgICAib25DbGljayI6ICJAIHNob3V0KCdhYkNoYXRCYXJPcGVuJykiLAogICAgICAgICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDQKICAgIH0sCiAgICB7CiAgICAgICAgImxhYmVsIjogIm51Z2dldHMiLAogICAgICAgICJvbkNyZWF0ZSI6ICJAIHRhZ3MubnVnTWFuYWdlciA9IGdldExpbmsoZ2V0Qm90KCdzeXN0ZW0nLCAnYWIuaW50ZXJmYWNlLm51Z2dldCcpKTsgaWYgKGxpbmtzLm51Z01hbmFnZXIudGFncy5saXN0ZW5pbmcpe3RhZ3Mub25DbGljayA9IGBAIHNob3V0KCdhYk1lbnVSZWZyZXNoJyk7IGxpbmtzLm1hbmlmZXN0YXRpb24uYWJDbGljaygpOyBzZXRUYWdNYXNrKGxpbmtzLm51Z01hbmFnZXIsICdsaXN0ZW5pbmcnLCBudWxsKTtgO3RhZ3MuZm9ybUFkZHJlc3MgPSBgY2hlY2tfYm94YDt9ZWxzZXsgICAgdGFncy5vbkNsaWNrID0gYEAgc2hvdXQoJ2FiTWVudVJlZnJlc2gnKTsgbGlua3MubWFuaWZlc3RhdGlvbi5hYkNsaWNrKCk7IHNldFRhZ01hc2sobGlua3MubnVnTWFuYWdlciwgJ2xpc3RlbmluZycsIHRydWUsICdsb2NhbCcpO2A7ICAgIHRhZ3MuZm9ybUFkZHJlc3MgPSBgY2hlY2tfYm94X291dGxpbmVfYmxhbmtgO30iLAogICAgICAgICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDUKICAgIH0sCiAgICB7CiAgICAgICAgImFiRW52aXJvbm1lbnRHYXRlIjogImdwdCIsCiAgICAgICAgIm9uQ3JlYXRlIjogIkAgIGlmICghYXV0aEJvdCl7ZGVzdHJveSh0aGlzQm90KTt9ZWxzZSBpZiAoYXV0aEJvdC50YWdzLnN1YnNjcmlwdGlvblRpZXIgPT0gJ0ZyZWVQbGF5JyB8fCBhdXRoQm90LnRhZ3Muc3Vic2NyaXB0aW9uVGllciA9PSB1bmRlZmluZWQpe2Rlc3Ryb3kodGhpc0JvdCk7fTsgdGFncy5sYWJlbCA9ICdlZGl0ICcgKyBsaW5rcy5yZW1lbWJlci50YWdzLmFiQnVpbGRlcklkZW50aXR5ICsgJyBwcm9tcHQnOyB0YWdzLmdwdEJvdCA9IGdldExpbmsoZ2V0Qm90KCdzeXN0ZW0nLCAnYWIuYWN0aW9uLmFzaycpKTsiLAogICAgICAgICJmb3JtQWRkcmVzcyI6ICJlZGl0X25vdGUiLAogICAgICAgICJvbkNsaWNrIjogIkAgbGlua3MuZ3B0Qm90LmVkaXRQcm9tcHQoKTsiLAogICAgICAgICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDcKICAgIH0sCiAgICB7CiAgICAgICAgImxhYmVsIjogImdyaWQgc25hcCIsCiAgICAgICAgIm9uQ3JlYXRlIjogIkAgdGFncy5mb3JtQWRkcmVzcyA9IGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkU25hcFN0YXRlID8gJ2NoZWNrX2JveCcgOiAnY2hlY2tfYm94X291dGxpbmVfYmxhbmsnIiwKICAgICAgICAib25DbGljayI6ICJAIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkU25hcFN0YXRlID0gIWxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkU25hcFN0YXRlO3RhZ3MuZm9ybUFkZHJlc3MgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZFNuYXBTdGF0ZSA/ICdjaGVja19ib3gnIDogJ2NoZWNrX2JveF9vdXRsaW5lX2JsYW5rJzsiLAogICAgICAgICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDgKICAgIH0sCiAgICB7CiAgICAgICAgImxhYmVsIjogImJvdCBzbmFwIiwKICAgICAgICAib25DcmVhdGUiOiAiQCB0YWdzLmZvcm1BZGRyZXNzID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJvdFNuYXBTdGF0ZSA/ICdjaGVja19ib3gnIDogJ2NoZWNrX2JveF9vdXRsaW5lX2JsYW5rJzsiLAogICAgICAgICJvbkNsaWNrIjogIkAgbGlua3MucmVtZW1iZXIudGFncy5hYkJvdFNuYXBTdGF0ZSA9ICFsaW5rcy5yZW1lbWJlci50YWdzLmFiQm90U25hcFN0YXRlOyB0YWdzLmZvcm1BZGRyZXNzID0gbGlua3MucmVtZW1iZXIudGFncy5hYkJvdFNuYXBTdGF0ZSA/ICdjaGVja19ib3gnIDogJ2NoZWNrX2JveF9vdXRsaW5lX2JsYW5rJzsiLAogICAgICAgICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDkKICAgIH0sCiAgICB7CiAgICAgICAgImxhYmVsIjogImFjY291bnQiLAogICAgICAgICJmb3JtQWRkcmVzcyI6ICJiYWRnZSIsCiAgICAgICAgIm9uQ2xpY2siOiAiQCBvcy5zaG93QWNjb3VudEluZm8oKTsiLAogICAgICAgICJhYkVudmlyb25tZW50TWVudVNvcnRPcmRlciI6IDEwCiAgICB9LAogICAgewogICAgICAgICJhYkVudmlyb25tZW50R2F0ZSI6ICJ0ZXN0cyIsCiAgICAgICAgImxhYmVsIjogInJlY29yZCB0ZXN0IiwKICAgICAgICAiZm9ybUFkZHJlc3MiOiAic2NpZW5jZSIsCiAgICAgICAgIm9uS2V5RG93biI6ICJAICIsCiAgICAgICAgIm9uS2V5VXAiOiAiQCAiLAogICAgICAgICJvbkNsaWNrIjogIkAgbGV0IHNoaWZ0Q2hlY2sgPSBvcy5nZXRJbnB1dFN0YXRlKCdrZXlib2FyZCcsICdTaGlmdCcpO2xldCBjdXJyZW50SW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7c2hvdXQoJ2FiUmVjb3JkVGVzdCcpO3Nob3V0KCdhYk1lbnVSZWZyZXNoJyk7IiwKICAgICAgICAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiAxMQogICAgfSwKICAgIHsKICAgICAgICAiYWJFbnZpcm9ubWVudEdhdGUiOiAidGVzdHMiLAogICAgICAgICJsYWJlbCI6ICJyZWNvcmQgdHJhY2UiLAogICAgICAgICJmb3JtQWRkcmVzcyI6ICJ0aW1lbGluZSIsCiAgICAgICAgIm9uS2V5RG93biI6ICJAICIsCiAgICAgICAgIm9uS2V5VXAiOiAiQCAiLAogICAgICAgICJvbkNsaWNrIjogIkAgbGV0IHNoaWZ0Q2hlY2sgPSBvcy5nZXRJbnB1dFN0YXRlKCdrZXlib2FyZCcsICdTaGlmdCcpO2xldCBjdXJyZW50SW5zdCA9IG9zLmdldEN1cnJlbnRJbnN0KCk7c2hvdXQoJ2FiUmVjb3JkVHJhY2UnKTtzaG91dCgnYWJNZW51UmVmcmVzaCcpOyIsCiAgICAgICAgImFiRW52aXJvbm1lbnRNZW51U29ydE9yZGVyIjogMTIKICAgIH0sCiAgICB7CiAgICAgICAgIm9uQ3JlYXRlIjogIkAgdGFncy5sYWJlbCA9ICdwZXJtYW5lbnRseSBkZWxldGUgJyArIGxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJCdWlsZGVySWRlbnRpdHkgKyAnIHYnICsgbGlua3MucmVtZW1iZXIudGFncy5hYlZlcnNpb247IHRhZ3MuY29sb3IgPSBsaW5rcy5yZW1lbWJlci50YWdzLmFiQmFzZUNvbnRyYXN0Q29sb3IgPz8gJyNEOTMwMzAnOyIsCiAgICAgICAgImZvcm1BZGRyZXNzIjogImRlbGV0ZV9mb3JldmVyIiwKICAgICAgICAib25DbGljayI6ICJAIGxldCBhbGxCb3RzID0gZ2V0Qm90cygnc3BhY2UnLCAnc2hhcmVkJyk7ZGVzdHJveShsaW5rcy5tYW5pZmVzdGF0aW9uLmxpbmtzLmFiQm90KTtmb3IgKGxldCBpID0gMDsgaSA8IGFsbEJvdHMubGVuZ3RoOyBpKyspe2lmIChhbGxCb3RzW2ldLnRhZ3Muc3lzdGVtKSB7aWYgKGFsbEJvdHNbaV0udGFncy5zeXN0ZW0uaW5jbHVkZXMoJ2FiJykpe2Rlc3Ryb3koYWxsQm90c1tpXSk7fX19IiwKICAgICAgICAiYWJFbnZpcm9ubWVudE1lbnVTb3J0T3JkZXIiOiAxMDAKICAgIH0KXScAhNma/gn5XAlhYlZlcnNpb24CBACE2Zr+CZCwAQQxMC40JwCE2Zr+CflcEWFiQ3JlYXRlTWVudUlucHV0AgQAhNma/gmVsAGeAkBpZiAoIXRoYXQpIHsNCiAgICByZXR1cm47DQp9DQoNCmxldCBtZW51SW5wdXQgPSB7DQogICAgZm9ybTogImlucHV0IiwNCiAgICBtZW51SXRlbVNob3dTdWJtaXRXaGVuRW1wdHk6IGZhbHNlLA0KICAgIGZvcm1JbnB1dE11bHRpbGluZTogbnVsbCwNCiAgICBvblBvaW50ZXJVcDogbnVsbCwNCiAgICBvblBvaW50ZXJEb3duOiBudWxsLA0KICAgIC4uLnRoYXQNCn07DQoNCmNvbnN0IG1lbnVCb3QgPSB0aGlzQm90LmFiQ3JlYXRlTWVudUJ1dHRvbihtZW51SW5wdXQpOw0KDQpyZXR1cm4gbWVudUJvdDsnAITZmv4J+VwQYWJDcmVhdGVNZW51VGV4dAIEAITZmv4JtLIBgQRAaWYgKCF0aGF0KSB7DQogICAgcmV0dXJuOw0KfQ0KDQpjb25zdCB7DQogICAgbWVudUl0ZW1MYWJlbFN0eWxlLA0KICAgIC4uLnJlc3QNCn0gPSB0aGF0Ow0KDQpsZXQgbWVudVRleHQgPSB7DQogICAgZm9ybTogInRleHQiLA0KICAgIG9uUG9pbnRlclVwOiBudWxsLA0KICAgIG9uUG9pbnRlckRvd246IG51bGwsDQogICAgcG9pbnRhYmxlOiBmYWxzZSwNCiAgICBjb2xvcjogIndoaXRlIiwNCiAgICBtZW51SXRlbVN0eWxlOiB7DQogICAgICAgICJwYWRkaW5nLXRvcCI6ICI2cHgiLA0KICAgICAgICAicGFkZGluZy1ib3R0b20iOiAiNnB4IiwNCiAgICB9LA0KICAgIG1lbnVJdGVtTGFiZWxTdHlsZTogew0KICAgICAgICAid2hpdGUtc3BhY2UiOiAicHJlLXdyYXAiLA0KICAgICAgICAuLi5tZW51SXRlbUxhYmVsU3R5bGUsDQogICAgfSwNCiAgICAuLi5yZXN0DQp9Ow0KDQpjb25zdCBtZW51Qm90ID0gdGhpc0JvdC5hYkNyZWF0ZU1lbnVCdXR0b24obWVudVRleHQpOw0KDQpyZXR1cm4gbWVudUJvdDsnAITZmv4J+VwQYWJDcmVhdGVNZW51VG9vbAIEAITZmv4JtrYBjgFAaWYgKCF0aGF0KSB7DQogICAgcmV0dXJuOw0KfQ0KDQpsZXQgbWVudVRvb2wgPSB7DQogICAgLi4udGhhdA0KfTsNCg0KY29uc3QgbWVudUJvdCA9IHRoaXNCb3QuYWJDcmVhdGVNZW51QnV0dG9uKG1lbnVUb29sKTsNCg0KcmV0dXJuIG1lbnVCb3Q7JwCE2Zr+CflcEmFiQ3JlYXRlTWVudVdpemFyZAIEAITZmv4JxbcBkgFAaWYgKCF0aGF0KSB7DQogICAgcmV0dXJuOw0KfQ0KDQpsZXQgbWVudVdpemFyZCA9IHsNCiAgICAuLi50aGF0DQp9Ow0KDQpjb25zdCBtZW51Qm90ID0gdGhpc0JvdC5hYkNyZWF0ZU1lbnVCdXR0b24obWVudVdpemFyZCk7DQoNCnJldHVybiBtZW51Qm90OycAhNma/gn5XBRhYkNyZWF0ZU1lbnVEcm9wZG93bgIEAITZmv4J2LgBiRZAaWYgKCF0aGF0KSB7DQogICAgcmV0dXJuOw0KfQ0KDQppZiAoIXRoYXQuZHJvcGRvd25Tb3J0T3JkZXIpIHsNCiAgICB0aHJvdyBuZXcgRXJyb3IoYGFiQ3JlYXRlTWVudURyb3Bkb3duOiBkcm9wZG93blNvcnRPcmRlciBpcyBub3QgcHJvdmlkZWQuYCk7DQp9DQoNCmxldCBvdXRlck1lbnVCdXR0b24gPSB7DQogICAgLi4udGhhdCwNCiAgICBmb3JtQWRkcmVzczogImFycm93X3JpZ2h0IiwNCiAgICBkcm9wZG93bk9wZW46IGZhbHNlLA0KICAgIG9uQ2xpY2s6IGBADQogICAgICAgIHRhZ3NbY29uZmlnQm90LnRhZ3MubWVudVBvcnRhbCArICJTb3J0T3JkZXIiXSA9ICR7dGhhdC5kcm9wZG93blNvcnRPcmRlcn0NCiAgICAgICAgaWYgKHRhZ3MuZHJvcGRvd25PcGVuID09IHRydWUpIHsNCiAgICAgICAgICAgIHdoaXNwZXIodGhpc0JvdC5saW5rcy5tZW51Qm90cywgImNsZWFyRHJvcGRvd25NZW51Iik7DQogICAgICAgICAgICB0YWdzLmRyb3Bkb3duT3BlbiA9IGZhbHNlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKHRoaXNCb3QudmFycy5nZW5lcmF0ZU1lbnVPcHRpb25zKSB7DQogICAgICAgICAgICAgICAgdGhpc0JvdC52YXJzLmdlbmVyYXRlTWVudU9wdGlvbnMoKTsNCiAgICAgICAgICAgICAgICB0YWdzLmRyb3Bkb3duT3BlbiA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICBgLA0KICAgIG9uRGVzdHJveTogYEANCiAgICAgICAgd2hpc3Blcih0aGlzQm90LmxpbmtzLm1lbnVCb3RzLCAiY2xlYXJEcm9wZG93bk1lbnUiKTsNCiAgICBgLA0KICAgIG9uUG9pbnRlclVwOiBgQA0KICAgICAgICBtYXNrcy5tZW51SXRlbVN0eWxlID0gbnVsbDsNCiAgICAgICAgbWFza3MuZm9ybUFkZHJlc3MgPSAiYXJyb3dfcmlnaHQiOw0KICAgICAgICBpZiAodGFncy5kcm9wZG93bk9wZW4gPT0gZmFsc2UpIHsNCiAgICAgICAgICAgIHNldFRhZ01hc2sodGhpc0JvdCwgImZvcm1BZGRyZXNzIiwgImFycm93X2Ryb3BfZG93biIpOw0KICAgICAgICAgICAgc2V0VGFnTWFzayh0aGlzQm90LCAibWVudUl0ZW1TdHlsZSIsIHsuLi50YWdzLm1lbnVJdGVtU3R5bGUsICJib3JkZXJCb3R0b21MZWZ0UmFkaXVzIjogIjAiLCAiYm9yZGVyQm90dG9tUmlnaHRSYWRpdXMiOiAiMCJ9KTsNCiAgICAgICAgfQ0KICAgIGANCn07DQoNCm91dGVyTWVudUJ1dHRvbltjb25maWdCb3QudGFncy5tZW51UG9ydGFsICsgIlNvcnRPcmRlciJdID0gdGhhdC5kcm9wZG93blNvcnRPcmRlcjsNCg0KY29uc3QgbWVudUJvdCA9IHRoaXNCb3QuYWJDcmVhdGVNZW51QnV0dG9uKG91dGVyTWVudUJ1dHRvbik7DQptZW51Qm90LnZhcnMuZ2VuZXJhdGVNZW51T3B0aW9ucyA9IGdlbmVyYXRlTWVudU9wdGlvbnM7DQoNCmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlTWVudU9wdGlvbnMgKCkgew0KICAgIGNvbnN0IG1lbnVCb3RzID0gW107DQogICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGF0LmRyb3Bkb3duT3B0aW9ucy5sZW5ndGg7ICsraSkgew0KDQogICAgICAgIGxldCBuZXdNZW51QnV0dG9uID0gew0KICAgICAgICAgICAgLi4udGhhdC5kcm9wZG93bk9wdGlvbnNbaV0sDQogICAgICAgICAgICBjbGVhckRyb3Bkb3duTWVudTogYEANCiAgICAgICAgICAgICAgICBkZXN0cm95KHRoaXNCb3QpOw0KICAgICAgICAgICAgYA0KICAgICAgICB9Ow0KDQogICAgICAgIG5ld01lbnVCdXR0b25bY29uZmlnQm90LnRhZ3MubWVudVBvcnRhbCArICJTb3J0T3JkZXIiXSA9IE51bWJlcih0aGF0LmRyb3Bkb3duU29ydE9yZGVyKSArICgoaSArIDEpIC8gMTAwKTsNCiAgICAgICAgbmV3TWVudUJ1dHRvbltjb25maWdCb3QudGFncy5tZW51UG9ydGFsXSA9IHRydWU7DQoNCiAgICAgICAgaWYgKGkgPT0gdGhhdC5kcm9wZG93bk9wdGlvbnMubGVuZ3RoIC0gMSkgew0KICAgICAgICAgICAgaWYgKG5ld01lbnVCdXR0b25bIm1lbnVJdGVtU3R5bGUiXSkgew0KICAgICAgICAgICAgICAgIG5ld01lbnVCdXR0b25bIm1lbnVJdGVtU3R5bGUiXVsiYm9yZGVyUmFkaXVzIl0gPSAiMCAwIDhweCA4cHgiOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBuZXdNZW51QnV0dG9uWyJtZW51SXRlbVN0eWxlIl0gPSB7DQogICAgICAgICAgICAgICAgICAgIGJvcmRlclJhZGl1czogIjAgMCA4cHggOHB4Ig0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKG5ld01lbnVCdXR0b25bIm1lbnVJdGVtU3R5bGUiXSkgew0KICAgICAgICAgICAgICAgIG5ld01lbnVCdXR0b25bIm1lbnVJdGVtU3R5bGUiXVsiYm9yZGVyUmFkaXVzIl0gPSAiMCI7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIG5ld01lbnVCdXR0b25bIm1lbnVJdGVtU3R5bGUiXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiAiMCINCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBuZXdNZW51QnV0dG9uWyJtZW51SXRlbVN0eWxlIl1bImJvcmRlclRvcCJdID0gIm5vbmUiOw0KICAgICAgICBuZXdNZW51QnV0dG9uWyJtZW51SXRlbVN0eWxlIl1bIm1hcmdpblRvcCJdID0gIjAiOw0KDQogICAgICAgIGNvbnN0IG5ld01lbnVCb3QgPSBhd2FpdCB0aGlzQm90LmFiQ3JlYXRlTWVudUJ1dHRvbihuZXdNZW51QnV0dG9uKTsNCiAgICAgICAgbWVudUJvdHMucHVzaChuZXdNZW51Qm90KTsNCiAgICB9DQoNCiAgICBtZW51Qm90LnRhZ3MubWVudUJvdHMgPSBnZXRMaW5rKG1lbnVCb3RzKTsNCn0NCg0KcmV0dXJuIG1lbnVCb3Q7DQoNCicAhNma/gn5XBFhYkNyZWF0ZU1lbnVHcm91cAIEAITZmv4J4s4BvxhALyoNCiAgICB0aGF0IGZvcm1hdDogDQogICAgew0KICAgICAgICAuLi50YWdzX2Zvcl9hbGxfYm90cywNCiAgICAgICAgZ3JvdXBTb3J0T3JkZXI6IG51bWJlciwNCiAgICAgICAgbWVudUl0ZW1zOiBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgbWVudUl0ZW1UeXBlOiAob3B0aW9uYWwpICJkcm9wZG93biIgfCAiaW5wdXQiIHwgInRleHQiIHwgInRvb2wiIHwgIndpemFyZCIsDQogICAgICAgICAgICAgICAgLi4udGFnc19mb3JfaW5kaXZpZHVhbF9ib3RzDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZXRjDQogICAgICAgIF0NCiAgICB9DQoqLw0KDQppZiAgKCF0aGF0KSB7DQogICAgcmV0dXJuOw0KfQ0KDQppZiAoIXRoYXQuZ3JvdXBTb3J0T3JkZXIpIHsNCiAgICB0aHJvdyBuZXcgRXJyb3IoYGFiQ3JlYXRlTWVudUdyb3VwOiBncm91cFNvcnRPcmRlciBpcyBub3QgcHJvdmlkZWQuYCk7DQp9DQoNCmxldCB7DQogICAgbWVudUl0ZW1TdHlsZSA9IHt9LA0KICAgIG1lbnVJdGVtcyA9IFtdLA0KICAgIC4uLmFkZGl0aW9uYWxUYWdzDQp9ID0gdGhhdCA/PyB7fQ0KDQpjb25zdCBtZW51Qm90cyA9IFtdOw0KZm9yIChsZXQgaSA9IDA7IGkgPCBtZW51SXRlbXMubGVuZ3RoOyArK2kpIHsNCg0KICAgIGxldCBuZXdNZW51QnV0dG9uID0ge307DQoNCiAgICBuZXdNZW51QnV0dG9uW2NvbmZpZ0JvdC50YWdzLm1lbnVQb3J0YWwgKyAiU29ydE9yZGVyIl0gPSBOdW1iZXIodGhhdC5ncm91cFNvcnRPcmRlcikgKyAoKGkgKyAxKSAvIDEwKTsNCg0KICAgIGxldCBpbmRpdk1lbnVJdGVtU3R5bGUgPSBtZW51SXRlbXNbaV0ubWVudUl0ZW1TdHlsZSA/PyB7fTsNCiAgICBsZXQgaW5kaXZNZW51VHlwZSA9IG1lbnVJdGVtc1tpXS5tZW51SXRlbVR5cGUgPz8gdW5kZWZpbmVkOw0KICAgIGxldCBpbmRpdkFkZGl0aW9uYWxUYWdzID0gbWVudUl0ZW1zW2ldOw0KICAgIGlmIChpbmRpdkFkZGl0aW9uYWxUYWdzWyJtZW51SXRlbVN0eWxlIl0pIHsNCiAgICAgICAgZGVsZXRlIGluZGl2QWRkaXRpb25hbFRhZ3NbIm1lbnVJdGVtU3R5bGUiXTsNCiAgICB9DQogICAgaWYgKGluZGl2QWRkaXRpb25hbFRhZ3NbIm1lbnVJdGVtVHlwZSJdKSB7DQogICAgICAgIGRlbGV0ZSBpbmRpdkFkZGl0aW9uYWxUYWdzWyJtZW51SXRlbVR5cGUiXTsNCiAgICB9DQoNCiAgICBjb25zdCBiYXNlU3R5bGluZyA9IHsNCiAgICAgICAgImJvcmRlclRvcCI6ICJub25lIiwNCiAgICAgICAgIm1hcmdpblRvcCI6ICIwIg0KICAgIH0NCg0KICAgIGlmIChpID09IG1lbnVJdGVtcy5sZW5ndGggLSAxKSB7DQogICAgICAgIGNvbnN0IG1lbnVTdHlsaW5nID0gew0KICAgICAgICAgICAgLi4uYmFzZVN0eWxpbmcsDQogICAgICAgICAgICAiYm9yZGVyUmFkaXVzIjogIjAgMCA4cHggOHB4IiwNCiAgICAgICAgICAgIC4uLm1lbnVJdGVtU3R5bGUsDQogICAgICAgICAgICAuLi5pbmRpdk1lbnVJdGVtU3R5bGUNCiAgICAgICAgfQ0KDQogICAgICAgIG5ld01lbnVCdXR0b25bIm1lbnVJdGVtU3R5bGUiXSA9IG1lbnVTdHlsaW5nOw0KICAgIH0gZWxzZSBpZiAoaSA9PSAwKSB7DQogICAgICAgIGNvbnN0IG1lbnVTdHlsaW5nID0gew0KICAgICAgICAgICAgImJvcmRlclJhZGl1cyI6ICI4cHggOHB4IDAgMCIsDQogICAgICAgICAgICAuLi5tZW51SXRlbVN0eWxlLA0KICAgICAgICAgICAgLi4uaW5kaXZNZW51SXRlbVN0eWxlDQogICAgICAgIH0NCg0KICAgICAgICBuZXdNZW51QnV0dG9uWyJtZW51SXRlbVN0eWxlIl0gPSBtZW51U3R5bGluZzt9DQogICAgZWxzZSB7DQogICAgICAgIGNvbnN0IG1lbnVTdHlsaW5nID0gew0KICAgICAgICAgICAgLi4uYmFzZVN0eWxpbmcsDQogICAgICAgICAgICAiYm9yZGVyUmFkaXVzIjogIjAiLA0KICAgICAgICAgICAgLi4ubWVudUl0ZW1TdHlsZSwNCiAgICAgICAgICAgIC4uLmluZGl2TWVudUl0ZW1TdHlsZQ0KICAgICAgICB9DQoNCiAgICAgICAgbmV3TWVudUJ1dHRvblsibWVudUl0ZW1TdHlsZSJdID0gbWVudVN0eWxpbmc7DQogICAgfQ0KDQogICAgZm9yIChjb25zdCB0YWcgaW4gYWRkaXRpb25hbFRhZ3MpDQogICAgew0KICAgICAgICBuZXdNZW51QnV0dG9uW3RhZ10gPSBhZGRpdGlvbmFsVGFnc1t0YWddOw0KICAgIH0NCg0KICAgIGZvciAoY29uc3QgdGFnIGluIGluZGl2QWRkaXRpb25hbFRhZ3MpDQogICAgew0KICAgICAgICBuZXdNZW51QnV0dG9uW3RhZ10gPSBpbmRpdkFkZGl0aW9uYWxUYWdzW3RhZ107DQogICAgfQ0KDQogICAgbGV0IG5ld01lbnVCb3Q7DQogICAgc3dpdGNoKGluZGl2TWVudVR5cGUpIHsNCiAgICAgICAgY2FzZSAiZHJvcGRvd24iOiANCiAgICAgICAgICAgIGF3YWl0IHRoaXNCb3QuYWJDcmVhdGVNZW51RHJvcGRvd24oDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAuLi5uZXdNZW51QnV0dG9uLA0KICAgICAgICAgICAgICAgICAgICAiZHJvcGRvd25Tb3J0T3JkZXIiOiBOdW1iZXIodGhhdC5ncm91cFNvcnRPcmRlcikgKyAoKGkgKyAxKSAvIDEwKQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgImlucHV0IjogDQogICAgICAgICAgICBhd2FpdCB0aGlzQm90LmFiQ3JlYXRlTWVudUlucHV0KG5ld01lbnVCdXR0b24pOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgInRleHQiOiANCiAgICAgICAgICAgIGF3YWl0IHRoaXNCb3QuYWJDcmVhdGVNZW51VGV4dChuZXdNZW51QnV0dG9uKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICJ0b29sIjogDQogICAgICAgICAgICBhd2FpdCB0aGlzQm90LmFiQ3JlYXRlTWVudVRvb2wobmV3TWVudUJ1dHRvbik7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAid2l6YXJkIjogDQogICAgICAgICAgICBhd2FpdCB0aGlzQm90LmFiQ3JlYXRlTWVudVdpemFyZChuZXdNZW51QnV0dG9uKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0OiANCiAgICAgICAgICAgIGF3YWl0IHRoaXNCb3QuYWJDcmVhdGVNZW51QnV0dG9uKG5ld01lbnVCdXR0b24pOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgfQ0KICAgIG1lbnVCb3RzLnB1c2gobmV3TWVudUJvdCk7DQp9DQoNCnJldHVybiBtZW51Qm90czsA"}]}