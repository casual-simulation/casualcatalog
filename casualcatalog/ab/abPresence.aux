{"version":2,"updates":[{"id":0,"timestamp":1767034088812,"update":"ATTor+TSCAAnAQRib3RzJDdkM2ExNzAzLTBhMDEtNDY2Yi05NzRmLWFlOWYxMDAxYWM3OAEnAOiv5NIIAAZzeXN0ZW0CBADor+TSCAETYWIucHJlc2VuY2UudmVyc2lvbicA6K/k0ggAFmFiUHJlc2VuY2VNaW5vclZlcnNpb24CBADor+TSCBUBMycA6K/k0ggAFmFiUHJlc2VuY2VNYWpvclZlcnNpb24CBADor+TSCBcBMCcA6K/k0ggACGFiSWdub3JlAgQA6K/k0ggZBHRydWUnAOiv5NIIAAphYlByZXNlbmNlAgQA6K/k0ggeBHRydWUnAOiv5NIIAARmb3JtAgQA6K/k0ggjB25vdGhpbmcnAOiv5NIIAA1vblNraWxsVXBkYXRlAgQA6K/k0ggrngFAY29uc3QgdmVyc2lvblN0cmluZyA9IHRhZ3MuYWJQcmVzZW5jZU1ham9yVmVyc2lvbiArICIuIiArIHRhZ3MuYWJQcmVzZW5jZU1pbm9yVmVyc2lvbjsKCmNvbnNvbGUubG9nKCJbQUJQcmVzZW5jZV0gTG9hZGVkIEFCIHNoZWxsIHZlcnNpb24gIiArIHZlcnNpb25TdHJpbmcpOycA6K/k0ggACWFiVmVyc2lvbgIEAOiv5NIIygEFMTAuMzUnAQRib3RzJDg3ZTk1MzQyLWU0NTYtNGI2My05ODkxLWQ3YTkyMWFkM2VlNwEnAOiv5NII0AEGc3lzdGVtAgQA6K/k0gjRARJhYi5wcmVzZW5jZS5jYW1lcmEnAOiv5NII0AEKYWJQcmVzZW5jZQIEAOiv5NII5AEEdHJ1ZScA6K/k0gjQAQhhYklnbm9yZQIEAOiv5NII6QEEdHJ1ZScA6K/k0gjQAQRmb3JtAgQA6K/k0gjuAQdub3RoaW5nJwDor+TSCNABCm9uQm90QWRkZWQCBADor+TSCPYBR0BpZiAob3MuaXNDb2xsYWJvcmF0aXZlKCkgJiYgdGFncy5lbmFibGVkKSB7CiAgICB0aGlzQm90LnN0YXJ0VGljaygpOwp9JwDor+TSCNABBHRpY2sCBADor+TSCL4C+RtAaWYgKHRhZ3MuZGVidWcpIHsKICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gc3RhcnRgKTsKfQoKaWYgKCFjb25maWdCb3QpIHsKICAgIGlmICh0YWdzLmRlYnVnKSB7CiAgICAgICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBpZ25vcmluZyB0aWNrIOKAlCB3YWl0aW5nIGZvciBjb25maWdCb3QgdG8gYmUgcmVhZHkuYCk7CiAgICB9CiAgICByZXR1cm47Cn0KCmlmICghZ2xvYmFsVGhpcy5hYikgewogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIGlnbm9yaW5nIHRpY2sg4oCUIHdhaXRpbmcgZm9yIGFiIHRvIGJlIHJlYWR5LmApOwogICAgfQogICAgcmV0dXJuOwp9CgppZiAoY29uZmlnQm90LnRhZ3Muc2hlZXRQb3J0YWwpIHsKICAgIGlmICh0YWdzLmRlYnVnKSB7CiAgICAgICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBpZ25vcmluZyB0aWNrIOKAlCB3YWl0aW5nIHRvIGxlYXZlIHNoZWV0IHBvcnRhbC5gKTsKICAgIH0KICAgIHJldHVybjsKfQoKaWYgKGNvbmZpZ0JvdC50YWdzLnN5c3RlbVBvcnRhbCkgewogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIGlnbm9yaW5nIHRpY2sg4oCUIHdhaXRpbmcgdG8gbGVhdmUgc3lzdGVtIHBvcnRhbC5gKTsKICAgIH0KICAgIHJldHVybjsKfQoKLy8gVGhlIG5hbWUgdGhhdCB0aGlzIHJlbW90ZSBpcyB0byBiZSBrbm93biBhcyB0byBvdGhlciB1c2Vycy4KbGV0IHJlbW90ZU5hbWUgPSBjb25maWdCb3QuaWQuc3Vic3RyaW5nKDAsNSk7CmlmIChhdXRoQm90ICYmIGF1dGhCb3QudGFncy5uYW1lKSB7CiAgICByZW1vdGVOYW1lID0gYXV0aEJvdC50YWdzLm5hbWU7Cn0gZWxzZSBpZiAoYWIubGlua3MuY29uc29sZS5tYXNrcy5wcmVmZXJyZWROYW1lKSB7CiAgICByZW1vdGVOYW1lID0gYWIubGlua3MuY29uc29sZS5tYXNrcy5wcmVmZXJyZWROYW1lOwp9CgovLyBHZXQgbGlzdCBvZiByZWxldmFudCBjYW1lcmFzIGZyb20gcG9ydGFscyAmIGRpbWVuc2lvbnMgdGhhdCB0aGUgdXNlciBpcyBhY3RpdmUgaW4uCmNvbnN0IGNhbWVyYURhdGFUb0VtaXQ6IEFCVXNlckNhbWVyYURhdGFbXSA9IFtdOwoKLy8gTWFwIHBvcnRhbCBzaXRzIG9uIHRvcCB0aGUgZ3JpZCBwb3J0YWwgc28gb25seSBzZW5kIG1hcCBwb3J0YWwgY2FtZXJhIGlmIGl0cyBlbmFibGVkLgppZiAoY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsKSB7CiAgICBjYW1lcmFEYXRhVG9FbWl0LnB1c2goewogICAgICAgIHJlbW90ZUlkOiBjb25maWdCb3QuaWQsCiAgICAgICAgcmVtb3RlTmFtZSwKICAgICAgICBwb3J0YWw6ICdtYXAnLAogICAgICAgIGNhbWVyYVR5cGU6ICdwZXJzcGVjdGl2ZScsCiAgICAgICAgZGltZW5zaW9uOiBjb25maWdCb3QudGFncy5tYXBQb3J0YWwsCiAgICAgICAgcG9zaXRpb246IG1hcFBvcnRhbEJvdC50YWdzLmNhbWVyYU1hcFBvc2l0aW9uLAogICAgICAgIHF1YXRlcm5pb246IG1hcFBvcnRhbEJvdC50YWdzLmNhbWVyYVJvdGF0aW9uLnF1YXRlcm5pb24sCiAgICB9KTsKfSBlbHNlIGlmIChjb25maWdCb3QudGFncy5ncmlkUG9ydGFsKSB7CiAgICBjYW1lcmFEYXRhVG9FbWl0LnB1c2goeyAKICAgICAgICByZW1vdGVJZDogY29uZmlnQm90LmlkLAogICAgICAgIHJlbW90ZU5hbWUsCiAgICAgICAgcG9ydGFsOiAnZ3JpZCcsCiAgICAgICAgY2FtZXJhVHlwZTogZ3JpZFBvcnRhbEJvdC50YWdzLnBvcnRhbENhbWVyYVR5cGUgPz8gJ29ydGhvZ3JhcGhpYycsCiAgICAgICAgZGltZW5zaW9uOiBjb25maWdCb3QudGFncy5ncmlkUG9ydGFsLAogICAgICAgIHBvc2l0aW9uOiBncmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUG9zaXRpb24sCiAgICAgICAgcXVhdGVybmlvbjogZ3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVJvdGF0aW9uLnF1YXRlcm5pb24sCiAgICAgICAgem9vbTogZ3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVpvb20sCiAgICB9KTsKfQoKLy8gTWluaSBtYXAgcG9ydGFsIHNpdHMgb24gdG9wIHRoZSBtaW5pIG1hcCBwb3J0YWwgc28gb25seSBzZW5kIG1pbmkgbWFwIHBvcnRhbCBjYW1lcmEgaWYgaXRzIGVuYWJsZWQuCmlmIChjb25maWdCb3QudGFncy5taW5pTWFwUG9ydGFsKSB7CiAgICBjYW1lcmFEYXRhVG9FbWl0LnB1c2goeyAKICAgICAgICByZW1vdGVJZDogY29uZmlnQm90LmlkLAogICAgICAgIHJlbW90ZU5hbWUsCiAgICAgICAgcG9ydGFsOiAnbWluaU1hcCcsCiAgICAgICAgY2FtZXJhVHlwZTogJ3BlcnNwZWN0aXZlJywKICAgICAgICBkaW1lbnNpb246IGNvbmZpZ0JvdC50YWdzLm1pbmlNYXBQb3J0YWwsCiAgICAgICAgcG9zaXRpb246IG1pbmlNYXBQb3J0YWxCb3QudGFncy5jYW1lcmFNYXBQb3NpdGlvbiwKICAgICAgICBxdWF0ZXJuaW9uOiBtaW5pTWFwUG9ydGFsQm90LnRhZ3MuY2FtZXJhUm90YXRpb24ucXVhdGVybmlvbiwKICAgIH0pOwp9IGVsc2UgaWYgKGNvbmZpZ0JvdC50YWdzLm1pbmlHcmlkUG9ydGFsKSB7CiAgICBjYW1lcmFEYXRhVG9FbWl0LnB1c2goeyAKICAgICAgICByZW1vdGVJZDogY29uZmlnQm90LmlkLAogICAgICAgIHJlbW90ZU5hbWUsCiAgICAgICAgcG9ydGFsOiAnbWluaUdyaWQnLAogICAgICAgIGNhbWVyYVR5cGU6IG1pbmlHcmlkUG9ydGFsQm90LnRhZ3MucG9ydGFsQ2FtZXJhVHlwZSA/PyAnb3J0aG9ncmFwaGljJywKICAgICAgICBkaW1lbnNpb246IGNvbmZpZ0JvdC50YWdzLm1pbmlHcmlkUG9ydGFsLAogICAgICAgIHBvc2l0aW9uOiBtaW5pR3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVBvc2l0aW9uLAogICAgICAgIHF1YXRlcm5pb246IG1pbmlHcmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUm90YXRpb24ucXVhdGVybmlvbiwKICAgICAgICB6b29tOiBtaW5pR3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVpvb20sCiAgICB9KTsKfQoKaWYgKGNhbWVyYURhdGFUb0VtaXQubGVuZ3RoID09PSAwKSB7CiAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gaWdub3JpbmcgdGljayDigJQgd2FpdGluZyB0byBiZSBpbiBhIHBvcnRhbCB3aXRoIGEgY2FtZXJhLmApOwogICAgfQogICAgcmV0dXJuOwp9CgppZiAodGFncy5kZWJ1ZykgewogICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBjYW1lcmFEYXRhVG9FbWl0OmAsIGNhbWVyYURhdGFUb0VtaXQpOwp9Cgpjb25zdCBvdGhlclJlbW90ZXMgPSAoYXdhaXQgb3MucmVtb3RlcygpKS5maWx0ZXIoaWQgPT4gaWQgIT09IGNvbmZpZ0JvdC5pZCk7CgppZiAodGFncy5kZWJ1ZykgewogICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBvdGhlclJlbW90ZXM6YCwgb3RoZXJSZW1vdGVzKTsKfQoKaWYgKG90aGVyUmVtb3Rlcy5sZW5ndGggPiAwKSB7CiAgICBzZW5kUmVtb3RlRGF0YShvdGhlclJlbW90ZXMsICdhYl91c2VyX2NhbWVyYV9kYXRhJywgY2FtZXJhRGF0YVRvRW1pdCk7Cn0KJwDor+TSCNABCXN0YXJ0VGljawIEAOiv5NIIrh7KBEBpZiAobWFza3MudGlja0ludGVydmFsSWQpIHsKICAgIHJldHVybjsKfQoKaWYgKCFvcy5pc0NvbGxhYm9yYXRpdmUoKSkgewogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIGNhbmNlbGluZyB0aWNrIHN0YXJ0IOKAlCB0aGUgaW5zdCBtdXN0IGJlIGNvbGxhYm9yYXRpdmUuYCk7CiAgICB9CgogICAgcmV0dXJuOwp9CgppZiAoIXRhZ3MuZW5hYmxlZCkgewogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIGNhbmNlbGluZyB0aWNrIHN0YXJ0IOKAlCBjYW1lcmEgcHJlc2VuZWNlIGlzIGRpc2FibGVkLmApOwogICAgfQoKICAgIHJldHVybjsKfQoKaWYgKHRhZ3MuZGVidWcpIHsKICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gc3RhcnQgaW50ZXJ2YWxgKTsKfQoKbWFza3MudGlja0ludGVydmFsSWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB3aGlzcGVyKHRoaXNCb3QsICd0aWNrJyksIHRhZ3MudGlja0ludGVydmFsTVMpOwp0aGlzQm90LnRpY2soKTsnAOiv5NII0AEIc3RvcFRpY2sCBADor+TSCPUixwFAaWYgKG1hc2tzLnRpY2tJbnRlcnZhbElkKSB7CiAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gc3RvcCBpbnRlcnZhbGApOwogICAgfQoKICAgIGNsZWFySW50ZXJ2YWwobWFza3MudGlja0ludGVydmFsSWQpOwogICAgbWFza3MudGlja0ludGVydmFsSWQgPSBudWxsOwp9JwDor+TSCNABDnRpY2tJbnRlcnZhbE1TAgQA6K/k0gi9JAQxNTAwJwDor+TSCNABBWRlYnVnAgQA6K/k0gjCJAVmYWxzZScA6K/k0gjQAQxvbkJvdENoYW5nZWQCBADor+TSCMgkqgJAaWYgKHRoYXQudGFncy5pbmNsdWRlcygndGlja0ludGVydmFsTVMnKSkgewogICAgdGhpc0JvdC5zdG9wVGljaygpOwoKICAgIGlmIChvcy5pc0NvbGxhYm9yYXRpdmUoKSAmJiB0YWdzLmVuYWJsZWQpIHsKICAgICAgICB0aGlzQm90LnN0YXJ0VGljaygpOwogICAgfQp9IGVsc2UgaWYgKHRoYXQudGFncy5pbmNsdWRlcygnZW5hYmxlZCcpKSB7CiAgICBpZiAodGFncy5lbmFibGVkKSB7CiAgICAgICAgdGhpc0JvdC5zdGFydFRpY2soKTsKICAgIH0gZWxzZSB7CiAgICAgICAgdGhpc0JvdC5zdG9wVGljaygpOwogICAgfQp9JwDor+TSCNABDG9uUmVtb3RlRGF0YQIEAOiv5NII8ybeA0BpZiAoIXRhZ3MuZW5hYmxlZCkgewogICAgcmV0dXJuOwp9CgppZiAodGhhdC5uYW1lID09PSAnYWJfdXNlcl9jYW1lcmFfZGF0YScpIHsKICAgIGNvbnN0IGRhdGE6IEFCVXNlckNhbWVyYURhdGEgfCBBQlVzZXJDYW1lcmFEYXRhW10gPSB0aGF0LnRoYXQ7CgogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIGFiX3VzZXJfY2FtZXJhX2RhdGEgZGF0YTpgLCBkYXRhKTsKICAgIH0KCiAgICBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0aGlzQm90Lm9uQUJVc2VyQ2FtZXJhRGF0YVJlY2VpdmVkKGRhdGFbaV0pOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgdGhpc0JvdC5vbkFCVXNlckNhbWVyYURhdGFSZWNlaXZlZChkYXRhKTsKICAgIH0KfQonAOiv5NII0AEFdHlwZXMCBADor+TSCNIqqAbwn5OEaW50ZXJmYWNlIEFCVXNlckNhbWVyYURhdGEgewogICAgLyoqIFRoZSByZW1vdGUgaWQgb2YgdGhlIHVzZXIgdGhlIGNhbWVyYSBkYXRhIGlzIGZvci4gKi8KICAgIHJlbW90ZUlkOiBzdHJpbmc7CgogICAgLyoqIENhbiBlaXRoZXIgYmUgdXNlcidzIGRpc3BsYXkgbmFtZSBvciBhIHNob3J0ZW5lZCBsb2NhbCB1c2VyIGlkLiAqKi8KICAgIHJlbW90ZU5hbWU6IHN0cmluZzsKCiAgICAvKiogVGhlIHBvcnRhbCB0aGF0IHRoZSBjYW1lcmEgZGF0YSBpcyBmb3IuICovCiAgICBwb3J0YWw6IHN0cmluZzsKICAgIAogICAgLyoqIFRoZSBkaW1lbnNpb24gdGhhdCB0aGUgY2FtZXJhIGRhdGEgaXMgZm9yLiAqKi8KICAgIGRpbWVuc2lvbjogc3RyaW5nOwoKICAgIC8qKiBUaGUgdHlwZSBvZiB0aGUgY2FtZXJhIHRoYXQgdGhlIGRhdGEgaXMgZm9yLiAqLwogICAgY2FtZXJhVHlwZTogJ3BlcnNwZWN0aXZlJyB8ICdvcnRob2dyYXBoaWMnOwogICAgCiAgICAvKiogVGhlIHBvc2l0aW9uIG9mIHRoZSBjYW1lcmEuICoqLwogICAgcG9zaXRpb246IHsgeDogbnVtYmVyLCB5OiBudW1iZXIsIHo6IG51bWJlciB9OwoKICAgIC8qKiBUaGUgcm90YXRpb24gcXVhdGVybmlvbiBvZiB0aGUgY2FtZXJhLiAqKi8KICAgIHF1YXRlcm5pb246IHsgeDogbnVtYmVyLCB5OiBudW1iZXIsIHo6IG51bWJlciwgdzogbnVtYmVyIH07CgogICAgLyoqIFRoZSB6b29tIHZsYXVlIHRoYXQgdGhlIGNhbWVyYSBpcyBhdC4gVGhpcyBpcyBvbmx5IHJlbGV2YW50IGZvciBvcnRob2dyYXBoaWMgY2FtZXJhcy4gICovCiAgICB6b29tPzogbnVtYmVyOwp9JwDor+TSCNABB2VuYWJsZWQCBADor+TSCPkwBWZhbHNlJwDor+TSCNABGm9uQUJVc2VyQ2FtZXJhRGF0YVJlY2VpdmVkAgQA6K/k0gj/MLUwQGNvbnN0IGNhbWVyYURhdGE6IEFCVXNlckNhbWVyYURhdGEgPSB0aGF0OwoKaWYgKHRhZ3MuZGVidWcpIHsKICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gY2FtZXJhRGF0YTpgLCBjYW1lcmFEYXRhKQp9Cgpjb25zdCBzaG91dFJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoc2hvdXQoJ29uQUJVc2VyQ2FtZXJhVXBkYXRlJywgY2FtZXJhRGF0YSkpOwpjb25zdCBjYW1lcmFVcGRhdGVkID0gc2hvdXRSZXN1bHRzLmxlbmd0aCA+IDAgJiYgc2hvdXRSZXN1bHRzLnNvbWUociA9PiByLnZhbHVlID09PSB0cnVlKTsKCmlmICghY2FtZXJhVXBkYXRlZCkgewogICAgLy8gVGhlcmUgd2FzIG5vIHVzZXIgY2FtZXJhIHRoYXQgYWNjZXB0ZWQgdGhlIHVwZGF0ZSwgbmVlZCB0byBjcmVhdGUgYSBuZXcgb25lLgoKICAgIGlmICh0YWdzLmRlYnVnKSB7CiAgICAgICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBtYWtlIHVzZXIgY2FtZXJhOmAsIGNhbWVyYURhdGEpOwogICAgfQoKICAgIC8vIFNldCByYW5kb20gc2VlZCBzbyB0aGF0IHRoZSAicmFuZG9tIiBnZW5lcmF0ZWQgY29sb3IgaXMgZGV0ZXJtaW5pc3RpYyBiYXNlZCBvbiByZW1vdGVJZC4KICAgIG1hdGguc2V0UmFuZG9tU2VlZChjYW1lcmFEYXRhLnJlbW90ZUlkKTsKCiAgICBjb25zdCB1c2VyQ29sb3IgPSBgcmdiKCR7bWF0aC5yYW5kb21JbnQoMCwgMjU1KX0sICR7bWF0aC5yYW5kb21JbnQoMCwgMjU1KX0sICR7bWF0aC5yYW5kb21JbnQoMCwgMjU1KX0pYDsKCiAgICBjb25zdCB1c2VyQ2FtZXJhQm90ID0gY3JlYXRlKHsKICAgICAgICBzcGFjZTogJ3RlbXBMb2NhbCcsCiAgICAgICAgYWJCb3Q6IHRydWUsCiAgICAgICAgYWJVc2VyQ2FtZXJhOiB0cnVlLAogICAgICAgIG1hbmFnZXI6IGdldExpbmsodGhpc0JvdCksCiAgICAgICAgZm9ybTogJ2ZydXN0dW0nLAogICAgICAgIGNvbG9yOiB1c2VyQ29sb3IsCiAgICAgICAgYW5jaG9yUG9pbnQ6ICdjZW50ZXInLAogICAgICAgIHJlbW90ZUlkOiBjYW1lcmFEYXRhLnJlbW90ZUlkLAogICAgICAgIHJlbW90ZU5hbWU6IGNhbWVyYURhdGEucmVtb3RlTmFtZSwKICAgICAgICBwb3J0YWw6IGNhbWVyYURhdGEucG9ydGFsLAogICAgICAgIGRpbWVuc2lvbjogY2FtZXJhRGF0YS5kaW1lbnNpb24sCiAgICAgICAgW2NhbWVyYURhdGEuZGltZW5zaW9uXTogdHJ1ZSwKICAgICAgICBwb2ludGFibGU6IGZhbHNlLAogICAgICAgIGxhYmVsUG9zaXRpb246ICdmbG9hdGluZ0JpbGxib2FyZCcsCiAgICAgICAgLy8gbGFiZWxTaXplOiAwLjI4LAogICAgICAgIC8vIGxhYmVsU2l6ZU1vZGU6ICdhdXRvJywKICAgICAgICBsYWJlbEZsb2F0aW5nQmFja2dyb3VuZENvbG9yOiB1c2VyQ29sb3IsCiAgICAgICAgb25DcmVhdGU6IExpc3RlbmVyU3RyaW5nKCgpID0+IHsKICAgICAgICAgICAgaWYgKGxpbmtzLm1hbmFnZXIudGFncy5kZWJ1ZykgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFthYlVzZXJDYW1lcmEuJHt0YWdOYW1lfSAoJHt0YWdzLnJlbW90ZU5hbWV9KV1gKTsKICAgICAgICAgICAgfQogICAgICAgIH0pLAogICAgICAgIG9uQUJVc2VyQ2FtZXJhVXBkYXRlOiBMaXN0ZW5lclN0cmluZyhhc3luYyAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGNhbWVyYURhdGE6IEFCVXNlckNhbWVyYURhdGEgPSB0aGF0OwoKICAgICAgICAgICAgdGFncy5sYWJlbCA9IGNhbWVyYURhdGEucmVtb3RlTmFtZTsKCiAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBpbmNvbWluZyB1cGRhdGUgaXMgZm9yIHRoaXMgYm90LgogICAgICAgICAgICBpZiAoY2FtZXJhRGF0YS5yZW1vdGVJZCAhPT0gdGFncy5yZW1vdGVJZCB8fAogICAgICAgICAgICAgICAgY2FtZXJhRGF0YS5wb3J0YWwgIT09IHRhZ3MucG9ydGFsIHx8CiAgICAgICAgICAgICAgICBjYW1lcmFEYXRhLmRpbWVuc2lvbiAhPT0gdGFncy5kaW1lbnNpb24KICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIENsZWFyIG9sZCB0aW1lb3V0LgogICAgICAgICAgICBpZiAodGhpc0JvdC52YXJzLnRpbWVvdXRJZCkgewogICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXNCb3QudmFycy50aW1lb3V0SWQpOwogICAgICAgICAgICAgICAgdGhpc0JvdC52YXJzLnRpbWVvdXRJZCA9IG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChsaW5rcy5tYW5hZ2VyLnRhZ3MuZGVidWcpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbYWJVc2VyQ2FtZXJhLiR7dGFnTmFtZX0gKCR7dGFncy5yZW1vdGVOYW1lfSldIGNhbWVyYURhdGE6YCwgY2FtZXJhRGF0YSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIGNsYW1wMDEodDogbnVtYmVyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgdCkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiB6b29tVG9UKHpvb206IG51bWJlciwgem9vbU1pbjogbnVtYmVyLCB6b29tTWF4OiBudW1iZXIpIHsKICAgICAgICAgICAgICAgIC8vIHQ9MCBhdCB6b29tTWluLCB0PTEgYXQgem9vbU1heAogICAgICAgICAgICAgICAgY29uc3QgeiA9IE1hdGgubWF4KHpvb20sIDFlLTYpOwogICAgICAgICAgICAgICAgY29uc3QgYSA9IE1hdGgubG9nKHpvb21NaW4pOwogICAgICAgICAgICAgICAgY29uc3QgYiA9IE1hdGgubG9nKHpvb21NYXgpOwogICAgICAgICAgICAgICAgY29uc3QgdiA9IChNYXRoLmxvZyh6KSAtIGEpIC8gKGIgLSBhKTsKICAgICAgICAgICAgICAgIHJldHVybiBjbGFtcDAxKHYpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBsZXJwKGE6IG51bWJlciwgYjogbnVtYmVyLCB0OiBudW1iZXIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBhICsgKGIgLSBhKSAqIHQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIE9wdGlvbmFsIHNtb290aGluZyBzbyBpdCBkb2VzbuKAmXQgZmVlbCBsaW5lYXIgLyBoYXJzaDoKICAgICAgICAgICAgZnVuY3Rpb24gc21vb3Roc3RlcCh0OiBudW1iZXIpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0ICogdCAqICgzIC0gMiAqIHQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyB0PTAgYXQgem9vbU1pbiAoem9vbWVkIG91dCksIHQ9MSBhdCB6b29tTWF4ICh6b29tZWQgaW4pCiAgICAgICAgICAgIGZ1bmN0aW9uIGFwcGx5RWFzZSh0OiBudW1iZXIsIGV4cG9uZW50OiBudW1iZXIpIHsKICAgICAgICAgICAgICAgIC8vIGV4cG9uZW50IDwgMSBzbG93cyBkb3duIHRoZSDigJxtb3ZlIGF3YXnigJ0gd2hlbiB6b29taW5nIG91dAogICAgICAgICAgICAgICAgLy8gKG1ha2VzIGN1cnZlIGdlbnRsZXIgbmVhciB0PTApCiAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5wb3coc21vb3Roc3RlcCh0KSwgZXhwb25lbnQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBhc3luYyBmdW5jdGlvbiBnZXRWaXpDYW1lcmFQb3NlKAogICAgICAgICAgICAgICAgY2FtZXJhUG9zaXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXI7IHo6IG51bWJlciB9LAogICAgICAgICAgICAgICAgY2FtZXJhUm90YXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXI7IHo6IG51bWJlcjsgdzogbnVtYmVyIH0sCiAgICAgICAgICAgICAgICBjYW1lcmFUeXBlOiAnb3J0aG9ncmFwaGljJyB8ICdwZXJzcGVjdGl2ZScsCiAgICAgICAgICAgICAgICBjYW1lcmFab29tOiBudW1iZXIgfCBudWxsIHwgdW5kZWZpbmVkLAogICAgICAgICAgICAgICAgem9vbU1pbiA9IDAuNCwKICAgICAgICAgICAgICAgIHpvb21NYXggPSA4MCwKICAgICAgICAgICAgICAgIGZhckRpc3QgPSAzMCwKICAgICAgICAgICAgICAgIG5lYXJEaXN0ID0gMiwKICAgICAgICAgICAgICAgIGV4cG9uZW50ID0gMC41LAogICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIGNvbnN0IHBvcyA9IG5ldyBWZWN0b3IzKGNhbWVyYVBvc2l0aW9uLngsIGNhbWVyYVBvc2l0aW9uLnksIGNhbWVyYVBvc2l0aW9uLnopOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBsZXQgcm90OwogICAgICAgICAgICAgICAgaWYgKChjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPT09IHRhZ3MuZGltZW5zaW9uIHx8IGNvbmZpZ0JvdC50YWdzLm1pbmlNYXBQb3J0YWwgPT09IHRhZ3MuZGltZW5zaW9uKSAmJiBjYW1lcmFUeXBlID09PSAncGVyc3BlY3RpdmUnKSB7IAogICAgICAgICAgICAgICAgICAgIHJvdCA9IGF3YWl0IGFiLmxpbmtzLnV0aWxzLmNhbGNNYXBSb3RhdGlvbih7IG1hcFBvc2l0aW9uOiBjYW1lcmFQb3NpdGlvbiwgYXV4Um90YXRpb246IG5ldyBSb3RhdGlvbih7IHF1YXRlcm5pb246IGNhbWVyYVJvdGF0aW9uIH0pfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJvdCA9IG5ldyBSb3RhdGlvbih7IHF1YXRlcm5pb246IGNhbWVyYVJvdGF0aW9uIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IGZvcndhcmQgPSByb3Qucm90YXRlVmVjdG9yMyhuZXcgVmVjdG9yMygwLCAxLCAwKSkubm9ybWFsaXplKCk7CgogICAgICAgICAgICAgICAgaWYgKGNhbWVyYVR5cGUgPT09ICdwZXJzcGVjdGl2ZScpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBwb3NpdGlvbjogcG9zLCByb3RhdGlvbjogcm90IH07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29uc3Qgem9vbSA9IE1hdGgubWF4KGNhbWVyYVpvb20gPz8gMTAsIDFlLTYpOwoKICAgICAgICAgICAgICAgIGxldCB0ID0gem9vbVRvVCh6b29tLCB6b29tTWluLCB6b29tTWF4KTsKICAgICAgICAgICAgICAgIHQgPSBhcHBseUVhc2UodCwgZXhwb25lbnQpOwoKICAgICAgICAgICAgICAgIGNvbnN0IGQgPSBsZXJwKGZhckRpc3QsIG5lYXJEaXN0LCB0KTsKICAgICAgICAgICAgICAgIGNvbnN0IHZpelBvcyA9IHBvcy5zdWJ0cmFjdChmb3J3YXJkLm11bHRpcGx5U2NhbGFyKGQpKTsKCiAgICAgICAgICAgICAgICByZXR1cm4geyBwb3NpdGlvbjogdml6UG9zLCByb3RhdGlvbjogcm90LCBkZWJ1ZzogeyB0LCBkLCB6b29tIH0gfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgcG9zZSA9IGF3YWl0IGdldFZpekNhbWVyYVBvc2UoCiAgICAgICAgICAgICAgICBjYW1lcmFEYXRhLnBvc2l0aW9uLAogICAgICAgICAgICAgICAgY2FtZXJhRGF0YS5xdWF0ZXJuaW9uLAogICAgICAgICAgICAgICAgY2FtZXJhRGF0YS5jYW1lcmFUeXBlLAogICAgICAgICAgICAgICAgY2FtZXJhRGF0YS56b29tLAogICAgICAgICAgICAgICAgMC40LAogICAgICAgICAgICAgICAgODAsCiAgICAgICAgICAgICAgICAwLAogICAgICAgICAgICAgICAgLTQyNywKICAgICAgICAgICAgICAgIDAuMSwKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gcG9zZS5wb3NpdGlvbjsKICAgICAgICAgICAgY29uc3Qgcm90YXRpb24gPSBwb3NlLnJvdGF0aW9uOwoKICAgICAgICAgICAgdGFnc1t0YWdzLmRpbWVuc2lvbiArICdQb3NpdGlvbiddID0gcG9zaXRpb247CiAgICAgICAgICAgIHRhZ3NbdGFncy5kaW1lbnNpb24gKyAnUm90YXRpb24nXSA9IHJvdGF0aW9uOwoKICAgICAgICAgICAgLy8gU2V0IG5ldyB0aW1lb3V0LgogICAgICAgICAgICB0aGlzQm90LnZhcnMudGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiBkZXN0cm95KHRoaXNCb3QpLCBsaW5rcy5tYW5hZ2VyLnRhZ3MuY2FtZXJhQm90VGltZW91dE1TKTsKCiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0pLAogICAgICAgIG9uRGVzdHJveTogTGlzdGVuZXJTdHJpbmcoKCkgPT4gewogICAgICAgICAgICBpZiAobGlua3MubWFuYWdlci50YWdzLmRlYnVnKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW2FiVXNlckNhbWVyYS4ke3RhZ05hbWV9ICgke3RhZ3MucmVtb3RlTmFtZX0pXWApOwogICAgICAgICAgICB9CiAgICAgICAgfSkKICAgIH0pCgogICAgLy8gRGlyZWN0bHkgY2FsbCBvbkFCVXNlckNhbWVyYVVwZGF0ZSB0aGUgZmlyc3QgdGltZSB3ZSBtYWtlIGEgbmV3IHVzZXIgY2FtZXJhIGJvdC4KICAgIHVzZXJDYW1lcmFCb3Qub25BQlVzZXJDYW1lcmFVcGRhdGUoY2FtZXJhRGF0YSk7Cn0nAOiv5NII0AESY2FtZXJhQm90VGltZW91dE1TAgQA6K/k0givYQQzMDAwJwDor+TSCNABCWFiVmVyc2lvbgIEAOiv5NIItGEFMTAuMzUA"}]}