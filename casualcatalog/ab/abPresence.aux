{"version":2,"updates":[{"id":0,"timestamp":1767819668101,"update":"AVS1xtEnACcBBGJvdHMkN2QzYTE3MDMtMGEwMS00NjZiLTk3NGYtYWU5ZjEwMDFhYzc4AScAtcbRJwAGc3lzdGVtAgQAtcbRJwETYWIucHJlc2VuY2UudmVyc2lvbicAtcbRJwAWYWJQcmVzZW5jZU1pbm9yVmVyc2lvbgIEALXG0ScVATknALXG0ScAFmFiUHJlc2VuY2VNYWpvclZlcnNpb24CBAC1xtEnFwEwJwC1xtEnAAhhYklnbm9yZQIEALXG0ScZBHRydWUnALXG0ScACmFiUHJlc2VuY2UCBAC1xtEnHgR0cnVlJwC1xtEnAARmb3JtAgQAtcbRJyMHbm90aGluZycAtcbRJwANb25Ta2lsbFVwZGF0ZQIEALXG0ScrngFAY29uc3QgdmVyc2lvblN0cmluZyA9IHRhZ3MuYWJQcmVzZW5jZU1ham9yVmVyc2lvbiArICIuIiArIHRhZ3MuYWJQcmVzZW5jZU1pbm9yVmVyc2lvbjsKCmNvbnNvbGUubG9nKCJbQUJQcmVzZW5jZV0gTG9hZGVkIEFCIHNoZWxsIHZlcnNpb24gIiArIHZlcnNpb25TdHJpbmcpOycAtcbRJwAJYWJWZXJzaW9uAgQAtcbRJ8oBBTEwLjM1JwEEYm90cyQ4N2U5NTM0Mi1lNDU2LTRiNjMtOTg5MS1kN2E5MjFhZDNlZTcBJwC1xtEn0AEGc3lzdGVtAgQAtcbRJ9EBE2FiLnByZXNlbmNlLm1hbmFnZXInALXG0SfQAQphYlByZXNlbmNlAgQAtcbRJ+UBBHRydWUnALXG0SfQAQhhYklnbm9yZQIEALXG0SfqAQR0cnVlJwC1xtEn0AEEZm9ybQIEALXG0SfvAQdub3RoaW5nJwC1xtEn0AEKb25Cb3RBZGRlZAIEALXG0Sf3ATdAaWYgKG9zLmlzQ29sbGFib3JhdGl2ZSgpKSB7CiAgICB0aGlzQm90LnN0YXJ0VGljaygpOwp9JwC1xtEn0AEJc3RhcnRUaWNrAgQAtcbRJ68CsAVAaWYgKG1hc2tzLnRpY2tJbnRlcnZhbElkKSB7CiAgICByZXR1cm47Cn0KCmlmICghb3MuaXNDb2xsYWJvcmF0aXZlKCkpIHsKICAgIGlmICh0YWdzLmRlYnVnKSB7CiAgICAgICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBjYW5jZWxpbmcgdGljayBzdGFydCDigJQgdGhlIGluc3QgbXVzdCBiZSBjb2xsYWJvcmF0aXZlLmApOwogICAgfQoKICAgIHJldHVybjsKfQoKaWYgKCF0aGlzQm90LmdldFByZXNlbmNlRW5hYmxlZCgpKSB7CiAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gY2FuY2VsaW5nIHRpY2sgc3RhcnQg4oCUIHByZXNlbmNlIGlzIGRpc2FibGVkLmApOwogICAgfQoKICAgIHJldHVybjsKfQoKaWYgKHRhZ3MuZGVidWcpIHsKICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gc3RhcnQgaW50ZXJ2YWxgKTsKfQoKZnVuY3Rpb24gdGljaygpIHsKICAgIGlmICh0YWdzLmRlYnVnKSB7CiAgICAgICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfV0gdGlja2ApOwogICAgfQoKICAgIHdoaXNwZXIodGhpc0JvdCwgJ29uVGljaycpOwp9CgptYXNrcy50aWNrSW50ZXJ2YWxJZCA9IHNldEludGVydmFsKHRpY2ssIHRhZ3MudGlja0ludGVydmFsTVMpOwp0aWNrKCk7JwC1xtEn0AEIc3RvcFRpY2sCBAC1xtEn3AfHAUBpZiAobWFza3MudGlja0ludGVydmFsSWQpIHsKICAgIGlmICh0YWdzLmRlYnVnKSB7CiAgICAgICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBzdG9wIGludGVydmFsYCk7CiAgICB9CgogICAgY2xlYXJJbnRlcnZhbChtYXNrcy50aWNrSW50ZXJ2YWxJZCk7CiAgICBtYXNrcy50aWNrSW50ZXJ2YWxJZCA9IG51bGw7Cn0nALXG0SfQAQ50aWNrSW50ZXJ2YWxNUwIEALXG0SekCQMzMDAnALXG0SfQAQVkZWJ1ZwIEALXG0SeoCQVmYWxzZScAtcbRJ9ABBm9uVGljawIEALXG0SeuCfM1QGlmICh0YWdzLmRlYnVnKSB7CiAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIHN0YXJ0YCk7Cn0KCmlmICghdGhpc0JvdC5nZXRQcmVzZW5jZUVuYWJsZWQoKSkgewogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIGlnbm9yaW5nIHRpY2sg4oCUIHByZXNlbmNlIGlzIGRpc2FibGVkLmApOwogICAgfQogICAgcmV0dXJuOwp9CgppZiAoIWNvbmZpZ0JvdCkgewogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIGlnbm9yaW5nIHRpY2sg4oCUIHdhaXRpbmcgZm9yIGNvbmZpZ0JvdCB0byBiZSByZWFkeS5gKTsKICAgIH0KICAgIHJldHVybjsKfQoKaWYgKCFnbG9iYWxUaGlzLmFiKSB7CiAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gaWdub3JpbmcgdGljayDigJQgd2FpdGluZyBmb3IgYWIgdG8gYmUgcmVhZHkuYCk7CiAgICB9CiAgICByZXR1cm47Cn0KCmlmIChjb25maWdCb3QudGFncy5zaGVldFBvcnRhbCkgewogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIGlnbm9yaW5nIHRpY2sg4oCUIHdhaXRpbmcgdG8gbGVhdmUgc2hlZXQgcG9ydGFsLmApOwogICAgfQogICAgcmV0dXJuOwp9CgppZiAoY29uZmlnQm90LnRhZ3Muc3lzdGVtUG9ydGFsKSB7CiAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gaWdub3JpbmcgdGljayDigJQgd2FpdGluZyB0byBsZWF2ZSBzeXN0ZW0gcG9ydGFsLmApOwogICAgfQogICAgcmV0dXJuOwp9CgovLyBHZXQgbGlzdCBvZiByZWxldmFudCBwcmVzZW5jZSBkYXRhIGZyb20gcG9ydGFscyAmIGRpbWVuc2lvbnMgdGhhdCB0aGUgdXNlciBpcyBhY3RpdmUgaW4uCmNvbnN0IHByZXNlbmNlRGF0YVRvRW1pdDogQUJVc2VyUHJlc2VuY2VEYXRhW10gPSBbXTsKCmNvbnN0IHJlbW90ZU5hbWUgPSB0aGlzQm90LmdldFJlbW90ZU5hbWUoKTsKY29uc3QgcmVtb3RlQ29sb3IgPSB0aGlzQm90LmdldFJlbW90ZUNvbG9yKCk7Cgphc3luYyBmdW5jdGlvbiB0cnlHZW5lcmF0ZVByZXNlbmNlRGF0YUZvclBvcnRhbChwb3J0YWw6IHN0cmluZyk6IEFCVXNlclByZXNlbmNlRGF0YSB8IG51bGwgewogICAgY29uc3QgaW5NYXAgPSBwb3J0YWwgPT09ICdtYXAnIHx8IHBvcnRhbCA9PT0gJ21pbmlNYXAnOwogICAgY29uc3QgZGltZW5zaW9uID0gb3MuZ2V0UG9ydGFsRGltZW5zaW9uKHBvcnRhbCk7CiAgICBjb25zdCBwb3J0YWxCb3QgPSBnbG9iYWxUaGlzW3BvcnRhbCArICdQb3J0YWxCb3QnXTsKCiAgICBpZiAoIXBvcnRhbCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQoKICAgIGlmICghZGltZW5zaW9uKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9CgogICAgaWYgKCFwb3J0YWxCb3QpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9LnRyeUdlbmVyYXRlUHJlc2VuY2VEYXRhRm9yUG9ydGFsXSB1bmFibGUgdG8gZmluZCAke3BvcnRhbH0gcG9ydGFsIGJvdC5gKTsKICAgIH0KICAgIAogICAgY29uc3QgcHJlc2VuY2VEYXRhOiBBQlVzZXJQcmVzZW5jZURhdGEgPSB7CiAgICAgICAgcmVtb3RlSWQ6IGNvbmZpZ0JvdC5pZCwKICAgICAgICByZW1vdGVOYW1lLAogICAgICAgIHBvcnRhbCwKICAgICAgICBkaW1lbnNpb24sCiAgICAgICAgY29sb3I6IHJlbW90ZUNvbG9yLAogICAgICAgIGNhbWVyYTogdW5kZWZpbmVkLAogICAgICAgIGN1cnNvcnM6IHVuZGVmaW5lZCwKICAgIH0KCiAgICBjb25zdCBjYW1lcmFTdXBwb3J0ZWQgPSBwb3J0YWwgPT09ICdncmlkJyB8fCBwb3J0YWwgPT09ICdtaW5pR3JpZCcgfHwgcG9ydGFsID09PSAnbWFwJyB8fCBwb3J0YWwgPT09ICdtaW5pTWFwJzsKCiAgICBpZiAodGFncy5jYW1lcmFFbmFibGVkICYmIGNhbWVyYVN1cHBvcnRlZCkgewogICAgICAgIHByZXNlbmNlRGF0YS5jYW1lcmEgPSB7CiAgICAgICAgICAgIGNhbWVyYVR5cGU6IGluTWFwID8gJ3BlcnNwZWN0aXZlJyA6IChwb3J0YWxCb3QudGFncy5wb3J0YWxDYW1lcmFUeXBlID8/ICdvcnRob2dyYXBoaWMnKSwKICAgICAgICAgICAgcG9zaXRpb246IGluTWFwID8gcG9ydGFsQm90LnRhZ3MuY2FtZXJhTWFwUG9zaXRpb24gOiBwb3J0YWxCb3QudGFncy5jYW1lcmFQb3NpdGlvbiwKICAgICAgICAgICAgcXVhdGVybmlvbjogcG9ydGFsQm90LnRhZ3MuY2FtZXJhUm90YXRpb24ucXVhdGVybmlvbiwKICAgICAgICAgICAgem9vbTogcG9ydGFsQm90LnRhZ3MuY2FtZXJhWm9vbSwKICAgICAgICB9OwogICAgfQoKICAgIGNvbnN0IGN1cnNvclN1cHBvcnRlZCA9IHBvcnRhbCA9PT0gJ2dyaWQnIHx8IHBvcnRhbCA9PT0gJ21pbmlHcmlkJzsKCiAgICBpZiAodGFncy5jdXJzb3JFbmFibGVkICYmIGN1cnNvclN1cHBvcnRlZCkgewogICAgICAgIGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlUG9pbnRlckN1cnNvckRhdGEocG9pbnRlcjogJ21vdXNlJyB8ICdsZWZ0JyB8ICdyaWdodCcpOiBBQlVzZXJQcmVzZW5jZUN1cnNvckRhdGEgewogICAgICAgICAgICBjb25zdCBwb2ludGVyUG9zaXRpb24gPSBvcy5nZXRQb2ludGVyUG9zaXRpb24ocG9pbnRlcik7CiAgICAgICAgICAgIGNvbnN0IHBvaW50ZXJEaXJlY3Rpb24gPSBvcy5nZXRQb2ludGVyRGlyZWN0aW9uKHBvaW50ZXIpOwogICAgICAgICAgICBjb25zdCByYXljYXN0UmVzdWx0ID0gYXdhaXQgb3MucmF5Y2FzdChwb3J0YWwsIHBvaW50ZXJQb3NpdGlvbiwgcG9pbnRlckRpcmVjdGlvbik7CgogICAgICAgICAgICBsZXQgcmF5Y2FzdEhpdDsKCiAgICAgICAgICAgIGlmIChyYXljYXN0UmVzdWx0LmJvdEludGVyc2VjdGlvbnMgJiYgcmF5Y2FzdFJlc3VsdC5ib3RJbnRlcnNlY3Rpb25zLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHJheWNhc3RIaXQgPSByYXljYXN0UmVzdWx0LmJvdEludGVyc2VjdGlvbnMuZmluZCgoaCkgPT4gewogICAgICAgICAgICAgICAgICAgIHJldHVybiBoLmJvdC50YWdzLnBvaW50YWJsZSAhPSBmYWxzZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChyYXljYXN0SGl0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIHBvaW50ZXJUeXBlOiBwb2ludGVyLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7IHg6IHJheWNhc3RIaXQucG9pbnQueCwgeTogcmF5Y2FzdEhpdC5wb2ludC55LCB6OiByYXljYXN0SGl0LnBvaW50LnogfSwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIERpZG4ndCBoaXQgYW55IGJvdHMuCiAgICAgICAgICAgICAgICAvLyBUcnkgdGVzdGluZyBhZ2FpbnN0IHRoZSBncm91bmQgcGxhbmUuCiAgICAgICAgICAgICAgICBjb25zdCBncm91bmRQb2ludCA9IG1hdGguaW50ZXJzZWN0UGxhbmUocG9pbnRlclBvc2l0aW9uLCBwb2ludGVyRGlyZWN0aW9uKTsKCiAgICAgICAgICAgICAgICBpZiAoZ3JvdW5kUG9pbnQgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXJUeXBlOiBwb2ludGVyLAogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogeyB4OiBncm91bmRQb2ludC54LCB5OiBncm91bmRQb2ludC55LCB6OiBncm91bmRQb2ludC56IH0sCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvLyBOb3QgaW50ZXJzZWN0aW5nIHdpdGggYW55dGhpbmcgcmlnaHQgc28gc28gbGV0cyBqdXN0IGdldCBhIHBvaW50IHNvbWUgZGlzdGFuY2UgZG93biB0aGUgCiAgICAgICAgICAgICAgICAgICAgLy8gcG9pbnRlcidzIHJheSBhbmQgY2FsbCBpdCBnb29kLgogICAgICAgICAgICAgICAgICAgIGNvbnN0IGZsb2F0aW5nUG9pbnQgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHg6IHBvaW50ZXJQb3NpdGlvbi54ICsgcG9pbnRlckRpcmVjdGlvbi54ICogdGFncy5mbG9hdGluZ0N1cnNvckRpc3RhbmNlLAogICAgICAgICAgICAgICAgICAgICAgICB5OiBwb2ludGVyUG9zaXRpb24ueSArIHBvaW50ZXJEaXJlY3Rpb24ueSAqIHRhZ3MuZmxvYXRpbmdDdXJzb3JEaXN0YW5jZSwKICAgICAgICAgICAgICAgICAgICAgICAgejogcG9pbnRlclBvc2l0aW9uLnogKyBwb2ludGVyRGlyZWN0aW9uLnogKiB0YWdzLmZsb2F0aW5nQ3Vyc29yRGlzdGFuY2UsCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBwb2ludGVyVHlwZTogcG9pbnRlciwKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGZsb2F0aW5nUG9pbnQsCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgIH0KCiAgICAgICAgY29uc3QgY3Vyc29yczogQUJVc2VyUHJlc2VuY2VDdXJzb3JEYXRhW10gPSBbXTsKCiAgICAgICAgaWYgKG1hc2tzLmluWFIpIHsKICAgICAgICAgICAgaWYgKGNvbmZpZ0JvdC50YWdzLmxlZnRQb2ludGVyUG9ydGFsID09PSBwb3J0YWwpIHsKICAgICAgICAgICAgICAgIGN1cnNvcnMucHVzaChhd2FpdCBnZW5lcmF0ZVBvaW50ZXJDdXJzb3JEYXRhKCdsZWZ0JykpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY29uZmlnQm90LnRhZ3MucmlnaHRQb2ludGVyUG9ydGFsID09PSBwb3J0YWwpIHsKICAgICAgICAgICAgICAgIGN1cnNvcnMucHVzaChhd2FpdCBnZW5lcmF0ZVBvaW50ZXJDdXJzb3JEYXRhKCdyaWdodCcpKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChjb25maWdCb3QudGFncy5tb3VzZVBvaW50ZXJQb3J0YWwgPT09IHBvcnRhbCkgewogICAgICAgICAgICAgICAgY3Vyc29ycy5wdXNoKGF3YWl0IGdlbmVyYXRlUG9pbnRlckN1cnNvckRhdGEoJ21vdXNlJykpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoY3Vyc29ycy5sZW5ndGgpIHsKICAgICAgICAgICAgcHJlc2VuY2VEYXRhLmN1cnNvcnMgPSBjdXJzb3JzOwogICAgICAgIH0KICAgIH0KCiAgICBpZiAocHJlc2VuY2VEYXRhLmNhbWVyYSB8fCAocHJlc2VuY2VEYXRhLmN1cnNvcnMgJiYgcHJlc2VuY2VEYXRhLmN1cnNvcnMubGVuZ3RoID4gMCkpIHsKICAgICAgICByZXR1cm4gcHJlc2VuY2VEYXRhOwogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KfQoKLy8gTWFwIHBvcnRhbCBzaXRzIG9uIHRvcCB0aGUgZ3JpZCBwb3J0YWwgc28gb25seSBzZW5kIG1hcCBwb3J0YWwgY2FtZXJhIGlmIGl0cyBlbmFibGVkLgppZiAoY29uZmlnQm90LnRhZ3MubWFwUG9ydGFsKSB7CiAgICBjb25zdCBwcmVzZW5jZURhdGEgPSBhd2FpdCB0cnlHZW5lcmF0ZVByZXNlbmNlRGF0YUZvclBvcnRhbCgnbWFwJyk7CiAgICBpZiAocHJlc2VuY2VEYXRhKSB7CiAgICAgICAgcHJlc2VuY2VEYXRhVG9FbWl0LnB1c2gocHJlc2VuY2VEYXRhKTsKICAgIH0KfSBlbHNlIGlmIChjb25maWdCb3QudGFncy5ncmlkUG9ydGFsKSB7CiAgICBjb25zdCBwcmVzZW5jZURhdGEgPSBhd2FpdCB0cnlHZW5lcmF0ZVByZXNlbmNlRGF0YUZvclBvcnRhbCgnZ3JpZCcpOwogICAgaWYgKHByZXNlbmNlRGF0YSkgewogICAgICAgIHByZXNlbmNlRGF0YVRvRW1pdC5wdXNoKHByZXNlbmNlRGF0YSk7CiAgICB9Cn0KCi8vIE1pbmkgbWFwIHBvcnRhbCBzaXRzIG9uIHRvcCB0aGUgbWluaSBtYXAgcG9ydGFsIHNvIG9ubHkgc2VuZCBtaW5pIG1hcCBwb3J0YWwgY2FtZXJhIGlmIGl0cyBlbmFibGVkLgppZiAoY29uZmlnQm90LnRhZ3MubWluaU1hcFBvcnRhbCkgewogICAgY29uc3QgcHJlc2VuY2VEYXRhID0gYXdhaXQgdHJ5R2VuZXJhdGVQcmVzZW5jZURhdGFGb3JQb3J0YWwoJ21pbmlNYXAnKTsKICAgIGlmIChwcmVzZW5jZURhdGEpIHsKICAgICAgICBwcmVzZW5jZURhdGFUb0VtaXQucHVzaChwcmVzZW5jZURhdGEpOwogICAgfQp9IGVsc2UgaWYgKGNvbmZpZ0JvdC50YWdzLm1pbmlHcmlkUG9ydGFsKSB7CiAgICBjb25zdCBwcmVzZW5jZURhdGEgPSBhd2FpdCB0cnlHZW5lcmF0ZVByZXNlbmNlRGF0YUZvclBvcnRhbCgnbWluaUdyaWQnKTsKICAgIGlmIChwcmVzZW5jZURhdGEpIHsKICAgICAgICBwcmVzZW5jZURhdGFUb0VtaXQucHVzaChwcmVzZW5jZURhdGEpOwogICAgfQp9CgppZiAocHJlc2VuY2VEYXRhVG9FbWl0Lmxlbmd0aCA9PT0gMCkgewogICAgaWYgKHRhZ3MuZGVidWcpIHsKICAgICAgICBjb25zb2xlLmxvZyhgWyR7dGFncy5zeXN0ZW19LiR7dGFnTmFtZX1dIGlnbm9yaW5nIHRpY2sg4oCUIHdhaXRpbmcgdG8gYmUgaW4gYSBwb3J0YWwgd2l0aCBwcmVzZW5jZSBkYXRhLmApOwogICAgfQogICAgcmV0dXJuOwp9Cgpjb25zdCBvdGhlclJlbW90ZXMgPSAoYXdhaXQgb3MucmVtb3RlcygpKS5maWx0ZXIoaWQgPT4gaWQgIT09IGNvbmZpZ0JvdC5pZCk7CgppZiAodGFncy5kZWJ1ZykgewogICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBwcmVzZW5jZURhdGFUb0VtaXQ6YCwgcHJlc2VuY2VEYXRhVG9FbWl0LCBgb3RoZXJSZW1vdGVzOmAsIG90aGVyUmVtb3Rlcyk7Cn0KCmlmIChvdGhlclJlbW90ZXMubGVuZ3RoID4gMCkgewogICAgc2VuZFJlbW90ZURhdGEob3RoZXJSZW1vdGVzLCAnYWJfdXNlcl9wcmVzZW5jZV9kYXRhJywgcHJlc2VuY2VEYXRhVG9FbWl0KTsKfQonALXG0SfQAQxvbkJvdENoYW5nZWQCBAC1xtEnlj/yAkBpZiAodGhhdC50YWdzLmluY2x1ZGVzKCd0aWNrSW50ZXJ2YWxNUycpKSB7CiAgICB0aGlzQm90LnN0b3BUaWNrKCk7CgogICAgaWYgKG9zLmlzQ29sbGFib3JhdGl2ZSgpICYmIHRoaXNCb3QuZ2V0UHJlc2VuY2VFbmFibGVkKCkpIHsKICAgICAgICB0aGlzQm90LnN0YXJ0VGljaygpOwogICAgfQp9IGVsc2UgaWYgKHRoYXQudGFncy5zb21lKCh0KSA9PiB0ID09PSAnY3Vyc29yRW5hYmxlZCcgfHwgdCA9PT0gJ2NhbWVyYUVuYWJsZWQnKSkgewogICAgaWYgKHRoaXNCb3QuZ2V0UHJlc2VuY2VFbmFibGVkKCkpIHsKICAgICAgICB0aGlzQm90LnN0YXJ0VGljaygpOwogICAgfSBlbHNlIHsKICAgICAgICB0aGlzQm90LnN0b3BUaWNrKCk7CiAgICB9Cn0nALXG0SfQAQxvblJlbW90ZURhdGECBAC1xtEniUL6A0BpZiAoIXRoaXNCb3QuZ2V0UHJlc2VuY2VFbmFibGVkKCkpIHsKICAgIHJldHVybjsKfQoKaWYgKHRoYXQubmFtZSA9PT0gJ2FiX3VzZXJfcHJlc2VuY2VfZGF0YScpIHsKICAgIGNvbnN0IGRhdGE6IEFCVXNlclByZXNlbmNlRGF0YSB8IEFCVXNlclByZXNlbmNlRGF0YVtdID0gdGhhdC50aGF0OwoKICAgIGlmICh0YWdzLmRlYnVnKSB7CiAgICAgICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBhYl91c2VyX3ByZXNlbmNlX2RhdGEgZGF0YTpgLCBkYXRhKTsKICAgIH0KCiAgICBpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0aGlzQm90Lm9uQUJVc2VyUHJlc2VuY2VEYXRhUmVjZWl2ZWQoZGF0YVtpXSk7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICB0aGlzQm90Lm9uQUJVc2VyUHJlc2VuY2VEYXRhUmVjZWl2ZWQoZGF0YSk7CiAgICB9Cn0KJwC1xtEn0AEFdHlwZXMCBAC1xtEnhEa/CfCfk4RpbnRlcmZhY2UgQUJVc2VyUHJlc2VuY2VEYXRhIHsKICAgIC8qKiBSZW1vdGUgaWQgb2YgdGhlIHVzZXIgdGhlIHByZXNlbmNlIGRhdGEgaXMgZm9yLiAqLwogICAgcmVtb3RlSWQ6IHN0cmluZzsKCiAgICAvKiogQ2FuIGVpdGhlciBiZSB1c2VyJ3MgZGlzcGxheSBuYW1lIG9yIGEgc2hvcnRlbmVkIGxvY2FsIHVzZXIgaWQuICoqLwogICAgcmVtb3RlTmFtZTogc3RyaW5nOwoKICAgIC8qKiBQb3J0YWwgdGhhdCB0aGUgcHJlc2VuY2UgZGF0YSBpcyBmb3IuICovCiAgICBwb3J0YWw6IHN0cmluZzsKCiAgICAvKiogRGltZW5zaW9uIHRoYXQgdGhlIHByZXNlbmNlIGRhdGEgaXMgZm9yLiAqKi8KICAgIGRpbWVuc2lvbjogc3RyaW5nOwoKICAgIC8qKiBDb2xvciBvZiB0aGUgdXNlci4gKi8KICAgIGNvbG9yOiBzdHJpbmc7CgogICAgY2FtZXJhPzogQUJVc2VyUHJlc2VuY2VDYW1lcmFEYXRhOwogICAgY3Vyc29ycz86IEFCVXNlclByZXNlbmNlQ3Vyc29yRGF0YVtdOwp9CgppbnRlcmZhY2UgQUJVc2VyUHJlc2VuY2VDYW1lcmFEYXRhIHsKICAgIC8qKiBUeXBlIG9mIHRoZSBjYW1lcmEgdGhhdCB0aGUgZGF0YSBpcyBmb3IuICovCiAgICBjYW1lcmFUeXBlOiAncGVyc3BlY3RpdmUnIHwgJ29ydGhvZ3JhcGhpYyc7CiAgICAKICAgIC8qKiBUaGUgcG9zaXRpb24gb2YgdGhlIGNhbWVyYS4gKiovCiAgICBwb3NpdGlvbjogeyB4OiBudW1iZXIsIHk6IG51bWJlciwgejogbnVtYmVyIH07CgogICAgLyoqIFRoZSByb3RhdGlvbiBxdWF0ZXJuaW9uIG9mIHRoZSBjYW1lcmEuICoqLwogICAgcXVhdGVybmlvbjogeyB4OiBudW1iZXIsIHk6IG51bWJlciwgejogbnVtYmVyLCB3OiBudW1iZXIgfTsKCiAgICAvKiogVGhlIHpvb20gdmxhdWUgdGhhdCB0aGUgY2FtZXJhIGlzIGF0LiBUaGlzIGlzIG9ubHkgcmVsZXZhbnQgZm9yIG9ydGhvZ3JhcGhpYyBjYW1lcmFzLiAgKi8KICAgIHpvb20/OiBudW1iZXI7Cn0KCmludGVyZmFjZSBBQlVzZXJQcmVzZW5jZUN1cnNvckRhdGEgewogICAgLyoqIFRoZSB0eXBlIG9mIHRoZSBwb2ludGVyIHRoYXQgdGhlIGRhdGEgaXMgZm9yLiAqLwogICAgcG9pbnRlclR5cGU6ICdtb3VzZScgfCAnbGVmdCcgfCAncmlnaHQnIHwgJ3RvdWNoJzsKICAgIAogICAgLyoqIFRoZSBwb3NpdGlvbiBvZiB0aGUgY3Vyc29yLiAqKi8KICAgIHBvc2l0aW9uOiB7IHg6IG51bWJlciwgeTogbnVtYmVyLCB6OiBudW1iZXIgfTsKfScAtcbRJ9ABEmNhbWVyYUJvdFRpbWVvdXRNUwIEALXG0SfCTwQzMDAwJwC1xtEn0AELaW50ZXJwb2xhdGUCBAC1xtEnx08EdHJ1ZScAtcbRJ9ABBnRpY2tlcgIEALXG0SfMTyjwn5SXNWMxOWJjOWYtYzY4ZC00M2M3LWJlMzQtMzYwMjFmN2U0ZGQzJwC1xtEn0AEOZ2V0UmVtb3RlQ29sb3ICBAC1xtEn80/NAUBpZiAoIW1hc2tzLnJlbW90ZUNvbG9yKSB7CiAgICBtYXRoLnNldFJhbmRvbVNlZWQoY29uZmlnQm90LmlkKTsKICAgIG1hc2tzLnJlbW90ZUNvbG9yID0gYHJnYigke21hdGgucmFuZG9tSW50KDAsIDI1NSl9LCAke21hdGgucmFuZG9tSW50KDAsIDI1NSl9LCAke21hdGgucmFuZG9tSW50KDAsIDI1NSl9KWA7Cn0KCnJldHVybiBtYXNrcy5yZW1vdGVDb2xvcjsnALXG0SfQAQ1nZXRSZW1vdGVOYW1lAgQAtcbRJ8FRzwJALy8gVGhlIG5hbWUgdGhhdCB0aGlzIHJlbW90ZSBpcyB0byBiZSBrbm93biBhcyB0byBvdGhlciB1c2Vycy4KbGV0IHJlbW90ZU5hbWU7CgppZiAoYWIubGlua3MuY29uc29sZS5tYXNrcy5wcmVmZXJyZWROYW1lKSB7CiAgICByZW1vdGVOYW1lID0gYWIubGlua3MuY29uc29sZS5tYXNrcy5wcmVmZXJyZWROYW1lOwp9IGVsc2UgaWYgKGF1dGhCb3QgJiYgYXV0aEJvdC50YWdzLm5hbWUpIHsKICAgIHJlbW90ZU5hbWUgPSBhdXRoQm90LnRhZ3MubmFtZTsKfSBlbHNlIHsKICAgIHJlbW90ZU5hbWUgPSBjb25maWdCb3QuaWQuc3Vic3RyaW5nKDAsNSk7Cn0KCnJldHVybiByZW1vdGVOYW1lOycAtcbRJ9ABEmN1cnNvckJvdFRpbWVvdXRNUwIEALXG0SeRVAQzMDAwJwC1xtEn0AENY2FtZXJhRW5hYmxlZAIEALXG0SeWVAVmYWxzZScAtcbRJ9ABDWN1cnNvckVuYWJsZWQCBAC1xtEnnFQFZmFsc2UnALXG0SfQARJnZXRQcmVzZW5jZUVuYWJsZWQCBAC1xtEnolQxQHJldHVybiB0YWdzLmN1cnNvckVuYWJsZWQgfHwgdGFncy5jYW1lcmFFbmFibGVkOycAtcbRJ9ABHG9uQUJVc2VyUHJlc2VuY2VEYXRhUmVjZWl2ZWQCBAC1xtEn1FT2lAFAY29uc3QgcHJlc2VuY2VEYXRhOiBBQlVzZXJQcmVzZW5jZURhdGEgPSB0aGF0OwoKaWYgKHRhZ3MuZGVidWcpIHsKICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gcHJlc2VuY2VEYXRhOmAsIHByZXNlbmNlRGF0YSkKfQoKaWYgKHByZXNlbmNlRGF0YS5jYW1lcmEpIHsKICAgIGNvbnN0IHNob3V0UmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChzaG91dCgnb25BQlVzZXJDYW1lcmFVcGRhdGUnLCBwcmVzZW5jZURhdGEpKTsKICAgIGNvbnN0IGNhbWVyYVVwZGF0ZWQgPSBzaG91dFJlc3VsdHMubGVuZ3RoID4gMCAmJiBzaG91dFJlc3VsdHMuc29tZShyID0+IHIudmFsdWUgPT09IHRydWUpOwogICAgCiAgICBpZiAoIWNhbWVyYVVwZGF0ZWQpIHsKICAgICAgICAvLyBUaGVyZSB3YXMgbm8gdXNlciBjYW1lcmEgdGhhdCBhY2NlcHRlZCB0aGUgdXBkYXRlLCBuZWVkIHRvIGNyZWF0ZSBhIG5ldyBvbmUuCgogICAgICAgIGlmICh0YWdzLmRlYnVnKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gbWFrZSB1c2VyIGNhbWVyYTpgLCBwcmVzZW5jZURhdGEpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgdXNlckNhbWVyYUJvdCA9IGNyZWF0ZSh7CiAgICAgICAgICAgIHNwYWNlOiAndGVtcExvY2FsJywKICAgICAgICAgICAgYWJCb3Q6IHRydWUsCiAgICAgICAgICAgIGFiVXNlckNhbWVyYTogdHJ1ZSwKICAgICAgICAgICAgbWFuYWdlcjogZ2V0TGluayh0aGlzQm90KSwKICAgICAgICAgICAgZm9ybTogJ2ZydXN0dW0nLAogICAgICAgICAgICBhbmNob3JQb2ludDogJ2NlbnRlcicsCiAgICAgICAgICAgIHJlbW90ZUlkOiBwcmVzZW5jZURhdGEucmVtb3RlSWQsCiAgICAgICAgICAgIHJlbW90ZU5hbWU6IHByZXNlbmNlRGF0YS5yZW1vdGVOYW1lLAogICAgICAgICAgICBwb3J0YWw6IHByZXNlbmNlRGF0YS5wb3J0YWwsCiAgICAgICAgICAgIGRpbWVuc2lvbjogcHJlc2VuY2VEYXRhLmRpbWVuc2lvbiwKICAgICAgICAgICAgW3ByZXNlbmNlRGF0YS5kaW1lbnNpb25dOiB0cnVlLAogICAgICAgICAgICBwb2ludGFibGU6IGZhbHNlLAogICAgICAgICAgICBsYWJlbFBvc2l0aW9uOiAnZmxvYXRpbmdCaWxsYm9hcmQnLAogICAgICAgICAgICBsYWJlbFdvcmRXcmFwTW9kZTogJ25vbmUnLAogICAgICAgICAgICAvLyBsYWJlbFNpemU6IDAuMjgsCiAgICAgICAgICAgIC8vIGxhYmVsU2l6ZU1vZGU6ICdhdXRvJywKICAgICAgICAgICAgb25DcmVhdGU6IExpc3RlbmVyU3RyaW5nKCgpID0+IHsKICAgICAgICAgICAgICAgIGlmIChsaW5rcy5tYW5hZ2VyLnRhZ3MuZGVidWcpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW2FiVXNlckNhbWVyYS4ke3RhZ05hbWV9ICgke3RhZ3MucmVtb3RlTmFtZX0pXWApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSwKICAgICAgICAgICAgb25BQlVzZXJDYW1lcmFVcGRhdGU6IExpc3RlbmVyU3RyaW5nKGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IHByZXNlbmNlRGF0YTogQUJVc2VyUHJlc2VuY2VEYXRhID0gdGhhdDsKCiAgICAgICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0aGUgaW5jb21pbmcgdXBkYXRlIGlzIGZvciB0aGlzIGJvdC4KICAgICAgICAgICAgICAgIGlmIChwcmVzZW5jZURhdGEucmVtb3RlSWQgIT09IHRhZ3MucmVtb3RlSWQgfHwKICAgICAgICAgICAgICAgICAgICBwcmVzZW5jZURhdGEucG9ydGFsICE9PSB0YWdzLnBvcnRhbCB8fAogICAgICAgICAgICAgICAgICAgIHByZXNlbmNlRGF0YS5kaW1lbnNpb24gIT09IHRhZ3MuZGltZW5zaW9uCiAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gQ2xlYXIgb2xkIHRpbWVvdXQuCiAgICAgICAgICAgICAgICBpZiAodGhpc0JvdC52YXJzLnRpbWVvdXRJZCkgewogICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzQm90LnZhcnMudGltZW91dElkKTsKICAgICAgICAgICAgICAgICAgICB0aGlzQm90LnZhcnMudGltZW91dElkID0gbnVsbDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAobGlua3MubWFuYWdlci50YWdzLmRlYnVnKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFthYlVzZXJDYW1lcmEuJHt0YWdOYW1lfSAoJHt0YWdzLnJlbW90ZU5hbWV9KV0gcHJlc2VuY2VEYXRhOmAsIHByZXNlbmNlRGF0YSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRhZ3MubGFiZWwgIT09IHByZXNlbmNlRGF0YS5yZW1vdGVOYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgdGFncy5sYWJlbCA9IHByZXNlbmNlRGF0YS5yZW1vdGVOYW1lOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh0YWdzLmNvbG9yICE9PSBwcmVzZW5jZURhdGEuY29sb3IpIHsKICAgICAgICAgICAgICAgICAgICB0YWdzLmNvbG9yID0gcHJlc2VuY2VEYXRhLmNvbG9yOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh0YWdzLmxhYmVsRmxvYXRpbmdCYWNrZ3JvdW5kQ29sb3IgIT09IHByZXNlbmNlRGF0YS5jb2xvcil7IAogICAgICAgICAgICAgICAgICAgIHRhZ3MubGFiZWxGbG9hdGluZ0JhY2tncm91bmRDb2xvciA9IHByZXNlbmNlRGF0YS5jb2xvcjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjbGFtcDAxKHQ6IG51bWJlcikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCB0KSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gem9vbVRvVCh6b29tOiBudW1iZXIsIHpvb21NaW46IG51bWJlciwgem9vbU1heDogbnVtYmVyKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gdD0wIGF0IHpvb21NaW4sIHQ9MSBhdCB6b29tTWF4CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeiA9IE1hdGgubWF4KHpvb20sIDFlLTYpOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBNYXRoLmxvZyh6b29tTWluKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiID0gTWF0aC5sb2coem9vbU1heCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdiA9IChNYXRoLmxvZyh6KSAtIGEpIC8gKGIgLSBhKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xhbXAwMSh2KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBsZXJwKGE6IG51bWJlciwgYjogbnVtYmVyLCB0OiBudW1iZXIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSArIChiIC0gYSkgKiB0OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIE9wdGlvbmFsIHNtb290aGluZyBzbyBpdCBkb2VzbuKAmXQgZmVlbCBsaW5lYXIgLyBoYXJzaDoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHNtb290aHN0ZXAodDogbnVtYmVyKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgKiB0ICogKDMgLSAyICogdCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gdD0wIGF0IHpvb21NaW4gKHpvb21lZCBvdXQpLCB0PTEgYXQgem9vbU1heCAoem9vbWVkIGluKQogICAgICAgICAgICAgICAgZnVuY3Rpb24gYXBwbHlFYXNlKHQ6IG51bWJlciwgZXhwb25lbnQ6IG51bWJlcikgewogICAgICAgICAgICAgICAgICAgIC8vIGV4cG9uZW50IDwgMSBzbG93cyBkb3duIHRoZSDigJxtb3ZlIGF3YXnigJ0gd2hlbiB6b29taW5nIG91dAogICAgICAgICAgICAgICAgICAgIC8vIChtYWtlcyBjdXJ2ZSBnZW50bGVyIG5lYXIgdD0wKQogICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLnBvdyhzbW9vdGhzdGVwKHQpLCBleHBvbmVudCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYXN5bmMgZnVuY3Rpb24gZ2V0Vml6Q2FtZXJhUG9zZSgKICAgICAgICAgICAgICAgICAgICBjYW1lcmFQb3NpdGlvbjogeyB4OiBudW1iZXI7IHk6IG51bWJlcjsgejogbnVtYmVyIH0sCiAgICAgICAgICAgICAgICAgICAgY2FtZXJhUm90YXRpb246IHsgeDogbnVtYmVyOyB5OiBudW1iZXI7IHo6IG51bWJlcjsgdzogbnVtYmVyIH0sCiAgICAgICAgICAgICAgICAgICAgY2FtZXJhVHlwZTogJ29ydGhvZ3JhcGhpYycgfCAncGVyc3BlY3RpdmUnLAogICAgICAgICAgICAgICAgICAgIGNhbWVyYVpvb206IG51bWJlciB8IG51bGwgfCB1bmRlZmluZWQsCiAgICAgICAgICAgICAgICAgICAgem9vbU1pbiA9IDAuNCwKICAgICAgICAgICAgICAgICAgICB6b29tTWF4ID0gODAsCiAgICAgICAgICAgICAgICAgICAgZmFyRGlzdCA9IDMwLAogICAgICAgICAgICAgICAgICAgIG5lYXJEaXN0ID0gMiwKICAgICAgICAgICAgICAgICAgICBleHBvbmVudCA9IDAuNSwKICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvcyA9IG5ldyBWZWN0b3IzKGNhbWVyYVBvc2l0aW9uLngsIGNhbWVyYVBvc2l0aW9uLnksIGNhbWVyYVBvc2l0aW9uLnopOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGxldCByb3Q7CiAgICAgICAgICAgICAgICAgICAgaWYgKChjb25maWdCb3QudGFncy5tYXBQb3J0YWwgPT09IHRhZ3MuZGltZW5zaW9uIHx8IGNvbmZpZ0JvdC50YWdzLm1pbmlNYXBQb3J0YWwgPT09IHRhZ3MuZGltZW5zaW9uKSAmJiBjYW1lcmFUeXBlID09PSAncGVyc3BlY3RpdmUnKSB7IAogICAgICAgICAgICAgICAgICAgICAgICByb3QgPSBhd2FpdCBhYi5saW5rcy51dGlscy5jYWxjTWFwUm90YXRpb24oeyBtYXBQb3NpdGlvbjogY2FtZXJhUG9zaXRpb24sIGF1eFJvdGF0aW9uOiBuZXcgUm90YXRpb24oeyBxdWF0ZXJuaW9uOiBjYW1lcmFSb3RhdGlvbiB9KX0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJvdCA9IG5ldyBSb3RhdGlvbih7IHF1YXRlcm5pb246IGNhbWVyYVJvdGF0aW9uIH0pOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9yd2FyZCA9IHJvdC5yb3RhdGVWZWN0b3IzKG5ldyBWZWN0b3IzKDAsIDEsIDApKS5ub3JtYWxpemUoKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKGNhbWVyYVR5cGUgPT09ICdwZXJzcGVjdGl2ZScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgcG9zaXRpb246IHBvcywgcm90YXRpb246IHJvdCB9OwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgY29uc3Qgem9vbSA9IE1hdGgubWF4KGNhbWVyYVpvb20gPz8gMTAsIDFlLTYpOwoKICAgICAgICAgICAgICAgICAgICBsZXQgdCA9IHpvb21Ub1Qoem9vbSwgem9vbU1pbiwgem9vbU1heCk7CiAgICAgICAgICAgICAgICAgICAgdCA9IGFwcGx5RWFzZSh0LCBleHBvbmVudCk7CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IGQgPSBsZXJwKGZhckRpc3QsIG5lYXJEaXN0LCB0KTsKICAgICAgICAgICAgICAgICAgICBjb25zdCB2aXpQb3MgPSBwb3Muc3VidHJhY3QoZm9yd2FyZC5tdWx0aXBseVNjYWxhcihkKSk7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHBvc2l0aW9uOiB2aXpQb3MsIHJvdGF0aW9uOiByb3QsIGRlYnVnOiB7IHQsIGQsIHpvb20gfSB9OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnN0IHBvc2UgPSBhd2FpdCBnZXRWaXpDYW1lcmFQb3NlKAogICAgICAgICAgICAgICAgICAgIHByZXNlbmNlRGF0YS5jYW1lcmEucG9zaXRpb24sCiAgICAgICAgICAgICAgICAgICAgcHJlc2VuY2VEYXRhLmNhbWVyYS5xdWF0ZXJuaW9uLAogICAgICAgICAgICAgICAgICAgIHByZXNlbmNlRGF0YS5jYW1lcmEuY2FtZXJhVHlwZSwKICAgICAgICAgICAgICAgICAgICBwcmVzZW5jZURhdGEuY2FtZXJhLnpvb20sCiAgICAgICAgICAgICAgICAgICAgMC40LAogICAgICAgICAgICAgICAgICAgIDgwLAogICAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAgICAgLTQyNywKICAgICAgICAgICAgICAgICAgICAwLjEsCiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIGNvbnN0IHBvc1RhZ05hbWUgPSB0YWdzLmRpbWVuc2lvbiArICdQb3NpdGlvbic7CiAgICAgICAgICAgICAgICBjb25zdCByb3RUYWdOYW1lID0gdGFncy5kaW1lbnNpb24gKyAnUm90YXRpb24nOwoKICAgICAgICAgICAgICAgIGNsZWFyQW5pbWF0aW9ucyh0aGlzQm90LCBbcG9zVGFnTmFtZSwgcm90VGFnTmFtZV0pOwoKICAgICAgICAgICAgICAgIGlmIChsaW5rcy5tYW5hZ2VyLnRhZ3MuaW50ZXJwb2xhdGUgJiYgdGFnc1twb3NUYWdOYW1lXSAmJiB0YWdzW3JvdFRhZ05hbWVdKSB7CiAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZVRhZyh0aGlzQm90LCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZyb21WYWx1ZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgW3Bvc1RhZ05hbWVdOiB0YWdzW3Bvc1RhZ05hbWVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgW3JvdFRhZ05hbWVdOiB0YWdzW3JvdFRhZ05hbWVdLAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB0b1ZhbHVlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbcG9zVGFnTmFtZV06IHBvc2UucG9zaXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBbcm90VGFnTmFtZV06IHBvc2Uucm90YXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAobGlua3MubWFuYWdlci50YWdzLnRpY2tJbnRlcnZhbE1TICsgNTApIC8gMTAwMCwKICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7fSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIG1hc2tzW3Bvc1RhZ05hbWVdID0gcG9zZS5wb3NpdGlvbjsKICAgICAgICAgICAgICAgICAgICBtYXNrc1tyb3RUYWdOYW1lXSA9IHBvc2Uucm90YXRpb247CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gU2V0IG5ldyB0aW1lb3V0LgogICAgICAgICAgICAgICAgdGhpc0JvdC52YXJzLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4gZGVzdHJveSh0aGlzQm90KSwgbGlua3MubWFuYWdlci50YWdzLmNhbWVyYUJvdFRpbWVvdXRNUyk7CgogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBvbkRlc3Ryb3k6IExpc3RlbmVyU3RyaW5nKCgpID0+IHsKICAgICAgICAgICAgICAgIGlmIChsaW5rcy5tYW5hZ2VyLnRhZ3MuZGVidWcpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW2FiVXNlckNhbWVyYS4ke3RhZ05hbWV9ICgke3RhZ3MucmVtb3RlTmFtZX0pXWApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgIH0pCgogICAgICAgIC8vIERpcmVjdGx5IGNhbGwgb25BQlVzZXJDYW1lcmFVcGRhdGUgdGhlIGZpcnN0IHRpbWUgd2UgbWFrZSBhIG5ldyB1c2VyIGNhbWVyYSBib3QuCiAgICAgICAgYXdhaXQgdXNlckNhbWVyYUJvdC5vbkFCVXNlckNhbWVyYVVwZGF0ZShwcmVzZW5jZURhdGEpOwogICAgfQp9CgppZiAocHJlc2VuY2VEYXRhLmN1cnNvcnMgJiYgcHJlc2VuY2VEYXRhLmN1cnNvcnMubGVuZ3RoID4gMCkgewogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcmVzZW5jZURhdGEuY3Vyc29ycy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHNob3V0UmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChzaG91dCgnb25BQlVzZXJDdXJzb3JVcGRhdGUnLCB7IHByZXNlbmNlRGF0YSwgY3Vyc29ySW5kZXg6IGkgfSkpOwogICAgICAgIGNvbnN0IGN1cnNvclVwZGF0ZWQgPSBzaG91dFJlc3VsdHMubGVuZ3RoID4gMCAmJiBzaG91dFJlc3VsdHMuc29tZShyID0+IHIudmFsdWUgPT09IHRydWUpOwogICAgICAgIAogICAgICAgIGlmICghY3Vyc29yVXBkYXRlZCkgewogICAgICAgICAgICAvLyBUaGVyZSB3YXMgbm8gdXNlciBjdXJzb3IgdGhhdCBhY2NlcHRlZCB0aGUgdXBkYXRlLCBuZWVkIHRvIGNyZWF0ZSBhIG5ldyBvbmUuCgogICAgICAgICAgICBpZiAodGFncy5kZWJ1ZykgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFske3RhZ3Muc3lzdGVtfS4ke3RhZ05hbWV9XSBtYWtlIHVzZXIgY3Vyc29yOmAsIHByZXNlbmNlRGF0YSwgYGN1cnNvcjpgLCBwcmVzZW5jZURhdGEuY3Vyc29yc1tpXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IGN1cnNvckJvdCA9IGNyZWF0ZSh7CiAgICAgICAgICAgICAgICBzcGFjZTogJ3RlbXBMb2NhbCcsCiAgICAgICAgICAgICAgICBhYkJvdDogdHJ1ZSwKICAgICAgICAgICAgICAgIGFiVXNlckN1cnNvcjogdHJ1ZSwKICAgICAgICAgICAgICAgIGZvcm06ICdub3RoaW5nJywKICAgICAgICAgICAgICAgIGFuY2hvclBvaW50OiAnY2VudGVyJywKICAgICAgICAgICAgICAgIG9yaWVudGF0aW9uTW9kZTogJ2JpbGxib2FyZCcsCiAgICAgICAgICAgICAgICBwb2ludGFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgZHJhZ2dhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIG1hbmFnZXI6IGdldExpbmsodGhpc0JvdCksCiAgICAgICAgICAgICAgICByZW1vdGVJZDogcHJlc2VuY2VEYXRhLnJlbW90ZUlkLAogICAgICAgICAgICAgICAgcmVtb3RlTmFtZTogcHJlc2VuY2VEYXRhLnJlbW90ZU5hbWUsCiAgICAgICAgICAgICAgICBwb3J0YWw6IHByZXNlbmNlRGF0YS5wb3J0YWwsCiAgICAgICAgICAgICAgICBwb2ludGVyOiBwcmVzZW5jZURhdGEuY3Vyc29yc1tpXS5wb2ludGVyVHlwZSwKICAgICAgICAgICAgICAgIG9uQ3JlYXRlOiBMaXN0ZW5lclN0cmluZygoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmtzLm1hbmFnZXIudGFncy5kZWJ1ZykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgW2FiVXNlckN1cnNvci4ke3RhZ05hbWV9ICgke3RhZ3MucmVtb3RlTmFtZX0pXWApOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgb25BQlVzZXJDdXJzb3JVcGRhdGU6IExpc3RlbmVyU3RyaW5nKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBwcmVzZW5jZURhdGE6IEFCVXNlclByZXNlbmNlRGF0YSA9IHRoYXQucHJlc2VuY2VEYXRhOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnNvckluZGV4OiBudW1iZXIgPSB0aGF0LmN1cnNvckluZGV4OwoKICAgICAgICAgICAgICAgICAgICBpZiAodGFncy5yZW1vdGVJZCAhPT0gcHJlc2VuY2VEYXRhLnJlbW90ZUlkIHx8CiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3MucG9ydGFsICE9PSBwcmVzZW5jZURhdGEucG9ydGFsIHx8CiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3MucG9pbnRlciAhPT0gcHJlc2VuY2VEYXRhLmN1cnNvcnNbY3Vyc29ySW5kZXhdLnBvaW50ZXJUeXBlCiAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgdXBkYXRlIGlzIG5vdCBmb3IgdGhpcyBjdXJzb3IuCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIChsaW5rcy5tYW5hZ2VyLnRhZ3MuZGVidWcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2N1cnNvciAnICsgdGhpc0JvdC5pZC5zdWJzdHJpbmcoMCw1KSArICcgdXBkYXRlJyk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB0aGlzQm90LnVwZGF0ZVBvc2l0aW9uKHsKICAgICAgICAgICAgICAgICAgICAgICAgZGltZW5zaW9uOiBwcmVzZW5jZURhdGEuZGltZW5zaW9uLAogICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogcHJlc2VuY2VEYXRhLmN1cnNvcnNbY3Vyc29ySW5kZXhdLnBvc2l0aW9uLAogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICB0aGlzQm90LnVwZGF0ZUNvbG9yKHsgY29sb3I6IHByZXNlbmNlRGF0YS5jb2xvciB9KTsKICAgICAgICAgICAgICAgICAgICB0aGlzQm90LnVwZGF0ZU5hbWUoeyBuYW1lOiBwcmVzZW5jZURhdGEucmVtb3RlTmFtZSB9KTsKCiAgICAgICAgICAgICAgICAgICAgdGhpc0JvdC5yZXNldFRpbWVvdXQoKTsKCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIG9uR3JpZFBvcnRhbENhbWVyYUNoYW5nZWQ6IExpc3RlbmVyU3RyaW5nKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzQm90LnVwZGF0ZVNjYWxlKCk7CiAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIG9uQm90Q2hhbmdlZDogTGlzdGVuZXJTdHJpbmcoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICh0aGF0LnRhZ3Muc29tZSgodCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5lbmRzV2l0aCgnWCcpIHx8IHQuZW5kc1dpdGgoJ1knKSB8fCB0LmVuZHNXaXRoKCdaJyk7CiAgICAgICAgICAgICAgICAgICAgfSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3Vyc29yIHBvc2l0aW9uIGNoYW5nZWQuCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNCb3QudXBkYXRlU2NhbGUoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIHVwZGF0ZVBvc2l0aW9uOiBMaXN0ZW5lclN0cmluZygoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBkaW1lbnNpb24sIHBvc2l0aW9uIH0gPSB0aGF0OwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmICh0YWdzLmRpbWVuc2lvbiAhPT0gZGltZW5zaW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERpbWVuc2lvbiBoYXMgY2hhbmdlZC4gCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFncy5kaW1lbnNpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgY3Vyc29yIGZyb20gdGhlIHByZXZpb3VzIGRpbWVuc2lvbi4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3NbIHRhZ3MuZGltZW5zaW9uIF0gPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlua3Muc2hhcGVCb3QudGFnc1sgdGFncy5kaW1lbnNpb24gXSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rcy5uYW1lQm90LnRhZ3NbIHRhZ3MuZGltZW5zaW9uIF0gPSBudWxsOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBwb3NpdGlvbiB0YWdzIGZvciBwcmV2aW91cyBkaW1lbnNpb24gYXMgd2VsbC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3NbIHRhZ3MuZGltZW5zaW9uICsgJ1gnIF0gPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnc1sgdGFncy5kaW1lbnNpb24gKyAnWScgXSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdzWyB0YWdzLmRpbWVuc2lvbiArICdaJyBdID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBjdXJzb3IgdG8gdGhlIGN1cnJlbnQgZGltZW5zaW9uLgogICAgICAgICAgICAgICAgICAgICAgICB0YWdzLmRpbWVuc2lvbiA9IGRpbWVuc2lvbjsKCiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3NbIGRpbWVuc2lvbiBdID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgbGlua3Muc2hhcGVCb3QudGFnc1sgZGltZW5zaW9uIF0gPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICBsaW5rcy5uYW1lQm90LnRhZ3NbIGRpbWVuc2lvbiBdID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpbVhUYWcgPSBkaW1lbnNpb24gKyAnWCc7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGltWVRhZyA9IGRpbWVuc2lvbiArICdZJzsKICAgICAgICAgICAgICAgICAgICBjb25zdCBkaW1aVGFnID0gZGltZW5zaW9uICsgJ1onOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZYID0gdGFnc1sgZGltWFRhZyBdOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZZID0gdGFnc1sgZGltWVRhZyBdOwogICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZaID0gdGFnc1sgZGltWlRhZyBdOwoKICAgICAgICAgICAgICAgICAgICBjbGVhckFuaW1hdGlvbnModGhpc0JvdCk7CgogICAgICAgICAgICAgICAgICAgIGlmIChwcmV2WCA9PSBudWxsICYmIHByZXZZID09IG51bGwgJiYgcHJldlogPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCB0aW1lIHNldHRpbmcgdGhlIHBvc2l0aW9uIG9mIHRoaXMgY3Vyc29yIGluIHRoaXMgZGltZW5zaW9uLgogICAgICAgICAgICAgICAgICAgICAgICAvLyBTbmFwIGN1cnNvciB0byB0aGUgcG9zaXRpb24uCiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3NbIGRpbVhUYWcgXSA9IHBvc2l0aW9uLng7CiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3NbIGRpbVlUYWcgXSA9IHBvc2l0aW9uLnk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3NbIGRpbVpUYWcgXSA9IHBvc2l0aW9uLno7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmtzLm1hbmFnZXIudGFncy5pbnRlcnBvbGF0ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3Vyc29yIGlzIGFscmVhZHkgcG9zaXRpb25lZCBpbiBkaW1lbnNpb24sIHNtb290aGx5IGFuaW1hdGUgdG8gdGhlIHVwZGF0ZWQgcG9zaXRpb24uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRlVGFnKHRoaXNCb3QsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmcm9tVmFsdWU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2RpbVhUYWddOiBwcmV2WCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2RpbVlUYWddOiBwcmV2WSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2RpbVpUYWddOiBwcmV2WiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvVmFsdWU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2RpbVhUYWddOiBwb3NpdGlvbi54LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbZGltWVRhZ106IHBvc2l0aW9uLnksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtkaW1aVGFnXTogcG9zaXRpb24ueiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAobGlua3MubWFuYWdlci50YWdzLnRpY2tJbnRlcnZhbE1TICsgNTApIC8gMTAwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBbmltYXRpb24gY2FuY2VsZWQsIGRvIG5vdGhpbmcuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3NbIGRpbVhUYWcgXSA9IHBvc2l0aW9uLng7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWdzWyBkaW1ZVGFnIF0gPSBwb3NpdGlvbi55OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFnc1sgZGltWlRhZyBdID0gcG9zaXRpb24uejsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgdXBkYXRlQ29sb3I6IExpc3RlbmVyU3RyaW5nKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGNvbG9yIH0gPSB0aGF0OwoKICAgICAgICAgICAgICAgICAgICBpZiAobGlua3Muc2hhcGVCb3QudGFncy5jb2xvciAhPT0gY29sb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGlua3Muc2hhcGVCb3QudGFncy5jb2xvciA9IGNvbG9yOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmtzLm5hbWVCb3QudGFncy5jb2xvciAhPT0gY29sb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGlua3MubmFtZUJvdC50YWdzLmNvbG9yID0gY29sb3I7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB1cGRhdGVOYW1lOiBMaXN0ZW5lclN0cmluZygoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSB0aGF0OwoKICAgICAgICAgICAgICAgICAgICBpZiAobGlua3MubmFtZUJvdC50YWdzLmxhYmVsICE9PSBuYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtzLm5hbWVCb3QudGFncy5sYWJlbCA9IG5hbWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB1cGRhdGVTY2FsZTogTGlzdGVuZXJTdHJpbmcoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnN0YW50U2NhbGUgPSBsaW5rcy5tYW5hZ2VyLnRhZ3MuY3Vyc29yQ29uc3RhbnRTY2FsZTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBpblhSID0gbGlua3MubWFuYWdlci50YWdzLmluWFI7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgaWYgKGluWFIgfHwKICAgICAgICAgICAgICAgICAgICAgICAgZ3JpZFBvcnRhbEJvdC50YWdzLnBvcnRhbENhbWVyYVR5cGUgPT09ICdwZXJzcGVjdGl2ZScKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGVyc3BlY3RpdmUgc2NhbGUKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FtZXJhUG9zaXRpb24gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiBncmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUG9zaXRpb25YID8/IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiBncmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUG9zaXRpb25ZID8/IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6OiBncmlkUG9ydGFsQm90LnRhZ3MuY2FtZXJhUG9zaXRpb25aID8/IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBUaGlzIHdpbGwgYnJlYWsgd2hlbiB0aGUgY3Vyc29yIGlzIGluIGEgZGltZW5zaW9uIGJlaW5nIGRpc3BsYXllZCBieSBhIHBvcnRhbCBib3QuCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBmaXggaXMgdG8gY2FsY3VsYXRlIHRoZSB3b3JsZCBwb3NpdGlvbiBvZiB0aGUgYm90LCBidXQgZm9yIG5vdyBpbSBnb2luZyB0byBza2lwLgogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJzb3JQb3NpdGlvbiA9IHsgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiB0YWdzWyB0YWdzLmRpbWVuc2lvbiArICdYJyBdID8/IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiB0YWdzWyB0YWdzLmRpbWVuc2lvbiArICdZJyBdID8/IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB6OiB0YWdzWyB0YWdzLmRpbWVuc2lvbiArICdaJyBdID8/IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkaXN0YW5jZSA9IG1hdGgudmVjdG9yTGVuZ3RoKCBtYXRoLnN1YnRyYWN0VmVjdG9ycyhjYW1lcmFQb3NpdGlvbiwgY3Vyc29yUG9zaXRpb24pICk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGluaXRpYWxEaXN0YW5jZSA9IGxpbmtzLm1hbmFnZXIudGFncy5jdXJzb3JJbml0aWFsRGlzdGFuY2U7CgogICAgICAgICAgICAgICAgICAgICAgICB0YWdzLnNjYWxlID0gKGRpc3RhbmNlIC8gaW5pdGlhbERpc3RhbmNlKSAqIGNvbnN0YW50U2NhbGU7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3J0aG9ncmFwaGljIHNjYWxlCiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3Muc2NhbGUgPSBjb25zdGFudFNjYWxlIC8gZ3JpZFBvcnRhbEJvdC50YWdzLmNhbWVyYVpvb207CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQ6IExpc3RlbmVyU3RyaW5nKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAodGFncy50aW1lb3V0SWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRhZ3MudGltZW91dElkKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGFncy50aW1lb3V0SWQgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgcmVzZXRUaW1lb3V0OiBMaXN0ZW5lclN0cmluZygoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpc0JvdC5jbGVhclRpbWVvdXQoKTsKCiAgICAgICAgICAgICAgICAgICAgdGFncy50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmtzLm1hbmFnZXIudGFncy5kZWJ1ZykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2N1cnNvciAnICsgdGhpc0JvdC5pZC5zdWJzdHJpbmcoMCw1KSArICcgaGFzIHRpbWVkIG91dCcpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBkZXN0cm95KHRoaXNCb3QpOwogICAgICAgICAgICAgICAgICAgIH0sIGxpbmtzLm1hbmFnZXIudGFncy5jdXJzb3JCb3RUaW1lb3V0TVMpOwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICBvbkRlc3Ryb3k6IExpc3RlbmVyU3RyaW5nKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzQm90LmNsZWFyVGltZW91dCgpOwoKICAgICAgICAgICAgICAgICAgICBkZXN0cm95KFsKICAgICAgICAgICAgICAgICAgICAgICAgbGlua3Muc2hhcGVCb3QsCiAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtzLm5hbWVCb3QsCiAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgfSkKCiAgICAgICAgICAgIGNvbnN0IHNoYXBlQm90ID0gY3JlYXRlKHsKICAgICAgICAgICAgICAgIHNwYWNlOiAndGVtcExvY2FsJywKICAgICAgICAgICAgICAgIGFiQm90OiB0cnVlLAogICAgICAgICAgICAgICAgYWJVc2VyQ3Vyc29yOiB0cnVlLAogICAgICAgICAgICAgICAgZm9ybTogJ21lc2gnLAogICAgICAgICAgICAgICAgZm9ybVN1YnR5cGU6ICdnbHRmJywKICAgICAgICAgICAgICAgIGZvcm1BZGRyZXNzOiB0YWdzLmN1cnNvck1vZGVsLAogICAgICAgICAgICAgICAgZm9ybURlcHRoVGVzdDogZmFsc2UsCiAgICAgICAgICAgICAgICBmb3JtRGVwdGhXcml0ZTogZmFsc2UsCiAgICAgICAgICAgICAgICBmb3JtUmVuZGVyT3JkZXI6IDk5OTk5LAogICAgICAgICAgICAgICAgYW5jaG9yUG9pbnQ6IFstMC40NSwgMC41LCAwXSwKICAgICAgICAgICAgICAgIHJvdGF0aW9uWE9mZnNldDogMCwKICAgICAgICAgICAgICAgIHJvdGF0aW9uWU9mZnNldDogMCwKICAgICAgICAgICAgICAgIHJvdGF0aW9uWk9mZnNldDogMCwKICAgICAgICAgICAgICAgIHBvaW50YWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICBkcmFnZ2FibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgc2NhbGU6IDAuNSwKICAgICAgICAgICAgICAgIHRyYW5zZm9ybWVyOiBjdXJzb3JCb3QudGFncy5pZCwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjb25zdCBuYW1lQm90ID0gY3JlYXRlKHsKICAgICAgICAgICAgICAgIHNwYWNlOiAndGVtcExvY2FsJywKICAgICAgICAgICAgICAgIGFiQm90OiB0cnVlLAogICAgICAgICAgICAgICAgYWJVc2VyQ3Vyc29yOiB0cnVlLAogICAgICAgICAgICAgICAgZm9ybTogJ2N1YmUnLAogICAgICAgICAgICAgICAgZm9ybURlcHRoVGVzdDogZmFsc2UsCiAgICAgICAgICAgICAgICBmb3JtRGVwdGhXcml0ZTogZmFsc2UsCiAgICAgICAgICAgICAgICBmb3JtUmVuZGVyT3JkZXI6IDk5OTk5LAogICAgICAgICAgICAgICAgYW5jaG9yUG9pbnQ6IFstMC42MjUsIDEuNSwgMF0sCiAgICAgICAgICAgICAgICBwb2ludGFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgZHJhZ2dhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNjYWxlWDogMywKICAgICAgICAgICAgICAgIHNjYWxlWTogMC41LAogICAgICAgICAgICAgICAgc2NhbGVaOiAwLjEsCiAgICAgICAgICAgICAgICBsYWJlbFBhZGRpbmc6IDAuMSwKICAgICAgICAgICAgICAgIHRyYW5zZm9ybWVyOiBjdXJzb3JCb3QudGFncy5pZCwKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAvLyBHaXZlIGN1cnNvciBib3QgbGlua3MgdG8gYWxsIG9mIHRoZSBjaGlsZCBib3RzIGl0IG5lZWRzIHRvIGNvbW11bmljYXRlIHdpdGguCiAgICAgICAgICAgIGN1cnNvckJvdC5saW5rcy5zaGFwZUJvdCA9IHNoYXBlQm90Lmxpbms7CiAgICAgICAgICAgIGN1cnNvckJvdC5saW5rcy5uYW1lQm90ID0gbmFtZUJvdC5saW5rOwoKICAgICAgICAgICAgLy8gRGlyZWN0bHkgY2FsbCBvbkFCVXNlckN1cnNvclVwZGF0ZSB0aGUgZmlyc3QgdGltZSB3ZSBtYWtlIGEgbmV3IHVzZXIgY2FtZXJhIGJvdC4KICAgICAgICAgICAgYXdhaXQgY3Vyc29yQm90Lm9uQUJVc2VyQ3Vyc29yVXBkYXRlKHsgcHJlc2VuY2VEYXRhLCBjdXJzb3JJbmRleDogaSB9KTsKICAgICAgICB9CiAgICB9Cn0nALXG0SfQAQlvbkVudGVyVlICBAC1xtEnxekBE0BtYXNrcy5pblhSID0gdHJ1ZTsnALXG0SfQAQlvbkVudGVyQVICBAC1xtEn2ekBE0BtYXNrcy5pblhSID0gdHJ1ZTsnALXG0SfQAQhvbkV4aXRBUgIEALXG0Sft6QETQG1hc2tzLmluWFIgPSBudWxsOycAtcbRJ9ABCG9uRXhpdFZSAgQAtcbRJ4HqARNAbWFza3MuaW5YUiA9IG51bGw7JwC1xtEn0AELY3Vyc29yTW9kZWwCBAC1xtEnleoB1RZkYXRhOnRleHQveG1sO2Jhc2U2NCxaMnhVUmdJQUFBQndDQUFBakFRQUFFcFRUMDU3SW1GemMyVjBJanA3SW1kbGJtVnlZWFJ2Y2lJNklrdG9jbTl1YjNNZ1oyeFVSaUJDYkdWdVpHVnlJRWt2VHlCMk15NDBMalV3SWl3aWRtVnljMmx2YmlJNklqSXVNQ0o5TENKbGVIUmxibk5wYjI1elZYTmxaQ0k2V3lKTFNGSmZiV0YwWlhKcFlXeHpYM1Z1YkdsMElsMHNJbk5qWlc1bElqb3dMQ0p6WTJWdVpYTWlPbHQ3SW01aGJXVWlPaUpUWTJWdVpTSXNJbTV2WkdWeklqcGJNRjE5WFN3aWJtOWtaWE1pT2x0N0ltMWxjMmdpT2pBc0ltNWhiV1VpT2lKRGRXSmxJbjFkTENKdFlYUmxjbWxoYkhNaU9sdDdJbVY0ZEdWdWMybHZibk1pT25zaVMwaFNYMjFoZEdWeWFXRnNjMTkxYm14cGRDSTZlMzE5TENKdVlXMWxJam9pVFdGMFpYSnBZV3dpTENKd1luSk5aWFJoYkd4cFkxSnZkV2RvYm1WemN5STZleUp0WlhSaGJHeHBZMFpoWTNSdmNpSTZNQ3dpY205MVoyaHVaWE56Um1GamRHOXlJam93TGpsOWZWMHNJbTFsYzJobGN5STZXM3NpYm1GdFpTSTZJa04xWW1VaUxDSndjbWx0YVhScGRtVnpJanBiZXlKaGRIUnlhV0oxZEdWeklqcDdJbEJQVTBsVVNVOU9Jam93TENKVVJWaERUMDlTUkY4d0lqb3hMQ0pPVDFKTlFVd2lPako5TENKcGJtUnBZMlZ6SWpvekxDSnRZWFJsY21saGJDSTZNSDFkZlYwc0ltRmpZMlZ6YzI5eWN5STZXM3NpWW5WbVptVnlWbWxsZHlJNk1Dd2lZMjl0Y0c5dVpXNTBWSGx3WlNJNk5URXlOaXdpWTI5MWJuUWlPakk0TENKdFlYZ2lPbHN4TGpRNU1qVTJNVE0wTURNek1qQXpNVElzTUM0d056VTFOREkxTXpFNU1EYzFOVGcwTkN3eExqWXdOVGN4TURFME9EZ3hNVE0wTUROZExDSnRhVzRpT2xzeExqSTVNRFExTWpJd01Ea3hPVE00T1RkbExUQTFMQzB3TGpBNE1UTTROekEwTWprNU9USTJOelU0TERjdU1URTFNekEwTkRjd01EWXlNalUyWlMwd05sMHNJblI1Y0dVaU9pSldSVU16SW4wc2V5SmlkV1ptWlhKV2FXVjNJam94TENKamIyMXdiMjVsYm5SVWVYQmxJam8xTVRJMkxDSmpiM1Z1ZENJNk1qZ3NJblI1Y0dVaU9pSldSVU15SW4wc2V5SmlkV1ptWlhKV2FXVjNJam95TENKamIyMXdiMjVsYm5SVWVYQmxJam8xTVRJMkxDSmpiM1Z1ZENJNk1qZ3NJblI1Y0dVaU9pSldSVU16SW4wc2V5SmlkV1ptWlhKV2FXVjNJam96TENKamIyMXdiMjVsYm5SVWVYQmxJam8xTVRJekxDSmpiM1Z1ZENJNk16WXNJblI1Y0dVaU9pSlRRMEZNUVZJaWZWMHNJbUoxWm1abGNsWnBaWGR6SWpwYmV5SmlkV1ptWlhJaU9qQXNJbUo1ZEdWTVpXNW5kR2dpT2pNek5pd2lZbmwwWlU5bVpuTmxkQ0k2TUN3aWRHRnlaMlYwSWpvek5EazJNbjBzZXlKaWRXWm1aWElpT2pBc0ltSjVkR1ZNWlc1bmRHZ2lPakl5TkN3aVlubDBaVTltWm5ObGRDSTZNek0yTENKMFlYSm5aWFFpT2pNME9UWXlmU3g3SW1KMVptWmxjaUk2TUN3aVlubDBaVXhsYm1kMGFDSTZNek0yTENKaWVYUmxUMlptYzJWMElqbzFOakFzSW5SaGNtZGxkQ0k2TXpRNU5qSjlMSHNpWW5WbVptVnlJam93TENKaWVYUmxUR1Z1WjNSb0lqbzNNaXdpWW5sMFpVOW1abk5sZENJNk9EazJMQ0owWVhKblpYUWlPak0wT1RZemZWMHNJbUoxWm1abGNuTWlPbHQ3SW1KNWRHVk1aVzVuZEdnaU9qazJPSDFkZlNESUF3QUFRa2xPQUVBTXZ6OEl0cG85Zk5FaVAwQU12ejhJdHBvOWZORWlQMEFNdno4SXRwbzlmTkVpUDF3aEh6OEF0cG85MjlKT1Axd2hIejhBdHBvOTI5Sk9QMXdoSHo4QXRwbzkyOUpPUDF3aEh6OEF0cG85MjlKT1A0Q0FXRGNMdHBvOUFBRHZOb0NBV0RjTHRwbzlBQUR2Tm9DQVdEY0x0cG85QUFEdk5vQ0FXRGNMdHBvOUFBRHZObmZKYlQ0QXRwbzk2WWZOUDNmSmJUNEF0cG85NllmTlAzZkpiVDRBdHBvOTZZZk5QMEFNdno4NHJxYTlmTkVpUDBBTXZ6ODRycWE5Zk5FaVAwQU12ejg0cnFhOWZORWlQMXdoSHo4NHJxYTkyOUpPUDF3aEh6ODRycWE5MjlKT1Axd2hIejg0cnFhOTI5Sk9QMXdoSHo4NHJxYTkyOUpPUDRDQVdEY3ZycWE5QU1EdU5vQ0FXRGN2cnFhOUFNRHVOb0NBV0RjdnJxYTlBTUR1Tm9DQVdEY3ZycWE5QU1EdU5uZkpiVDVBcnFhOTZZZk5QM2ZKYlQ1QXJxYTk2WWZOUDNmSmJUNUFycWE5NllmTlB3QUFJRDhBQUlBK0FBQWdQd0FBZ0Q0QUFDQS9BQUNBUGdBQXdENEFBSUErQUFEQVBnQUFnRDRBQU1BK0FBQ0FQZ0FBd0Q0QUFJQStBQUFnUHdBQUFBQUFBQ0EvQUFBQUFBQUFJRDhBQUFBQUFBQWdQd0FBQUFBQUFNQStBQUFBQUFBQXdENEFBQUFBQUFEQVBnQUFBQUFBQUNBL0FBQ0FQZ0FBSUQ4QUFJQStBQUFnUHdBQWdENEFBTUErQUFDQVBnQUF3RDRBQUlBK0FBREFQZ0FBZ0Q0QUFNQStBQUNBUGdBQUlEOEFBQUFBQUFBZ1B3QUFBQUFBQUNBL0FBQUFBQUFBSUQ4QUFBQUFBQURBUGdBQUFBQUFBTUErQUFBQUFBQUF3RDRBQUFBQTh5OEtzd0FBZ0QvM3BRODBxRVpHUGdBQUFBQzVKM3Mvd3JYSVBoMWZlelNFZ211Lzh5OEtzd0FBZ0QvM3BRODBFbW5GTS8vL2Z6L2VIQ2t6cUVaR1BnQUFBQUM1SjNzL2FnOW1Qd0FBQUFESWt1QStVbDE5dndBQUFBQnJqaEkrOHk4S3N3QUFnRC8zcFE4MEVtbkZNLy8vZnovZUhDa3p3clhJUGgxZmV6U0VnbXUvVWwxOXZ3QUFBQUJyamhJK0VtbkZNLy8vZnovZUhDa3phZzltUHdBQUFBRElrdUErRUdsRnNnQUFnTDhldnBxenFFWkdQZ0FBQUFDNUozcy93clhJUGgxZmV6U0VnbXUvcU8wZHMvLy9mNzlpV2FlekVHbEZzZ0FBZ0w4ZXZwcXpxRVpHUGdBQUFBQzVKM3MvYWc5bVB3QUFBQURJa3VBK1VsMTl2d0FBQUFCcmpoSStxTzBkcy8vL2Y3OWlXYWV6RUdsRnNnQUFnTDhldnBxendyWElQaDFmZXpTRWdtdS9VbDE5dndBQUFBQnJqaEkrcU8wZHMvLy9mNzlpV2FlemFnOW1Qd0FBQUFESWt1QStCQUFKQUF3QUNBQURBQUFBRVFBYUFCWUFGd0FPQUJJQUFnQVFBQmdBQWdBWUFBb0FCd0FWQUJrQUJ3QVpBQXNBRFFBYkFCUUFEUUFVQUFZQUJRQVRBQThBQlFBUEFBRUEnALXG0SfQARNjdXJzb3JDb25zdGFudFNjYWxlAgQAtcbRJ+uAAgE4JwC1xtEn0AEVY3Vyc29ySW5pdGlhbERpc3RhbmNlAgQAtcbRJ+2AAgMyMjUnALXG0SfQARBvbkFueUJvdHNDaGFuZ2VkAgQAtcbRJ/GAAuYIQGNvbnN0IGdyaWRQb3J0YWxCb3RJbmRleCA9IHRoYXQuZmluZEluZGV4KChlbCkgPT4gewogICAgaWYgKGVsICYmIGdsb2JhbFRoaXMuZ3JpZFBvcnRhbEJvdCAmJiBlbC5ib3QgPT09IGdyaWRQb3J0YWxCb3QpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KfSk7CgppZiAoZ3JpZFBvcnRhbEJvdEluZGV4ID49IDApIHsKICAgIGNvbnN0IGNoYW5nZWRUYWdzID0gdGhhdFtncmlkUG9ydGFsQm90SW5kZXhdLnRhZ3M7CiAgICBjb25zdCBjYW1lcmFDaGFuZ2VkID0gY2hhbmdlZFRhZ3Muc29tZSgodCkgPT4gewogICAgICAgIHJldHVybiB0ID09PSAnY2FtZXJhUG9zaXRpb25YJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUG9zaXRpb25ZJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUG9zaXRpb25aJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUG9zaXRpb25PZmZzZXRYJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUG9zaXRpb25PZmZzZXRZJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUG9zaXRpb25PZmZzZXR6JyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUm90YXRpb25YJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUm90YXRpb25ZJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUm90YXRpb25aJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUm90YXRpb25PZmZzZXRYJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUm90YXRpb25PZmZzZXRZJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUm90YXRpb25PZmZzZXRaJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhUm90YXRpb25PZmZzZXRXJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhRm9jdXNYJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhRm9jdXNZJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhRm9jdXNaJyB8fAogICAgICAgICAgICB0ID09PSAnY2FtZXJhWm9vbScgfHwKICAgICAgICAgICAgdCA9PT0gJ2NhbWVyYVpvb21PZmZzZXQnOwogICAgfSkKCiAgICBpZiAoY2FtZXJhQ2hhbmdlZCkgewogICAgICAgIHNob3V0KCdvbkdyaWRQb3J0YWxDYW1lcmFDaGFuZ2VkJywgeyBjaGFuZ2VkVGFncyB9KTsKICAgIH0KfScAtcbRJ9ABFmZsb2F0aW5nQ3Vyc29yRGlzdGFuY2UCBAC1xtEn2IkCAzAuNycAtcbRJ9ABCWFiVmVyc2lvbgIEALXG0SfciQIFMTAuMzUA"}]}