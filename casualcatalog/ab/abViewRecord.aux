{"version":2,"updates":[{"id":0,"timestamp":1755201684491,"update":"AR+4hqIWACcBBGJvdHMkOTJmZjZkMjgtMzM1MS00Y2ZiLTg0NjQtOWQ3YzYxNDI3YTI2AScAuIaiFgAHY3JlYXRvcgIEALiGohYBJGY4NjAyODc4LWMyZWYtNDhiZC04NWEwLThkNjM1MWViNDEyMCcAuIaiFgAGc3lzdGVtAgQAuIaiFiYWYWIudmlld3JlY29yZC5kYXRhX2FwcCcAuIaiFgAJb25LZXlEb3duAgQAuIaiFj2IAkBpZiAodGFncy5hY3RpdmUgJiYgdGhhdC5rZXlzLmluY2x1ZGVzKCdFc2NhcGUnKSkgewogICAgaWYgKHRoaXNCb3QudmFycy5vbkVzY2FwZUtleVByZXNzKSB7CiAgICAgICAgZm9yIChsZXQgY2FsbGJhY2sgb2YgdGhpc0JvdC52YXJzLm9uRXNjYXBlS2V5UHJlc3MpIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfScAuIaiFgAHdW5tb3VudAIEALiGohbGAo4BQGF3YWl0IG9zLmNvbXBpbGVBcHAodGFncy5hcHBJZCwgPD48Lz4pOwphd2FpdCBvcy51bnJlZ2lzdGVyQXBwKHRhZ3MuYXBwSWQpOwoKdGhpc0JvdC52YXJzLm9uRXNjYXBlS2V5UHJlc3MgPSB1bmRlZmluZWQ7Cm1hc2tzLmFjdGl2ZSA9IGZhbHNlOycAuIaiFgAJb25EZXN0cm95AgQAuIaiFtUDE0B0aGlzQm90LnVubW91bnQoKTsnALiGohYABW1vdW50AgQAuIaiFukD5AJAY29uc3QgewogICAgcmVjb3JkTmFtZQp9ID0gdGhhdCA/PyB7fTsKCmlmICghbGlua3MuY29tcG9uZW50KSB7CiAgICBhd2FpdCBsaW5rcy5sZWFybi5hYkFkYXB0KCdhYlNoZWxsJyk7Cn0KCmlmIChtYXNrcy5hY3RpdmUpIHsKICAgIGF3YWl0IHRoaXNCb3QudW5tb3VudCgpOwp9Cgpjb25zdCBBcHAgPSB0aGlzQm90LkFwcCgpOwoKYXdhaXQgb3MucmVnaXN0ZXJBcHAodGFncy5hcHBJZCwgdGhpc0JvdCk7CmF3YWl0IG9zLmNvbXBpbGVBcHAodGFncy5hcHBJZCwgPEFwcCByZWNvcmROYW1lPXtyZWNvcmROYW1lfSAvPik7Cgp0aGlzQm90LnZhcnMub25Fc2NhcGVLZXlQcmVzcyA9IFtdOwptYXNrcy5hY3RpdmUgPSB0cnVlOycAuIaiFgAKY29tcG9uZW50cwIEALiGohbOBijwn5SXMTFjOTVjN2QtYTE5My00MDBlLWI3MTAtM2JhMDQ4NmE2YTFhJwC4hqIWAAV1dGlscwIEALiGohb1Bijwn5SXOTNkOTY1ZTAtZDIwZS00YjQ1LThjYTAtNjQ5MjczYjcxMzhjJwC4hqIWAAhhYklnbm9yZQIEALiGohacBwR0cnVlJwC4hqIWAAlhYlZlcnNpb24CBAC4hqIWoQcEMTAuNScAuIaiFgAJc3R5bGUuY3NzAgQAuIaiFqYH0BIucmVjb3JkLW5hbWUgeyBmb250LXN0eWxlOiBpdGFsaWM7IG9wYWNpdHk6IDAuODsgfQoKLmxheW91dCB7CiAgZGlzcGxheTogZ3JpZDsKICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDI4MHB4IDFmcjsKICBnYXA6IDFyZW07CiAgbWluLWhlaWdodDogMzYwcHg7CiAgYWxpZ24taXRlbXM6IHN0YXJ0Owp9CgovKiBTaWRlYmFyICovCi5zaWRlYmFyIHsKICBib3JkZXI6IDFweCBzb2xpZCByZ2JhKDAsMCwwLC4wOCk7CiAgYm9yZGVyLXJhZGl1czogLjc1cmVtOwogIG92ZXJmbG93OiBoaWRkZW47CiAgZGlzcGxheTogZmxleDsKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwp9Cgouc2lkZWJhci1oZWFkZXIgewogIHBvc2l0aW9uOiBzdGlja3k7CiAgdG9wOiAwOwogIGJhY2tncm91bmQ6IGluaGVyaXQ7CiAgcGFkZGluZzogLjVyZW07CiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHJnYmEoMCwwLDAsLjA2KTsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIGF1dG87CiAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiBhdXRvIGF1dG87CiAgZ2FwOiAuNXJlbSAuNzVyZW07CiAgei1pbmRleDogMTsKfQoKLnNpZGViYXItdG9vbGJhciB7CiAgZ3JpZC1jb2x1bW46IDEgLyAtMTsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogIGdhcDogLjc1cmVtOwp9Cgouc2lkZWJhci1zZWFyY2ggeyB3aWR0aDogMTAwJTsgfQoKLnNpZGViYXItbGlzdCB7CiAgb3ZlcmZsb3c6IGF1dG87CiAgcGFkZGluZzogLjI1cmVtOwogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICBnYXA6IC4yNXJlbTsKfQoKLnJvdyB7CiAgcGFkZGluZzogLjVyZW0gLjZyZW07CiAgYm9yZGVyLXJhZGl1czogLjVyZW07CiAgY3Vyc29yOiBwb2ludGVyOwogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICBnYXA6IC4yNXJlbTsKfQoucm93OmhvdmVyIHsgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwuMDQpOyB9Ci5yb3cuYWN0aXZlIHsgYmFja2dyb3VuZDogcmdiYSgwLDAsMCwuMDgpOyB9CgouYWRkciB7CiAgZm9udC1mYW1pbHk6IHVpLW1vbm9zcGFjZSwgU0ZNb25vLVJlZ3VsYXIsIE1lbmxvLCBNb25hY28sIENvbnNvbGFzLCAiTGliZXJhdGlvbiBNb25vIiwgIkNvdXJpZXIgTmV3IiwgbW9ub3NwYWNlOwogIGZvbnQtc2l6ZTogLjg1ZW07CiAgd29yZC1icmVhazogYnJlYWstYWxsOwp9CgouYmFkZ2VzIHsgZGlzcGxheTogZmxleDsgZ2FwOiAuMjVyZW07IGZsZXgtd3JhcDogd3JhcDsgfQouYmFkZ2UgeyBmb250LXNpemU6IC43MmVtOyBwYWRkaW5nOiAuMXJlbSAuNHJlbTsgYm9yZGVyLXJhZGl1czogOTk5cHg7IGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMCwwLDAsLjEyKTsgfQoKLyogUmlnaHQgcGFuZWwgKHN0aWNreSkgKi8KLmRldGFpbCB7CiAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgwLDAsMCwuMDgpOwogIGJvcmRlci1yYWRpdXM6IC43NXJlbTsKICBvdmVyZmxvdzogaGlkZGVuOwogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKCiAgcG9zaXRpb246IHN0aWNreTsKICB0b3A6IDA7CiAgYWxpZ24tc2VsZjogc3RhcnQ7CiAgbWF4LWhlaWdodDogY2FsYygxMDB2aCAtIDE0MHB4KTsKfQoKLmRldGFpbC1oZWFkZXIgewogIHBhZGRpbmc6IC42cmVtIC43NXJlbTsKICBib3JkZXItYm90dG9tOiAxcHggc29saWQgcmdiYSgwLDAsMCwuMDYpOwogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgZ2FwOiAuNXJlbTsKfQoKLmRldGFpbC1ib2R5IHsKICBwYWRkaW5nOiAuNzVyZW07CiAgb3ZlcmZsb3c6IGF1dG87Cn0KCnByZS5kYXRhIHsKICBtYXJnaW46IDA7CiAgbWF4LWhlaWdodDogNTV2aDsKICBvdmVyZmxvdzogYXV0bzsKICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLC4wMyk7CiAgcGFkZGluZzogLjc1cmVtOwogIGJvcmRlci1yYWRpdXM6IC41cmVtOwp9CgovKiBIZWxwZXJzICovCi5tdXRlZCB7IG9wYWNpdHk6IC43OyB9Ci5kYW5nZXIgeyBjb2xvcjogI2IwMDAyMDsgfQoKLmNhbGxvdXQgewogIGJhY2tncm91bmQ6IHJnYmEoMjU1LDIwMCwwLC4wOCk7CiAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsMjAwLDAsLjQpOwogIGJvcmRlci1yYWRpdXM6IC41cmVtOwogIHBhZGRpbmc6IC43NXJlbTsKfQoKLyogUmVzcG9uc2l2ZSAqLwpAbWVkaWEgKG1heC13aWR0aDogODIwcHgpIHsKICAubGF5b3V0IHsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnI7IH0KICAuZGV0YWlsIHsgbWF4LWhlaWdodDogY2FsYygxMDB2aCAtIDE4MHB4KTsgfQp9CicAuIaiFgADQXBwAgQAuIaiFvcZ8n1AY29uc3QgQXBwQ29udGFpbmVyID0gbGlua3MuY29tcG9uZW50cy5BcHBDb250YWluZXIoKTsKY29uc3QgV2luZG93ID0gbGlua3MuY29tcG9uZW50cy5XaW5kb3coKTsKY29uc3QgVGV4dExpbmsgPSBsaW5rcy5jb21wb25lbnRzLlRleHRMaW5rKCk7CmNvbnN0IGNzcyA9IGxpbmtzLnV0aWxzLmFiQ29tcGlsZUNTUyhbIHRoaXNCb3QsIGxpbmtzLmNvbXBvbmVudHMgXSk7Cgpjb25zdCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrLCB1c2VNZW1vIH0gPSBvcy5hcHBIb29rczsKCmZ1bmN0aW9uIGlzQXV0aEVycm9yTWVzc2FnZShtc2cpIHsKICAgIHJldHVybiAvbm90W19ccy1dP2F1dGhvcml6ZWR8bWlzc2luZ1tfXHMtXT9wZXJtaXNzaW9ufHBlcm1pc3Npb25bX1xzLV0/ZGVuaWVkL2kudGVzdChtc2cgfHwgJycpOwp9CgpmdW5jdGlvbiB1c2VSZWNvcmRCcm93c2VyKHJlY29yZE5hbWUpIHsKICAgIGNvbnN0IFtpdGVtcywgc2V0SXRlbXNdID0gdXNlU3RhdGUoW10pOwogICAgY29uc3QgW3RvdGFsQ291bnQsIHNldFRvdGFsQ291bnRdID0gdXNlU3RhdGUobnVsbCk7CiAgICBjb25zdCBbbGFzdEFkZHJlc3MsIHNldExhc3RBZGRyZXNzXSA9IHVzZVN0YXRlKG51bGwpOwogICAgY29uc3QgW2hhc01vcmUsIHNldEhhc01vcmVdID0gdXNlU3RhdGUodHJ1ZSk7CgogICAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpOwogICAgY29uc3QgW2xvYWRpbmdBbGwsIHNldExvYWRpbmdBbGxdID0gdXNlU3RhdGUoZmFsc2UpOwogICAgY29uc3QgW2dyYW50aW5nLCBzZXRHcmFudGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7CiAgICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlKG51bGwpOwogICAgY29uc3QgW3Blcm1OZWVkZWQsIHNldFBlcm1OZWVkZWRdID0gdXNlU3RhdGUoZmFsc2UpOwoKICAgIGNvbnN0IFtzZWxlY3RlZEluZGV4LCBzZXRTZWxlY3RlZEluZGV4XSA9IHVzZVN0YXRlKDApOwogICAgY29uc3QgW3F1ZXJ5LCBzZXRRdWVyeV0gPSB1c2VTdGF0ZSgnJyk7CiAgICBjb25zdCBbbWFya2VyRmlsdGVyLCBzZXRNYXJrZXJGaWx0ZXJdID0gdXNlU3RhdGUoJycpOwoKICAgIHVzZUVmZmVjdCgoKSA9PiB7CiAgICAgICAgc2V0SXRlbXMoW10pOwogICAgICAgIHNldFRvdGFsQ291bnQobnVsbCk7CiAgICAgICAgc2V0TGFzdEFkZHJlc3MobnVsbCk7CiAgICAgICAgc2V0SGFzTW9yZSh0cnVlKTsKICAgICAgICBzZXRMb2FkaW5nKGZhbHNlKTsKICAgICAgICBzZXRMb2FkaW5nQWxsKGZhbHNlKTsKICAgICAgICBzZXRHcmFudGluZyhmYWxzZSk7CiAgICAgICAgc2V0RXJyb3IobnVsbCk7CiAgICAgICAgc2V0UGVybU5lZWRlZChmYWxzZSk7CiAgICAgICAgc2V0U2VsZWN0ZWRJbmRleCgwKTsKICAgICAgICBzZXRRdWVyeSgnJyk7CiAgICAgICAgc2V0TWFya2VyRmlsdGVyKCcnKTsKICAgIH0sIFtyZWNvcmROYW1lXSk7CgogICAgY29uc3QgYXBwbHlQYWdlUmVzdWx0ID0gdXNlQ2FsbGJhY2soKHJlc3VsdCwgcHJldkxlbikgPT4gewogICAgICAgIGNvbnN0IG5ld0l0ZW1zID0gcmVzdWx0Lml0ZW1zIHx8IFtdOwogICAgICAgIHNldEl0ZW1zKHByZXYgPT4gcHJldi5jb25jYXQobmV3SXRlbXMpKTsKICAgICAgICBzZXRUb3RhbENvdW50KHJlc3VsdC50b3RhbENvdW50ID8/IG51bGwpOwogICAgICAgIGlmIChuZXdJdGVtcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGNvbnN0IG5leHRMYXN0ID0gbmV3SXRlbXNbbmV3SXRlbXMubGVuZ3RoIC0gMV0uYWRkcmVzczsKICAgICAgICAgICAgc2V0TGFzdEFkZHJlc3MobmV4dExhc3QpOwogICAgICAgICAgICBpZiAocmVzdWx0LnRvdGFsQ291bnQgIT0gbnVsbCAmJiAocHJldkxlbiArIG5ld0l0ZW1zLmxlbmd0aCkgPj0gcmVzdWx0LnRvdGFsQ291bnQpIHsKICAgICAgICAgICAgICAgIHNldEhhc01vcmUoZmFsc2UpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2V0SGFzTW9yZShmYWxzZSk7CiAgICAgICAgfQogICAgICAgIHNldFBlcm1OZWVkZWQoZmFsc2UpOwogICAgfSwgW10pOwoKICAgIGNvbnN0IGxvYWRQYWdlID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4gewogICAgICAgIGlmICghcmVjb3JkTmFtZSB8fCBsb2FkaW5nIHx8ICFoYXNNb3JlKSByZXR1cm47CiAgICAgICAgc2V0TG9hZGluZyh0cnVlKTsKICAgICAgICBzZXRFcnJvcihudWxsKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBvcy5saXN0RGF0YShyZWNvcmROYW1lLCBsYXN0QWRkcmVzcyB8fCBudWxsKTsKICAgICAgICAgICAgaWYgKHJlc3VsdD8uc3VjY2VzcykgewogICAgICAgICAgICAgICAgYXBwbHlQYWdlUmVzdWx0KHJlc3VsdCwgaXRlbXMubGVuZ3RoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1zZyA9IHJlc3VsdD8uZXJyb3JNZXNzYWdlIHx8ICdGYWlsZWQgdG8gbGlzdCBkYXRhLic7CiAgICAgICAgICAgICAgICBzZXRFcnJvcihtc2cpOwogICAgICAgICAgICAgICAgaWYgKGlzQXV0aEVycm9yTWVzc2FnZShtc2cpKSBzZXRQZXJtTmVlZGVkKHRydWUpOwogICAgICAgICAgICAgICAgc2V0SGFzTW9yZShmYWxzZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgY29uc3QgbXNnID0gZXJyPy5tZXNzYWdlID8/IFN0cmluZyhlcnIpOwogICAgICAgICAgICBzZXRFcnJvcihtc2cpOwogICAgICAgICAgICBpZiAoaXNBdXRoRXJyb3JNZXNzYWdlKG1zZykpIHNldFBlcm1OZWVkZWQodHJ1ZSk7CiAgICAgICAgICAgIHNldEhhc01vcmUoZmFsc2UpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHNldExvYWRpbmcoZmFsc2UpOwogICAgICAgIH0KICAgIH0sIFtyZWNvcmROYW1lLCBsYXN0QWRkcmVzcywgbG9hZGluZywgaGFzTW9yZSwgaXRlbXMubGVuZ3RoLCBhcHBseVBhZ2VSZXN1bHRdKTsKCiAgICBjb25zdCBsb2FkQWxsID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4gewogICAgICAgIGlmICghcmVjb3JkTmFtZSB8fCBsb2FkaW5nQWxsKSByZXR1cm47CiAgICAgICAgc2V0TG9hZGluZ0FsbCh0cnVlKTsKICAgICAgICBzZXRFcnJvcihudWxsKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBsZXQgY3Vyc29yID0gbGFzdEFkZHJlc3MgfHwgbnVsbDsKICAgICAgICAgICAgbGV0IGRvbmUgPSBmYWxzZTsKICAgICAgICAgICAgbGV0IGFjY3VtdWxhdGVkID0gW107CiAgICAgICAgICAgIGxldCBwYWdlQ291bnQgPSAwOwogICAgICAgICAgICBjb25zdCBNQVhfUEFHRVMgPSA0MDA7CiAgICAgICAgICAgIHdoaWxlICghZG9uZSAmJiBwYWdlQ291bnQgPCBNQVhfUEFHRVMpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG9zLmxpc3REYXRhKHJlY29yZE5hbWUsIGN1cnNvcik7CiAgICAgICAgICAgICAgICBpZiAoIXJlc3VsdD8uc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IG1zZyA9IHJlc3VsdD8uZXJyb3JNZXNzYWdlIHx8ICdGYWlsZWQgdG8gbGlzdCBkYXRhLic7CiAgICAgICAgICAgICAgICAgICAgc2V0RXJyb3IobXNnKTsKICAgICAgICAgICAgICAgICAgICBpZiAoaXNBdXRoRXJyb3JNZXNzYWdlKG1zZykpIHNldFBlcm1OZWVkZWQodHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgc2V0SGFzTW9yZShmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCBwYWdlSXRlbXMgPSByZXN1bHQuaXRlbXMgfHwgW107CiAgICAgICAgICAgICAgICBpZiAocGFnZUl0ZW1zLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlZCA9IGFjY3VtdWxhdGVkLmNvbmNhdChwYWdlSXRlbXMpOwogICAgICAgICAgICAgICAgICAgIGN1cnNvciA9IHBhZ2VJdGVtc1twYWdlSXRlbXMubGVuZ3RoIC0gMV0uYWRkcmVzczsKICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdUb3RhbCA9IHJlc3VsdC50b3RhbENvdW50ID8/IG51bGw7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1RvdGFsICE9IG51bGwgJiYgKGl0ZW1zLmxlbmd0aCArIGFjY3VtdWxhdGVkLmxlbmd0aCkgPj0gbmV3VG90YWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9uZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcGFnZUNvdW50ICs9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGFjY3VtdWxhdGVkLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIHNldEl0ZW1zKHByZXYgPT4gcHJldi5jb25jYXQoYWNjdW11bGF0ZWQpKTsKICAgICAgICAgICAgICAgIHNldExhc3RBZGRyZXNzKGFjY3VtdWxhdGVkW2FjY3VtdWxhdGVkLmxlbmd0aCAtIDFdLmFkZHJlc3MpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwYWdlQ291bnQgPj0gTUFYX1BBR0VTKSB7CiAgICAgICAgICAgICAgICBzZXRIYXNNb3JlKHRydWUpOwogICAgICAgICAgICAgICAgb3MudG9hc3QgJiYgb3MudG9hc3QoJ1N0b3BwZWQgZWFybHkgKHRvbyBtYW55IHBhZ2VzKS4gUmVmaW5lIHlvdXIgZmlsdGVyIG9yIGNvbnRpbnVlIG1hbnVhbGx5LicpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2V0SGFzTW9yZShmYWxzZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2V0UGVybU5lZWRlZChmYWxzZSk7CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIGNvbnN0IG1zZyA9IGVycj8ubWVzc2FnZSA/PyBTdHJpbmcoZXJyKTsKICAgICAgICAgICAgc2V0RXJyb3IobXNnKTsKICAgICAgICAgICAgaWYgKGlzQXV0aEVycm9yTWVzc2FnZShtc2cpKSBzZXRQZXJtTmVlZGVkKHRydWUpOwogICAgICAgICAgICBzZXRIYXNNb3JlKGZhbHNlKTsKICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBzZXRMb2FkaW5nQWxsKGZhbHNlKTsKICAgICAgICB9CiAgICB9LCBbcmVjb3JkTmFtZSwgbGFzdEFkZHJlc3MsIGl0ZW1zLmxlbmd0aCwgbG9hZGluZ0FsbF0pOwoKICAgIGNvbnN0IGdyYW50QWRtaW4gPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7CiAgICAgICAgaWYgKCFyZWNvcmROYW1lKSB7CiAgICAgICAgICAgIHNldEVycm9yKCdSZWNvcmQgbmFtZSBpcyByZXF1aXJlZCB0byBncmFudCBwZXJtaXNzaW9uLicpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNldEdyYW50aW5nKHRydWUpOwogICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBvcy5ncmFudEluc3RBZG1pblBlcm1pc3Npb24ocmVjb3JkTmFtZSk7CiAgICAgICAgICAgIGlmIChyZXM/LnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIHNldFBlcm1OZWVkZWQoZmFsc2UpOwogICAgICAgICAgICAgICAgc2V0SXRlbXMoW10pOwogICAgICAgICAgICAgICAgc2V0VG90YWxDb3VudChudWxsKTsKICAgICAgICAgICAgICAgIHNldExhc3RBZGRyZXNzKG51bGwpOwogICAgICAgICAgICAgICAgc2V0SGFzTW9yZSh0cnVlKTsKICAgICAgICAgICAgICAgIHNldEVycm9yKG51bGwpOwogICAgICAgICAgICAgICAgYXdhaXQgbG9hZFBhZ2UoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHNldEVycm9yKHJlcz8uZXJyb3JNZXNzYWdlIHx8ICdGYWlsZWQgdG8gZ3JhbnQgYWRtaW4gcGVybWlzc2lvbi4nKTsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgc2V0RXJyb3IoZT8ubWVzc2FnZSA/PyBTdHJpbmcoZSkpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIHNldEdyYW50aW5nKGZhbHNlKTsKICAgICAgICB9CiAgICB9LCBbcmVjb3JkTmFtZSwgbG9hZFBhZ2VdKTsKCiAgICBjb25zdCBhbGxNYXJrZXJzID0gdXNlTWVtbygoKSA9PiB7CiAgICAgICAgY29uc3QgcyA9IG5ldyBTZXQoKTsKICAgICAgICBmb3IgKGNvbnN0IGl0IG9mIGl0ZW1zKSB7CiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGl0Lm1hcmtlcnMpKSBmb3IgKGNvbnN0IG0gb2YgaXQubWFya2Vycykgcy5hZGQobSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBBcnJheS5mcm9tKHMpLnNvcnQoKTsKICAgIH0sIFtpdGVtc10pOwoKICAgIGNvbnN0IGZpbHRlcmVkID0gdXNlTWVtbygoKSA9PiB7CiAgICAgICAgY29uc3QgcSA9IChxdWVyeSB8fCAnJykudG9Mb3dlckNhc2UoKS50cmltKCk7CiAgICAgICAgY29uc3QgYnlNYXJrZXIgPSBtYXJrZXJGaWx0ZXIgPyAoaXQpID0+IEFycmF5LmlzQXJyYXkoaXQubWFya2VycykgJiYgaXQubWFya2Vycy5pbmNsdWRlcyhtYXJrZXJGaWx0ZXIpIDogKCkgPT4gdHJ1ZTsKICAgICAgICBpZiAoIXEpIHJldHVybiBpdGVtcy5maWx0ZXIoYnlNYXJrZXIpOwogICAgICAgIHJldHVybiBpdGVtcy5maWx0ZXIoaXQgPT4gewogICAgICAgICAgICBpZiAoIWJ5TWFya2VyKGl0KSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICBjb25zdCBhZGRyID0gU3RyaW5nKGl0LmFkZHJlc3MgfHwgJycpLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgICAgIGlmIChhZGRyLmluY2x1ZGVzKHEpKSByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShpdC5kYXRhKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHEpOwogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwgW2l0ZW1zLCBxdWVyeSwgbWFya2VyRmlsdGVyXSk7CgogICAgdXNlRWZmZWN0KCgpID0+IHsKICAgICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoID09PSAwKSBzZXRTZWxlY3RlZEluZGV4KDApOwogICAgICAgIGVsc2UgaWYgKHNlbGVjdGVkSW5kZXggPj0gZmlsdGVyZWQubGVuZ3RoKSBzZXRTZWxlY3RlZEluZGV4KGZpbHRlcmVkLmxlbmd0aCAtIDEpOwogICAgfSwgW2ZpbHRlcmVkLmxlbmd0aCwgc2VsZWN0ZWRJbmRleF0pOwoKICAgIGNvbnN0IHNlbGVjdGVkID0gZmlsdGVyZWRbc2VsZWN0ZWRJbmRleF0gfHwgbnVsbDsKCiAgICBjb25zdCBjb3B5ID0gdXNlQ2FsbGJhY2soYXN5bmMgKHRleHQpID0+IHsKICAgICAgICB0cnkgewogICAgICAgICAgICBhd2FpdCBvcy5zZXRDbGlwYm9hcmQoU3RyaW5nKHRleHQpKTsKICAgICAgICAgICAgb3MudG9hc3QgJiYgb3MudG9hc3QoJ0NvcGllZCB0byBjbGlwYm9hcmQnKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIG9zLnRvYXN0ICYmIG9zLnRvYXN0KCdDb3B5IGZhaWxlZCcpOwogICAgICAgIH0KICAgIH0sIFtdKTsKCiAgICAvLyBORVc6IGVyYXNlIGEgc2luZ2xlIGFkZHJlc3MgKHdpdGggY29uZmlybWF0aW9uKQogICAgY29uc3QgZXJhc2VBZGRyZXNzID0gdXNlQ2FsbGJhY2soYXN5bmMgKGFkZHJlc3MpID0+IHsKICAgICAgICBpZiAoIXJlY29yZE5hbWUgfHwgIWFkZHJlc3MpIHJldHVybjsKICAgICAgICBjb25zdCBjb25maXJtZWQgPSBhd2FpdCBvcy5zaG93Q29uZmlybSh7CiAgICAgICAgICAgIHRpdGxlOiAnRXJhc2UgZGF0YT8nLAogICAgICAgICAgICBjb250ZW50OiBgVGhpcyB3aWxsIHBlcm1hbmVudGx5IGVyYXNlOlxuJHthZGRyZXNzfWAsCiAgICAgICAgICAgIGNvbmZpcm1UZXh0OiAnRXJhc2UnLAogICAgICAgICAgICBjYW5jZWxUZXh0OiAnQ2FuY2VsJwogICAgICAgIH0pOwogICAgICAgIGlmICghY29uZmlybWVkKSByZXR1cm47CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IG9zLmVyYXNlRGF0YShyZWNvcmROYW1lLCBhZGRyZXNzKTsKICAgICAgICAgICAgaWYgKHJlcz8uc3VjY2VzcykgewogICAgICAgICAgICAgICAgc2V0SXRlbXMocHJldiA9PiBwcmV2LmZpbHRlcihpdCA9PiBpdC5hZGRyZXNzICE9PSBhZGRyZXNzKSk7CiAgICAgICAgICAgICAgICBzZXRUb3RhbENvdW50KHRjID0+ICh0YyAhPSBudWxsID8gTWF0aC5tYXgoMCwgdGMgLSAxKSA6IHRjKSk7CiAgICAgICAgICAgICAgICBvcy50b2FzdCAmJiBvcy50b2FzdCgnRGF0YSBlcmFzZWQuJyk7CiAgICAgICAgICAgICAgICBzZXRQZXJtTmVlZGVkKGZhbHNlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1zZyA9IHJlcz8uZXJyb3JNZXNzYWdlIHx8ICdGYWlsZWQgdG8gZXJhc2UgZGF0YS4nOwogICAgICAgICAgICAgICAgc2V0RXJyb3IobXNnKTsKICAgICAgICAgICAgICAgIGlmIChpc0F1dGhFcnJvck1lc3NhZ2UobXNnKSkgc2V0UGVybU5lZWRlZCh0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc3QgbXNnID0gZT8ubWVzc2FnZSA/PyBTdHJpbmcoZSk7CiAgICAgICAgICAgIHNldEVycm9yKG1zZyk7CiAgICAgICAgICAgIGlmIChpc0F1dGhFcnJvck1lc3NhZ2UobXNnKSkgc2V0UGVybU5lZWRlZCh0cnVlKTsKICAgICAgICB9CiAgICB9LCBbcmVjb3JkTmFtZV0pOwoKICAgIHJldHVybiB7CiAgICAgICAgaXRlbXMsIHRvdGFsQ291bnQsIGhhc01vcmUsIGxhc3RBZGRyZXNzLAogICAgICAgIGxvYWRpbmcsIGxvYWRpbmdBbGwsIGdyYW50aW5nLCBlcnJvciwgcGVybU5lZWRlZCwKICAgICAgICBzZWxlY3RlZCwgc2VsZWN0ZWRJbmRleCwKICAgICAgICBmaWx0ZXJlZCwgYWxsTWFya2VycywgcXVlcnksIG1hcmtlckZpbHRlciwKICAgICAgICBzZXRTZWxlY3RlZEluZGV4LCBzZXRRdWVyeSwgc2V0TWFya2VyRmlsdGVyLAogICAgICAgIGxvYWRQYWdlLCBsb2FkQWxsLCBncmFudEFkbWluLCBjb3B5LAogICAgICAgIGVyYXNlQWRkcmVzcywgLy8gPOKAlCBleHBvc2UKICAgIH07Cn0KCmZ1bmN0aW9uIFNpZGViYXJIZWFkZXIocHJvcHMpIHsKICAgIGNvbnN0IHsKICAgICAgICBpdGVtc0NvdW50LCB0b3RhbENvdW50LCBoYXNNb3JlLAogICAgICAgIG9uTG9hZE1vcmUsIG9uTG9hZEFsbCwgbG9hZGluZywgbG9hZGluZ0FsbCwKICAgICAgICBxdWVyeSwgc2V0UXVlcnksIG1hcmtlckZpbHRlciwgc2V0TWFya2VyRmlsdGVyLCBhbGxNYXJrZXJzCiAgICB9ID0gcHJvcHM7CgogICAgcmV0dXJuICgKICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ic2lkZWJhci1oZWFkZXIiPgogICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ic2lkZWJhci10b29sYmFyIj4KICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT0iY291bnQiPgogICAgICAgICAgICAgICAgICAgIHt0b3RhbENvdW50ICE9IG51bGwgPyBgJHtpdGVtc0NvdW50fSAvICR7dG90YWxDb3VudH0gaXRlbXNgIDogYCR7aXRlbXNDb3VudH0gaXRlbXNgfQogICAgICAgICAgICAgICAgPC9zcGFuPgogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17eyBkaXNwbGF5OiAnZmxleCcsIGdhcDogJy43NXJlbScgfX0+CiAgICAgICAgICAgICAgICAgICAge2hhc01vcmUgJiYgPFRleHRMaW5rIG9uQ2xpY2s9e29uTG9hZE1vcmV9Pntsb2FkaW5nID8gJ0xvYWRpbmfigKYnIDogJ0xvYWQgbW9yZSd9PC9UZXh0TGluaz59CiAgICAgICAgICAgICAgICAgICAge2hhc01vcmUgJiYgPFRleHRMaW5rIG9uQ2xpY2s9e29uTG9hZEFsbH0+e2xvYWRpbmdBbGwgPyAnTG9hZGluZyBhbGzigKYnIDogJ0xvYWQgYWxsJ308L1RleHRMaW5rPn0KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgIDxpbnB1dAogICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJzaWRlYmFyLXNlYXJjaCIKICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPSJGaWx0ZXIgYnkgYWRkcmVzcyBvciBkYXRh4oCmIgogICAgICAgICAgICAgICAgdmFsdWU9e3F1ZXJ5fQogICAgICAgICAgICAgICAgb25DaGFuZ2U9e2UgPT4gc2V0UXVlcnkoZS50YXJnZXQudmFsdWUpfQogICAgICAgICAgICAvPgogICAgICAgICAgICA8c2VsZWN0IHZhbHVlPXttYXJrZXJGaWx0ZXJ9IG9uQ2hhbmdlPXtlID0+IHNldE1hcmtlckZpbHRlcihlLnRhcmdldC52YWx1ZSl9PgogICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iIj5BbGwgbWFya2Vyczwvb3B0aW9uPgogICAgICAgICAgICAgICAge2FsbE1hcmtlcnMubWFwKG0gPT4gPG9wdGlvbiBrZXk9e219IHZhbHVlPXttfT57bX08L29wdGlvbj4pfQogICAgICAgICAgICA8L3NlbGVjdD4KICAgICAgICA8L2Rpdj4KICAgICk7Cn0KCmZ1bmN0aW9uIExpc3RSb3coeyBpdGVtLCBhY3RpdmUsIG9uQ2xpY2sgfSkgewogICAgcmV0dXJuICgKICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YHJvdyAke2FjdGl2ZSA/ICdhY3RpdmUnIDogJyd9YH0gb25DbGljaz17b25DbGlja30+CiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJhZGRyIj57aXRlbS5hZGRyZXNzfTwvZGl2PgogICAgICAgICAgICB7QXJyYXkuaXNBcnJheShpdGVtLm1hcmtlcnMpICYmIGl0ZW0ubWFya2Vycy5sZW5ndGggPiAwICYmICgKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJiYWRnZXMiPgogICAgICAgICAgICAgICAgICAgIHtpdGVtLm1hcmtlcnMubWFwKG0gPT4gPHNwYW4ga2V5PXttfSBjbGFzc05hbWU9ImJhZGdlIj57bX08L3NwYW4+KX0KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICApfQogICAgICAgIDwvZGl2PgogICAgKTsKfQoKLy8gdXBkYXRlZDogYWNjZXB0IG9uRXJhc2UgYW5kIHNob3cgIkVyYXNlIGRhdGEiCmZ1bmN0aW9uIERldGFpbFBhbmVsKHsgc2VsZWN0ZWQsIHBlcm1OZWVkZWQsIGdyYW50aW5nLCByZWNvcmROYW1lLCBncmFudEFkbWluLCBjb3B5LCBvbkVyYXNlIH0pIHsKICAgIHJldHVybiAoCiAgICAgICAgPGRpdiBjbGFzc05hbWU9ImRldGFpbCI+CiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJkZXRhaWwtaGVhZGVyIj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJhZGRyIj57c2VsZWN0ZWQgPyBzZWxlY3RlZC5hZGRyZXNzIDogPHNwYW4gY2xhc3NOYW1lPSJtdXRlZCI+U2VsZWN0IGFuIGl0ZW08L3NwYW4+fTwvZGl2PgogICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17e2Rpc3BsYXk6J2ZsZXgnLCBnYXA6Jy43NXJlbSd9fT4KICAgICAgICAgICAgICAgICAgICB7c2VsZWN0ZWQgJiYgKAogICAgICAgICAgICAgICAgICAgICAgICA8PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRleHRMaW5rIG9uQ2xpY2s9eygpID0+IGNvcHkoc2VsZWN0ZWQuYWRkcmVzcyl9PkNvcHkgYWRkcmVzczwvVGV4dExpbms+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dExpbmsgb25DbGljaz17KCkgPT4gY29weShKU09OLnN0cmluZ2lmeShzZWxlY3RlZC5kYXRhLCBudWxsLCAyKSl9PkNvcHkgSlNPTjwvVGV4dExpbms+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VGV4dExpbmsgb25DbGljaz17KCkgPT4gb25FcmFzZShzZWxlY3RlZC5hZGRyZXNzKX0+RXJhc2UgZGF0YTwvVGV4dExpbms+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvPgogICAgICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJkZXRhaWwtYm9keSI+CiAgICAgICAgICAgICAgICB7c2VsZWN0ZWQgPyAoCiAgICAgICAgICAgICAgICAgICAgPD4KICAgICAgICAgICAgICAgICAgICAgICAge0FycmF5LmlzQXJyYXkoc2VsZWN0ZWQubWFya2VycykgJiYgc2VsZWN0ZWQubWFya2Vycy5sZW5ndGggPiAwICYmICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT0ibXV0ZWQiIHN0eWxlPXt7bWFyZ2luVG9wOjB9fT5tYXJrZXJzOiB7c2VsZWN0ZWQubWFya2Vycy5qb2luKCcsICcpfTwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgKX0KICAgICAgICAgICAgICAgICAgICAgICAgPHByZSBjbGFzc05hbWU9ImRhdGEiPntKU09OLnN0cmluZ2lmeShzZWxlY3RlZC5kYXRhLCBudWxsLCAyKX08L3ByZT4KICAgICAgICAgICAgICAgICAgICA8Lz4KICAgICAgICAgICAgICAgICkgOiAoCiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSJtdXRlZCI+Q2hvb3NlIGFuIGl0ZW0gZnJvbSB0aGUgbGlzdCB0byB2aWV3IGl0cyBkYXRhLjwvcD4KICAgICAgICAgICAgICAgICl9CiAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAge3Blcm1OZWVkZWQgJiYgKAogICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9ImNhbGxvdXQiIHN0eWxlPXt7bWFyZ2luOiAnLjc1cmVtJ319PgogICAgICAgICAgICAgICAgICAgIDxwPjxzdHJvbmc+QWNjZXNzIG5lZWRlZC48L3N0cm9uZz4gR3JhbnQgdGhpcyBpbnN0IGFkbWluIGFjY2VzcyB0byA8Y29kZT57cmVjb3JkTmFtZX08L2NvZGU+IHRvIGxpc3QgZGF0YS48L3A+CiAgICAgICAgICAgICAgICAgICAgPFRleHRMaW5rIG9uQ2xpY2s9e2dyYW50QWRtaW59PntncmFudGluZyA/ICdHcmFudGluZ+KApicgOiAnR3JhbnQgYWRtaW4gdG8gdGhpcyBpbnN0J308L1RleHRMaW5rPgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICl9CiAgICAgICAgPC9kaXY+CiAgICApOwp9Cgpjb25zdCBBcHAgPSAoeyByZWNvcmROYW1lIH0pID0+IHsKICAgIHVzZUVmZmVjdCgoKSA9PiB7CiAgICAgICAgY29uc3Qgb25Fc2NhcGVLZXlQcmVzcyA9ICgpID0+IHRoaXNCb3QudW5tb3VudCgpOwogICAgICAgIHRoaXNCb3QudmFycy5vbkVzY2FwZUtleVByZXNzLnB1c2gob25Fc2NhcGVLZXlQcmVzcyk7CiAgICAgICAgcmV0dXJuICgpID0+IHsKICAgICAgICAgICAgY29uc3QgaSA9IHRoaXNCb3QudmFycy5vbkVzY2FwZUtleVByZXNzLmZpbmRJbmRleChjYiA9PiBjYiA9PT0gb25Fc2NhcGVLZXlQcmVzcyk7CiAgICAgICAgICAgIGlmIChpID49IDApIHRoaXNCb3QudmFycy5vbkVzY2FwZUtleVByZXNzLnNwbGljZShpLCAxKTsKICAgICAgICB9OwogICAgfSwgW10pOwoKICAgIGNvbnN0IG9uQmFja2dyb3VuZENsaWNrID0gdXNlQ2FsbGJhY2soKCkgPT4gdGhpc0JvdC51bm1vdW50KCksIFtdKTsKICAgIGNvbnN0IG9uQ2xvc2UgPSB1c2VDYWxsYmFjaygoKSA9PiB0aGlzQm90LnVubW91bnQoKSwgW10pOwoKICAgIGNvbnN0IHN0YXRlID0gdXNlUmVjb3JkQnJvd3NlcihyZWNvcmROYW1lKTsKCiAgICB1c2VFZmZlY3QoKCkgPT4gewogICAgICAgIGlmIChzdGF0ZS5pdGVtcy5sZW5ndGggPT09IDAgJiYgc3RhdGUuaGFzTW9yZSAmJiAhc3RhdGUubG9hZGluZyAmJiByZWNvcmROYW1lKSB7CiAgICAgICAgICAgIHN0YXRlLmxvYWRQYWdlKCk7CiAgICAgICAgfQogICAgfSwgW3JlY29yZE5hbWUsIHN0YXRlLml0ZW1zLmxlbmd0aCwgc3RhdGUuaGFzTW9yZSwgc3RhdGUubG9hZGluZywgc3RhdGUubG9hZFBhZ2VdKTsKCiAgICByZXR1cm4gKAogICAgICAgIDw+CiAgICAgICAgICAgIDxzdHlsZT57Y3NzfTwvc3R5bGU+CgogICAgICAgICAgICA8QXBwQ29udGFpbmVyIG9uQmFja2dyb3VuZENsaWNrPXtvbkJhY2tncm91bmRDbGlja30+CiAgICAgICAgICAgICAgICA8V2luZG93PgogICAgICAgICAgICAgICAgICAgIDxwPjxUZXh0TGluayBvbkNsaWNrPXtvbkNsb3NlfT57J3ggQ2xvc2UnfTwvVGV4dExpbms+PC9wPgogICAgICAgICAgICAgICAgICAgIDxoMj5WaWV3IFJlY29yZDwvaDI+CiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3NOYW1lPSdyZWNvcmQtbmFtZSc+UmVjb3JkIE5hbWU6IHtyZWNvcmROYW1lIHx8IDxzcGFuIGNsYXNzTmFtZT0ibXV0ZWQiPihub25lKTwvc3Bhbj59PC9wPgoKICAgICAgICAgICAgICAgICAgICB7c3RhdGUuZXJyb3IgJiYgPHAgY2xhc3NOYW1lPSJkYW5nZXIiIHN0eWxlPXt7bWFyZ2luVG9wOicuMjVyZW0nfX0+RXJyb3I6IHtzdGF0ZS5lcnJvcn08L3A+fQoKICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT0ibGF5b3V0IiBzdHlsZT17e21hcmdpblRvcDonLjVyZW0nfX0+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSJzaWRlYmFyIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxTaWRlYmFySGVhZGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNDb3VudD17c3RhdGUuaXRlbXMubGVuZ3RofQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQ291bnQ9e3N0YXRlLnRvdGFsQ291bnR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzTW9yZT17c3RhdGUuaGFzTW9yZX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkaW5nPXtzdGF0ZS5sb2FkaW5nfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRpbmdBbGw9e3N0YXRlLmxvYWRpbmdBbGx9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Mb2FkTW9yZT17c3RhdGUubG9hZFBhZ2V9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Mb2FkQWxsPXtzdGF0ZS5sb2FkQWxsfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5PXtzdGF0ZS5xdWVyeX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRRdWVyeT17c3RhdGUuc2V0UXVlcnl9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyRmlsdGVyPXtzdGF0ZS5tYXJrZXJGaWx0ZXJ9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0TWFya2VyRmlsdGVyPXtzdGF0ZS5zZXRNYXJrZXJGaWx0ZXJ9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsTWFya2Vycz17c3RhdGUuYWxsTWFya2Vyc30KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9InNpZGViYXItbGlzdCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3N0YXRlLmZpbHRlcmVkLm1hcCgoaXQsIGkpID0+ICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPExpc3RSb3cKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleT17aXQuYWRkcmVzc30KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW09e2l0fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlPXtpID09PSBzdGF0ZS5zZWxlY3RlZEluZGV4fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc3RhdGUuc2V0U2VsZWN0ZWRJbmRleChpKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApKX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7c3RhdGUuZmlsdGVyZWQubGVuZ3RoID09PSAwICYmIDxkaXYgY2xhc3NOYW1lPSJyb3cgbXV0ZWQiPk5vIG1hdGNoZXMuPC9kaXY+fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgICAgICAgICAgPERldGFpbFBhbmVsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZD17c3RhdGUuc2VsZWN0ZWR9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJtTmVlZGVkPXtzdGF0ZS5wZXJtTmVlZGVkfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JhbnRpbmc9e3N0YXRlLmdyYW50aW5nfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3JkTmFtZT17cmVjb3JkTmFtZX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyYW50QWRtaW49e3N0YXRlLmdyYW50QWRtaW59CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3B5PXtzdGF0ZS5jb3B5fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25FcmFzZT17c3RhdGUuZXJhc2VBZGRyZXNzfQogICAgICAgICAgICAgICAgICAgICAgICAvPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9XaW5kb3c+CiAgICAgICAgICAgIDwvQXBwQ29udGFpbmVyPgogICAgICAgIDwvPgogICAgKTsKfTsKCnJldHVybiBBcHA7JwC4hqIWAAVhcHBJZAIEALiGohbglwEOYWItdmlldy1yZWNvcmQnALiGohYADGFiVmlld1JlY29yZAIEALiGohbvlwEEdHJ1ZScAuIaiFgAFbGVhcm4CBAC4hqIW9JcBKPCflJc2NjU3Yjg2NS1lOTgzLTQ0MDEtOWZjOS1mNTQxOGQxOGE3ZjcA"}]}