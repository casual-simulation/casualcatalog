{"version":2,"updates":[{"id":0,"timestamp":1771971369647,"update":"AYUBjaeu9AgAJwEEYm90cyQwN2NmZTg5NS0zYWVlLTQwYjYtODFlYS01M2ZkNTBiMzFjZDkBJwCNp670CAAGc3lzdGVtAgQAjaeu9AgBCmFiLmFpLm11dGUnAI2nrvQIABBhYkNvcmVNZW51QWN0aW9uAgQAjaeu9AgMmgRAc2V0VGFnTWFzayh0aGlzQm90LCAibXV0ZWQiLCAhdGFncy5tdXRlZCk7DQoNCmNvbnN0IG1lbnVCb3QgPSBnZXRCb3QoYnlUYWcoImJhc2VTa2lsbCIsICfwn5SXJyArIGdldElEKHRoaXNCb3QpKSwgYnlUYWcoImFiTWVudSIsIHRydWUpKTsNCmlmIChtZW51Qm90KSB7DQogICAgaWYgKHRhZ3MubXV0ZWQpIHsNCiAgICAgICAgbWVudUJvdC50YWdzLmxhYmVsID0gInVubXV0ZSI7DQogICAgICAgIG1lbnVCb3QudGFncy5mb3JtQWRkcmVzcyA9ICdtaWNfb2ZmJzsNCiAgICB9IGVsc2Ugew0KICAgICAgICBtZW51Qm90LnRhZ3MubGFiZWwgPSAibXV0ZSI7DQogICAgICAgIG1lbnVCb3QudGFncy5mb3JtQWRkcmVzcyA9ICdtaWMnOw0KICAgICAgICANCiAgICAgICAgY29uc3Qgdm9pY2VCb3QgPSBnZXRCb3QoInN5c3RlbSIsICJhYi5haS52b2ljZSIpOw0KICAgICAgICBpZiAodm9pY2VCb3QgJiYgIXZvaWNlQm90LnZhcnMuaHVtZVNvY2tldCkgew0KICAgICAgICAgICAgdm9pY2VCb3Quc3RhcnRIdW1lKCk7DQogICAgICAgIH0NCiAgICB9DQp9JwCNp670CAAOYWJBcnRpZmFjdE5hbWUCBACNp670CKUEB2FiVm9pY2UoAI2nrvQIAAVtdXRlZAF4JwCNp670CAAOYWJDb3JlTWVudUljb24CBACNp670CK4EB21pY19vZmYnAI2nrvQIAA9hYkNvcmVNZW51TGFiZWwCBACNp670CLYEBnVubXV0ZScAjaeu9AgABWxhYmVsAgQAjaeu9Ai9BARtdXRlJwCNp670CAALZm9ybUFkZHJlc3MCBACNp670CMIEA21pYycAjaeu9AgAE2FiQ29yZU1lbnVTb3J0T3JkZXICBACNp670CMYEBDEwMDAnAI2nrvQIABhhYkNvcmVNZW51T25CZWZvcmVDcmVhdGUCBACNp670CMsEsQFAaWYgKHRhZ3MubXV0ZWQpIHsNCiAgICB0YWdzLmFiQ29yZU1lbnVMYWJlbCA9ICJ1bm11dGUiOw0KICAgIHRhZ3MuYWJDb3JlTWVudUljb24gPSAnbWljX29mZic7DQp9IGVsc2Ugew0KICAgIHRhZ3MuYWJDb3JlTWVudUxhYmVsID0gIm11dGUiOw0KICAgIHRhZ3MuYWJDb3JlTWVudUljb24gPSAnbWljJzsNCn0nAI2nrvQIAAphYklET3JpZ2luAgQAjaeu9Aj9BQdhYlZvaWNlJwCNp670CAAHYWJWb2ljZQIEAI2nrvQIhQYEdHJ1ZScAjaeu9AgACWFiVmVyc2lvbgIEAI2nrvQIigYFMTAuNDInAQRib3RzJDI1N2JlMzM3LWYwYTEtNDE5Mi1iZTk3LTM3NzNmYWUyODJjYgEnAI2nrvQIkAYHY3JlYXRvcgIEAI2nrvQIkQYkMzRjM2MyMTAtNWJmMS00OWNmLWIxNTEtZWUyZDA3ZjBlNjczJwCNp670CJAGBnN5c3RlbQIEAI2nrvQItgYPYWIuYWkuYXV0b1NwZWFrJwCNp670CJAGDmFiQ29yZU1lbnVJY29uAgQAjaeu9AjGBgdtaWNfb2ZmJwCNp670CJAGEGFiQ29yZU1lbnVBY3Rpb24CBACNp670CM4GzgNAc2V0VGFnTWFzayh0aGlzQm90LCAiYXV0b1NwZWFrIiwgIXRhZ3MuYXV0b1NwZWFrKTsNCg0KY29uc3QgbWVudUJvdCA9IGdldEJvdChieVRhZygiYmFzZVNraWxsIiwgJ/CflJcnICsgZ2V0SUQodGhpc0JvdCkpLCBieVRhZygiYWJNZW51IiwgdHJ1ZSkpOw0KaWYgKG1lbnVCb3QpIHsNCiAgICBpZiAoIXRhZ3MuYXV0b1NwZWFrKSB7DQogICAgICAgIG1lbnVCb3QudGFncy5sYWJlbCA9ICJ1bm11dGUgIiArIGFiUGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eTsNCiAgICAgICAgbWVudUJvdC50YWdzLmZvcm1BZGRyZXNzID0gJ21pY19vZmYnOw0KICAgIH0gZWxzZSB7DQogICAgICAgIG1lbnVCb3QudGFncy5sYWJlbCA9ICJtdXRlICIgKyBhYlBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7DQogICAgICAgIG1lbnVCb3QudGFncy5mb3JtQWRkcmVzcyA9ICdtaWMnOw0KICAgIH0NCn0nAI2nrvQIkAYYYWJDb3JlTWVudU9uQmVmb3JlQ3JlYXRlAgQAjaeu9AibCoYCQGlmICghdGFncy5hdXRvU3BlYWspIHsNCiAgICB0YWdzLmFiQ29yZU1lbnVMYWJlbCA9ICJ1bm11dGUgIiArIGFiUGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eTsNCiAgICB0YWdzLmFiQ29yZU1lbnVJY29uID0gJ21pY19vZmYnOw0KfSBlbHNlIHsNCiAgICB0YWdzLmFiQ29yZU1lbnVMYWJlbCA9ICJtdXRlICIgKyBhYlBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHk7DQogICAgdGFncy5hYkNvcmVNZW51SWNvbiA9ICdtaWMnOw0KfScAjaeu9AiQBg9hYkNvcmVNZW51TGFiZWwCBACNp670CKIMEXVubXV0ZSBjYXN1YWwuYm90JwCNp670CJAGE2FiQ29yZU1lbnVTb3J0T3JkZXICBACNp670CLQMAzk5OSgAjaeu9AiQBglhdXRvU3BlYWsBeScAjaeu9AiQBgtvbkFueUNyZWF0ZQIEAI2nrvQIuQxxQGlmICh0aGF0LmJvdC50YWdzLm5hbWUgPT0gImFiVm9pY2VOb3RpZkJvdCIpIHsNCiAgICBpZiAodGFncy5hdXRvU3BlYWspIHsNCiAgICAgICAgdGhhdC5ib3Qub25DbGljaygpOw0KICAgIH0NCn0nAI2nrvQIkAYKYWJJRE9yaWdpbgIEAI2nrvQIqw0HYWJWb2ljZScAjaeu9AiQBgdhYlZvaWNlAgQAjaeu9AizDQR0cnVlJwCNp670CJAGCWFiVmVyc2lvbgIEAI2nrvQIuA0FMTAuNDInAQRib3RzJDk5ZWE1ODZkLTQyMmItNDYyYy1iMGRmLWFlMWNiNDA4MjE1MQEnAI2nrvQIvg0Gc3lzdGVtAgQAjaeu9Ai/DQthYi5haS52b2ljZScAjaeu9Ai+DRRhYkNvcmVNZW51T25HZW5lcmF0ZQIEAI2nrvQIyw31A0B0YWdzLm9uU3VibWl0ID0gYEANCiAgICBsaW5rcy5iYXNlU2tpbGwuYWJDb3JlTWVudUFjdGlvbih7bWVzc2FnZTogdGhhdC50ZXh0LCBtZW51OiAiY29yZSJ9KTsNCiAgICBtYXNrcy5tZW51SXRlbVRleHQgPSAiIjsNCmA7DQoNCnRhZ3MuZm9ybSA9ICJpbnB1dCI7DQoNCmlmICghYXV0aEJvdCkNCnsNCiAgICB0YWdzLmxhYmVsID0gInlvdSBtdXN0IGJlIGxvZ2dlZCBpbiB0byBjaGF0IHdpdGggIiArIGFiUGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eTsNCn0NCmVsc2UgaWYgKGF1dGhCb3QudGFncy5zdWJzY3JpcHRpb25UaWVyID09ICJGcmVlUGxheSIpDQp7DQogICAgdGFncy5sYWJlbCA9ICJjaGF0IHdpdGggIiArIGFiUGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSArICIgKGxpbWl0ZWQpIjsNCn0NCmVsc2UNCnsNCiAgICB0YWdzLmxhYmVsID0gImNoYXQgd2l0aCAiICsgYWJQZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5Ow0KfScAjaeu9Ai+DRBhYkNvcmVNZW51QWN0aW9uAgQAjaeu9AjBEa0DQGlmICh0aGF0ICYmIHRoYXQubWVzc2FnZSkgew0KICAgIGlmICh0aGF0Lm1lc3NhZ2UgPT0gJy5zdG9wSHVtZScpIHsNCiAgICAgICAgdGhpc0JvdC5lbmRIdW1lKCk7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBsZXQgdXNlcm5hbWUgPSBhd2FpdCB0aGlzQm90LmdldFVzZXJOYW1lKCk7DQoNCiAgICBpZiAoIXRoaXNCb3QudmFycy5odW1lU29ja2V0KSB7DQogICAgICAgIHNldFRhZ01hc2sodGhpc0JvdCwgImF3YWl0aW5nVGV4dCIsIHt1c2VyOiB1c2VybmFtZSwgbWVzc2FnZTogdGhhdC5tZXNzYWdlfSk7DQogICAgICAgIGF3YWl0IHRoaXNCb3Quc3RhcnRIdW1lKCk7DQogICAgfSBlbHNlIHsNCiAgICAgICAgdGhpc0JvdC50ZXh0UmVzcG9uc2Uoe3VzZXI6IHVzZXJuYW1lLCBtZXNzYWdlOiB0aGF0Lm1lc3NhZ2V9KTsNCiAgICB9DQp9JwCNp670CL4NCXN0YXJ0SHVtZQIEAI2nrvQI7xTdJ0Bjb25zdCBlbmRwb2ludCA9ICJ3c3M6Ly9hcGkuaHVtZS5haS92MC9ldmkvY2hhdCI7DQpjb25zdCBhY2Nlc3NUb2tlbiA9IChhd2FpdCBhaS5odW1lLmdldEFjY2Vzc1Rva2VuKCkpLmFjY2Vzc1Rva2VuOw0KLy9jb25zdCBjb25maWdJRCA9ICJlMDRiMDJkNS1jYjc4LTQyOTItYWJhNC1hOTEyZDg5MjZkZGQiOw0KY29uc3QgY29uZmlnSUQgPSAiZmYxMTMzZmItMmEyNy00YTljLTg4MDEtMjU4ZWNmN2ViMmFhIjsNCg0KY29uc3QgdXJsID0gbmV3IFVSTChlbmRwb2ludCk7DQp1cmwuc2VhcmNoUGFyYW1zLnNldCgiYWNjZXNzX3Rva2VuIiwgYWNjZXNzVG9rZW4pOw0KdXJsLnNlYXJjaFBhcmFtcy5zZXQoImNvbmZpZ19pZCIsIGNvbmZpZ0lEKTsNCg0KY29uc3QgaHVtZVNvY2tldCA9IG5ldyBXZWJTb2NrZXQodXJsLnRvU3RyaW5nKCkpOw0KdGhpc0JvdC52YXJzLmh1bWVTb2NrZXQgPSBodW1lU29ja2V0Ow0KdGhpc0JvdC52YXJzLnBsYXlpbmdRdWV1ZSA9IGZhbHNlOw0KDQpjb25zdCBzZXNzaW9uX3NldHRpbmdzID0gew0KICAgICJ0eXBlIjogInNlc3Npb25fc2V0dGluZ3MiLA0KICAgICJ2YXJpYWJsZXMiOiB7DQogICAgICAgICJuYW1lIjogYWJQZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5LA0KICAgICAgICAiY2F0YWxvZ19hc2tzIjogYXdhaXQgdGhpc0JvdC5nZXRDYXRhbG9nQXNrcygpDQogICAgfQ0KfTsNCg0KaHVtZVNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdvcGVuJywgKGV2ZW50KSA9PiB7DQogICAgY29uc29sZS53YXJuKCJIdW1lIFNvY2tldCBvcGVuZWQ6ICIsIGV2ZW50KTsNCg0KICAgIHRoaXNCb3QuY2xlYXJRdWV1ZXMoKTsNCiAgICBzZXRUYWdNYXNrKHRoaXNCb3QsICJoYW5kUmFpc2VkIiwgZmFsc2UpOw0KDQogICAgc2V0VGFnTWFzayh0aGlzQm90LCAibGF0ZXN0SW5xdWlyeSIsIG51bGwpOw0KICAgIHNldFRhZ01hc2sodGhpc0JvdCwgImxhdGVzdElucXVpcnlJRCIsIG51bGwpOw0KDQogICAgdGhpc0JvdC52YXJzLnBsYXlIdW1lQXVkaW8gPSB0cnVlOw0KDQogICAgLy9JZiBjb25zb2xlIGlzIG5vdCBvcGVuLCBvcGVuIGNvbnNvbGUNCiAgICBpZiAoIWxpbmtzLmNvbnNvbGUubWFza3Mub3Blbikgew0KICAgICAgICB3aGlzcGVyKGxpbmtzLmNvbnNvbGUsICJzaG93Q29uc29sZSIpOw0KICAgICAgICBsaW5rcy5jb25zb2xlLm1hc2tzLm9wZW4gPSB0cnVlOw0KICAgIH0NCg0KICAgIGh1bWVTb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeShzZXNzaW9uX3NldHRpbmdzKSk7DQoNCiAgICBzZXRUYWdNYXNrKHRoaXNCb3QsICJzZW50SW5pdENodW5rIiwgZmFsc2UpOw0KDQogICAgb3MuYmVnaW5BdWRpb1JlY29yZGluZyh7DQogICAgICAgIHN0cmVhbTogdHJ1ZSwNCiAgICAgICAgbWltZVR5cGU6ICdhdWRpby93YXYnDQogICAgfSk7DQoNCiAgICBvcy50b2FzdCgiSHVtZSBhY3RpdmUuLi4iKTsNCiAgICBzaG91dCgib25IdW1lU29ja2V0T3BlbmVkIik7DQp9KTsNCg0KaHVtZVNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsIChldmVudCkgPT4gew0KICAgIGNvbnNvbGUud2FybigiSHVtZSBTb2NrZXQgY2xvc2VkOiAiLCBldmVudCk7DQogICAgdGhpc0JvdC5lbmRIdW1lKCk7DQoNCiAgICBjb25zdCBtdXRlQm90ID0gZ2V0Qm90KCJzeXN0ZW0iLCAiYWIuYWkubXV0ZSIpOw0KICAgIGlmIChtdXRlQm90ICYmICFtdXRlQm90LnRhZ3MubXV0ZWQpIHsNCiAgICAgICAgbXV0ZUJvdC5hYkNvcmVNZW51QWN0aW9uKCk7DQogICAgfQ0KDQogICAgc2V0VGFnTWFzayh0aGlzQm90LCAibGF0ZXN0SW5xdWlyeSIsIG51bGwpOw0KICAgIHNldFRhZ01hc2sodGhpc0JvdCwgImxhdGVzdElucXVpcnlJRCIsIG51bGwpOw0KDQogICAgb3MudG9hc3QoIkh1bWUgY2xvc2VkLi4uIik7DQogICAgLy8gc2hvdXQoIm9uSHVtZUNoYXRFbmRlZCIsIGV2ZW50KTsNCn0pOw0KDQpodW1lU29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBhc3luYyAoZXZlbnQpID0+IHsNCiAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShldmVudC5kYXRhKTsNCg0KICAgIGlmIChkYXRhLnR5cGUgPT0gImF1ZGlvX291dHB1dCIpIHsNCiAgICAgICAgdGhpc0JvdC5xdWV1ZUF1ZGlvKGRhdGEuZGF0YSk7DQogICAgfQ0KICAgIGVsc2UgaWYgKGRhdGEudHlwZSA9PSAiYXNzaXN0YW50X21lc3NhZ2UiKSB7DQogICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBkYXRhLm1lc3NhZ2UuY29udGVudDsNCg0KICAgICAgICB0aGlzQm90LnF1ZXVlVGV4dChtZXNzYWdlKTsgDQogICAgICAgIA0KICAgIH0NCiAgICBlbHNlIGlmIChkYXRhLnR5cGUgPT0gImFzc2lzdGFudF9lbmQiKSB7DQogICAgICAgIC8vdGFncy50aGlua2luZyA9IHRydWU7DQogICAgfQ0KICAgIGVsc2UgaWYgKGRhdGEudHlwZSA9PSAiZXJyb3IiKSB7DQogICAgICAgIGNvbnNvbGUud2FybignZXJyb3I6ICcsIGRhdGEubWVzc2FnZSk7DQogICAgfQ0KICAgIGVsc2UgaWYgKGRhdGEudHlwZSA9PSAidXNlcl9tZXNzYWdlIikgew0KICAgICAgICBsZXQgdXNlcm5hbWUgPSBhd2FpdCB0aGlzQm90LmdldFVzZXJOYW1lKCk7DQogICAgICAgIHNldFRhZ01hc2sodGhpc0JvdCwgImhhbmRSYWlzZWQiLCBmYWxzZSk7DQoNCiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGEubWVzc2FnZS5jb250ZW50Ow0KDQogICAgICAgIGlmIChtZXNzYWdlKSB7DQogICAgICAgICAgICBhYi5sb2coew0KICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsDQogICAgICAgICAgICAgICAgbmFtZTogdXNlcm5hbWUsDQogICAgICAgICAgICAgICAgc3BhY2U6ICJzaGFyZWQiLA0KICAgICAgICAgICAgICAgIG1lc3NhZ2VPcmlnaW46IGNvbmZpZ0JvdC5pZCwNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgfQ0KICAgIGVsc2UgaWYgKGRhdGEudHlwZSA9PSAidG9vbF9jYWxsIikgew0KICAgICAgICBjb25zb2xlLmxvZygiVG9vbCBjYWxsZWQ6ICIsIGRhdGEubmFtZSwgZGF0YSk7DQogICAgICAgIGlmICh0YWdzLmRlYnVnTW9kZSA9PSB0cnVlICYmIGRhdGEubmFtZSAhPSAndGhpbmsnKSB7DQogICAgICAgICAgICBhYi5sb2coew0KICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEubmFtZSArICc6ICcgKyBkYXRhLnBhcmFtZXRlcnMsDQogICAgICAgICAgICAgICAgbmFtZTogYWJQZXJzb25hbGl0eS50YWdzLmFiQnVpbGRlcklkZW50aXR5LA0KICAgICAgICAgICAgICAgIHNwYWNlOiAic2hhcmVkIiwNCiAgICAgICAgICAgICAgICBtZXNzYWdlT3JpZ2luOiBjb25maWdCb3QuaWQsDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoZGF0YS5uYW1lID09ICJ0aGluayIpIHsNCiAgICAgICAgICAgIGlmIChKU09OLnBhcnNlKGRhdGEucGFyYW1ldGVycykubWVzc2FnZSkgew0KICAgICAgICAgICAgICAgIGFiLmxvZyh7IG1lc3NhZ2U6IEpTT04ucGFyc2UoZGF0YS5wYXJhbWV0ZXJzKS5tZXNzYWdlLCBuYW1lOiBhYlBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHksIHNwYWNlOiAic2hhcmVkIiwgbWVzc2FnZU9yaWdpbjogY29uZmlnQm90LmlkIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2UgaWYgKGRhdGEubmFtZSA9PSAibWFrZVRvRG9Cb3QiKSB7DQogICAgICAgICAgICB0aGlzQm90Lm1ha2VUb0RvQm90KHtpZDogZGF0YS50b29sX2NhbGxfaWQsIGRhdGE6IGRhdGEucGFyYW1ldGVyc30pOw0KICAgICAgICB9IGVsc2UgaWYgKGRhdGEubmFtZSA9PSAiY29tcGxldGVUb0RvcyIpIHsNCiAgICAgICAgICAgIHRoaXNCb3QuY29tcGxldGVUb0Rvcyh7aWQ6IGRhdGEudG9vbF9jYWxsX2lkfSk7DQogICAgICAgIH0gIGVsc2UgaWYgKGRhdGEubmFtZSA9PSAibWFrZSIpIHsNCiAgICAgICAgICAgIHRoaXNCb3QubWFrZVNvbWV0aGluZyh7aWQ6IGRhdGEudG9vbF9jYWxsX2lkLCBkYXRhOiBkYXRhLnBhcmFtZXRlcnN9KTsNCiAgICAgICAgfSAgZWxzZSBpZiAoZGF0YS5uYW1lID09ICJwdWxsRnJvbUNhdGFsb2ciKSB7DQogICAgICAgICAgICB0aGlzQm90LnB1bGxGcm9tQ2F0YWxvZyh7aWQ6IGRhdGEudG9vbF9jYWxsX2lkLCBkYXRhOiBkYXRhLnBhcmFtZXRlcnN9KTsNCiAgICAgICAgfSAgZWxzZSBpZiAoZGF0YS5uYW1lID09ICJnZXRTY2VuZURhdGEiKSB7DQogICAgICAgICAgICB0aGlzQm90LmdldFNjZW5lRGF0YSh7aWQ6IGRhdGEudG9vbF9jYWxsX2lkLCBkYXRhOiBkYXRhLnBhcmFtZXRlcnN9KTsNCiAgICAgICAgfSAgZWxzZSBpZiAoZGF0YS5uYW1lID09ICJzZWVVc2VyRm9jdXMiKSB7DQogICAgICAgICAgICB0aGlzQm90LnNlZVVzZXJGb2N1cyh7aWQ6IGRhdGEudG9vbF9jYWxsX2lkLCBkYXRhOiBkYXRhLnBhcmFtZXRlcnN9KTsNCiAgICAgICAgfSAgZWxzZSBpZiAoZGF0YS5uYW1lID09ICJjbGlja09uIikgew0KICAgICAgICAgICAgdGhpc0JvdC5haUNsaWNrKGRhdGEucGFyYW1ldGVycyk7DQogICAgICAgICAgICB0aGlzQm90LnNlbmRUb29sQ29tcGxldGVNZXNzYWdlKHtpZDogZGF0YS50b29sX2NhbGxfaWR9KTsNCiAgICAgICAgfSAgDQoNCiAgICAgICAgbGV0IGRlbGF5ID0gMjAwMDA7DQogICAgICAgIGlmIChkYXRhLm5hbWUgPT0gImNvbXBsZXRlVG9Eb3MiKSB7DQogICAgICAgICAgICBkZWxheSA9IDEyMDAwMDsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzQm90LnZhcnNbInRvb2xSZXNwb25zZVRpbWVvdXQiICsgZGF0YS50b29sX2NhbGxfaWRdID0gYXdhaXQgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICB0aGlzQm90LnNlbmRUb29sQ29tcGxldGVNZXNzYWdlKHtpZDogZGF0YS50b29sX2NhbGxfaWQsIGNvbnRlbnQ6ICJmYWlsZWQifSk7DQogICAgICAgIH0sIFtkZWxheV0pOw0KICAgIH0NCiAgICBlbHNlIGlmIChkYXRhLnR5cGUgPT0gInVzZXJfaW50ZXJydXB0aW9uIikgew0KICAgICAgICB0aGlzQm90LmNsZWFyUXVldWVzKCk7DQoNCiAgICAgICAgdGhpc0JvdC52YXJzLnBsYXlIdW1lQXVkaW8gPSB0cnVlOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgICAgY29uc29sZS5sb2coInVuZXhwZWN0ZWQgbWVzc2FnZToiLCBkYXRhLnR5cGUsIGRhdGEpOw0KICAgIH0NCn0pOycAjaeu9Ai+DQdlbmRIdW1lAgQAjaeu9AjNPMICQGNvbnN0IGh1bWVTb2NrZXQgPSB0aGlzQm90LnZhcnMuaHVtZVNvY2tldDsNCg0KY29uc3Qgbm90aWZCb3RzID0gZ2V0Qm90cygiYWJWb2ljZU5vdGlmaWNhdGlvbkJvdCIsIHRydWUpOw0KZGVzdHJveShub3RpZkJvdHMpOw0KDQppZihodW1lU29ja2V0KSB7DQogICAgaHVtZVNvY2tldC5jbG9zZSgxMDAwLCAnVXNlciBlbmRlZCB0aGUgY2hhdCcpOw0KICAgIGRlbGV0ZSB0aGlzQm90LnZhcnMuaHVtZVNvY2tldDsNCn0NCg0KdHJ5IHsNCiAgICBhd2FpdCBvcy5lbmRBdWRpb1JlY29yZGluZygpOw0KfSBjYXRjaChlKSB7DQogICAgY29uc29sZS53YXJuKGUpOw0KfScAjaeu9Ai+DQlxdWV1ZVRleHQCBACNp670CJA/fkBjb25zdCB0ZXh0ID0gdGhhdDsNCg0KdGhpc0JvdC5tYXNrcy50ZXh0UXVldWUgPSB0aGlzQm90Lm1hc2tzLnRleHRRdWV1ZSA/IFsuLi50aGlzQm90Lm1hc2tzLnRleHRRdWV1ZV0uY29uY2F0KHRleHQpIDogW3RleHRdOycAjaeu9Ai+DQ9wbGF5UXVldWVkQXVkaW8CBACNp670CI9A2g1AaWYgKHRoaXNCb3QudmFycy5wbGF5aW5nUXVldWUpDQp7DQogICAgcmV0dXJuOw0KfQ0KDQp0aGlzQm90LnZhcnMucGxheWluZ1F1ZXVlID0gdHJ1ZTsNCg0Kd2hpbGUgKHRoaXNCb3QubWFza3MuYXVkaW9RdWV1ZT8ubGVuZ3RoID4gMCkNCnsNCiAgICBjb25zdCBhY3RpdmVBdWRpbyA9IHRoaXNCb3QubWFza3MuYXVkaW9RdWV1ZVswXTsNCiAgICBjb25zdCBhY3RpdmVUZXh0ID0gdGhpc0JvdC5tYXNrcy50ZXh0UXVldWVbMF07DQoNCiAgICB0aGlzQm90Lm1hc2tzLmF1ZGlvUXVldWUuc3BsaWNlKDAsIDEpOw0KICAgIHRoaXNCb3QubWFza3MudGV4dFF1ZXVlLnNwbGljZSgwLDEpOw0KDQogICAgbGV0IHNvdW5kSWQgPSBvcy5wbGF5U291bmQoYWN0aXZlQXVkaW8pOw0KICAgIHRoaXNCb3QubWFza3MuYWN0aXZlU291bmQgPSBzb3VuZElkOw0KICAgIGlmIChhY3RpdmVUZXh0KSB7DQogICAgICAgIGFiLmxvZyh7IG1lc3NhZ2U6IGFjdGl2ZVRleHQsIG5hbWU6IGFiUGVyc29uYWxpdHkudGFncy5hYkJ1aWxkZXJJZGVudGl0eSwgc3BhY2U6ICJzaGFyZWQiLCBtZXNzYWdlT3JpZ2luOiBjb25maWdCb3QuaWQgfSk7DQogICAgfQ0KICAgIA0KICAgIGF3YWl0IG9zLnNsZWVwKChnZXREdXJhdGlvbihhY3RpdmVBdWRpbykgKiAxMDAwKSk7DQogICAgDQogICAgdGhpc0JvdC5tYXNrcy5hY3RpdmVTb3VuZCA9IG51bGw7DQp9DQoNCnRoaXNCb3QudmFycy5wbGF5aW5nUXVldWUgPSBudWxsOw0KDQpmdW5jdGlvbiBiYXNlNjRUb0FycmF5QnVmZmVyKGJhc2U2NCkgew0KICAgIGNvbnN0IGJpbmFyeVN0cmluZyA9IHNlbGYuYXRvYihiYXNlNjQuc3BsaXQoJywnKVsxXSk7DQogICAgY29uc3QgYnl0ZXMgPSBVaW50OEFycmF5LmZyb20oYmluYXJ5U3RyaW5nLCBjaGFyID0+IGNoYXIuY2hhckNvZGVBdCgwKSk7DQogICAgcmV0dXJuIGJ5dGVzLmJ1ZmZlcjsNCn0NCg0KZnVuY3Rpb24gZ2V0V2F2RHVyYXRpb24oYXJyYXlCdWZmZXIpIHsNCiAgICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyKTsNCg0KICAgIC8vIENoZWNrIHRoZSAiUklGRiIgaWRlbnRpZmllcg0KICAgIGlmICh2aWV3LmdldFVpbnQzMigwLCBmYWxzZSkgIT09IDB4NTI0OTQ2NDYpIHsNCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIFdBViBmaWxlIik7DQogICAgfQ0KDQogICAgLy8gQ2hlY2sgdGhlICJXQVZFIiBpZGVudGlmaWVyDQogICAgaWYgKHZpZXcuZ2V0VWludDMyKDgsIGZhbHNlKSAhPT0gMHg1NzQxNTY0NSkgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgV0FWIGZpbGUiKTsNCiAgICB9DQoNCiAgICAvLyBHZXQgdGhlIGJ5dGUgcmF0ZSBmcm9tIHRoZSBmbXQgc3ViY2h1bmsNCiAgICBjb25zdCBieXRlUmF0ZSA9IHZpZXcuZ2V0VWludDMyKDI4LCB0cnVlKTsNCg0KICAgIC8vIEdldCB0aGUgdG90YWwgbnVtYmVyIG9mIGJ5dGVzIGluIHRoZSBkYXRhIHN1YmNodW5rDQogICAgY29uc3QgZGF0YUNodW5rU2l6ZSA9IHZpZXcuZ2V0VWludDMyKDQwLCB0cnVlKTsNCg0KICAgIC8vIENhbGN1bGF0ZSBkdXJhdGlvbg0KICAgIGNvbnN0IGR1cmF0aW9uID0gZGF0YUNodW5rU2l6ZSAvIGJ5dGVSYXRlOw0KDQogICAgcmV0dXJuIGR1cmF0aW9uOw0KfQ0KDQpmdW5jdGlvbiBnZXREdXJhdGlvbihiYXNlNjQpIHsNCiAgICB2YXIgYXJyQnVmZmVyID0gYmFzZTY0VG9BcnJheUJ1ZmZlcihiYXNlNjQpOw0KICAgIHJldHVybiBnZXRXYXZEdXJhdGlvbihhcnJCdWZmZXIpOw0KfScAjaeu9Ai+DQx0ZXh0UmVzcG9uc2UCBACNp670COpNkwJALy8gbGV0IHJlc3BvbnNlID0gYXdhaXQgYWkuY2hhdChyZXNwb25zZVByb21wdCwgew0KLy8gICAgIHByZWZlcnJlZE1vZGVsOiB0YWdzLmFpTW9kZWwNCi8vIH0pOw0KDQpjb25zdCBodW1lU29ja2V0ID0gdGhpc0JvdC52YXJzLmh1bWVTb2NrZXQ7DQoNCmlmKGh1bWVTb2NrZXQpIHsNCiAgICBodW1lU29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoew0KICAgICAgICAidHlwZSI6ICJ1c2VyX2lucHV0IiwNCiAgICAgICAgInRleHQiOiB0aGF0Lm1lc3NhZ2UsDQogICAgfSkpOw0KfScAjaeu9Ai+DRNhYkNvcmVNZW51U29ydE9yZGVyAgQAjaeu9Aj+TwQxMDAxJwCNp670CL4NDG9uQXVkaW9DaHVuawIEAI2nrvQIg1CrB0Bjb25zdCBtdXRlQm90ID0gZ2V0Qm90KCJzeXN0ZW0iLCAiYWIuYWkubXV0ZSIpOw0KbGV0IGF1ZGlvRGF0YTsNCmlmIChtdXRlQm90ICYmIG11dGVCb3QudGFncy5tdXRlZCAmJiB0YWdzLnNlbnRJbml0Q2h1bmspIHsNCiAgICBjb25zdCBzaWxlbmNlID0gbmV3IEJsb2IoW25ldyBVaW50OEFycmF5KHRoYXQuc2l6ZSldLCB7IHR5cGU6ICdhdWRpby93YXYnIH0pOw0KICAgIGF1ZGlvRGF0YSA9IGF3YWl0IGJsb2JUb0Jhc2U2NChzaWxlbmNlKTsNCn0gZWxzZSB7DQogICAgYXVkaW9EYXRhID0gYXdhaXQgYmxvYlRvQmFzZTY0KHRoYXQpOw0KfQ0KDQpzZXRUYWdNYXNrKHRoaXNCb3QsICJzZW50SW5pdENodW5rIiwgdHJ1ZSk7DQoNCmNvbnN0IGh1bWVTb2NrZXQgPSB0aGlzQm90LnZhcnMuaHVtZVNvY2tldDsNCg0KY29uc3QgcGFja2V0SGFzaCA9IGNyeXB0by5oYXNoKCdzaGExJywgJ2hleCcsIGF1ZGlvRGF0YSk7DQoNCmlmKGh1bWVTb2NrZXQpIHsNCiAgICBjb25zb2xlLmxvZygicGFja2V0IGhlcmUiLCBwYWNrZXRIYXNoKTsNCg0KICAgIGh1bWVTb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7DQogICAgICAgICJ0eXBlIjogImF1ZGlvX2lucHV0IiwNCiAgICAgICAgImRhdGEiOiBhdWRpb0RhdGENCiAgICB9KSk7DQp9DQoNCmFzeW5jIGZ1bmN0aW9uIGJsb2JUb0Jhc2U2NChibG9iKSB7DQogIC8vIFJlYWQgdGhlIEJsb2IgYXMgYW4gQXJyYXlCdWZmZXINCiAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7DQogIA0KICAvLyBDb252ZXJ0IHRoZSBBcnJheUJ1ZmZlciB0byBhIEJhc2U2NCBzdHJpbmcNCiAgY29uc3QgYmFzZTY0U3RyaW5nID0gYnl0ZXMudG9CYXNlNjRTdHJpbmcobmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIpLCAnYXVkaW8vd2F2Jyk7DQogIA0KICByZXR1cm4gYmFzZTY0U3RyaW5nOw0KfScAjaeu9Ai+DQpxdWV1ZUF1ZGlvAgQAjaeu9AivV/QCQGNvbnN0IGJhc2U2NEF1ZGlvID0gdGhhdDsNCg0KY29uc3QgbWltZVR5cGUgPSAiYXVkaW8vd2F2IjsgLy8gQWRqdXN0IE1JTUUgdHlwZSBhcyBuZWVkZWQNCmNvbnN0IGRhdGFVUkwgPSBgZGF0YToke21pbWVUeXBlfTtiYXNlNjQsJHtiYXNlNjRBdWRpb31gOw0KDQp0aGlzQm90Lm1hc2tzLmF1ZGlvUXVldWUgPSB0aGlzQm90Lm1hc2tzLmF1ZGlvUXVldWUgPyBbLi4udGhpc0JvdC5tYXNrcy5hdWRpb1F1ZXVlXS5jb25jYXQoZGF0YVVSTCkgOiBbZGF0YVVSTF07DQoNCi8vdGhpc0JvdC5wbGF5UXVldWVkQXVkaW8oKTsNCmlmICghdGFncy5oYW5kUmFpc2VkKSB7DQogICAgc2V0VGFnTWFzayh0aGlzQm90LCAiaGFuZFJhaXNlZCIsIHRydWUpOw0KfQ0KJwCNp670CL4NC2dldFVzZXJOYW1lAgQAjaeu9AikWqUDQGxldCB1c2VybmFtZSA9ICJ1c2VyIjsNCg0KaWYgKGF1dGhCb3QgJiYgYXV0aEJvdC50YWdzLm5hbWUgJiYgYXV0aEJvdC50YWdzLm5hbWUgIT0gIiIpIHsNCiAgICB1c2VybmFtZSA9IGF1dGhCb3QudGFncy5uYW1lOw0KfSBlbHNlIGlmIChhYi5saW5rcy5jb25zb2xlLm1hc2tzLnByZWZlcnJlZE5hbWUpIHsNCiAgICB1c2VybmFtZSA9IGFiLmxpbmtzLmNvbnNvbGUubWFza3MucHJlZmVycmVkTmFtZTsNCn0gZWxzZSB7DQogICAgdXNlcm5hbWUgPSBhd2FpdCBvcy5zaG93SW5wdXQoIiIsIHsNCiAgICAgICAgdGl0bGU6ICJXaGF0IHdvdWxkIHlvdSBsaWtlIG1lIHRvIGNhbGwgeW91PyINCiAgICB9KTsNCiAgICBhYi5saW5rcy5jb25zb2xlLm1hc2tzLnByZWZlcnJlZE5hbWUgPSB1c2VybmFtZTsNCn0NCg0KcmV0dXJuIHVzZXJuYW1lOycAjaeu9Ai+DQphYklET3JpZ2luAgQAjaeu9AjKXQdhYlZvaWNlJwCNp670CL4NDmFiQ29yZU1lbnVJY29uAgQAjaeu9AjSXQRjdWJlJwCNp670CL4NA2FzawIEAI2nrvQI110o8J+Ul2VjODVjMWQ2LTlmMWEtNDBkNC04MmUxLTViZDY4MDM0OWMyNycAjaeu9Ai+DQxvbkJvdENoYW5nZWQCBACNp670CP5dwgpAaWYgKHRoYXQudGFncy5pbmNsdWRlcygiaGFuZFJhaXNlZCIpKSB7DQogICAgLy9jcmVhdGUgYm90IGFib3ZlIGFiIHdpdGggc3BlY2lhbCBjbGlja2FibGUgbGFiZWwNCiAgICANCiAgICBjb25zdCBhYkJvdCA9IGFiLmxpbmtzLm1hbmlmZXN0YXRpb24ubGlua3MuYWJCb3Q7DQogICAgaWYgKCFhYkJvdCkgew0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgaWYgKHRhZ3MuaGFuZFJhaXNlZCkgew0KICAgICAgICBjb25zdCBub3RpZkJvdHMgPSBnZXRCb3RzKCJhYlZvaWNlTm90aWZpY2F0aW9uQm90IiwgdHJ1ZSk7DQogICAgICAgIGRlc3Ryb3kobm90aWZCb3RzKTsNCiAgICAgICAgDQogICAgICAgIGNyZWF0ZSh7DQogICAgICAgICAgICB0cmFuc2Zvcm1lcjogZ2V0SUQoYWJCb3QpLA0KICAgICAgICAgICAgb25DbGljazogYEANCiAgICAgICAgICAgICAgICBsaW5rcy52b2ljZS5jYWxsZWRPbih0aGlzQm90KTsNCiAgICAgICAgICAgIGAsDQogICAgICAgICAgICBuYW1lOiAiYWJWb2ljZU5vdGlmQm90IiwNCiAgICAgICAgICAgIHZvaWNlOiBnZXRMaW5rKHRoaXNCb3QpLA0KICAgICAgICAgICAgYWJWb2ljZU5vdGlmaWNhdGlvbkJvdDogdHJ1ZSwNCiAgICAgICAgICAgIFthYi5saW5rcy5yZW1lbWJlci50YWdzLmFiQWN0aXZlRGltZW5zaW9uXTogdHJ1ZSwNCiAgICAgICAgICAgIFthYi5saW5rcy5yZW1lbWJlci50YWdzLmFiQWN0aXZlRGltZW5zaW9uICsgJ1onXTogMSwNCiAgICAgICAgICAgIGZvcm06ICdzcHJpdGUnLA0KICAgICAgICAgICAgZm9jdXNhYmxlOiB0cnVlLA0KICAgICAgICAgICAgb25Gb2N1c0VudGVyOiBgQA0KICAgICAgICAgICAgICAgIGlmICh0aGF0LmJvdCA9PSB0aGlzQm90KSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXNCb3Qub25DbGljaygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGAsDQogICAgICAgICAgICBvcmllbnRhdGlvbk1vZGU6ICdiaWxsYm9hcmQnLA0KICAgICAgICAgICAgc3BhY2U6ICJ0ZW1wTG9jYWwiLA0KICAgICAgICAgICAgZm9ybUFkZHJlc3M6ICdodHRwczovL2F1dGgtYXV4LXByb2QtZmlsZXNidWNrZXQtNjgyMzk3NjkwNjYwLnMzLmFtYXpvbmF3cy5jb20vNjRiZWI0MzktMTJiOS00MTU1LWIzODgtZGIwM2I3ZWMxYzljLzg5Mjk5ZDhjNThmOTdmODg1M2E5ZTg3ZDRhMDIwNzU3NDgzOWRiZWIzYzY2YjkyZWE2OTFkYjcxMGIzM2M1MTYnLA0KDQogICAgICAgIH0pDQogICAgfSBlbHNlIHsNCiAgICAgICAgY29uc3Qgbm90aWZCb3RzID0gZ2V0Qm90cygiYWJWb2ljZU5vdGlmaWNhdGlvbkJvdCIsIHRydWUpOw0KICAgICAgICBkZXN0cm95KG5vdGlmQm90cyk7DQogICAgfQ0KfScAjaeu9Ai+DQdjb25zb2xlAgQAjaeu9AjBaCjwn5SXMjRiN2U2NmYtMGQ1Yi00MDY0LWJmNDgtYjU2MmI5ZTZlM2ViJwCNp670CL4NCGNhbGxlZE9uAgQAjaeu9AjoaC1AZGVzdHJveSh0aGF0KTsNCg0KdGhpc0JvdC5wbGF5UXVldWVkQXVkaW8oKTsnAI2nrvQIvg0Sb25IdW1lU29ja2V0T3BlbmVkAgQAjaeu9AiWaXpAaWYgKHRhZ3MuYXdhaXRpbmdUZXh0KSB7DQogICAgdGhpc0JvdC50ZXh0UmVzcG9uc2UodGFncy5hd2FpdGluZ1RleHQpOw0KICAgIHNldFRhZ01hc2sodGhpc0JvdCwgImF3YWl0aW5nVGV4dCIsIG51bGwpOw0KfScAjaeu9Ai+DQtjbGVhclF1ZXVlcwIEAI2nrvQIkWqAA0B0aGlzQm90Lm1hc2tzLmF1ZGlvUXVldWUgJiYgdGhpc0JvdC5tYXNrcy5hdWRpb1F1ZXVlLmxlbmd0aCA+IDAgPyB0aGlzQm90Lm1hc2tzLmF1ZGlvUXVldWUubGVuZ3RoID0gMSA6IG51bGw7DQp0aGlzQm90Lm1hc2tzLnRleHRRdWV1ZSAmJiB0aGlzQm90Lm1hc2tzLnRleHRRdWV1ZS5sZW5ndGggPiAwID8gdGhpc0JvdC5tYXNrcy50ZXh0UXVldWUubGVuZ3RoID0gMSA6IG51bGw7DQoNCm9zLmNhbmNlbFNvdW5kKHRoaXNCb3QubWFza3MuYWN0aXZlU291bmQpOw0KDQpjb25zdCBub3RpZkJvdHMgPSBnZXRCb3RzKCJhYlZvaWNlTm90aWZpY2F0aW9uQm90IiwgdHJ1ZSk7DQpkZXN0cm95KG5vdGlmQm90cyk7DQoNCnRoaXNCb3QubWFza3MuYWN0aXZlU291bmQgPSBudWxsOygAjaeu9Ai+DQh0aGlua2luZwF4JwCNp670CL4NC21ha2VUb0RvQm90AgQAjaeu9AiTbdcHQGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHRoYXQuZGF0YSk7DQoNCmZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5ib3RzLmxlbmd0aDsgKytpKSB7DQogICAgY29uc3QgYWJBcnRpZmFjdFNoYXJkID0gew0KICAgICAgICBkYXRhOiB7DQogICAgICAgICAgICBwcm9tcHQ6IGRhdGEuYm90c1tpXS5wcm9tcHQsDQogICAgICAgICAgICBlZ2dQYXJhbWV0ZXJzOiB7DQogICAgICAgICAgICAgICAgZ3JpZEluZm9ybWF0aW9uOiB7DQogICAgICAgICAgICAgICAgICAgIGRpbWVuc2lvbjogYWIubGlua3MucmVtZW1iZXIuYWJHcmlkRm9jdXM/LmRpbWVuc2lvbiA/PyB0YWdzLmRpbWVuc2lvbiA/PyAnaG9tZScsDQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiB7DQogICAgICAgICAgICAgICAgICAgICAgICB4OiBhYi5saW5rcy5yZW1lbWJlci5hYkdyaWRGb2N1cz8ucG9zaXRpb24/LnggPz8gZGF0YS5ib3RzW2ldLmxvY2F0aW9uPy54ID8/IDAsDQogICAgICAgICAgICAgICAgICAgICAgICB5OiBhYi5saW5rcy5yZW1lbWJlci5hYkdyaWRGb2N1cz8ucG9zaXRpb24/LnggPz8gZGF0YS5ib3RzW2ldLmxvY2F0aW9uPy55ID8/IDANCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgZGVwZW5kZW5jaWVzOiBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgYXNrSUQ6ICd0b0RvQm90Jw0KICAgICAgICAgICAgfQ0KICAgICAgICBdDQogICAgfTsNCiAgICBhd2FpdCBhYi5saW5rcy5hcnRpZmFjdC5hYkNyZWF0ZUFydGlmYWN0UHJvbWlzZUJvdCh7DQogICAgICAgIGFiQXJ0aWZhY3ROYW1lOiAndG9Eb0JvdCcsDQogICAgICAgIGFiQXJ0aWZhY3RJbnN0YW5jZUlEOiB1dWlkKCksDQogICAgICAgIGFiQXJ0aWZhY3RTaGFyZCwNCiAgICB9KTsNCn0NCg0KdGhpc0JvdC5zZW5kVG9vbENvbXBsZXRlTWVzc2FnZSh7aWQ6IHRoYXQuaWR9KTsnAI2nrvQIvg0OZ2V0Q2F0YWxvZ0Fza3MCBACNp670COt0+wZAY29uc3QgY2F0YWxvZ0FyciA9IFtdOw0KY29uc3QgcG9zc2libGVUb29sYm94ZXMgPSBhYi5saW5rcy5yZW1lbWJlci50YWdzLnRvb2xib3hfYXJyYXk7DQoNCmZvciAobGV0IGkgPSAwOyBpIDwgcG9zc2libGVUb29sYm94ZXMubGVuZ3RoOyBpKyspDQp7DQogICAgY29uc3QgYWN0aXZlVG9vbGJveCA9IHBvc3NpYmxlVG9vbGJveGVzW2ldOw0KICAgIGNvbnN0IGV4dGFudEJvdCA9IGFjdGl2ZVRvb2xib3guc3R1ZGlvID8gZ2V0Qm90KCJhYklET3JpZ2luIiwgYWN0aXZlVG9vbGJveC5uYW1lKTogZ2V0Qm90KGFjdGl2ZVRvb2xib3gubmFtZSwgdHJ1ZSk7DQoNCiAgICBpZiAoIWV4dGFudEJvdCkNCiAgICB7DQogICAgICAgIGNvbnN0IG9iaiA9IHsNCiAgICAgICAgICAgICJuYW1lIjogYWN0aXZlVG9vbGJveC50aXRsZSwNCiAgICAgICAgICAgICJpZCI6IGFjdGl2ZVRvb2xib3gubmFtZQ0KICAgICAgICB9DQogICAgICAgIGNhdGFsb2dBcnIucHVzaChvYmopOw0KICAgIH0NCn0NCg0KY29uc3QgbG9hZGVkVG9vbGJveGVzID0gZ2V0Qm90cygidG9vbF9hcnJheSIpOw0KZm9yIChsZXQgaiA9IDA7IGogPCBsb2FkZWRUb29sYm94ZXMubGVuZ3RoOyArK2opIHsNCiAgICBjb25zdCBhcnIgPSBsb2FkZWRUb29sYm94ZXNbal0udGFncy50b29sX2FycmF5ID8/IFtdOw0KICAgIGZvciAobGV0IGsgPSAwOyBrIDwgYXJyLmxlbmd0aDsgKytrKSB7DQogICAgICAgIGNvbnN0IG9iaiA9IHsNCiAgICAgICAgICAgICJuYW1lIjogYXJyW2tdLm5hbWUgPz8gYXJyW2tdLnRhcmdldEFCLA0KICAgICAgICAgICAgImlkIjogYXJyW2tdLnRhcmdldEFCDQogICAgICAgIH0NCiAgICAgICAgY2F0YWxvZ0Fyci5wdXNoKG9iaik7DQogICAgfQ0KfQ0KDQpyZXR1cm4gY2F0YWxvZ0FycjsnAI2nrvQIvg0NbWFrZVNvbWV0aGluZwIEAI2nrvQI53uBF0Bjb25zdCBkYXRhID0gSlNPTi5wYXJzZSh0aGF0LmRhdGEpOw0KaWYgKGRhdGEgJiYgZGF0YS5wcm9tcHQpIHsNCiAgICBzZXRUYWdNYXNrKHRoaXNCb3QsICJsYXRlc3RJbnF1aXJ5IiwgZGF0YS5wcm9tcHQpOw0KICAgIHNldFRhZ01hc2sodGhpc0JvdCwgImxhdGVzdElucXVpcnlJRCIsIHRoYXQuaWQpOw0KICAgIA0KICAgIC8vYWIubGlua3MuYXNrLmFiQ29yZU1lbnVBY3Rpb24oZGF0YS5wcm9tcHQpOw0KICAgIGNvbnN0IGFiQXJ0aWZhY3RTaGFyZCA9IHsNCiAgICAgICAgZGF0YTogew0KICAgICAgICAgICAgcHJvbXB0OiBkYXRhLnByb21wdCwNCiAgICAgICAgICAgIGVnZ1BhcmFtZXRlcnM6IHsNCiAgICAgICAgICAgICAgICBncmlkSW5mb3JtYXRpb246IHsNCiAgICAgICAgICAgICAgICAgICAgZGltZW5zaW9uOiBhYi5saW5rcy5yZW1lbWJlci5hYkdyaWRGb2N1cz8uZGltZW5zaW9uID8/IHRhZ3MuZGltZW5zaW9uID8/ICdob21lJywNCiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHg6IGFiLmxpbmtzLnJlbWVtYmVyLmFiR3JpZEZvY3VzPy5wb3NpdGlvbj8ueCA/PyAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgeTogYWIubGlua3MucmVtZW1iZXIuYWJHcmlkRm9jdXM/LnBvc2l0aW9uPy54ID8/IDANCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgZGVwZW5kZW5jaWVzOiBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgYXNrSUQ6ICd0b0RvQm90Jw0KICAgICAgICAgICAgfQ0KICAgICAgICBdDQogICAgfTsNCiAgICBhd2FpdCBhYi5saW5rcy5hcnRpZmFjdC5hYkNyZWF0ZUFydGlmYWN0UHJvbWlzZUJvdCh7DQogICAgICAgIGFiQXJ0aWZhY3ROYW1lOiAndG9Eb0JvdCcsDQogICAgICAgIGFiQXJ0aWZhY3RJbnN0YW5jZUlEOiB1dWlkKCksDQogICAgICAgIGFiQXJ0aWZhY3RTaGFyZCwNCiAgICB9KTsNCg0KICAgIGF3YWl0IG9zLnNsZWVwKDEwMDApOw0KDQogICAgLy9wdWxsIGluIGFnZW50IGJvdA0KICAgIGF3YWl0IGFiLmxpbmtzLnNlYXJjaC5vbkxvb2t1cEFza0lEKHsNCiAgICAgICAgYXNrSUQ6ICdhZ2VudF9ib3RfdG9vbCcsDQogICAgICAgIGVnZ1BhcmFtZXRlcnM6IHsNCiAgICAgICAgICAgIGdyaWRJbmZvcm1hdGlvbjogew0KICAgICAgICAgICAgICAgIGRpbWVuc2lvbjogY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCA/PyAnaG9tZScsDQogICAgICAgICAgICAgICAgcG9zaXRpb246IHsNCiAgICAgICAgICAgICAgICAgICAgeDogMSwNCiAgICAgICAgICAgICAgICAgICAgeTogMA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBhaU1vZGVsOiBhYlBlcnNvbmFsaXR5LnRhZ3MuYWJQcmVmZXJyZWRBSU1vZGVsLA0KICAgICAgICB9DQogICAgfSkNCiAgICBsZXQgYWdlbnRCb3QgPSBnZXRCb3QoImFnZW50X2JvdF90b29sIiwgdHJ1ZSk7DQoNCiAgICBpZiAoIWFnZW50Qm90KSB7DQogICAgICAgIG9zLnRvYXN0KCJjb3VsZCBub3QgY3JlYXRlIGFpIGFnZW50Iik7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICAvL2NvbXBsZXRlIHRoZSB0b2RvDQogICAgY29uc3QgdG9Eb0JvdCA9IGdldEJvdChieVRhZygidG9EbyIsIHRydWUpLCBieVRhZygicHJvbXB0IiwgZGF0YS5wcm9tcHQpKTsNCiAgICBjb25zdCBwcm9tcHQgPSB0b0RvQm90LnRhZ3MucHJvbXB0Ow0KICAgIGlmICghcHJvbXB0KSB7DQogICAgICAgIG9zLnRvYXN0KCJmYWlsZWQgdG8gZXhlY3V0ZSByZXF1ZXN0IikNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGNvbnN0IHhQb3MgPSB0b0RvQm90LnRhZ3NbdG9Eb0JvdC50YWdzLmRpbWVuc2lvbiArICdYJ107DQogICAgY29uc3QgeVBvcyA9IHRvRG9Cb3QudGFnc1t0b0RvQm90LnRhZ3MuZGltZW5zaW9uICsgJ1knXTsNCg0KICAgIGxpbmtzLmFybV90b29sLmFiQ3JlYXRlQXJtKHsNCiAgICAgICAgb3JpZ2luQm90OiBhZ2VudEJvdCwNCiAgICAgICAgZGltZW5zaW9uOiB0b0RvQm90LnRhZ3MuZGltZW5zaW9uLA0KICAgICAgICBwb3NpdGlvbjogew0KICAgICAgICAgICAgeDogeFBvcywNCiAgICAgICAgICAgIHk6IHlQb3MsDQogICAgICAgICAgICB6OiAwDQogICAgICAgIH0NCiAgICB9KQ0KICAgIGF3YWl0IG9zLnNsZWVwKDEwMDApOw0KDQogICAgY29uc3QgcmVxdWVzdERhdGEgPSB7fTsNCiAgICBpZiAoYWdlbnRCb3QubGlua3MuYXJtQm90KSB7DQogICAgICAgIGNvbnN0IGFybUJvdCA9IGFnZW50Qm90LmxpbmtzLmFybUJvdDsNCiAgICAgICAgY29uc3QgYXJtRGltZW5zaW9uID0gYXJtQm90LnRhZ3MuZGltZW5zaW9uOw0KDQogICAgICAgIHJlcXVlc3REYXRhLmFybURpbWVuc2lvbiA9IGFybURpbWVuc2lvbjsNCiAgICAgICAgcmVxdWVzdERhdGEuYXJtRGltZW5zaW9uWCA9IGFybUJvdC50YWdzW2FybURpbWVuc2lvbiArICJYIl07DQogICAgICAgIHJlcXVlc3REYXRhLmFybURpbWVuc2lvblkgPSBhcm1Cb3QudGFnc1thcm1EaW1lbnNpb24gKyAiWSJdOw0KICAgIH0NCg0KICAgIGFnZW50Qm90Lm1hc2tzLnRhcmdldEJvdCA9IGdldExpbmsodG9Eb0JvdCk7DQogICAgYWdlbnRCb3QubWFza3MucHJvbXB0VHlwZSA9ICdncmlkJzsNCiAgICBhZ2VudEJvdC5hZ2VudE9uUmVxdWVzdCh7DQogICAgICAgIGlucXVpcnk6IHByb21wdCwNCiAgICAgICAgZGF0YTogcmVxdWVzdERhdGEsIA0KICAgICAgICBtb2RlbDogYWdlbnRCb3QudGFncy5haU1vZGVsDQogICAgfSk7DQoNCiAgICB0b0RvQm90LnRhZ3NbdG9Eb0JvdC50YWdzLmRpbWVuc2lvbl0gPSBmYWxzZTsNCiAgICAvLyBkZXN0cm95KHRvRG9Cb3QpOw0KICAgIC8vIGRlc3Ryb3koYWdlbnRCb3QpOw0KDQogICAgYXdhaXQgb3Muc2xlZXAoMTAwMCk7DQp9JwCNp670CL4ND3B1bGxGcm9tQ2F0YWxvZwIEAI2nrvQI6ZIB3BFAY29uc3QgZGF0YSA9IEpTT04ucGFyc2UodGhhdC5kYXRhKTsNCg0KLy9nZXQgZ3JpZCBkYXRhDQppZiAoIWFiLmxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMpIHsNCiAgY29uc3QgZ3JpZERhdGEgPSB7DQogICAgICBkaW1lbnNpb246IGFiUmVtZW1iZXIudGFncy5hYkFjdGl2ZURpbWVuc2lvbiA/PyAnaG9tZScsIA0KICAgICAgcG9zaXRpb246IHsNCiAgICAgICAgICB4OiAwLA0KICAgICAgICAgIHk6IDANCiAgICAgIH0NCiAgfQ0KICBhYi5saW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZEZvY3VzID0gZ3JpZERhdGE7DQp9DQoNCi8vbWFrZSBzdXJlIHRoZSBhc2sgaXMgdGhlcmUNCmlmIChkYXRhICYmIGRhdGEuYXNrKSB7DQoNCiAgLy9JZiBwdWxsaW5nIGEgdG9vbGJveA0KICBpZiAoZGF0YS5hc2suaW5jbHVkZXMoInRvb2xib3giKSkgew0KICAgIGNvbnN0IHRvb2xib3hEYXRhID0gYWIubGlua3MucmVtZW1iZXIudGFncy50b29sYm94X2FycmF5LmZpbmQodG9vbEJveCA9PiB0b29sQm94Lm5hbWUgPT0gZGF0YS5hc2spOw0KICAgIGxpbmtzLm1hbmFnZXIudG9vbGJveF9hZGQoe3Rvb2xib3hEYXRhOiB0b29sYm94RGF0YSwgZ3JpZERhdGE6IGFiLmxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXN9KTsNCiAgfSANCiAgLy9lbHNlIHB1bGxpbmcgYXJ0aWZhY3Qgb3IgYXNrDQogIGVsc2Ugew0KICAgIGxldCBpc0FydGlmYWN0ID0gZmFsc2U7DQoNCiAgICAvL2ZpbmQgdGhlIHRvb2xib3ggZm9yIHRoaXMgYXNrLCB0byBkZXRlcm1pbmUgaWYgaXRzIGFuIGFydGlmYWN0DQogICAgY29uc3QgdG9vbGJveCA9IGdldEJvdChieVRhZygidG9vbF9hcnJheSIsIHRvb2xfYXJyID0+IHsNCiAgICAgIGlmICh0b29sX2Fyci5maW5kKHRvb2wgPT4gdG9vbC50YXJnZXRBQiA9PSBkYXRhLmFzaykpIHsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICB9fQ0KICAgICkpOw0KICAgIGlmICh0b29sYm94KSB7DQogICAgICBpc0FydGlmYWN0ID0gdG9vbGJveC50YWdzLnRvb2xfYXJyYXkuZmluZCh0b29sID0+IHRvb2wudGFyZ2V0QUIgPT0gZGF0YS5hc2spPy5hcnRpZmFjdDsNCiAgICB9DQoNCiAgICAvL2lzIGFydGlmYWN0DQogICAgaWYgKGlzQXJ0aWZhY3QpIHsNCiAgICAgIGNvbnN0IGFiQXJ0aWZhY3RTaGFyZCA9IHsNCiAgICAgICAgICBkYXRhOiB7DQogICAgICAgICAgICAgIGVnZ1BhcmFtZXRlcnM6IHsNCiAgICAgICAgICAgICAgICAgIHRvb2xib3hCb3Q6IG51bGwsDQogICAgICAgICAgICAgICAgICBncmlkSW5mb3JtYXRpb246IGFiLmxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0sDQogICAgICAgICAgZGVwZW5kZW5jaWVzOiBbDQogICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgIGFza0lEOiBkYXRhLmFzaw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgXQ0KICAgICAgfTsNCiAgICAgIGFiLmxpbmtzLmFydGlmYWN0LmFiQ3JlYXRlQXJ0aWZhY3RQcm9taXNlQm90KHsNCiAgICAgICAgICBhYkFydGlmYWN0TmFtZTogZGF0YS5hc2ssDQogICAgICAgICAgYWJBcnRpZmFjdEluc3RhbmNlSUQ6IHV1aWQoKSwNCiAgICAgICAgICBhYkFydGlmYWN0U2hhcmQsDQogICAgICB9KTsNCiAgICAgIHNob3V0KCJhYk1lbnVSZWZyZXNoIik7DQogICAgICB0aGlzQm90LnNlbmRUb29sQ29tcGxldGVNZXNzYWdlKHtpZDogdGhhdC5pZH0pOw0KICAgIH0gDQogICAgLy9pcyBub3QgYXJ0aWZhY3QNCiAgICBlbHNlIHsNCiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYWIubGlua3Muc2VhcmNoLm9uTG9va3VwQXNrSUQoew0KICAgICAgICAgIGFza0lEOiBkYXRhLmFzaywNCiAgICAgICAgICBzb3VyY2VFdmVudDogJ3Rvb2wnLA0KICAgICAgICAgIGVnZ1BhcmFtZXRlcnM6IHsNCiAgICAgICAgICAgICAgdG9vbGJveEJvdDogbnVsbCwNCiAgICAgICAgICAgICAgZ3JpZEluZm9ybWF0aW9uOiBhYi5saW5rcy5yZW1lbWJlci50YWdzLmFiR3JpZEZvY3VzDQogICAgICAgICAgfSwNCiAgICAgIH0pOw0KICAgICAgc2hvdXQoImFiTWVudVJlZnJlc2giKTsNCiAgICAgIGlmIChyZXNwb25zZS5zdWNjZXNzKSB7DQogICAgICAgIHRoaXNCb3Quc2VuZFRvb2xDb21wbGV0ZU1lc3NhZ2Uoe2lkOiB0aGF0LmlkfSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzQm90LnNlbmRUb29sQ29tcGxldGVNZXNzYWdlKHtpZDogdGhhdC5pZCwgY29udGVudDogImZhaWxlZCJ9KTsNCiAgICAgIH0NCiAgICB9DQogIH0NCn0nAI2nrvQIvg0Ob25BbnlCb3RzQWRkZWQCBACNp670CMakAakFQGZvciAobGV0IGkgPSAwOyBpIDwgdGhhdC5ib3RzLmxlbmd0aDsgKytpKSB7DQogICAgaWYgKHRoYXQuYm90c1tpXS50YWdzLnRvb2xfYXJyYXkpIHsNCiAgICAgICAgY29uc3QgaHVtZVNvY2tldCA9IHRoaXNCb3QudmFycy5odW1lU29ja2V0Ow0KDQogICAgICAgIGlmKGh1bWVTb2NrZXQpIHsNCiAgICAgICAgICAgIGh1bWVTb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7DQogICAgICAgICAgICAgICAgInR5cGUiOiAic2Vzc2lvbl9zZXR0aW5ncyIsDQogICAgICAgICAgICAgICAgInZhcmlhYmxlcyI6IHsNCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiBhYlBlcnNvbmFsaXR5LnRhZ3MuYWJCdWlsZGVySWRlbnRpdHksDQogICAgICAgICAgICAgICAgICAgICJjYXRhbG9nX2Fza3MiOiBhd2FpdCB0aGlzQm90LmdldENhdGFsb2dBc2tzKCkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAodGhhdC5ib3RzW2ldLnRhZ3MuYWJQYXRjaEJvdCA9PSB0cnVlICYmIHRoYXQuYm90c1tpXS50YWdzLmFiUGF0Y2hBc2tJbnB1dD8uaW5xdWlyeSA9PSB0YWdzLmxhdGVzdElucXVpcnkpIHsNCiAgICAgICAgdGhpc0JvdC5zZW5kVG9vbENvbXBsZXRlTWVzc2FnZSh7aWQ6IHRhZ3MubGF0ZXN0SW5xdWlyeUlEfSk7DQogICAgfQ0KfQ0KJwCNp670CL4NF3NlbmRUb29sQ29tcGxldGVNZXNzYWdlAgQAjaeu9AjwqQGEA0Bjb25zdCBjb21wbGV0ZV9zZXR0aW5ncyA9IHsNCiAgICAidHlwZSI6ICJ0b29sX3Jlc3BvbnNlIiwNCiAgICAidG9vbF9jYWxsX2lkIjogdGhhdC5pZCwNCiAgICAiY29udGVudCI6IHRoYXQuY29udGVudCA/PyAiY29tcGxldGVkIg0KfTsNCg0KaWYgKHRoaXNCb3QudmFyc1sidG9vbFJlc3BvbnNlVGltZW91dCIgKyB0aGF0LmlkXSkgew0KICAgIGNsZWFyVGltZW91dCh0aGlzQm90LnZhcnNbInRvb2xSZXNwb25zZVRpbWVvdXQiICsgdGhhdC5pZF0pOw0KfQ0KDQpjb25zdCBodW1lU29ja2V0ID0gdGhpc0JvdC52YXJzLmh1bWVTb2NrZXQ7DQoNCmlmKGh1bWVTb2NrZXQpIHsNCiAgICBodW1lU29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoY29tcGxldGVfc2V0dGluZ3MpKTsNCn0nAI2nrvQIvg0HbWFuYWdlcgIEAI2nrvQI9awBKPCflJcxM2YzM2E1MS1jMmZhLTQ2ZGEtYTg4ZS1lNWMwNjc1NTZkMDInAI2nrvQIvg0MZ2V0U2NlbmVEYXRhAgQAjaeu9AicrQH9BEBjb25zdCBib3RzID0gZ2V0Qm90cyhieVRhZyhhYi5saW5rcy5yZW1lbWJlci50YWdzLmFiQWN0aXZlRGltZW5zaW9uLCB0cnVlKSwgbm90KGJ5VGFnKCJhYklnbm9yZSIsIHRydWUpKSwgbm90KGJ5VGFnKCJhYkJvdCIsIHRydWUpKSk7DQoNCmNvbnN0IHRvb2xfcmVzcG9uc2UgPSB7DQogICAgInR5cGUiOiAidG9vbF9yZXNwb25zZSIsDQogICAgInRvb2xfY2FsbF9pZCI6IHRoYXQuaWQsDQogICAgImNvbnRlbnQiOiBKU09OLnN0cmluZ2lmeShib3RzKQ0KfTsNCg0KY29uc29sZS5sb2coIlNjZW5lIERhdGEgU2VudDogIiwgYm90cykNCmlmICh0YWdzLmRlYnVnTW9kZSA9PSB0cnVlKSB7DQogICAgYWIubG9nKHsNCiAgICAgICAgbWVzc2FnZTogIlNjZW5lIERhdGEgU2VudDogIiArIEpTT04uc3RyaW5naWZ5KGJvdHMpLA0KICAgICAgICBuYW1lOiAnY2FzdWFsb3MnLA0KICAgICAgICBzcGFjZTogInNoYXJlZCIsDQogICAgICAgIG1lc3NhZ2VPcmlnaW46IGNvbmZpZ0JvdC5pZCwNCiAgICB9KTsNCn0NCg0KY29uc3QgaHVtZVNvY2tldCA9IHRoaXNCb3QudmFycy5odW1lU29ja2V0Ow0KDQppZihodW1lU29ja2V0KSB7DQogICAgaHVtZVNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHRvb2xfcmVzcG9uc2UpKTsNCn0nAI2nrvQIvg0Mc2VlVXNlckZvY3VzAgQAjaeu9AiasgG4BUBjb25zdCBmb2N1cyA9IGFiLmxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiTXVsdGlwbGVCb3RGb2N1cyA/PyBhYi5saW5rcy5yZW1lbWJlci5saW5rcy5hYkJvdEZvY3VzID8/IGFiLmxpbmtzLnJlbWVtYmVyLmxpbmtzLmFiR3JpZEZvY3VzID8/IGFiLmxpbmtzLnJlbWVtYmVyLnRhZ3MuYWJHcmlkRm9jdXMgPz8gbnVsbA0KDQpjb25zdCB0b29sX3Jlc3BvbnNlID0gew0KICAgICJ0eXBlIjogInRvb2xfcmVzcG9uc2UiLA0KICAgICJ0b29sX2NhbGxfaWQiOiB0aGF0LmlkLA0KICAgICJjb250ZW50IjogSlNPTi5zdHJpbmdpZnkoZm9jdXMpDQp9Ow0KDQpjb25zdCBodW1lU29ja2V0ID0gdGhpc0JvdC52YXJzLmh1bWVTb2NrZXQ7DQoNCmNvbnNvbGUubG9nKCJVc2VyIEZvY3VzIERhdGEgU2VudDogIiwgZm9jdXMpDQppZiAodGFncy5kZWJ1Z01vZGUgPT0gdHJ1ZSkgew0KICAgIGFiLmxvZyh7DQogICAgICAgIG1lc3NhZ2U6ICJVc2VyIEZvY3VzIERhdGEgU2VudDogIiArIEpTT04uc3RyaW5naWZ5KGZvY3VzKSwNCiAgICAgICAgbmFtZTogJ2Nhc3VhbG9zJywNCiAgICAgICAgc3BhY2U6ICJzaGFyZWQiLA0KICAgICAgICBtZXNzYWdlT3JpZ2luOiBjb25maWdCb3QuaWQsDQogICAgfSk7DQp9DQoNCmlmKGh1bWVTb2NrZXQpIHsNCiAgICBodW1lU29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkodG9vbF9yZXNwb25zZSkpOw0KfScAjaeu9Ai+DQdhaUNsaWNrAgQAjaeu9AjTtwF7QGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKHRoYXQpOw0KDQppZiAoIWRhdGEgfHwgIWRhdGEuYm90KSB7DQogICAgcmV0dXJuOw0KfQ0KDQp3aGlzcGVyKGdldEJvdChieUlEKGRhdGEuYm90KSksICJvbkNsaWNrIik7JwCNp670CL4NDWNvbXBsZXRlVG9Eb3MCBACNp670CM+4AZ0PQGNvbnN0IHRvRG9Cb3RzID0gZ2V0Qm90cygidG9EbyIsIHRydWUpOw0KbGV0IGFnZW50Qm90ID0gZ2V0Qm90KCJhZ2VudF9ib3RfdG9vbCIsIHRydWUpOw0KaWYgKCFhZ2VudEJvdCkgew0KICAgIC8vY3JlYXRlIGFnZW50IGJvdA0KICAgIGF3YWl0IGFiLmxpbmtzLnNlYXJjaC5vbkxvb2t1cEFza0lEKHsNCiAgICAgICAgYXNrSUQ6ICdhZ2VudF9ib3RfdG9vbCcsDQogICAgICAgIGVnZ1BhcmFtZXRlcnM6IHsNCiAgICAgICAgICAgIGdyaWRJbmZvcm1hdGlvbjogew0KICAgICAgICAgICAgICAgIGRpbWVuc2lvbjogY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbCA/PyAnaG9tZScsDQogICAgICAgICAgICAgICAgcG9zaXRpb246IHsNCiAgICAgICAgICAgICAgICAgICAgeDogMSwNCiAgICAgICAgICAgICAgICAgICAgeTogMA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBhaU1vZGVsOiBhYlBlcnNvbmFsaXR5LnRhZ3MuYWJQcmVmZXJyZWRBSU1vZGVsLA0KICAgICAgICB9DQogICAgfSkNCiAgICBhZ2VudEJvdCA9IGdldEJvdCgiYWdlbnRfYm90X3Rvb2wiLCB0cnVlKTsNCn0NCg0KaWYgKCFhZ2VudEJvdCkgew0KICAgIG9zLnRvYXN0KCJjb3VsZCBub3QgZmluZCBvciBjcmVhdGUgYWkgYWdlbnQiKTsNCiAgICByZXR1cm47DQp9DQoNCnNldFRhZ01hc2sodGhpc0JvdCwgImxhdGVzdElucXVpcnkiLCB0b0RvQm90c1t0b0RvQm90cy5sZW5ndGggLSAxXS50YWdzLnByb21wdCk7DQpzZXRUYWdNYXNrKHRoaXNCb3QsICJsYXRlc3RJbnF1aXJ5SUQiLCB0aGF0LmlkKTsNCg0KZm9yIChsZXQgaSA9IDA7IGkgPCB0b0RvQm90cy5sZW5ndGg7ICsraSkgew0KICAgIGNvbnN0IHByb21wdCA9IHRvRG9Cb3RzW2ldLnRhZ3MucHJvbXB0Ow0KICAgIGlmICghcHJvbXB0KSB7DQogICAgICAgIGNvbnRpbnVlOw0KICAgIH0NCg0KICAgIGNvbnN0IHhQb3MgPSB0b0RvQm90c1tpXS50YWdzW3RvRG9Cb3RzW2ldLnRhZ3MuZGltZW5zaW9uICsgJ1gnXTsNCiAgICBjb25zdCB5UG9zID0gdG9Eb0JvdHNbaV0udGFnc1t0b0RvQm90c1tpXS50YWdzLmRpbWVuc2lvbiArICdZJ107DQoNCiAgICBsaW5rcy5hcm1fdG9vbC5hYkNyZWF0ZUFybSh7DQogICAgICAgIG9yaWdpbkJvdDogYWdlbnRCb3QsDQogICAgICAgIGRpbWVuc2lvbjogdG9Eb0JvdHNbaV0udGFncy5kaW1lbnNpb24sDQogICAgICAgIHBvc2l0aW9uOiB7DQogICAgICAgICAgICB4OiB4UG9zLA0KICAgICAgICAgICAgeTogeVBvcywNCiAgICAgICAgICAgIHo6IDANCiAgICAgICAgfQ0KICAgIH0pDQogICAgYXdhaXQgb3Muc2xlZXAoMTAwMCk7DQoNCiAgICBjb25zdCByZXF1ZXN0RGF0YSA9IHt9Ow0KICAgIGlmIChhZ2VudEJvdC5saW5rcy5hcm1Cb3QpIHsNCiAgICAgICAgY29uc3QgYXJtQm90ID0gYWdlbnRCb3QubGlua3MuYXJtQm90Ow0KICAgICAgICBjb25zdCBhcm1EaW1lbnNpb24gPSBhcm1Cb3QudGFncy5kaW1lbnNpb247DQoNCiAgICAgICAgcmVxdWVzdERhdGEuYXJtRGltZW5zaW9uID0gYXJtRGltZW5zaW9uOw0KICAgICAgICByZXF1ZXN0RGF0YS5hcm1EaW1lbnNpb25YID0gYXJtQm90LnRhZ3NbYXJtRGltZW5zaW9uICsgIlgiXTsNCiAgICAgICAgcmVxdWVzdERhdGEuYXJtRGltZW5zaW9uWSA9IGFybUJvdC50YWdzW2FybURpbWVuc2lvbiArICJZIl07DQogICAgfQ0KDQogICAgYWdlbnRCb3QubWFza3MudGFyZ2V0Qm90ID0gZ2V0TGluayh0b0RvQm90c1tpXSk7DQogICAgYWdlbnRCb3QubWFza3MucHJvbXB0VHlwZSA9ICdncmlkJzsNCiAgICBhZ2VudEJvdC5hZ2VudE9uUmVxdWVzdCh7DQogICAgICAgIGlucXVpcnk6IHByb21wdCwNCiAgICAgICAgZGF0YTogcmVxdWVzdERhdGEsIA0KICAgICAgICBtb2RlbDogYWdlbnRCb3QudGFncy5haU1vZGVsDQogICAgfSk7DQoNCiAgICBhd2FpdCBvcy5zbGVlcCgxMDAwKTsNCn0nAI2nrvQIvg0IYXJtX3Rvb2wCBACNp670CO3HASjwn5SXM2M3NGM5ZjEtODJkYy00NjU1LThiMzgtZTdmMTFkZTg5NzhlJwCNp670CL4NCmhhbmRSYWlzZWQCBACNp670CJTIAQVmYWxzZScAjaeu9Ai+DQ9vbkFCSW5pdGlhbGl6ZWQCBACNp670CJrIARhAdGFncy5kZWJ1Z01vZGUgPSBmYWxzZTsnAI2nrvQIvg0HYWJWb2ljZQIEAI2nrvQIs8gBBHRydWUnAI2nrvQIvg0JYWJWZXJzaW9uAgQAjaeu9Ai4yAEFMTAuNDIoAI2nrvQIvg0JZGVidWdNb2RlAXknAI2nrvQIvg0Qb25BQlBhdGNoQXBwcm92ZQIEAI2nrvQIv8gBnAJAaWYgKHRoYXQuYWJQYXRjaEFza0lucHV0Py5pbnF1aXJ5ID09IHRhZ3MubGF0ZXN0SW5xdWlyeSkgew0KICAgIGNvbnN0IGFnZW50Qm90ID0gZ2V0Qm90KGJ5SUQodGhhdC5hYlBhdGNoQXNrSW5wdXQ/LmFiQm90KSk7DQogICAgaWYgKGFnZW50Qm90KSB7DQogICAgICAgIGRlc3Ryb3koYWdlbnRCb3QpOw0KICAgIH0NCiAgICBzZXRUYWdNYXNrKHRoaXNCb3QsICJsYXRlc3RJbnF1aXJ5IiwgbnVsbCk7DQogICAgc2V0VGFnTWFzayh0aGlzQm90LCAibGF0ZXN0SW5xdWlyeUlEIiwgbnVsbCk7IA0KfScAjaeu9Ai+DRBvbkFCUGF0Y2hBcHBsaWVkAgQAjaeu9AjcygGLAkBjb25zdCBwcm9tcHQgPSB0aGF0LmFiUGF0Y2hBc2tJbnB1dD8uaW5xdWlyeTsNCmNvbnN0IHRvRG9Cb3QgPSBnZXRCb3QoYnlUYWcoInRvRG8iLCB0cnVlKSwgYnlUYWcoInByb21wdCIsIHByb21wdCkpOw0KaWYgKHRvRG9Cb3QpIHsNCiAgICBkZXN0cm95KHRvRG9Cb3QpOw0KfQ0KDQppZiAodGFncy5sYXRlc3RJbnF1aXJ5ID09IHByb21wdCkgew0KICAgIHRoaXNCb3Quc2VuZFRvb2xDb21wbGV0ZU1lc3NhZ2Uoe2lkOiB0YWdzLmxhdGVzdElucXVpcnlJRH0pOw0KfScAjaeu9Ai+DQ9vbkFCUGF0Y2hGYWlsZWQCBACNp670COjMAZMCQGNvbnN0IHByb21wdCA9IHRoYXQuYWJQYXRjaEFza0lucHV0Py5pbnF1aXJ5Ow0KDQppZiAodGFncy5sYXRlc3RJbnF1aXJ5ID09IHByb21wdCkgew0KICAgIHRoaXNCb3Quc2VuZFRvb2xDb21wbGV0ZU1lc3NhZ2Uoe2lkOiB0YWdzLmxhdGVzdElucXVpcnlJRCwgY29udGVudDogImZhaWxlZCJ9KTsNCg0KICAgIHNldFRhZ01hc2sodGhpc0JvdCwgImxhdGVzdElucXVpcnkiLCBudWxsKTsNCiAgICBzZXRUYWdNYXNrKHRoaXNCb3QsICJsYXRlc3RJbnF1aXJ5SUQiLCBudWxsKTsNCn0nAI2nrvQIvg0Nb25BQlBhdGNoVW5kbwIEAI2nrvQI/M4BnAJAaWYgKHRoYXQuYWJQYXRjaEFza0lucHV0Py5pbnF1aXJ5ID09IHRhZ3MubGF0ZXN0SW5xdWlyeSkgew0KICAgIGNvbnN0IGFnZW50Qm90ID0gZ2V0Qm90KGJ5SUQodGhhdC5hYlBhdGNoQXNrSW5wdXQ/LmFiQm90KSk7DQogICAgaWYgKGFnZW50Qm90KSB7DQogICAgICAgIGRlc3Ryb3koYWdlbnRCb3QpOw0KICAgIH0NCiAgICBzZXRUYWdNYXNrKHRoaXNCb3QsICJsYXRlc3RJbnF1aXJ5IiwgbnVsbCk7DQogICAgc2V0VGFnTWFzayh0aGlzQm90LCAibGF0ZXN0SW5xdWlyeUlEIiwgbnVsbCk7IA0KfQA="}]}