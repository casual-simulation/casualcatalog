{"version":2,"updates":[{"id":0,"timestamp":1771649516550,"update":"AVGL/OGXCwAnAQRib3RzJDY2YzljN2RmLWQ4NDItNGJhNC04ZWM1LTBkNDk1ZWVmMWQwYwEnAIv84ZcLAAZzeXN0ZW0CBACL/OGXCwEKYWIueHBlLmd1aScAi/zhlwsAA0FwcAIEAIv84ZcLDLobQGNvbnN0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2ssIHVzZVJlZiB9ID0gb3MuYXBwSG9va3M7Cgpjb25zdCBDcmVkaXREaXNwbGF5ID0gdGhpc0JvdC5DcmVkaXREaXNwbGF5KCk7CiAgICAgICAgCmNvbnN0IEFwcCA9ICgpID0+IHsKICAgIGNvbnN0IFtjcmVkaXRzLCBzZXRDcmVkaXRzXSA9IHVzZVN0YXRlKCk7CiAgICBjb25zdCBbaWNvbiwgc2V0SWNvbl0gPSB1c2VTdGF0ZSgpOwogICAgY29uc3QgY3JlZGl0RGlzcGxheVJlZiA9IHVzZVJlZihudWxsKTsKCiAgICAvLyBvbiBtb3VudAogICAgdXNlRWZmZWN0KCgpID0+IHsKICAgICAgICBjb25zdCBvbkFCWFBFUGFpZE91dCA9IGFzeW5jIChsaXN0ZW5lclRoYXQpID0+IHsKICAgICAgICAgICAgY29uc3QgeyBwYXlBbW91bnQsIGN1ckNyZWRpdHMgfSA9IGxpc3RlbmVyVGhhdDsKCiAgICAgICAgICAgIHNldENyZWRpdHMoY3VyQ3JlZGl0cyk7CiAgICAgICAgICAgIGFiLmxpbmtzLnNvdW5kLmFiUGxheVNvdW5kKHsgdmFsdWU6ICdhYi9hdWRpby9wdXJjaGFzZS5tcDMnIH0pOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgc3Bhd25Db2lucyA9IGFzeW5jIChsaXN0ZW5lclRoYXQpID0+IHsKICAgICAgICAgICAgY29uc3QgeyB0YXJnZXRYLCB0YXJnZXRZLCB0YXJnZXRCb3QsIGNvdW50IH0gPSBsaXN0ZW5lclRoYXQ7CgogICAgICAgICAgICBjb25zdCBzdGFydFggPSBncmlkUG9ydGFsQm90LnRhZ3MucGl4ZWxXaWR0aCAtIDEwMDsKICAgICAgICAgICAgY29uc3Qgc3RhcnRZID0gNTA7CgogICAgICAgICAgICBpZiAoY3JlZGl0RGlzcGxheVJlZi5jdXJyZW50ICYmIGNvdW50KSB7CiAgICAgICAgICAgICAgICBsZXQgY29tcHV0ZWRUYXJnZXRYOwogICAgICAgICAgICAgICAgbGV0IGNvbXB1dGVkVGFyZ2V0WTsKCiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0Qm90KSB7CiAgICAgICAgICAgICAgICAgICAgLy8gY29tcHV0ZSB0YXJnZXQgcG9zaXRpb24gdXNpbmcgZ2l2ZW4gYm90LgogICAgICAgICAgICAgICAgICAgIGxldCBwb3J0YWw7CiAgICAgICAgICAgICAgICAgICAgbGV0IGRpbWVuc2lvbjsKCiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpZ0JvdC50YWdzLm1hcFBvcnRhbCAmJiB0YXJnZXRCb3QudGFnc1tjb25maWdCb3QudGFncy5tYXBQb3J0YWxdID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvcnRhbCA9ICdtYXAnOwogICAgICAgICAgICAgICAgICAgICAgICBkaW1lbnNpb24gPSBjb25maWdCb3QudGFncy5tYXBQb3J0YWw7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb25maWdCb3QudGFncy5ncmlkUG9ydGFsICYmIHRhcmdldEJvdC50YWdzW2NvbmZpZ0JvdC50YWdzLmdyaWRQb3J0YWxdID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBvcnRhbCA9ICdncmlkJzsKICAgICAgICAgICAgICAgICAgICAgICAgZGltZW5zaW9uID0gY29uZmlnQm90LnRhZ3MuZ3JpZFBvcnRhbDsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBwb3J0YWw6ICR7cG9ydGFsfSwgZGltZW5zaW9uOiAke2RpbWVuc2lvbn1gKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKHBvcnRhbCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBib3RQb3NpdGlvbiA9IGdldEJvdFBvc2l0aW9uKHRhcmdldEJvdCwgZGltZW5zaW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYm90U2NyZWVuQ29vcmRzID0gYXdhaXQgb3MuY2FsY3VsYXRlU2NyZWVuQ29vcmRpbmF0ZXNGcm9tUG9zaXRpb24ocG9ydGFsLCBib3RQb3NpdGlvbik7CgogICAgICAgICAgICAgICAgICAgICAgICBjb21wdXRlZFRhcmdldFggPSBib3RTY3JlZW5Db29yZHMueDsKICAgICAgICAgICAgICAgICAgICAgICAgY29tcHV0ZWRUYXJnZXRZID0gYm90U2NyZWVuQ29vcmRzLnk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNyZWRpdERpc3BsYXlSZWYuY3VycmVudC5zcGF3bkNvaW5zKAogICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGNvdW50LCAxMCksCiAgICAgICAgICAgICAgICAgICAgc3RhcnRYLAogICAgICAgICAgICAgICAgICAgIHN0YXJ0WSwKICAgICAgICAgICAgICAgICAgICBjb21wdXRlZFRhcmdldFggPz8gdGFyZ2V0WCwKICAgICAgICAgICAgICAgICAgICBjb21wdXRlZFRhcmdldFkgPz8gdGFyZ2V0WQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgb3MuYWRkQm90TGlzdGVuZXIodGhpc0JvdCwgJ29uQUJYUEVQYWlkT3V0Jywgb25BQlhQRVBhaWRPdXQpOwogICAgICAgIG9zLmFkZEJvdExpc3RlbmVyKHRoaXNCb3QsICdzcGF3bkNvaW5zJywgc3Bhd25Db2lucyk7CgogICAgICAgIC8vIEdyYWIgY3VycmVudCBjcmVkaXRzIGFtb3VudC4KICAgICAgICBhYlhQRS5nZXRDcmVkaXRzKCkudGhlbigoY3VyQ3JlZGl0cykgPT4gewogICAgICAgICAgICBzZXRDcmVkaXRzKGN1ckNyZWRpdHMpOwogICAgICAgIH0pCiAgICAgICAgCiAgICAgICAgLy8gTG9hZCBpY29uCiAgICAgICAgaWYgKHRhZ3MuY3JlZGl0SWNvbikgewogICAgICAgICAgICBjb25zdCBpY29uVVJMID0gYWIuYWJCdWlsZENhc3VhbENhdGFsb2dVUkwodGFncy5jcmVkaXRJY29uKTsKICAgICAgICAgICAgc2V0SWNvbihpY29uVVJMKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAoKSA9PiB7CiAgICAgICAgICAgIG9zLnJlbW92ZUJvdExpc3RlbmVyKHRoaXNCb3QsICdvbkFCWFBFUGFpZE91dCcsIG9uQUJYUEVQYWlkT3V0KTsKICAgICAgICAgICAgb3MucmVtb3ZlQm90TGlzdGVuZXIodGhpc0JvdCwgJ3NwYXduQ29pbnMnLCBzcGF3bkNvaW5zKTsKICAgICAgICB9OwogICAgfSwgW10pOwoKICAgIGNvbnN0IG9uQ3JlZGl0RGlzcGxheUNsaWNrID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnN0IGVuZHBvaW50ID0gYXdhaXQgb3MuZ2V0UmVjb3Jkc0VuZHBvaW50KCk7CiAgICAgICAgb3Mub3BlblVSTChlbmRwb2ludCk7CiAgICB9LCBbXSk7CgogICAgcmV0dXJuICgKICAgICAgICA8PgogICAgICAgICAgICA8c3R5bGU+e3RhZ3NbJ3N0eWxlLmNzcyddfTwvc3R5bGU+CiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSdhYi14cGUtZ3VpJz4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPSd0b3AtcmlnaHQnPgogICAgICAgICAgICAgICAgICAgIHtjcmVkaXRzICE9IG51bGwgJiYgCiAgICAgICAgICAgICAgICAgICAgICAgIDxDcmVkaXREaXNwbGF5IGljb249e2ljb259IGFtb3VudD17Y3JlZGl0c30gYW5pbWF0ZT17dHJ1ZX0gb25DbGljaz17b25DcmVkaXREaXNwbGF5Q2xpY2t9IHJlZj17Y3JlZGl0RGlzcGxheVJlZn0gLz4KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC8+CiAgICApCn0KCnJldHVybiBBcHA7CicAi/zhlwsABW1vdW50AgQAi/zhlwvHG9QBQGlmICghdGhpc0JvdC52YXJzLmFwcEluc3RhbmNlKSB7CiAgICB0aGlzQm90LnZhcnMuYXBwSW5zdGFuY2UgPSB0aGlzQm90LkFwcCgpOwogICAgYXdhaXQgb3MucmVnaXN0ZXJBcHAodGFncy5zeXN0ZW0sIHRoaXNCb3QpOwoKICAgIGNvbnN0IEFwcCA9IHRoaXNCb3QudmFycy5hcHBJbnN0YW5jZTsKICAgIG9zLmNvbXBpbGVBcHAodGFncy5zeXN0ZW0sIDxBcHAvPikKfQonAIv84ZcLAAd1bm1vdW50AgQAi/zhlwucHXFAaWYgKHRoaXNCb3QudmFycy5hcHBJbnN0YW5jZSkgewogICAgZGVsZXRlIHRoaXNCb3QudmFycy5hcHBJbnN0YW5jZTsKICAgIGF3YWl0IG9zLnVucmVnaXN0ZXJBcHAodGFncy5zeXN0ZW0pOwp9CicAi/zhlwsACXN0eWxlLmNzcwIEAIv84ZcLjh6+Ci5hYi14cGUtZ3VpIHsKfQoKLmFiLXhwZS1ndWkgLnRvcC1yaWdodCB7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB0b3A6IDEuMjVyZW07CiAgICByaWdodDogMC41cmVtOwogICAgZGlzcGxheTogZmxleDsKICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47Cn0KCi5jcmVkaXQtZGlzcGxheSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuNSk7CiAgICB1c2VyLXNlbGVjdDogbm9uZTsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGNvbG9yOiB3aGl0ZTsKICAgIHBhZGRpbmc6IDAuNnJlbTsKICAgIGJvcmRlci1yYWRpdXM6IDAuNXJlbTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMTVzIGVhc2Utb3V0OwogICAgdHJhbnNmb3JtLW9yaWdpbjogcmlnaHQgY2VudGVyOwp9CgouY3JlZGl0LWRpc3BsYXkgaW1nIHsKICAgIHdpZHRoOiAycmVtOwp9CgouY3JlZGl0LWRpc3BsYXkgc3BhbiB7CiAgICBtYXJnaW4tbGVmdDogMC41cmVtOwogICAgZm9udC1zaXplOiAxLjJyZW07CiAgICBmb250LXdlaWdodDogYm9sZDsKfQoKLmNyZWRpdC1jb2luIHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHdpZHRoOiAycmVtOwogICAgaGVpZ2h0OiAycmVtOwogICAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgICB6LWluZGV4OiAxMDAwMDsKfQoKLmNyZWRpdC1mbG9hdCB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBsZWZ0OiA1MCU7CiAgICB0b3A6IDEwMCU7CiAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgIGZvbnQtd2VpZ2h0OiA3MDA7CiAgICBmb250LXNpemU6IDE0cHg7CiAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgYW5pbWF0aW9uOiBjcmVkaXQtZmxvYXQtYW5pbSAycyBlYXNlLW91dCBmb3J3YXJkczsKfQoKQGtleWZyYW1lcyBjcmVkaXQtZmxvYXQtYW5pbSB7CiAgICAwJSB7CiAgICAgICAgb3BhY2l0eTogMTsKICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVgoLTUwJSkgdHJhbnNsYXRlWSgwKTsKICAgIH0KICAgIDEwMCUgewogICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVYKC01MCUpIHRyYW5zbGF0ZVkoM3JlbSk7CiAgICB9Cn0KCi5jcmVkaXQtcHVsc2UgeyAKICAgIGFuaW1hdGlvbjogY3JlZGl0LXB1bHNlLWFuaW0gMC41cyBlYXNlLW91dDsKfQoKQGtleWZyYW1lcyBjcmVkaXQtcHVsc2UtYW5pbSB7CiAgICAwJSAgIHsgdHJhbnNmb3JtOiBzY2FsZSgxKTsgfQogICAgMjIlICB7IHRyYW5zZm9ybTogc2NhbGUoMS4zMyk7IH0KICAgIDEwMCUgeyB0cmFuc2Zvcm06IHNjYWxlKDEpOyB9Cn0nAIv84ZcLAAlvbkRlc3Ryb3kCBACL/OGXC80oE0B0aGlzQm90LnVubW91bnQoKTsoAIv84ZcLAAVob21lWAF9ACgAi/zhlwsABWhvbWVZAX0DJwCL/OGXCwASb25BQlhQRUluaXRpYWxpemVkAgQAi/zhlwvjKBFAdGhpc0JvdC5tb3VudCgpOycAi/zhlwsABWFiWFBFAgQAi/zhlwv1KAR0cnVlJwCL/OGXCwAIYWJJZ25vcmUCBACL/OGXC/ooBHRydWUnAIv84ZcLAARmb3JtAgQAi/zhlwv/KAdub3RoaW5nJwCL/OGXCwAFdHlwZXMCBACL/OGXC4cpBPCfk4QnAIv84ZcLAA1DcmVkaXREaXNwbGF5AgQAi/zhlwuKKYkuQGNvbnN0IHsgdXNlRWZmZWN0LCB1c2VTdGF0ZSwgdXNlUmVmLCB1c2VDYWxsYmFjaywgdXNlSW1wZXJhdGl2ZUhhbmRsZSB9ID0gb3MuYXBwSG9va3M7CmNvbnN0IHsgZm9yd2FyZFJlZiB9ID0gb3MuYXBwQ29tcGF0OwoKaW50ZXJmYWNlIENyZWRpdERpc3BsYXlQcm9wcyB7CiAgICBhbW91bnQ6IG51bWJlcjsKICAgIGljb246IHN0cmluZzsKICAgIGFuaW1hdGU/OiBib29sZWFuOwogICAgb25DbGljaz86ICgpID0+IHZvaWQ7Cn0KCmludGVyZmFjZSBGbG9hdGluZ051bWJlciB7CiAgICBpZDogbnVtYmVyOwogICAgdmFsdWU6IG51bWJlcjsKfQoKaW50ZXJmYWNlIENvaW5QYXJ0aWNsZSB7CiAgICBpZDogbnVtYmVyOwogICAgc3RhcnRYOiBudW1iZXI7CiAgICBzdGFydFk6IG51bWJlcjsKICAgIHRhcmdldFg6IG51bWJlcjsKICAgIHRhcmdldFk6IG51bWJlcjsKICAgIHN0YXJ0VGltZTogbnVtYmVyOwogICAgZHVyYXRpb246IG51bWJlcjsKICAgIGFyY0hlaWdodDogbnVtYmVyOwogICAgb2Zmc2V0WDogbnVtYmVyOwogICAgcHJvZ3Jlc3M6IG51bWJlcjsKfQoKZnVuY3Rpb24gZWFzZU91dEN1YmljKHQ6IG51bWJlcikgewogICAgcmV0dXJuIDEgLSBNYXRoLnBvdygxIC0gdCwgMyk7Cn0KCmZ1bmN0aW9uIGVhc2VJbk91dFF1YWQodDogbnVtYmVyKSB7CiAgICByZXR1cm4gdCA8IDAuNSA/IDIgKiB0ICogdCA6IDEgLSBNYXRoLnBvdygtMiAqIHQgKyAyLCAyKSAvIDI7Cn0KCmxldCBmbG9hdElkID0gMDsKbGV0IGNvaW5JZCA9IDA7Cgpjb25zdCBGTE9BVFNfVElNRU9VVF9NUyA9IDIwMDA7CmNvbnN0IFBVTFNFX1RJTUVPVVRfTVMgPSA1MDA7Cgpjb25zdCBDcmVkaXREaXNwbGF5ID0gZm9yd2FyZFJlZigoewogICAgYW1vdW50LAogICAgaWNvbiwKICAgIGFuaW1hdGUgPSBmYWxzZSwKICAgIG9uQ2xpY2sKfTogQ3JlZGl0RGlzcGxheVByb3BzLCByZWYpID0+IHsKICAgIGNvbnN0IFtkaXNwbGF5QW1vdW50LCBzZXREaXNwbGF5QW1vdW50XSA9IHVzZVN0YXRlKGFtb3VudCk7CiAgICBjb25zdCBbcHVsc2UsIHNldFB1bHNlXSA9IHVzZVN0YXRlKGZhbHNlKTsKICAgIGNvbnN0IFtmbG9hdHMsIHNldEZsb2F0c10gPSB1c2VTdGF0ZTxGbG9hdGluZ051bWJlcltdPihbXSk7CiAgICBjb25zdCBbY29pbnMsIHNldENvaW5zXSA9IHVzZVN0YXRlPENvaW5QYXJ0aWNsZVtdPihbXSk7CiAgICBjb25zdCBwcmV2QW1vdW50UmVmID0gdXNlUmVmKGFtb3VudCk7CiAgICBjb25zdCBhbmltRnJhbWVSZWYgPSB1c2VSZWY8bnVtYmVyIHwgbnVsbD4obnVsbCk7CiAgICBjb25zdCBjb2luc0xvb3BSZWYgPSB1c2VSZWY8bnVtYmVyIHwgbnVsbD4obnVsbCk7CiAgICBjb25zdCB3aWRnZXRSZWYgPSB1c2VSZWY8SFRNTERpdkVsZW1lbnQgfCBudWxsPihudWxsKTsKCiAgICAvLyAtLS0gTnVtYmVyIGFuaW1hdGlvbiAtLS0KICAgIHVzZUVmZmVjdCgoKSA9PiB7CiAgICAgICAgY29uc3QgZnJvbSA9IHByZXZBbW91bnRSZWYuY3VycmVudDsKICAgICAgICBjb25zdCB0byA9IGFtb3VudDsKICAgICAgICBwcmV2QW1vdW50UmVmLmN1cnJlbnQgPSBhbW91bnQ7CgogICAgICAgIGlmICghYW5pbWF0ZSB8fCBmcm9tID09PSB0bykgewogICAgICAgICAgICBzZXREaXNwbGF5QW1vdW50KHRvKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgc2V0UHVsc2UodHJ1ZSk7CgogICAgICAgIGNvbnN0IGRpZmYgPSB0byAtIGZyb207CiAgICAgICAgY29uc3QgaWQgPSArK2Zsb2F0SWQ7CiAgICAgICAgc2V0RmxvYXRzKHByZXYgPT4gWy4uLnByZXYsIHsgaWQsIHZhbHVlOiBkaWZmIH1dKTsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgc2V0RmxvYXRzKHByZXYgPT4gcHJldi5maWx0ZXIoZiA9PiBmLmlkICE9PSBpZCkpOwogICAgICAgIH0sIEZMT0FUU19USU1FT1VUX01TKTsKCiAgICAgICAgY29uc3QgZHVyYXRpb24gPSBNYXRoLm1pbigxNTAwLCA0MDAgKyBNYXRoLmFicyh0byAtIGZyb20pICogNSk7CiAgICAgICAgY29uc3Qgc3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTsKCiAgICAgICAgZnVuY3Rpb24gdGljayhub3c6IG51bWJlcikgewogICAgICAgICAgICBjb25zdCB0ID0gTWF0aC5taW4oMSwgKG5vdyAtIHN0YXJ0KSAvIGR1cmF0aW9uKTsKICAgICAgICAgICAgc2V0RGlzcGxheUFtb3VudChNYXRoLnJvdW5kKGZyb20gKyAodG8gLSBmcm9tKSAqIGVhc2VPdXRDdWJpYyh0KSkpOwogICAgICAgICAgICBpZiAodCA8IDEpIHsKICAgICAgICAgICAgICAgIGFuaW1GcmFtZVJlZi5jdXJyZW50ID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRpY2spOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBhbmltRnJhbWVSZWYuY3VycmVudCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aWNrKTsKICAgICAgICByZXR1cm4gKCkgPT4gewogICAgICAgICAgICBpZiAoYW5pbUZyYW1lUmVmLmN1cnJlbnQpIGNhbmNlbEFuaW1hdGlvbkZyYW1lKGFuaW1GcmFtZVJlZi5jdXJyZW50KTsKICAgICAgICB9OwogICAgfSwgW2Ftb3VudCwgYW5pbWF0ZV0pOwoKICAgIC8vIC0tLSBQdWxzZSAtLS0KICAgIHVzZUVmZmVjdCgoKSA9PiB7CiAgICAgICAgaWYgKCFwdWxzZSkgcmV0dXJuOwogICAgICAgIGNvbnN0IHQgPSBzZXRUaW1lb3V0KCgpID0+IHNldFB1bHNlKGZhbHNlKSwgUFVMU0VfVElNRU9VVF9NUyk7CiAgICAgICAgcmV0dXJuICgpID0+IGNsZWFyVGltZW91dCh0KTsKICAgIH0sIFtwdWxzZV0pOwoKICAgIC8vIC0tLSBDb2luIGFuaW1hdGlvbiBsb29wIC0tLQogICAgdXNlRWZmZWN0KCgpID0+IHsKICAgICAgICBpZiAoY29pbnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGlmIChjb2luc0xvb3BSZWYuY3VycmVudCkgY2FuY2VsQW5pbWF0aW9uRnJhbWUoY29pbnNMb29wUmVmLmN1cnJlbnQpOwogICAgICAgICAgICBjb2luc0xvb3BSZWYuY3VycmVudCA9IG51bGw7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGxvb3AoKSB7CiAgICAgICAgICAgIGNvbnN0IG5vdyA9IHBlcmZvcm1hbmNlLm5vdygpOwogICAgICAgICAgICBzZXRDb2lucyhwcmV2ID0+CiAgICAgICAgICAgICAgICBwcmV2CiAgICAgICAgICAgICAgICAgICAgLm1hcChjID0+ICh7IC4uLmMsIHByb2dyZXNzOiBNYXRoLm1pbigxLCAobm93IC0gYy5zdGFydFRpbWUpIC8gYy5kdXJhdGlvbikgfSkpCiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihjID0+IGMucHJvZ3Jlc3MgPCAxKQogICAgICAgICAgICApOwogICAgICAgICAgICBjb2luc0xvb3BSZWYuY3VycmVudCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTsKICAgICAgICB9CgogICAgICAgIGNvaW5zTG9vcFJlZi5jdXJyZW50ID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApOwogICAgICAgIHJldHVybiAoKSA9PiB7CiAgICAgICAgICAgIGlmIChjb2luc0xvb3BSZWYuY3VycmVudCkgY2FuY2VsQW5pbWF0aW9uRnJhbWUoY29pbnNMb29wUmVmLmN1cnJlbnQpOwogICAgICAgIH07CiAgICB9LCBbY29pbnMubGVuZ3RoID4gMF0pOwoKICAgIC8vIC0tLSBJbXBlcmF0aXZlIEFQSSAtLS0KICAgIGNvbnN0IHNwYXduQ29pbnMgPSB1c2VDYWxsYmFjaygoY291bnQ6IG51bWJlciwgc3RhcnRYOiBudW1iZXIsIHN0YXJ0WTogbnVtYmVyLCB0YXJnZXRYOiBudW1iZXIsIHRhcmdldFk6IG51bWJlcikgPT4gewogICAgICAgIGNvbnN0IG5vdyA9IHBlcmZvcm1hbmNlLm5vdygpOwoKICAgICAgICBjb25zdCBuZXdDb2luczogQ29pblBhcnRpY2xlW10gPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBjb3VudCB9LCAoXywgaSkgPT4gKHsKICAgICAgICAgICAgaWQ6ICsrY29pbklkLAogICAgICAgICAgICBzdGFydFgsCiAgICAgICAgICAgIHN0YXJ0WSwKICAgICAgICAgICAgdGFyZ2V0WCwKICAgICAgICAgICAgdGFyZ2V0WSwKICAgICAgICAgICAgc3RhcnRUaW1lOiBub3cgKyBpICogNjAsCiAgICAgICAgICAgIGR1cmF0aW9uOiA1MDAgKyBNYXRoLnJhbmRvbSgpICogMzAwLAogICAgICAgICAgICBhcmNIZWlnaHQ6IDQwICsgTWF0aC5yYW5kb20oKSAqIDgwLAogICAgICAgICAgICBvZmZzZXRYOiAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiA2MCwKICAgICAgICAgICAgcHJvZ3Jlc3M6IDAsCiAgICAgICAgfSkpOwoKICAgICAgICBzZXRDb2lucyhwcmV2ID0+IFsuLi5wcmV2LCAuLi5uZXdDb2luc10pOwogICAgfSwgW10pOwoKICAgIHVzZUltcGVyYXRpdmVIYW5kbGUocmVmLCAoKSA9PiAoeyBzcGF3bkNvaW5zIH0pLCBbc3Bhd25Db2luc10pOwoKICAgIC8vIC0tLSBSZW5kZXIgYSBzaW5nbGUgY29pbiAtLS0KICAgIGNvbnN0IHJlbmRlckNvaW4gPSAoYzogQ29pblBhcnRpY2xlKSA9PiB7CiAgICAgICAgY29uc3QgdCA9IGVhc2VJbk91dFF1YWQoYy5wcm9ncmVzcyk7CgogICAgICAgIGNvbnN0IHggPSBjLnN0YXJ0WCArIChjLnRhcmdldFggLSBjLnN0YXJ0WCkgKiB0ICsgYy5vZmZzZXRYICogKDEgLSB0KTsKICAgICAgICBjb25zdCBiYXNlWSA9IGMuc3RhcnRZICsgKGMudGFyZ2V0WSAtIGMuc3RhcnRZKSAqIHQ7CiAgICAgICAgY29uc3QgYXJjID0gLWMuYXJjSGVpZ2h0ICogNCAqIHQgKiAoMSAtIHQpOwogICAgICAgIGNvbnN0IHkgPSBiYXNlWSArIGFyYzsKCiAgICAgICAgY29uc3Qgc2NhbGUgPSAxIC0gdCAqIDAuNDsKICAgICAgICBjb25zdCBvcGFjaXR5ID0gdCA+IDAuODUgPyAxIC0gKHQgLSAwLjg1KSAvIDAuMTUgOiAxOwoKICAgICAgICByZXR1cm4gKAogICAgICAgICAgICA8aW1nCiAgICAgICAgICAgICAgICBrZXk9e2MuaWR9CiAgICAgICAgICAgICAgICBzcmM9e2ljb259CiAgICAgICAgICAgICAgICBjbGFzc05hbWU9ImNyZWRpdC1jb2luIgogICAgICAgICAgICAgICAgc3R5bGU9e3sKICAgICAgICAgICAgICAgICAgICBsZWZ0OiBgJHt4fXB4YCwKICAgICAgICAgICAgICAgICAgICB0b3A6IGAke3l9cHhgLAogICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgtNTAlLCAtNTAlKSBzY2FsZSgke3NjYWxlfSlgLAogICAgICAgICAgICAgICAgICAgIG9wYWNpdHksCiAgICAgICAgICAgICAgICB9fQogICAgICAgICAgICAvPgogICAgICAgICk7CiAgICB9OwoKICAgIHJldHVybiAoCiAgICAgICAgPD4KICAgICAgICAgICAgPGRpdgogICAgICAgICAgICAgICAgcmVmPXt3aWRnZXRSZWZ9CiAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2BjcmVkaXQtZGlzcGxheSAke3B1bHNlID8gJ2NyZWRpdC1wdWxzZScgOiAnJ31gfQogICAgICAgICAgICAgICAgb25DbGljaz17b25DbGlja30KICAgICAgICAgICAgICAgIHN0eWxlPXt7IHBvc2l0aW9uOiAncmVsYXRpdmUnIH19CiAgICAgICAgICAgID4KICAgICAgICAgICAgICAgIDxpbWcgc3JjPXtpY29ufT48L2ltZz4KICAgICAgICAgICAgICAgIDxzcGFuPntkaXNwbGF5QW1vdW50fTwvc3Bhbj4KICAgICAgICAgICAgICAgIHtmbG9hdHMubWFwKGYgPT4gKAogICAgICAgICAgICAgICAgICAgIDxzcGFuCiAgICAgICAgICAgICAgICAgICAgICAgIGtleT17Zi5pZH0KICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPSJjcmVkaXQtZmxvYXQiCiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IGNvbG9yOiBmLnZhbHVlID4gMCA/ICcjMjJjNTVlJyA6ICcjZWY0NDQ0JyB9fQogICAgICAgICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgICAgICAgICAge2YudmFsdWUgPiAwID8gJysnIDogJyd9e2YudmFsdWV9CiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPgogICAgICAgICAgICAgICAgKSl9CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICB7Y29pbnMubWFwKHJlbmRlckNvaW4pfQogICAgICAgIDwvPgogICAgKTsKfSk7CgpyZXR1cm4gQ3JlZGl0RGlzcGxheTsnAIv84ZcLABpvbkFCQ29tbWFuZHNNYW5hZ2VyQ3JlYXRlZAIEAIv84ZcLlFe1AkBsZXQgYWJDb21tYW5kczogQUJDb21tYW5kc01hbmFnZXIgPSB0aGF0OwoKYWJDb21tYW5kcy5hZGRDb21tYW5kKCd4cGVndWlyZWxvYWQnLCBhc3luYyAoYXJncykgPT4gewogICAgYXdhaXQgdGhpc0JvdC51bm1vdW50KCk7CiAgICBhd2FpdCB0aGlzQm90Lm1vdW50KCk7CiAgICBjb25zb2xlLmxvZyhgW3hwZWd1aXJlbG9hZF0gUmVsb2FkZWQgdGhlIEFCIFhQRSBHVUkgYXBwLmApOwp9LCB7CiAgICBzaG9ydERlc2NyaXB0aW9uOiAnUmVsb2FkIHRoZSBBQiBYUEUgR1VJIGFwcC4nLAogICAgdXNhZ2U6IFsnLnhwZWd1aXJlbG9hZCddCn0pOycAi/zhlwsACmNyZWRpdEljb24CBACL/OGXC8pZIWFiL2ljb25zL2F1eF9jcmVkaXRfaWNvbl80OHB4LnBuZycAi/zhlwsACWFiVmVyc2lvbgIEAIv84ZcL7FkFMTAuNDAnAQRib3RzJDc1N2NkMmMwLWJhNDYtNDJiZi05YzI2LTFiMWY3YjA0MmM4MgEnAIv84ZcL8lkGc3lzdGVtAgQAi/zhlwvzWQ9hYi54cGUuZXhjaGFuZ2UnAIv84ZcL8lkIYWJJZ25vcmUCBACL/OGXC4NaBHRydWUnAIv84ZcL8lkEZm9ybQIEAIv84ZcLiFoHbm90aGluZycAi/zhlwvyWQ9vbkFCSW5pdGlhbGl6ZWQCBACL/OGXC5BaFkB0aGlzQm90LmluaXRpYWxpemUoKTsnAIv84ZcL8lkNb25Ta2lsbFVwZGF0ZQIEAIv84ZcLp1oWQHRoaXNCb3QuaW5pdGlhbGl6ZSgpOycAi/zhlwvyWRFnZXRBY2NvdW50QmFsYW5jZQIEAIv84ZcLvlr/AUBhc3NlcnQobWFza3MuaW5pdGlhbGl6ZWQsIGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gc2tpbGwgbXVzdCBiZSBsb2FkZWQgYmVmb3JlIGZpcnN0LmApOwoKaWYgKHRhZ3MubW9jaykgewogICAgYXdhaXQgb3Muc2xlZXAoMTAwKTsKICAgIHJldHVybiB0aGlzQm90LnZhcnMubW9ja0JhbGFuY2U7Cn0gZWxzZSB7CiAgICBjb25zdCBiYWxhbmNlID0gYXdhaXQgeHAuZ2V0QWNjb3VudEJhbGFuY2VzKCk7CiAgICByZXR1cm4gYmFsYW5jZTsKfScAi/zhlwvyWQpnZXRDcmVkaXRzAgQAi/zhlwu+XMIBQGltcG9ydCB7IEpTT05BY2NvdW50QmFsYW5jZSB9IGZyb20gJ2Nhc3VhbG9zJzsKCmNvbnN0IGJhbGFuY2U6IEpTT05BY2NvdW50QmFsYW5jZSA9IGF3YWl0IHRoaXNCb3QuZ2V0QWNjb3VudEJhbGFuY2UoKTsKY29uc3QgY3JlZGl0c051bSA9IE51bWJlci5wYXJzZUZsb2F0KGJhbGFuY2UuY3JlZGl0cyk7CgpyZXR1cm4gY3JlZGl0c051bTsnAIv84ZcL8lkFYWJYUEUCBACL/OGXC4FeBHRydWUnAIv84ZcL8lkJYWJWZXJzaW9uAgQAi/zhlwuGXgUxMC40MCcAi/zhlwvyWQppbml0aWFsaXplAgQAi/zhlwuMXqoEQGltcG9ydCB7IEpTT05BY2NvdW50QmFsYW5jZSB9IGZyb20gJ2Nhc3VhbG9zJzsKCmlmIChtYXNrcy5pbml0aWFsaXplZCkgewogICAgcmV0dXJuOwp9CgptYXNrcy5pbml0aWFsaXplZCA9IHRydWU7CgpnbG9iYWxUaGlzLmFiWFBFID0gdGhpc0JvdDsKCmlmICh0YWdzLm1vY2spIHsKICAgIGNvbnN0IGluaXRpYWxNb2NrQmFsYW5jZTogSlNPTkFjY291bnRCYWxhbmNlID0gewogICAgICAgIGFjY291bnRJZDogYXV0aEJvdC5pZCwKICAgICAgICBjcmVkaXRzOiAnMTAnLAogICAgICAgIGN1cnJlbmN5OiAnVVNEJywKICAgICAgICBkZWJpdHM6ICcwJywKICAgICAgICBkaXNwbGF5RmFjdG9yOiAnMScsCiAgICAgICAgcGVuZGluZ0NyZWRpdHM6ICcwJywKICAgICAgICBwZW5kaW5nRGViaXRzOiAnMCcsCiAgICB9CgogICAgdGhpc0JvdC52YXJzLm1vY2tCYWxhbmNlID0gaW5pdGlhbE1vY2tCYWxhbmNlOwoKICAgIHNob3V0KCdvbkFCWFBFSW5pdGlhbGl6ZWQnKTsKfSBlbHNlIHsKICAgIC8vIFRPRE8/CiAgICAKICAgIHNob3V0KCdvbkFCWFBFSW5pdGlhbGl6ZWQnKTsKfQonAIv84ZcL8lkGcGF5b3V0AgQAi/zhlwu3YugLQGltcG9ydCB7IEpTT05BY2NvdW50QmFsYW5jZSB9IGZyb20gJ2Nhc3VhbG9zJzsKCmNvbnN0IHsKICAgIGFtb3VudCwKICAgIGRlc3RpbmF0aW9uLAogICAgc291cmNlSWQsCn06IEFCWFBFID0gdGhhdCA/PyB7fTsKCmlmICh0YWdzLm1vY2spIHsKICAgIGF3YWl0IG9zLnNsZWVwKDEwMCk7CgogICAgY29uc3QgYmFsYW5jZTogSlNPTkFjY291bnRCYWxhbmNlID0gdGhpc0JvdC52YXJzLm1vY2tCYWxhbmNlOwogICAgbGV0IGNyZWRpdHNOdW0gPSBOdW1iZXIucGFyc2VGbG9hdChiYWxhbmNlLmNyZWRpdHMpOwoKICAgIGlmIChjcmVkaXRzTnVtID49IGFtb3VudCkgewogICAgICAgIGlmICh0YWdzLmRlYnVnKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbJHt0YWdzLnN5c3RlbX0uJHt0YWdOYW1lfV0gbW9jazogcGF5aW5nICR7YW1vdW50fSBvdXQgYSBiYWxhbmNlIG9mICR7Y3JlZGl0c051bX0uYCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGNyZWRpdHNOdW0gLT0gYW1vdW50OwogICAgICAgIGJhbGFuY2UuY3JlZGl0cyA9IGNyZWRpdHNOdW0udG9TdHJpbmcoKTsKCiAgICAgICAgY29uc3QgcmVzdWx0OiBBQlhQRVBheW91dFJlc3VsdFN1Y2Nlc3MgPSB7IHN1Y2Nlc3M6IHRydWUsIHBheUFtb3VudDogYW1vdW50LCBjdXJDcmVkaXRzOiBjcmVkaXRzTnVtLCBzb3VyY2VJZCB9OwogICAgICAgIHNob3V0KCdvbkFCWFBFUGFpZE91dCcsIHJlc3VsdCk7CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IHJlc3VsdDogQUJYUEVQYXlvdXRSZXN1bHRGYWlsdXJlID0geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3JDb2RlOiAnbW9ja19pbnN1ZmZpY2llbnRfZnVuZHMnLCBlcnJvck1lc3NhZ2U6ICdVc2VyIGhhcyBpbnN1ZmZpY2llbnQgZnVuZHMuJywgc291cmNlSWR9OwogICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9Cn0gZWxzZSB7CiAgICBjb25zdCByZXNwb25zZTogR2VuZXJpY1Jlc3VsdDx2b2lkLCBTaW1wbGVFcnJvcj4gPSBhd2FpdCB4cC5wYXlvdXQoeyBhbW91bnQsIGRlc3RpbmF0aW9uIH0pOwogICAgY29uc3QgY3VyQ3JlZGl0cyA9IGF3YWl0IHRoaXNCb3QuZ2V0Q3JlZGl0cygpOwoKICAgIGlmIChyZXNwb25zZS5zdWNjZXNzKSB7CiAgICAgICAgY29uc3QgcmVzdWx0OiBBQlhQRVBheW91dFJlc3VsdFN1Y2Nlc3MgPSB7IHN1Y2Nlc3M6IHRydWUsIHBheUFtb3VudDogYW1vdW50LCBjdXJDcmVkaXRzLCBzb3VyY2VJZCB9OwogICAgICAgIHNob3V0KCdvbkFCWFBFUGFpZE91dCcsIHJlc3VsdCk7CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IHJlc3VsdDogQUJYUEVQYXlvdXRSZXN1bHRGYWlsdXJlID0geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3JDb2RlOiByZXBzb25zZS5lcnJvckNvZGUsIGVycm9yTWVzc2FnZTogcmVzcG9uc2UuZXJyb3JNZXNzYWdlLCBzb3VyY2VJZCB9OwoKICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgfQp9CgoKJwCL/OGXC/JZBG1vY2sCBACL/OGXC6BuBHRydWUnAIv84ZcL8lkFZGVidWcCBACL/OGXC6VuBHRydWUnAIv84ZcL8lkFdHlwZXMCBACL/OGXC6pu3gPwn5OEaW50ZXJmYWNlIEFCWFBFUGF5b3V0UGFyYW1zIGV4dGVuZHMgQVBJUGF5b3V0UmVxdWVzdCB7CiAgICBhbW91bnQ6IG51bWJlcjsKICAgIGRlc3RpbmF0aW9uOiAnc3RyaXBlJyB8ICdjYXNoJzsKICAgIHNvdXJjZUlkPzogc3RyaW5nCn0KCnR5cGUgQUJYUEVQYXlvdXRSZXN1bHQgPSBBQlhQRVBheW91dFJlc3VsdFN1Y2Nlc3MgfCBBQlhQRVBheW91dFJlc3VsdEZhaWx1cmU7CgppbnRlcmZhY2UgQUJYUEVQYXlvdXRSZXN1bHRTdWNjZXNzIHsKICAgIHN1Y2Nlc3M6IHRydWU7CiAgICBwYXlBbW91bnQ6IG51bWJlcjsKICAgIGN1ckNyZWRpdHM6IG51bWJlcjsKICAgIHNvdXJjZUlkPzogc3RyaW5nOwp9CgppbnRlcmZhY2UgQUJYUEVQYXlvdXRSZXN1bHRGYWlsdXJlIHsKICAgIHN1Y2Nlc3M6IGZhbHNlOwogICAgZXJyb3JDb2RlOiBzdHJpbmc7CiAgICBlcnJvck1lc3NhZ2U6IHN0cmluZzsKICAgIHNvdXJjZUlkPzogc3RyaW5nOwp9JwCL/OGXC/JZA2d1aQIEAIv84ZcLh3Io8J+UlzY2YzljN2RmLWQ4NDItNGJhNC04ZWM1LTBkNDk1ZWVmMWQwYycBBGJvdHMkZDdkZjNlMDUtZDliOS00YTc0LTkxZTMtYWY4MGExYWYzNWEwAScAi/zhlwuucgZzeXN0ZW0CBACL/OGXC69yDmFiLnhwZS52ZXJzaW9uJwCL/OGXC65yCGFiSWdub3JlAgQAi/zhlwu+cgR0cnVlJwCL/OGXC65yBGZvcm0CBACL/OGXC8NyB25vdGhpbmcnAIv84ZcLrnIFYWJYUEUCBACL/OGXC8tyBHRydWUnAIv84ZcLrnIRYWJYUEVNYWpvclZlcnNpb24CBACL/OGXC9ByATAnAIv84ZcLrnIJYWJWZXJzaW9uAgQAi/zhlwvScgUxMC40MCcAi/zhlwuucg1vblNraWxsVXBkYXRlAgQAi/zhlwvYcpQBQGNvbnN0IHZlcnNpb25TdHJpbmcgPSB0YWdzLmFiWFBFTWFqb3JWZXJzaW9uICsgIi4iICsgdGFncy5hYlhQRU1pbm9yVmVyc2lvbjsKY29uc29sZS5sb2coIltBQlhQRV0gTG9hZGVkIEFCIFhQIEV4Y2hhbmdlIHZlcnNpb24gIiArIHZlcnNpb25TdHJpbmcpOycAi/zhlwuuchFhYlhQRU1pbm9yVmVyc2lvbgIEAIv84ZcL7XMBNQA="}]}