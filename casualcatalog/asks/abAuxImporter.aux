{"version":1,"state":{"d3979f5e-7028-4f17-be9b-aeb056a3e9f8":{"id":"d3979f5e-7028-4f17-be9b-aeb056a3e9f8","space":"shared","tags":{"creator":"34c3c210-5bf1-49cf-b151-ee2d07f0e673","home":true,"onClick":"@shout(\"abMenuRefresh\");\r\nshout('abAuxImporterMenuReset');\r\n\r\nthisBot.animateSpin();\r\n\r\nconfigBot.tags.menuPortal = \"abAuxImporterMenu\";\r\n\r\nab.links.menu.abCreateMenuButton({\r\n    label: 'import .aux from file(s)',\r\n    formAddress: 'upload_file',\r\n    manager: getLink(thisBot),\r\n    abAuxImporterMenu: true,\r\n    abAuxImporterMenuReset: ListenerString(() => {\r\n        destroy(thisBot);\r\n    }),\r\n    onClick: ListenerString(async () => {\r\n        links.manager.onUploadFileClick();\r\n        shout('abAuxImporterMenuReset');\r\n    }),\r\n})","system":"abAuxImporter.wizard","remember":"ðŸ”—e5380a6b-8b4d-4a8b-8b04-58e1eb03e5e7","homeX":-1,"homeY":8,"onGridClick":"@shout(\"abAuxImporterMenuReset\")","formOpacity":"0.33","strokeColor":"black","animateSpin":"@clearAnimations(thisBot);\n\nconst dimension = configBot.tags.mapPortal ?? configBot.tags.gridPortal;\nlet currentRotZ = tags[dimension + 'RotationZ'] ?? 0;\n\nfunction getNextOrthogonalSpin(currentRotZ) {\n    const HALF_TURN = Math.PI;\n    const QUARTER_TURN = Math.PI / 2;\n\n    const minTarget = currentRotZ + HALF_TURN;\n    const nextMultiple = Math.ceil(minTarget / QUARTER_TURN) * QUARTER_TURN;\n    return nextMultiple;\n}\n\nconst targetRotZ = getNextOrthogonalSpin(currentRotZ);\n\nawait animateTag(thisBot, {\n    fromValue: {\n        [dimension + 'RotationZ']: currentRotZ,\n    },\n    toValue: {\n        [dimension + 'RotationZ']: targetRotZ,\n    },\n    easing: {\n        type: \"sinusoidal\",\n        mode: \"inout\"\n    },\n    duration: 0.5,\n    tagMaskSpace: 'tempLocal',\n}).catch(() => {});\n\nmasks[dimension + 'RotationZ'] = null;","cursor":"pointer","labelPosition":"floatingBillboard","labelWordWrapMode":"none","scale":"0.9","abVersion":"10.43","abIgnore":true,"onEggHatch":"@if (that.eggParameters) {\r\n    const dimension = that.eggParameters.gridInformation?.dimension ?? 'home';\r\n    const dimensionX = that.eggParameters.gridInformation?.position?.x ?? 0;\r\n    const dimensionY = that.eggParameters.gridInformation?.position?.y ?? 0;\r\n\r\n    tags[dimension] = true;\r\n    tags[dimension + 'X'] = dimensionX;\r\n    tags[dimension + 'Y'] = dimensionY;\r\n}\r\n\r\ntags.color = ab.links.personality.tags.abBaseColor;\r\ntags.strokeColor = ab.links.personality.tags.abBaseStrokeColor;\r\ntags.labelFloatingBackgroundColor = ab.links.personality.tags.abBaseColor;\r\ntags.labelColor = ab.links.personality.tags.abBaseLabelColor;\r\n\r\nthisBot.onClick();","onDestroy":"@shout('abAuxImporterMenuReset');","soundClick":"true","destroyAfterUse":"true","label":"aux importer","abAuxImporter":"true","onABAdded":"@if (thisBot.vars.filesToUpload) {\n    if (that.sourceEvent === 'file_upload') {\n        const entry = thisBot.vars.filesToUpload.find(e => e.name === that.ab);\n\n        if (entry) {\n            entry.success = true;\n        }\n    }\n}","onUploadFileClick":"@const files = await os.showUploadFiles();\n\nthisBot.vars.filesToUpload = [];\n\nconst auxFiles = files.filter((file) => {\n    if (file.name.endsWith('.aux')) {\n        const basename = file.name.slice(0, -4);\n\n        thisBot.vars.filesToUpload.push({\n            name: basename,\n            file: file,\n            success: false,\n        });\n\n        return true;\n    }\n\n    return false;\n});\n\nif (thisBot.vars.filesToUpload.length > 0) {\n    for (const fileToUpload of thisBot.vars.filesToUpload) {\n        try {\n            // Go through ab input's onFileUpload so we get all the benefits of moving aux file data through the abCreateBots process.\n            await ab.links.input.onFileUpload({ file: fileToUpload.file });\n        } catch (e) {\n            ab.links.utils.abLog({ message: `Somehing went wrong uploading ${fileToUpload.name}. Error: ${ab.links.utils.getErrorMessage(e)}`, logType: 'error'});\n        }\n    }\n}\n\nawait os.sleep(250);\n\nconst uploadedFilenames = thisBot.vars.filesToUpload.map((file) => {\n    if (file.success) {\n        return file.name;\n    }\n}).filter(n => n != null);\n\nif (uploadedFilenames.length > 0) {\n    ab.links.utils.abLogAndToast(`Imported ${uploadedFilenames.length} aux ${uploadedFilenames.length > 1 ? 'files' : 'file'}: ${uploadedFilenames.join(', ')}`);\n}\n\nif (tags.destroyAfterUse && uploadedFilenames.length > 0) {\n    destroy(thisBot);\n}","abIDOrigin":"abAuxImporter","homeZ":0,"color":"black","labelFloatingBackgroundColor":"black","labelColor":"white"}}}}