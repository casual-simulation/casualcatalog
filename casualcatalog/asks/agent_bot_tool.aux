{"version":1,"state":{"005fb751-3aad-467a-992e-16dd6279debe":{"id":"005fb751-3aad-467a-992e-16dd6279debe","space":"shared","tags":{"creator":"bdbeef26-8eb0-494e-b5df-94114c7f6155","abAgent":"true","abMenuRefresh":"@thisBot.agentReset();","abVersion":"10.35","agentOnRequest":"@thisBot.agentReset();\n\nlet inquiry = that.inquiry ?? that;\n\nconst abAskBot = ab.links.ask;\n\nabAskBot.masks.gptActive = true;\n\nconst data = {\n    dimension: that.data?.armDimension,\n    dimensionX: that.data?.armDimensionX,\n    dimensionY: that.data?.armDimensionY,\n    bot: links.targetBot?.id,\n    bots: that.data?.bots,\n}\n\nconst prevLabel = tags.label;\ntags.label = null;\n\nabAskBot.askGPT({\n    inquiry,\n    prompt: tags.promptType,\n    model: tags.aiModel,\n    abBot: thisBot,\n    abDimension: tags.dimension,\n    abPosition: getBotPosition(thisBot, tags.dimension),\n    data,\n})\n\n// Wait some amount of time before bringing bot label back.\nawait os.sleep(1600 + 250);\ntags.label = prevLabel;","agentReset":"@if (masks.armBot) {\n    destroy(links.armBot);\n    masks.armBot = null;\n}\n\nclearTagMasks(thisBot);\n\nshout('onABAIAgentReset');\n\nif (globalThis.abRemember) {\n    abRemember.masks.abBuilderIdentity = null;\n}","aiModel":"unset","askAgent":"@const menuPortal = configBot.tags.menuPortal ?? \"menu\";\n\nif (!configBot.tags.menuPortal) {\n    configBot.tags.menuPortal = menuPortal;\n}\n\nif (thisBot.vars.inputBot) {\n    destroy(thisBot.vars.inputBot);\n    thisBot.vars.inputBot = null;\n}\n\nthisBot.vars.inputBot = ab.links.menu.abCreateMenuInput({\n    [menuPortal]: true,\n    dimension: menuPortal,\n    label: `ask ${tags.aiModel}`,\n    color: tags.menuColor,\n    labelColor: 'black',\n    promptType: that.prompt,\n    agentBotId: thisBot.id,\n    agentBot: getLink(thisBot),\n    onABAIAgentReset: `@destroy(thisBot)`,\n    onSubmit: `@\n        links.agentBot.masks.promptType = tags.promptType;\n        links.agentBot.onSubmit(that);\n    `,\n    onAnyBotsRemoved: `@\n        const { botIDs } = that;\n\n        if (botIDs.includes(tags.agentBotId)) {\n            shout('onABAIAgentReset');\n        }\n    `,\n})\n\nif (that.bot && that.prompt === \"bot\") {\n    masks.targetBot = getLink(that.bot);\n}\n\nabRemember.masks.abBuilderIdentity = tags.aiModel;\n\nthisBot.animateSpin();","botChat":"@const dimension = configBot.tags.gridPortal;\nconst message = that.message;\nconst messageTime = that.time ? that.time * 1000 : 1600; \n\nab.links.manifestation.abBotChat({\n    bot: thisBot,\n    dimension,\n    message,\n    messageTime,\n});\n\n// await os.sleep(messageTime + 250);\n\n// thisBot.updateBillboardLabel();","onClick":"@thisBot.askAgent({ prompt: \"core\" });","onSubmit":"@console.log(`[${tags.system}.${tagName}] that:`, that);\n\nconst requestData = {};\nconst activeDimension = that.dimension ?? configBot.tags.gridPortal;\n\nif (links.armBot) {\n    const armBot = links.armBot;\n    const armDimension = armBot.tags.dimension;\n\n    requestData.armDimension = armDimension;\n    requestData.armDimensionX = armBot.tags[armDimension + \"X\"];\n    requestData.armDimensionY = armBot.tags[armDimension + \"Y\"];\n}\n\nconst inquiry = that.text;\n\nconst aiRequest = await thisBot.agentOnRequest({inquiry, data: requestData, model: tags.aiModel});","system":"agent_bot_tool.model","agent_bot_tool":"true","abIgnore":true,"abIDOrigin":"agent_bot_tool","animateSpin":"@clearAnimations(thisBot);\n\nconst dimension = configBot.tags.mapPortal ?? configBot.tags.gridPortal;\nlet currentRotZ = tags[dimension + 'RotationZ'] ?? 0;\n\nconst FULL_TURN = Math.PI * 2;\n\nconst nextZeroEquivalent = Math.ceil(currentRotZ / FULL_TURN) * FULL_TURN;\nconst targetRotZ = nextZeroEquivalent + FULL_TURN;\n\nawait animateTag(thisBot, {\n    fromValue: {\n        [dimension + 'RotationZ']: currentRotZ,\n    },\n    toValue: {\n        [dimension + 'RotationZ']: targetRotZ,\n    },\n    easing: {\n        type: \"sinusoidal\",\n        mode: \"inout\"\n    },\n    duration: 1,\n    tagMaskSpace: 'tempLocal',\n}).catch(() => {});\n\nmasks[dimension + 'RotationZ'] = null;","cursor":"pointer","armSelection":"true","onArmSelectedBots":"@const selectedBots = that;\n\nassert(!Array.isArray(selectedBots), `[${tags.system}.${tagName}] agent bots are not currently designed to support multi-selected bots. Support must be added.`);\n\nthisBot.askAgent({ prompt: \"bot\", bot: selectedBots });","onArmPlaced":"@thisBot.askAgent({ prompt: \"grid\" });","armMultiSelect":"false","onArmDestroy":"@thisBot.agentReset();","onGridClick":"@thisBot.agentReset();","listening":"false"}},"8aad6740-3981-4e48-b014-79e3ae4f00c8":{"id":"8aad6740-3981-4e48-b014-79e3ae4f00c8","space":"shared","tags":{"creator":"34c3c210-5bf1-49cf-b151-ee2d07f0e673","destroyAfterUse":"true","home":true,"onClick":"@const {\r\n    dimension = configBot.tags.mapPortal ?? configBot.tags.gridPortal\r\n} = that ?? {}\r\n\r\nif (!dimension) {\r\n    return;\r\n}\r\n\r\nshout(\"abMenuRefresh\");\r\nshout('clearAiKitAgentBotMenu');\r\n\r\nconfigBot.tags.menuPortal = \"ai_kit_bot_menu\";\r\n\r\nconst menuOptions = {\r\n    ai_kit_bot_menu: true,\r\n    color: 'white',\r\n}\r\n\r\nconst aiMenu = {\r\n    onClick: `@`,\r\n    ...menuOptions,\r\n    groupSortOrder: 1,\r\n    clearAiKitAgentBotMenu: `@destroy(this);`\r\n}\r\n\r\nconst aiChatModels = configBot.tags.aiChatModels ?? [];\r\n\r\nif (aiChatModels.length > 0) {\r\n    const providerDropdowns = {};\r\n\r\n    for (let i = 0; i < aiChatModels.length; ++i) {\r\n        let dropdown = providerDropdowns[aiChatModels[i].provider];\r\n\r\n        if (!dropdown) {\r\n            dropdown = {\r\n                menuItemType: \"dropdown\",\r\n                label: aiChatModels[i].provider,\r\n                dropdownOptions: []\r\n            }\r\n\r\n            providerDropdowns[aiChatModels[i].provider] = dropdown;\r\n        }\r\n        \r\n        const option = {\r\n            label: aiChatModels[i].name,\r\n            aiProvider: aiChatModels[i].provider,\r\n            aiModel: aiChatModels[i].name,\r\n            color: 'white',\r\n            botGen: await getLink(thisBot),\r\n            dimension,\r\n            onClick: `@\r\n                links.botGen.createAIAgent({\r\n                    dimension: tags.dimension,\r\n                    aiModel: tags.aiModel,\r\n                    aiProvider: tags.aiProvider\r\n                });\r\n            `,\r\n        }\r\n\r\n        dropdown.dropdownOptions.push(option);\r\n    }\r\n\r\n    const menuItems = [];\r\n    for (let provider in providerDropdowns) {\r\n        menuItems.push(providerDropdowns[provider]);\r\n    }\r\n    aiMenu[\"menuItems\"] = menuItems;\r\n\r\n    ab.links.menu.abCreateMenuGroup(aiMenu);\r\n} else {\r\n    if (authBot) {\r\n        os.showAlert({\r\n            title: 'something went wrong',\r\n            content: 'failed to get list of ai chat models.'\r\n        })\r\n    } else {\r\n        os.showAlert({\r\n            title: 'sign in required',\r\n            content: 'you must sign in to use ai.'\r\n        })\r\n    }\r\n}\r\n\r\nthisBot.animateSpin();","system":"agent_bot_tool.maker","remember":"ðŸ”—e5380a6b-8b4d-4a8b-8b04-58e1eb03e5e7","homeX":-3,"homeY":12,"onGridClick":"@shout(\"clearAiKitAgentBotMenu\")","createAIAgent":"@const { dimension, aiModel, aiProvider } = that;\r\n\r\nshout(\"clearAiKitAgentBotMenu\");\r\n\r\nconst agentConfig = tags.agentConfigs[aiProvider] ?? tags.agentConfigs['default'];\r\n\r\nconst botTags = {\r\n    abIDOrigin: null,\r\n    abIgnore: true,\r\n    aiModel,\r\n    aiProvider,\r\n    ai_toolbox: null,\r\n    listening: true,\r\n    menuColor: agentConfig.themeColor,\r\n    armColor: agentConfig.themeColor,\r\n    armMeshPath: agentConfig.armMeshPath,\r\n    scale: agentConfig.scale,\r\n    system: \"ai.agent.\" + aiModel\r\n}\r\n\r\nif (agentConfig.meshPath) {\r\n    if (agentConfig.meshPath.startsWith('https://')) {\r\n        botTags.formAddress = agentConfig.meshPath;\r\n    } else {\r\n        botTags.formAddress = ab.abBuildCasualCatalogURL(agentConfig.meshPath);\r\n    }\r\n\r\n    botTags.form = 'mesh';\r\n    botTags.formSubtype = 'gltf';\r\n} else {\r\n    botTags.form = 'cube';\r\n    botTags.strokeWidth = 1;\r\n    botTags.strokeColor = agentConfig.themeColor;\r\n    botTags.color = 'clear';\r\n}\r\n\r\nif (agentConfig.showName) {\r\n    botTags.label = aiModel;\r\n    botTags.labelPosition = 'floatingBillboard';\r\n    botTags.labelFloatingBackgroundColor = agentConfig.themeColor;\r\n    botTags.labelWordWrapMode = 'none';\r\n}\r\n\r\nconst dimensionX = thisBot.tags[dimension + 'X'] ?? 0;\r\nconst dimensionY = thisBot.tags[dimension + 'Y'] ?? 0;\r\n\r\nbotTags.dimension = dimension;\r\nbotTags[dimension] = true;\r\nbotTags[dimension + 'X'] = dimensionX;\r\nbotTags[dimension + 'Y'] = dimensionY;\r\n\r\nconst agentModel = getBot(\"system\", \"agent_bot_tool.model\");\r\n\r\nif (agentModel) {\r\n    const bot = await create(agentModel, botTags);\r\n\r\n    if (bot && tags.destroyAfterUse) {\r\n        destroy(agentModel);\r\n        destroy(thisBot);\r\n    }\r\n}\r\n\r\n","formOpacity":"0.33","strokeColor":"white","animateSpin":"@clearAnimations(thisBot);\n\nconst dimension = configBot.tags.mapPortal ?? configBot.tags.gridPortal;\nlet currentRotZ = tags[dimension + 'RotationZ'] ?? 0;\n\nfunction getNextOrthogonalSpin(currentRotZ) {\n    const HALF_TURN = Math.PI;\n    const QUARTER_TURN = Math.PI / 2;\n\n    const minTarget = currentRotZ + HALF_TURN;\n    const nextMultiple = Math.ceil(minTarget / QUARTER_TURN) * QUARTER_TURN;\n    return nextMultiple;\n}\n\nconst targetRotZ = getNextOrthogonalSpin(currentRotZ);\n\nawait animateTag(thisBot, {\n    fromValue: {\n        [dimension + 'RotationZ']: currentRotZ,\n    },\n    toValue: {\n        [dimension + 'RotationZ']: targetRotZ,\n    },\n    easing: {\n        type: \"sinusoidal\",\n        mode: \"inout\"\n    },\n    duration: 0.5,\n    tagMaskSpace: 'tempLocal',\n}).catch(() => {});\n\nmasks[dimension + 'RotationZ'] = null;","cursor":"pointer","onCreate":"@tags.abIgnore = true;\r\nthisBot.onClick();","agentConfigs":"ðŸ§¬{\n    \"openai\": {\n        \"meshPath\": \"/ab/meshes/casualBot_chatGPT_01.glb\",\n        \"armMeshPath\": \"/ab/meshes/webslinger.glb\",\n        \"themeColor\": \"#76a298\",\n        \"scale\": 0.9999,\n        \"formOpacity\": null,\n        \"showName\": false\n    },\n    \"google\": {\n        \"meshPath\": \"/ab/meshes/casualBot_gemini_01.glb\",\n        \"armMeshPath\": \"/ab/meshes/webslinger.glb\",\n        \"themeColor\": \"#3187ea\",\n        \"scale\": 0.9999,\n        \"formOpacity\": null,\n        \"showName\": false\n    },\n    \"anthropic\": {\n        \"meshPath\": \"/ab/meshes/casualBot_claude_01.glb\",\n        \"armMeshPath\": \"/ab/meshes/webslinger.glb\",\n        \"themeColor\": \"#d4825a\",\n        \"scale\": 0.9999,\n        \"formOpacity\": null,\n        \"showName\": false\n    },\n    \"default\": {\n        \"meshPath\": null,\n        \"armMeshPath\": null,\n        \"themeColor\": \"gold\",\n        \"scale\": 0.9,\n        \"formOpacity\": 0.33,\n        \"showName\": true\n    }\n}","label":"make an agent","labelPosition":"floatingBillboard","labelWordWrapMode":"none","scale":"0.9","agent_bot_tool":"true","abVersion":"10.35","abIgnore":true,"onEggHatch":"@if (that.eggParameters) {\r\n    const dimension = that.eggParameters.gridInformation?.dimension ?? 'home';\r\n    const dimensionX = that.eggParameters.gridInformation?.position?.x ?? 0;\r\n    const dimensionY = that.eggParameters.gridInformation?.position?.y ?? 0;\r\n\r\n    tags[dimension] = true;\r\n    tags[dimension + 'X'] = dimensionX;\r\n    tags[dimension + 'Y'] = dimensionY;\r\n}","abIDOrigin":"agent_bot_tool","homeZ":0}}}}