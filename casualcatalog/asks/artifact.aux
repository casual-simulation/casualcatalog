{"version":1,"state":{"e563f276-8a61-453e-b082-924ecaf90ac2":{"id":"e563f276-8a61-453e-b082-924ecaf90ac2","space":"shared","tags":{"system":"place_toolbox.tools.artifact","onClick":"@if (that) {\r\n    if (that.modality == 'mouse' && that.buttonId == 'right') {\r\n        return;\r\n    }\r\n}\r\n\r\nshout('abMenuRefresh');\r\nshout('clearArtifactMenu');\r\n\r\nconfigBot.tags.menuPortal = 'artifact_menu';\r\n\r\nconst menuOptions = {\r\n    artifact_menu: true,\r\n    clearArtifactMenu: `@destroy(thisBot);`,\r\n    abMenuRefresh: \"@ destroy(thisBot);\",\r\n    art: getLink(thisBot)\r\n}\r\n\r\nconst nameButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'name this artifact',\r\n    artifact_menuSortOrder: 1,\r\n    onClick: `@\r\n        const newName = await os.showInput(links.art.tags.artifactName ?? '', {\r\n        autoSelect: true,\r\n        title: 'Name this artifact'\r\n    });\r\n\r\n    links.art.tags.artifactName = newName;\r\n    links.art.tags.placeLabel = newName;\r\n    links.art.updateBillboardLabel();\r\n    \r\n    links.art.onClick();\r\n    `\r\n}\r\n\r\nconst descButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'add a description',\r\n    artifact_menuSortOrder: 2,\r\n    onClick: `@\r\n        const newDesc = await os.showInput(links.art.tags.artifactDescription ?? '', {\r\n        autoSelect: true,\r\n        title: 'describe this artifact'\r\n    });\r\n\r\n    links.art.tags.artifactDescription = newDesc;\r\n    links.art.onClick();\r\n    `\r\n}\r\n\r\nconst landmarkButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'add a landmark',\r\n    artifact_menuSortOrder: 3,\r\n    onClick: `@\r\n        const newLand = await os.showInput('', {\r\n        autoSelect: true,\r\n        title: 'provide a landmarkID'\r\n    });\r\n\r\n    links.art.addLandmark(newLand);\r\n    links.art.onClick();\r\n    `\r\n}\r\n\r\nconst collectionButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'provide a collection ID',\r\n    artifact_menuSortOrder: 4,\r\n    onClick: `@\r\n        const newID = await os.showInput(links.art.tags.collectionID ?? '', {\r\n        autoSelect: true,\r\n        title: 'provide a collectionID'\r\n    });\r\n\r\n    links.art.collectionID = newID;\r\n    links.art.onClick();\r\n    `\r\n}\r\n\r\nconst imageButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'provide an image',\r\n    artifact_menuSortOrder: 5,\r\n    onClick: `@\r\n        const newImg = await os.showInput('', {\r\n        autoSelect: true,\r\n        title: 'provide an image'\r\n    });\r\n\r\n    links.art.tags.artifactImage = newImg;\r\n    links.art.tags.formAddress = newImg;\r\n    links.art.tags.form = \"sprite\";\r\n    links.art.onClick();\r\n    `\r\n}\r\n\r\nconst addLinkButton = {\r\n    ...menuOptions,\r\n    formAddress: 'link',\r\n    label: 'add a link',\r\n    artifact_menuSortOrder: 6,\r\n    onClick: `@\r\n        const link = await os.showInput(links.art.tags.artifactLink ?? '', {\r\n        autoSelect: true,\r\n        title: 'add a link'\r\n    });\r\n    \r\n    links.art.tags.artifactLink = link;\r\n    \r\n    links.art.onClick();\r\n    `\r\n}\r\n\r\nconst lockButton = {\r\n    ...menuOptions,\r\n    formAddress: 'lock',\r\n    label: 'lock artifact',\r\n    artifact_menuSortOrder: 100,\r\n    onClick: `@\r\n        links.art.tags.artifactLocked = true;\r\n        links.art.onClick();\r\n    `\r\n}\r\n\r\nconst nameTag = {\r\n    ...menuOptions,\r\n    label: tags.artifactName,\r\n    color: ab.links.personality.tags.abBaseMenuColor,\r\n    artifact_menuSortOrder: 1\r\n}\r\n\r\nconst visitLinkButton = {\r\n    ...menuOptions,\r\n    formAddress: 'link',\r\n    label: tags.artifactLink,\r\n    artifact_menuSortOrder: 2,\r\n    onClick: `@\r\n        os.openURL(links.artifact.tags.artifactLink);\r\n        shout('clearArtifactMenu');\r\n    `\r\n}\r\n\r\nif (!tags.artifactLocked) {\r\n    ab.links.menu.abCreateMenuButton(nameButton);\r\n    ab.links.menu.abCreateMenuButton(descButton);\r\n    ab.links.menu.abCreateMenuButton(landmarkButton);\r\n    ab.links.menu.abCreateMenuButton(collectionButton);\r\n    ab.links.menu.abCreateMenuButton(imageButton);\r\n    ab.links.menu.abCreateMenuButton(addLinkButton);\r\n    ab.links.menu.abCreateMenuButton(lockButton);\r\n\r\n} else {\r\n    ab.links.menu.abCreateMenuText(nameTag);\r\n    if (tags.artifactLink) {\r\n       ab.links.menu.abCreateMenuButton(visitLinkButton); \r\n    }\r\n}\r\n","cursor":"pointer","abVersion":"10.6","abIDOrigin":"artifact","labelWordWrapMode":"breakWords","onGridClick":"@shout('clearArtifactMenu');","navigation":"ðŸ”—3a6cb9ca-b3b4-4d77-82f6-fa59b5296ec9","homeWorldBot":"true","abArtifactName":"artifact","onABArtifactCollectShards":"@const shard: ABArtifactShard = {\r\n    data: {\r\n        homeBase: tags.homeBase,\r\n        label: tags.placeLabel,\r\n        dimensionData: {\r\n            dimension: ab.links.remember.tags.abActiveDimension,\r\n            [ab.links.remember.tags.abActiveDimension]: tags[ab.links.remember.tags.abActiveDimension],\r\n            [ab.links.remember.tags.abActiveDimension + 'X']: tags[ab.links.remember.tags.abActiveDimension + 'X'],\r\n            [ab.links.remember.tags.abActiveDimension + 'Y']: tags[ab.links.remember.tags.abActiveDimension + 'Y'],\r\n            [ab.links.remember.tags.abActiveDimension + 'Z']: tags[ab.links.remember.tags.abActiveDimension + 'Z'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationX']: tags[ab.links.remember.tags.abActiveDimension + 'RotationX'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationY']: tags[ab.links.remember.tags.abActiveDimension + 'RotationY'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationZ']: tags[ab.links.remember.tags.abActiveDimension + 'RotationZ'],\r\n        },\r\n        scaleX: tags.scaleX,\r\n        scaleY: tags.scaleY,\r\n        scaleZ: tags.scaleZ,\r\n        color: tags.color,\r\n        labelFloatingBackgroundColor: tags.placeLabelFloatingBackgroundColor,\r\n        labelColor: tags.placeLabelColor,\r\n        form: tags.form,\r\n        formSubtype: tags.formSubtype,\r\n        formAddress: tags.formAddress,\r\n        formAddressAspectRatio: tags.formAddressAspectRatio,\r\n        artifactName: tags.artifactName,\r\n        artifactLink: tags.artifactLink,\r\n        landmarkIDs: tags.landmarkIDs,\r\n        artifactID: tags.artifactID,\r\n        artifactImage: tags.artifactImage,\r\n        artifactDescription: tags.artifactDescription,\r\n        collectionID: tags.collectionID,\r\n        realArtifactImage: tags.realArtifactImage,\r\n        artifactYear: tags.artifactYear\r\n    },\r\n    dependencies: [\r\n        {\r\n            askID: 'artifact'\r\n        }\r\n    ]\r\n}\r\n\r\nreturn shard;","onABArtifactReconstitute":"@const data = that.data;\r\n\r\ntags.placeLabel = data.label ?? 'artifact';\r\ntags.scaleX = data.scaleX;\r\ntags.scaleY = data.scaleY;\r\ntags.scaleZ = data.scaleZ;\r\ntags.color = data.color ?? abPersonality?.tags?.abBaseColor ?? '#00D9CD';\r\ntags.placeLabelFloatingBackgroundColor = data.labelFloatingBackgroundColor ?? abPersonality?.tags?.abBaseColor ?? '#00D9CD'; \r\ntags.placeLabelColor = data.labelColor ?? abPersonality?.tags?.abBaseLabelColor ?? 'black';\r\ntags.form = data.form;\r\ntags.formSubtype = data.formSubtype;\r\ntags.formAddress = data.formAddress;\r\ntags.formAddressAspectRatio = data.formAddressAspectRatio;\r\ntags.artifactName = data.artifactName;\r\ntags.artifactLink = data.artifactLink;\r\ntags.landmarkIDs = data.landmarkIDs;\r\ntags.artifactID = data.artifactID ?? uuid();\r\ntags.artifactImage = data.artifactImage;\r\ntags.realArtifactImage = data.realArtifactImage;\r\ntags.artifactDescription = data.artifactDescription;\r\ntags.artifactYear = data.artifactYear;\r\ntags.collectionID = data.collectionID;\r\ntags.collectable = false;\r\ntags.pointable = false;\r\n\r\nif (data.dimensionData) {\r\n    for (const tagName in data.dimensionData) {\r\n        tags[tagName] = data.dimensionData[tagName];\r\n    }\r\n}\r\n\r\nif (data.eggParameters) {\r\n    const dimension = data.eggParameters.gridInformation?.dimension ?? 'home';\r\n    const dimensionX = data.eggParameters.gridInformation?.position?.x ?? 0;\r\n    const dimensionY = data.eggParameters.gridInformation?.position?.y ?? 0;\r\n\r\n    tags.dimension = dimension;\r\n    tags[dimension] = true;\r\n    tags[dimension + 'X'] = dimensionX;\r\n    tags[dimension + 'Y'] = dimensionY;\r\n\r\n    thisBot.onClick();\r\n}\r\n\r\nthisBot.updateBillboardLabel();","artifact":"ðŸ”—78e41503-c933-4f8a-817a-ba97bf8d5d27","learn":"ðŸ”—6657b865-e983-4401-9fc9-f5418d18a7f7","onBotChanged":"@const needUpdateBillboardLabel = that.tags.some(t => t === 'placeLabel' || t === 'placeLabelFloatingBackgroundColor' || t === 'placeLabelColor');\n\nif (needUpdateBillboardLabel && tags.ready) {\n    thisBot.updateBillboardLabel();\n}","updateBillboardLabel":"@if (thisBot.vars.billboardLabelBot) {\n    destroy(thisBot.vars.billboardLabelBot);\n    thisBot.vars.billboardLabelBot = null;\n}\n\nthisBot.vars.billboardLabelBot = ab.links.bot_factory.abCreateBillboardLabel({ \n    bot: thisBot, \n    label: tags.placeLabel,\n    color: tags.placeLabelFloatingBackgroundColor,\n    dimension: tags.dimension ?? 'home',\n    // botLabelMargin: 0,\n    labelColor: tags.placeLabelColor,\n    space: 'tempLocal',\n})","onBotAdded":"@let waitTime = 0;\n\nwhile(!globalThis.ab?.links.bot_factory) {\n    if (waitTime >= 5000) {\n        return;\n    }\n    \n    await os.sleep(250);\n    waitTime += 250;\n}\n\nmasks.ready = true;\n\nthisBot.updateBillboardLabel();","onABStripArtifactInstanceDataFromBotData":"@const { data } = that;\n\ndelete data.tags.placeLabel;\ndelete data.tags.placeLabelColor;\ndelete data.tags.placeLabelFloatingBackgroundColor;\ndelete data.tags.color;\ndelete data.tags.form ;\ndelete data.tags.formSubtype;\ndelete data.tags.formAddress;\ndelete data.tags.formAddressAspectRatio;\n\ndelete data.tags[data.tags.dimension + \"X\"];\ndelete data.tags[data.tags.dimension + \"Y\"];\ndelete data.tags[data.tags.dimension + \"Z\"];\ndelete data.tags[data.tags.dimension + \"RotationX\"];\ndelete data.tags[data.tags.dimension + \"RotationY\"];\ndelete data.tags[data.tags.dimension + \"RotationZ\"];\ndelete data.tags[data.tags.dimension];\ndelete data.tags.dimension;\n\ndelete data.tags.artifactName;\ndelete data.tags.artifactLink;\ndelete data.tags.landmarkIDs;\ndelete data.tags.artifactID;\ndelete data.tags.artifactImage;\ndelete data.tags.artifactDescription;\ndelete data.tags.collectionID;\ndelete data.tags.collectable;\ndelete data.tags.realArtifactImage;\ndelete data.tags.artifactYear;","onABOpenMenu":"@if (that.menuType != 'abBotMenu' || ab.links.remember.links.abBotFocus != thisBot) {\r\n    return;\r\n}\r\n\r\nconst menuOptions = {\r\n    abMenuRefresh: `@destroy(thisBot);`,\r\n    abMenu: true,\r\n    art: getLink(thisBot)\r\n}\r\n\r\nconst unlockButton = {\r\n    ...menuOptions,\r\n    formAddress: 'lock',\r\n    label: 'unlock',\r\n    onClick: `@\r\n        links.art.tags.artifactLocked = false;\r\n        shout('abMenuRefresh');\r\n        shout(\"clearArtifactMenu\");\r\n\r\n        links.art.onClick();\r\n    `\r\n}\r\n\r\nif (tags.artifactLocked) {\r\n    ab.links.menu.abCreateMenuButton(unlockButton); \r\n}","onBotNearLandmark":"@if (that.bot.tags.simAvatar && that.bot.tags.remoteID == getID(configBot)) {\r\n    if (tags.landmarkIDs && tags.landmarkIDs.length > 0 && tags.landmarkIDs.includes(that.landmarkID)) {\r\n        thisBot.showSelf(that.landmarkID);\r\n    }\r\n}","showSelf":"@const landmarkBot = getBot(\"landmarkID\", that);\r\n\r\nsetTagMask(thisBot, \"home\", true, \"tempLocal\");\r\nsetTagMask(thisBot, \"homeX\", landmarkBot.tags.homeX + (Math.random() * 2), \"tempLocal\");\r\nsetTagMask(thisBot, \"homeY\", landmarkBot.tags.homeY + (Math.random() * 2), \"tempLocal\");\r\nsetTagMask(thisBot, \"collectable\", true, \"tempLocal\");\r\nsetTagMask(thisBot, \"pointable\", true, \"tempLocal\");","addLandmark":"@const landmarkBot = getBot(\"landmarkID\", that);\r\n\r\nif (!landmarkBot) {\r\n    return;\r\n}\r\n\r\nif (!tags.landmarkIDs) {\r\n    tags.landmarkIDs = [];\r\n}\r\n\r\nif (!tags.landmarkIDs.includes(that)) {\r\n    tags.landmarkIDs.push(that);\r\n}","scaleX":1,"scaleY":1,"scaleZ":2,"pointable":false}}}}