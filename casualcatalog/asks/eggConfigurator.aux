{"version":1,"state":{"076a871c-76e9-42e2-af94-01564f600df6":{"id":"076a871c-76e9-42e2-af94-01564f600df6","space":"shared","tags":{"system":"egg_toolbox.tools.eggConfigurator","clearEggSetupMenu":"@configBot.masks.menuPortal = null;","onABArtifactCollectShards":"@const shard: ABArtifactShard = {\r\n    data: {\r\n        eggName: tags.chosenEggName,\r\n        eggSetupLabel: tags.channelSetupLabel,\r\n        dimensionData: {\r\n            [ab.links.remember.tags.abActiveDimension]: tags[ab.links.remember.tags.abActiveDimension],\r\n            [ab.links.remember.tags.abActiveDimension + 'X']: tags[ab.links.remember.tags.abActiveDimension + 'X'],\r\n            [ab.links.remember.tags.abActiveDimension + 'Y']: tags[ab.links.remember.tags.abActiveDimension + 'Y'],\r\n            [ab.links.remember.tags.abActiveDimension + 'Z']: tags[ab.links.remember.tags.abActiveDimension + 'Z'],\r\n        }\r\n    },\r\n    dependencies: [\r\n        {\r\n            askID: 'eggConfigurator'\r\n        }\r\n    ]\r\n}\r\n\r\nreturn shard;","onABArtifactReconstitute":"@const data = that.data;\r\n\r\ntags.chosenEggName = data.eggName;\r\ntags.eggSetupLabel = data.eggSetupLabel ?? \"configure egg\";\r\n\r\nif (data.dimensionData) {\r\n    for (const tagName in data.dimensionData) {\r\n        tags[tagName] = data.dimensionData[tagName];\r\n    }\r\n}\r\n\r\nif (data.eggParameters) {\r\n    const dimension = data.eggParameters.gridInformation?.dimension ?? 'home';\r\n    const dimensionX = data.eggParameters.gridInformation?.position?.x ?? 0;\r\n    const dimensionY = data.eggParameters.gridInformation?.position?.y ?? 0;\r\n\r\n    tags.dimension = dimension;\r\n    tags[dimension] = true;\r\n    tags[dimension + 'X'] = dimensionX;\r\n    tags[dimension + 'Y'] = dimensionY;\r\n\r\n    tags.eggSetupLabel = \"configure egg\";\r\n    thisBot.showEggSetupMenu();\r\n}\r\n\r\nthisBot.updateBillboardLabel();","onABStripArtifactInstanceDataFromBotData":"@const { data } = that;\r\n\r\ndelete data.tags.chosenEggName;\r\ndelete data.tags.eggSetupLabel;\r\ndelete data.tags[data.tags.dimension];\r\ndelete data.tags[data.tags.dimension + 'X'];\r\ndelete data.tags[data.tags.dimension + 'Y'];\r\ndelete data.tags[data.tags.dimension + 'Z'];\r\ndelete data.tags.dimension;","onAnyBotsRemoved":"@const { botIDs } = that;\r\n\r\nif (botIDs.includes(thisBot.id)) {\r\n    shout(\"clearEggSetupMenu\");\r\n}","onBotAdded":"@let waitTime = 0;\r\n\r\nwhile(!globalThis.ab?.links.bot_factory) {\r\n    if (waitTime >= 5000) {\r\n        return;\r\n    }\r\n    \r\n    await os.sleep(250);\r\n    waitTime += 250;\r\n}\r\n\r\nmasks.ready = true;\r\n\r\nthisBot.updateBillboardLabel();","onClick":"@thisBot.showEggSetupMenu();","onGridClick":"@shout(\"clearEggSetupMenu\");","showEggSetupMenu":"@shout('clearEggSetupMenu');\r\n\r\nconfigBot.masks.menuPortal = 'eggSetupMenu';\r\n\r\nconst menuTags = {\r\n    clearEggSetupMenu: `@destroy(thisBot);`,\r\n    eggSetupMenu: true,\r\n    eggConfigurator: getLink(thisBot)\r\n}\r\n\r\nconst eggNameButton = {\r\n    ...menuTags,\r\n    label: \"egg name: \" + (tags.chosenEggName || ''),\r\n    onClick: `@\r\n        const instName = await os.showInput(links.eggConfigurator.tags.chosenEggName || \"\", {\r\n            title: 'choose a name for your egg'\r\n        });\r\n\r\n        links.eggConfigurator.tags.chosenEggName = instName;\r\n        links.eggConfigurator.tags.eggSetupLabel = instName;\r\n        links.eggConfigurator.updateBillboardLabel();\r\n        links.eggConfigurator.showEggSetupMenu();\r\n    `,\r\n    eggSetupMenuSortOrder: 1\r\n}\r\n\r\nab.links.menu.abCreateMenuButton(eggNameButton);\r\n\r\nconst createButton = {\r\n    ...menuTags,\r\n    label: \"publish egg\",\r\n    onClick: `@\r\n        if (links.eggConfigurator.tags.chosenEggName) {\r\n            links.eggConfigurator.publishEggConfigurator();\r\n        } else {\r\n            os.toast(\"You must provide an egg name\");\r\n        }\r\n        \r\n    `,\r\n    eggSetupMenuSortOrder: 10,\r\n    \r\n}\r\n\r\nif (!tags.chosenEggName) {\r\n    createButton.menuItemStyle = {\r\n        filter: `brightness(50%)`\r\n    }\r\n}\r\n\r\nab.links.menu.abCreateMenuButton(createButton);","updateBillboardLabel":"@if (thisBot.vars.billboardLabelBot) {\r\n    destroy(thisBot.vars.billboardLabelBot);\r\n    thisBot.vars.billboardLabelBot = null;\r\n}\r\n\r\nthisBot.vars.billboardLabelBot = ab.links.bot_factory.abCreateBillboardLabel({ \r\n    bot: thisBot, \r\n    label: tags.channelSetupLabel,\r\n    color: tags.channelSetupLabelFloatingBackgroundColor,\r\n    dimension: configBot.tags.mapPortal ?? configBot.tags.gridPortal ?? 'home',\r\n    // botLabelMargin: 0,\r\n    labelColor: tags.channelSetupLabelColor,\r\n    space: 'tempLocal',\r\n})","abArtifactName":"eggConfigurator","artifact":"ðŸ”—78e41503-c933-4f8a-817a-ba97bf8d5d27","eggConfigurator":"true","form":"egg","eggSetupLabelColor":"black","eggSetupLabelFloatingBackgroundColor":"white","cursor":"pointer","publishEggConfigurator":"@console.log(\"[Egg Configurator]: publish, WIP\");"}}}}