{"version":1,"state":{"caad0260-a103-4e44-aa9b-cb0c22388549":{"id":"caad0260-a103-4e44-aa9b-cb0c22388549","space":"shared","tags":{"system":"place_toolbox.tools.landmark","onClick":"@if (that) {\r\n    if (that.modality == 'mouse' && that.buttonId == 'right') {\r\n        return;\r\n    }\r\n}\r\n\r\nshout('abMenuRefresh');\r\nshout('clearLandmarkMenu');\r\n\r\nconfigBot.tags.menuPortal = 'landmark_menu';\r\n\r\nconst menuOptions = {\r\n    landmark_menu: true,\r\n    clearLandmarkMenu: `@destroy(thisBot);`,\r\n    abMenuRefresh: \"@ destroy(thisBot);\",\r\n    place: getLink(thisBot)\r\n}\r\n\r\nconst nameButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'name this landmark',\r\n    landmark_menuSortOrder: 1,\r\n    onClick: `@\r\n        const newName = await os.showInput(links.place.tags.landmarkName ?? '', {\r\n        autoSelect: true,\r\n        title: 'Name this landmark'\r\n    });\r\n\r\n    links.place.tags.landmarkName = newName;\r\n    links.place.tags.placeLabel = newName;\r\n    links.place.updateBillboardLabel();\r\n    \r\n    links.place.onClick();\r\n    `\r\n}\r\n\r\nconst addLinkButton = {\r\n    ...menuOptions,\r\n    formAddress: 'link',\r\n    label: 'add a link',\r\n    landmark_menuSortOrder: 2,\r\n    onClick: `@\r\n        const link = await os.showInput(links.place.tags.landmarkLink ?? '', {\r\n        autoSelect: true,\r\n        title: 'add a link'\r\n    });\r\n    \r\n    links.place.tags.landmarkLink = link;\r\n    \r\n    links.place.onClick();\r\n    `\r\n}\r\n\r\nconst lockButton = {\r\n    ...menuOptions,\r\n    formAddress: 'lock',\r\n    label: 'lock landmark',\r\n    landmark_menuSortOrder: 3,\r\n    onClick: `@\r\n        links.place.tags.landmarkLocked = true;\r\n        links.place.onClick();\r\n    `\r\n}\r\n\r\nconst nameTag = {\r\n    ...menuOptions,\r\n    label: tags.landmarkName,\r\n    color: ab.links.personality.tags.abBaseMenuColor,\r\n    landmark_menuSortOrder: 1\r\n}\r\n\r\nconst visitLinkButton = {\r\n    ...menuOptions,\r\n    formAddress: 'link',\r\n    label: tags.landmarkLink,\r\n    landmark_menuSortOrder: 2,\r\n    onClick: `@\r\n        os.openURL(links.place.tags.landmarkLink);\r\n        shout('clearLandmarkMenu');\r\n    `\r\n}\r\n\r\nconst copyButton = {\r\n    ...menuOptions,\r\n    formAddress: 'copy',\r\n    label: 'copy id to clipboard',\r\n    landmark_menuSortOrder: 3,\r\n    onClick: `@\r\n        os.setClipboard(links.place.tags.landmarkID);\r\n        shout('clearLandmarkMenu');\r\n    `\r\n}\r\n\r\nif (!tags.landmarkLocked) {\r\n    ab.links.menu.abCreateMenuButton(nameButton);\r\n    ab.links.menu.abCreateMenuButton(addLinkButton);\r\n    ab.links.menu.abCreateMenuButton(lockButton);\r\n} else {\r\n    ab.links.menu.abCreateMenuText(nameTag);\r\n    if (tags.landmarkLink) {\r\n       ab.links.menu.abCreateMenuButton(visitLinkButton); \r\n    }\r\n    ab.links.menu.abCreateMenuText(copyButton);\r\n}\r\n","cursor":"pointer","abVersion":"10.6","abIDOrigin":"landmark","labelWordWrapMode":"breakWords","onGridClick":"@shout('clearLandmarkMenu');","navigation":"ðŸ”—3a6cb9ca-b3b4-4d77-82f6-fa59b5296ec9","homeWorldBot":"true","abArtifactName":"landmark","onABArtifactCollectShards":"@const shard: ABArtifactShard = {\r\n    data: {\r\n        homeBase: tags.homeBase,\r\n        label: tags.placeLabel,\r\n        dimensionData: {\r\n            dimension: ab.links.remember.tags.abActiveDimension,\r\n            [ab.links.remember.tags.abActiveDimension]: tags[ab.links.remember.tags.abActiveDimension],\r\n            [ab.links.remember.tags.abActiveDimension + 'X']: tags[ab.links.remember.tags.abActiveDimension + 'X'],\r\n            [ab.links.remember.tags.abActiveDimension + 'Y']: tags[ab.links.remember.tags.abActiveDimension + 'Y'],\r\n            [ab.links.remember.tags.abActiveDimension + 'Z']: tags[ab.links.remember.tags.abActiveDimension + 'Z'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationX']: tags[ab.links.remember.tags.abActiveDimension + 'RotationX'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationY']: tags[ab.links.remember.tags.abActiveDimension + 'RotationY'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationZ']: tags[ab.links.remember.tags.abActiveDimension + 'RotationZ'],\r\n        },\r\n        scaleX: tags.scaleX,\r\n        scaleY: tags.scaleY,\r\n        scaleZ: tags.scaleZ,\r\n        color: tags.color,\r\n        labelFloatingBackgroundColor: tags.placeLabelFloatingBackgroundColor,\r\n        labelColor: tags.placeLabelColor,\r\n        form: tags.form,\r\n        formSubtype: tags.formSubtype,\r\n        formAddress: tags.formAddress,\r\n        formAddressAspectRatio: tags.formAddressAspectRatio,\r\n        landmarkName: tags.landmarkName,\r\n        landmarkLink: tags.landmarkLink,\r\n        landmarkLocked: tags.landmarkLocked,\r\n        landmarkID: tags.landmarkID,\r\n        landmarkImg: tags.landmarkImg,\r\n        landmarkDesc: tags.landmarkDesc\r\n    },\r\n    dependencies: [\r\n        {\r\n            askID: 'landmark'\r\n        }\r\n    ]\r\n}\r\n\r\nreturn shard;","onABArtifactReconstitute":"@const data = that.data;\r\n\r\ntags.placeLabel = data.label ?? 'name me';\r\ntags.scaleX = data.scaleX ?? 1;\r\ntags.scaleY = data.scaleY ?? 1;\r\ntags.scaleZ = data.scaleZ ?? 2;\r\ntags.color = data.color ?? abPersonality?.tags?.abBaseColor ?? '#00D9CD';\r\ntags.placeLabelFloatingBackgroundColor = data.labelFloatingBackgroundColor ?? abPersonality?.tags?.abBaseColor ?? '#00D9CD'; \r\ntags.placeLabelColor = data.labelColor ?? abPersonality?.tags?.abBaseLabelColor ?? 'black';\r\ntags.form = data.form ?? 'hex';\r\ntags.formSubtype = data.formSubtype;\r\ntags.formAddress = data.formAddress;\r\ntags.formAddressAspectRatio = data.formAddressAspectRatio;\r\ntags.landmarkLocked = data.landmarkLocked ?? false;\r\ntags.landmarkName = data.landmarkName;\r\ntags.landmarkLink = data.landmarkLink;\r\ntags.landmarkID = data.landmarkID ?? uuid();\r\ntags.landmarkImg = data.landmarkImg;\r\ntags.landmarkDesc = data.landmarkDesc;\r\n\r\nif (data.dimensionData) {\r\n    for (const tagName in data.dimensionData) {\r\n        tags[tagName] = data.dimensionData[tagName];\r\n    }\r\n}\r\n\r\nif (data.eggParameters) {\r\n    const dimension = data.eggParameters.gridInformation?.dimension ?? 'home';\r\n    const dimensionX = data.eggParameters.gridInformation?.position?.x ?? 0;\r\n    const dimensionY = data.eggParameters.gridInformation?.position?.y ?? 0;\r\n\r\n    tags.dimension = dimension;\r\n    tags[dimension] = true;\r\n    tags[dimension + 'X'] = dimensionX;\r\n    tags[dimension + 'Y'] = dimensionY;\r\n\r\n    thisBot.onClick();\r\n}\r\n\r\nthisBot.updateBillboardLabel();","scaleX":1,"scaleY":1,"scaleZ":2,"artifact":"ðŸ”—78e41503-c933-4f8a-817a-ba97bf8d5d27","learn":"ðŸ”—6657b865-e983-4401-9fc9-f5418d18a7f7","onBotChanged":"@const needUpdateBillboardLabel = that.tags.some(t => t === 'placeLabel' || t === 'placeLabelFloatingBackgroundColor' || t === 'placeLabelColor');\n\nif (needUpdateBillboardLabel && tags.ready) {\n    thisBot.updateBillboardLabel();\n}","updateBillboardLabel":"@if (thisBot.vars.billboardLabelBot) {\n    destroy(thisBot.vars.billboardLabelBot);\n    thisBot.vars.billboardLabelBot = null;\n}\n\nthisBot.vars.billboardLabelBot = ab.links.bot_factory.abCreateBillboardLabel({ \n    bot: thisBot, \n    label: tags.placeLabel,\n    color: tags.placeLabelFloatingBackgroundColor,\n    dimension: tags.dimension ?? 'home',\n    // botLabelMargin: 0,\n    labelColor: tags.placeLabelColor,\n    space: 'tempLocal',\n})","onBotAdded":"@let waitTime = 0;\n\nwhile(!globalThis.ab?.links.bot_factory) {\n    if (waitTime >= 5000) {\n        return;\n    }\n    \n    await os.sleep(250);\n    waitTime += 250;\n}\n\nmasks.ready = true;\n\nthisBot.updateBillboardLabel();","onABStripArtifactInstanceDataFromBotData":"@const { data } = that;\n\ndelete data.tags.placeLabel;\ndelete data.tags.placeLabelColor;\ndelete data.tags.placeLabelFloatingBackgroundColor;\ndelete data.tags.color;\ndelete data.tags.form ;\ndelete data.tags.formSubtype;\ndelete data.tags.formAddress;\ndelete data.tags.formAddressAspectRatio;\n\ndelete data.tags[data.tags.dimension + \"X\"];\ndelete data.tags[data.tags.dimension + \"Y\"];\ndelete data.tags[data.tags.dimension + \"Z\"];\ndelete data.tags[data.tags.dimension + \"RotationX\"];\ndelete data.tags[data.tags.dimension + \"RotationY\"];\ndelete data.tags[data.tags.dimension + \"RotationZ\"];\ndelete data.tags[data.tags.dimension];\ndelete data.tags.dimension;\n\ndelete data.tags.landmarkName;\ndelete data.tags.landmarkLink;\ndelete data.tags.landmarkLocked;\ndelete data.tags.landmarkID;\ndelete data.tags.landmarkImg,\ndelete data.tags.landmarkDesc","onABOpenMenu":"@if (that.menuType != 'abBotMenu' || ab.links.remember.links.abBotFocus != thisBot) {\r\n    return;\r\n}\r\n\r\nconst menuOptions = {\r\n    abMenuRefresh: `@destroy(thisBot);`,\r\n    abMenu: true,\r\n    place: getLink(thisBot)\r\n}\r\n\r\nconst unlockButton = {\r\n    ...menuOptions,\r\n    formAddress: 'lock',\r\n    label: 'unlock',\r\n    onClick: `@\r\n        links.place.tags.landmarkLocked = false;\r\n        shout('abMenuRefresh');\r\n        shout(\"clearLandmarkMenu\");\r\n\r\n        links.place.onClick();\r\n    `\r\n}\r\n\r\nif (tags.landmarkLocked) {\r\n    ab.links.menu.abCreateMenuButton(unlockButton); \r\n}","landmark":"true","onAnyBotDrop":"@if (tags[that.to.dimension]) {\r\n    if (Math.abs(tags[that.to.dimension + 'X'] - that.to.x) <= 5 && Math.abs(tags[that.to.dimension + 'Y'] - that.to.y) <= 5) {\r\n        shout(\"onBotNearLandmark\", {'landmarkID': tags.landmarkID, 'bot': that.bot});\r\n    }\r\n}","rotBot":"true"}}}}