{"version":1,"state":{"36a97c24-e77f-484b-96ed-2862b042b1b9":{"id":"36a97c24-e77f-484b-96ed-2862b042b1b9","space":"shared","tags":{"system":"ab.uuab.launcher","abVersion":"10.6","abIDOrigin":"launcher","onGridClick":"@shout(\"clearNewMenuItemMenu\");\r\nshout(\"clearLauncherMenu\");\r\nshout(\"clearUUABMenu\");\r\n\r\nif (tags.uuabLocked) {\r\n    thisBot.showUUABMenu()\r\n} else {\r\n    thisBot.showLauncherMenu();\r\n}","abArtifactName":"launcher","onABArtifactCollectShards":"@const shard: ABArtifactShard = {\r\n    data: {\r\n        uuabMenuData: thisBot.vars.uuabMenuData,\r\n        uuabLocked: tags.uuabLocked\r\n    },\r\n    dependencies: [\r\n        {\r\n            askID: 'launcher'\r\n        }\r\n    ]\r\n}\r\n\r\nreturn shard;","onABArtifactReconstitute":"@const data = that.data;\r\n\r\nthisBot.vars.uuabMenuData = data.uuabMenuData ?? [];\r\n\r\ntags.chosenOnClick = 'unlock';\r\nthisBot.addNewMenuItem();\r\n\r\ntags.uuabMenuData = thisBot.vars.uuabMenuData;\r\n\r\ntags.uuabLocked = data.uuabLocked ?? false;\r\n\r\nlinks.console.cmdABSleep();\r\n\r\nif (tags.uuabLocked) {\r\n    thisBot.showUUABMenu()\r\n} else {\r\n    thisBot.showLauncherMenu();\r\n}","artifact":"ðŸ”—78e41503-c933-4f8a-817a-ba97bf8d5d27","learn":"ðŸ”—6657b865-e983-4401-9fc9-f5418d18a7f7","onABStripArtifactInstanceDataFromBotData":"@const { data } = that;\r\n\r\ndelete data.vars?.uuabMenuData;\r\ndelete data.tags.uuabMenuData;\r\n\r\ndelete data.tags.uuabLocked;\r\n\r\ndelete data.tags.chosenLabel;\r\ndelete data.tags.chosenColor;\r\ndelete data.tags.chosenGroup;\r\ndelete data.tags.chosenOrder;\r\ndelete data.tags.chosenOnClick;\r\n\r\ndelete data.tags.chosenInfo;\r\ndelete data.tags.chosenLink;\r\ndelete data.tags.chosenAsk;","showLauncherMenu":"@shout('abMenuRefresh');\r\nshout(\"clearLauncherMenu\");\r\n\r\nconfigBot.tags.menuPortal = 'launcher_menu';\r\n\r\nconst menuOptions = {\r\n    launcher_menu: true,\r\n    clearLauncherMenu: `@destroy(thisBot);`,\r\n    launcher: getLink(thisBot)\r\n}\r\n\r\nconst newMenuItemButton = {\r\n    ...menuOptions,\r\n    formAddress: 'add',\r\n    label: 'new menu item',\r\n    launcher_menuSortOrder: 1,\r\n    onClick: `@\r\n        links.launcher.clearNewOptions();\r\n        links.launcher.showNewMenuItemMenu()`\r\n}\r\n\r\nconst removeMenuItemButton = {\r\n    ...menuOptions,\r\n    label: 'remove menu item',\r\n    dropdownSortOrder: 2,\r\n    dropdownOptions: []\r\n}\r\n\r\nif (thisBot.vars.uuabMenuData) {\r\n    for(let i = 0; i < thisBot.vars.uuabMenuData.length; ++i) {\r\n        if (thisBot.vars.uuabMenuData[i].groupID) {\r\n            for(let j = 0; j < thisBot.vars.uuabMenuData[i].menuItems.length; ++j) {\r\n                const tempItem = {\r\n                    ...menuOptions,\r\n                    label: thisBot.vars.uuabMenuData[i].menuItems[j].label,\r\n                    onClick: `@\r\n                        links.launcher.removeMenuItem({index: ${i}, groupIndex: ${j}});\r\n                        links.launcher.showLauncherMenu();\r\n                    `\r\n                }\r\n\r\n                removeMenuItemButton.dropdownOptions.push(tempItem);\r\n            }\r\n        } else {\r\n            const tempItem2 = {\r\n                ...menuOptions,\r\n                label: thisBot.vars.uuabMenuData[i].label,\r\n                onClick: `@\r\n                    links.launcher.removeMenuItem({index: ${i}});\r\n                    links.launcher.showLauncherMenu();\r\n                `\r\n            }\r\n            removeMenuItemButton.dropdownOptions.push(tempItem2);\r\n        }\r\n    }\r\n}\r\n\r\nconst lockButton = {\r\n    ...menuOptions,\r\n    formAddress: 'lock',\r\n    label: 'lock uuab',\r\n    launcher_menuSortOrder: 3,\r\n    onClick: `@\r\n        links.launcher.lockUUAB();\r\n        links.launcher.showUUABMenu();\r\n    `\r\n}\r\n\r\nconst saveButton = {\r\n    ...menuOptions,\r\n    formAddress: 'save',\r\n    label: 'submit',\r\n    launcher_menuSortOrder: 4,\r\n    onClick: `@\r\n        links.launcher.submitUUAB();\r\n    `\r\n}\r\n\r\nconst testButton = {\r\n    ...menuOptions,\r\n    formAddress: 'science',\r\n    label: 'test menu',\r\n    launcher_menuSortOrder: 5,\r\n    onClick: `@\r\n        links.launcher.showTestMenu();\r\n    `\r\n}\r\n\r\nif (thisBot.vars.uuabMenuData && thisBot.vars.uuabMenuData.length != 0) {\r\n    ab.links.menu.abCreateMenuDropdown(removeMenuItemButton);\r\n}\r\nab.links.menu.abCreateMenuButton(newMenuItemButton);\r\nab.links.menu.abCreateMenuButton(lockButton);\r\nab.links.menu.abCreateMenuButton(saveButton);\r\nab.links.menu.abCreateMenuButton(testButton);","onInstStreaming":"@if (!thisBot.vars.uuabMenuData) {\r\n    thisBot.vars.uuabMenuData = tags.uuabMenuData ?? [];\r\n}\r\n\r\nawait os.sleep(1000);\r\nif (tags.uuabLocked) {\r\n    thisBot.showUUABMenu()\r\n} else {\r\n    thisBot.showLauncherMenu();\r\n}","console":"ðŸ”—f8602878-c2ef-48bd-85a0-8d6351eb4120","showNewMenuItemMenu":"@shout('abMenuRefresh');\r\nshout(\"clearNewMenuItemMenu\");\r\n\r\nconfigBot.tags.menuPortal = 'new_menu_item_menu';\r\n\r\nconst menuOptions = {\r\n    new_menu_item_menu: true,\r\n    clearNewMenuItemMenu: `@destroy(thisBot);`,\r\n    launcher: getLink(thisBot)\r\n}\r\n\r\nconst labelButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'label: ' + (tags.chosenLabel ?? \"\"),\r\n    new_menu_item_menuSortOrder: 1,\r\n    onClick: `@\r\n        const response = await os.showInput(links.launcher.tags.chosenLabel ?? \"\", {\r\n            autoSelect: true,\r\n            title: 'label this menu item'\r\n        })\r\n\r\n        links.launcher.tags.chosenLabel = response ?? null;\r\n        links.launcher.showNewMenuItemMenu();\r\n    `\r\n}\r\n\r\nconst colorButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'color: ' + (tags.chosenColor ?? \"\"),\r\n    new_menu_item_menuSortOrder: 2,\r\n    onClick: `@\r\n        const response = await os.showInput(links.launcher.tags.chosenColor ?? \"\", {\r\n            type: 'color',\r\n            autoSelect: true,\r\n            title: 'choose a color for this menu item'\r\n        })\r\n\r\n        links.launcher.tags.chosenColor = response ?? null;\r\n        links.launcher.showNewMenuItemMenu();\r\n    `\r\n}\r\n\r\nconst groupButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'group: ' + (tags.chosenGroup ?? \"\"),\r\n    new_menu_item_menuSortOrder: 3,\r\n    onClick: `@\r\n        const response = await os.showInput(links.launcher.tags.chosenGroup ?? \"\", {\r\n            autoSelect: true,\r\n            title: 'group this menu item with other menu items'\r\n        })\r\n\r\n        links.launcher.tags.chosenGroup = response ?? null;\r\n        links.launcher.showNewMenuItemMenu();\r\n    `\r\n}\r\n\r\nconst orderButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'menu order: ' + (tags.chosenOrder ?? \"\"),\r\n    new_menu_item_menuSortOrder: 4,\r\n    onClick: `@\r\n        const response = await os.showInput(links.launcher.tags.chosenOrder ?? \"\", {\r\n            autoSelect: true,\r\n            title: 'choose the order in which this menu item will appear, higher numbers are lower down'\r\n        })\r\n\r\n        links.launcher.tags.chosenOrder = response ?? null;\r\n        links.launcher.showNewMenuItemMenu();\r\n    `\r\n}\r\n\r\nconst onClickButton = {\r\n    ...menuOptions,\r\n    label: 'button type: ' + (tags.chosenOnClick ?? \"\"),\r\n    dropdownSortOrder: 5,\r\n    dropdownOptions: [\r\n        {\r\n            ...menuOptions,\r\n            label: 'info',\r\n            onClick: `@\r\n                links.launcher.tags.chosenOnClick = 'info';\r\n                links.launcher.showNewMenuItemMenu();\r\n            `\r\n        },\r\n        {\r\n            ...menuOptions,\r\n            label: 'open link',\r\n            onClick: `@\r\n                links.launcher.tags.chosenOnClick = 'link';\r\n                links.launcher.showNewMenuItemMenu();\r\n            `\r\n        },\r\n        {\r\n            ...menuOptions,\r\n            label: 'open link in new tab',\r\n            onClick: `@\r\n                links.launcher.tags.chosenOnClick = 'external_link';\r\n                links.launcher.showNewMenuItemMenu();\r\n            `\r\n        },\r\n        {\r\n            ...menuOptions,\r\n            label: 'ask',\r\n            onClick: `@\r\n                links.launcher.tags.chosenOnClick = 'ask';\r\n                links.launcher.showNewMenuItemMenu();\r\n            `\r\n        },\r\n        {\r\n            ...menuOptions,\r\n            label: 'unlock',\r\n            onClick: `@\r\n                links.launcher.tags.chosenOnClick = 'unlock';\r\n                links.launcher.showNewMenuItemMenu();\r\n            `\r\n        }\r\n    ]\r\n}\r\n\r\nconst createButton = {\r\n    ...menuOptions,\r\n    formAddress: 'add',\r\n    label: 'create',\r\n    new_menu_item_menuSortOrder: 7,\r\n    onClick: `@\r\n        if (links.launcher.tags.chosenOnClick) {\r\n            links.launcher.addNewMenuItem();\r\n            links.launcher.showLauncherMenu();\r\n        } else {\r\n            os.toast(\"you must provide a button type.\");\r\n        }\r\n    `\r\n}\r\n\r\nab.links.menu.abCreateMenuButton(labelButton);\r\nab.links.menu.abCreateMenuButton(colorButton);\r\nab.links.menu.abCreateMenuButton(groupButton);\r\nab.links.menu.abCreateMenuButton(orderButton);\r\nab.links.menu.abCreateMenuDropdown(onClickButton);\r\n\r\nif (!tags.chosenOnClick) {\r\n    createButton.menuItemStyle = {\r\n        filter: `brightness(50%)`\r\n    }\r\n}\r\n\r\nab.links.menu.abCreateMenuButton(createButton);\r\n\r\n//menus if chosen onClick\r\nswitch(tags.chosenOnClick) {\r\n    case 'info':\r\n        const infoConfigButton = {\r\n            ...menuOptions,\r\n            formAddress: 'edit',\r\n            label: 'provide information',\r\n            new_menu_item_menuSortOrder: 6,\r\n            onClick: `@\r\n                const response = await os.showInput(links.launcher.tags.chosenInfo ?? \"\", {\r\n                    autoSelect: true,\r\n                    title: 'provide the information that should be displayed when clicking this button'\r\n                })\r\n\r\n                links.launcher.tags.chosenInfo = response ?? null;\r\n                links.launcher.showNewMenuItemMenu();\r\n            `\r\n        }\r\n        ab.links.menu.abCreateMenuButton(infoConfigButton);\r\n\r\n        break;\r\n    case 'link':\r\n    case 'external_link':\r\n        const linkConfigButton = {\r\n            ...menuOptions,\r\n            formAddress: 'edit',\r\n            label: 'provide link',\r\n            new_menu_item_menuSortOrder: 6,\r\n            onClick: `@\r\n                const response = await os.showInput(links.launcher.tags.chosenLink ?? \"\", {\r\n                    autoSelect: true,\r\n                    title: 'provide the link that the user should be sent to when clicking this button'\r\n                })\r\n\r\n                links.launcher.tags.chosenLink = response ?? null;\r\n                links.launcher.showNewMenuItemMenu();\r\n            `\r\n        }\r\n        ab.links.menu.abCreateMenuButton(linkConfigButton);\r\n        break;\r\n    case 'ask':\r\n        const askConfigButton = {\r\n            ...menuOptions,\r\n            formAddress: 'edit',\r\n            label: 'provide ask',\r\n            new_menu_item_menuSortOrder: 6,\r\n            onClick: `@\r\n                const response = await os.showInput(links.launcher.tags.chosenAsk ?? \"\", {\r\n                    autoSelect: true,\r\n                    title: 'provide ask that should be loaded when clicking this button'\r\n                })\r\n\r\n                links.launcher.tags.chosenAsk = response ?? null;\r\n                links.launcher.showNewMenuItemMenu();\r\n            `\r\n        }\r\n        ab.links.menu.abCreateMenuButton(askConfigButton);\r\n        break;\r\n    case 'unlock':\r\n    default: \r\n        break;\r\n}","onClick":"@thisBot.showLauncherMenu();\r\nconsole.log(\"[LAUNCHER MENU]: \", thisBot.vars.uuabMenuData);","search":"ðŸ”—d8371444-9158-4436-8fc7-84cc91b7f525","clearNewOptions":"@tags.chosenLabel = null;\r\ntags.chosenColor = null;\r\ntags.chosenGroup = null;\r\ntags.chosenOrder = null;\r\ntags.chosenOnClick = null;\r\n\r\ntags.chosenInfo = null;\r\ntags.chosenLink = null;\r\ntags.chosenAsk = null;","addNewMenuItem":"@if (!thisBot.vars.uuabMenuData) {\r\n    thisBot.vars.uuabMenuData = [];\r\n}\r\n\r\nconst menuItem = {\r\n    uuabMenu: true,\r\n    uuabMenuSortOrder: tags.chosenOrder ?? null,\r\n    clearUUABMenu: `@destroy(thisBot)`,\r\n    label: tags.chosenLabel,\r\n    color: tags.chosenColor\r\n}\r\n\r\n//Button type specific onClicks\r\nswitch(tags.chosenOnClick) {\r\n    case 'info':\r\n        menuItem.isInfo = true;\r\n        menuItem.info = tags.chosenInfo;\r\n        break;\r\n    case 'link':\r\n        menuItem.url = tags.chosenLink;\r\n        menuItem.onClick = `@\r\n            os.goToURL(tags.url);\r\n        `\r\n        break;\r\n    case 'external_link':\r\n        menuItem.url = tags.chosenLink;\r\n        menuItem.onClick = `@\r\n            os.openURL(tags.url);\r\n            shout(\"clearUUABMenu\");\r\n        `\r\n        break;\r\n    case 'unlock':\r\n        if (!menuItem.label) {\r\n            menuItem.label = 'unlock';\r\n        }\r\n        menuItem.formAddress = 'lock';\r\n        menuItem.launcher = getLink(thisBot);\r\n        menuItem.onClick = `@\r\n            links.launcher.unlockUUAB();\r\n            shout(\"clearUUABMenu\");\r\n            links.launcher.showLauncherMenu();\r\n        `\r\n        break;\r\n    case 'ask':\r\n        break;\r\n    default: \r\n        break;\r\n}\r\n\r\n//handle grouping logic\r\nif (tags.chosenGroup) {\r\n    const groupIndex = thisBot.vars.uuabMenuData.findIndex((item) => {\r\n        return item?.groupID == tags.chosenGroup;\r\n    })\r\n\r\n    if (groupIndex != -1) {\r\n        thisBot.vars.uuabMenuData[groupIndex].menuItems.push(menuItem);\r\n    } else {\r\n        thisBot.vars.uuabMenuData.push({\r\n            groupID: tags.chosenGroup,\r\n            groupSortOrder: tags.chosenOrder ?? thisBot.vars.uuabMenuData.length,\r\n            menuItems: [\r\n                {\r\n                    ...menuItem\r\n                }\r\n            ]\r\n        })\r\n    }\r\n} \r\n\r\n//if no specified group\r\nelse {\r\n    thisBot.vars.uuabMenuData.push(menuItem);\r\n}\r\n\r\ntags.uuabMenuData = thisBot.vars.uuabMenuData;\r\nconsole.log(\"[LAUNCHER MENU]: \", thisBot.vars.uuabMenuData);","showTestMenu":"@shout('abMenuRefresh');\nshout(\"clearUUABMenu\");\n\nconfigBot.tags.menuPortal = 'uuabMenu';\n\nif (thisBot.vars.uuabMenuData && thisBot.vars.uuabMenuData.length != 0) {\n    for (let i = 0; i < thisBot.vars.uuabMenuData.length; ++i) {\n        if (thisBot.vars.uuabMenuData[i].groupID) {\n            ab.links.menu.abCreateMenuGroup(thisBot.vars.uuabMenuData[i]);\n        } \n         else if (thisBot.vars.uuabMenuData[i].isInfo) {\n            const infoCopy = {\n                ...thisBot.vars.uuabMenuData[i],\n                label: thisBot.vars.uuabMenuData[i].info\n            }\n            ab.links.menu.abCreateMenuText(infoCopy);\n        }\n        else {\n            ab.links.menu.abCreateMenuButton(thisBot.vars.uuabMenuData[i]);\n        }\n    }\n} else {\n    os.toast(\"no menu items found\");\n}","launcher":"true","removeMenuItem":"@const index = that?.index;\r\nconst groupIndex = that?.groupIndex;\r\n\r\nif (!thisBot.vars.uuabMenuData) {\r\n    thisBot.vars.uuabMenuData = [];\r\n}\r\n\r\nif (!index && index != 0) {\r\n    console.log(\"[UUAB Launcher]: no index provided to remove.\");\r\n    return;\r\n}\r\n\r\nif (groupIndex) {\r\n    thisBot.vars.uuabMenuData[index].menuItems.splice(groupIndex, 1);\r\n    if (thisBot.vars.uuabMenuData[index].menuItems.length == 0) {\r\n        thisBot.vars.uuabMenuData.splice(index, 1);\r\n    }\r\n} else {\r\n    thisBot.vars.uuabMenuData.splice(index, 1);\r\n}\r\n\r\ntags.uuabMenuData = thisBot.vars.uuabMenuData;","submitUUAB":"@const launcherName = await os.showInput(\"\", {\r\n    title: \"name this launcher, no spaces\"\r\n});\r\n\r\nif (!launcherName) {\r\n    console.log(`${tags.system}.${tagName}]: no launcher name`);\r\n    return;\r\n}\r\n\r\nconst abArtifactShard = {\r\n    data: {\r\n        uuabMenuData: thisBot.vars.uuabMenuData,\r\n        uuabLocked: tags.uuabLocked\r\n    },\r\n    dependencies: [\r\n        {\r\n            askID: 'launcher'\r\n        }\r\n    ]\r\n};\r\n                \r\nconst launcherEgg = await ab.links.artifact.abCreateArtifactPromiseBot({\r\n                    abArtifactName: 'launcher',\r\n                    abArtifactInstanceID: uuid(),\r\n                    abArtifactShard,\r\n                });\r\n\r\nconsole.log(`${tags.system}.${tagName}]: uuab promise bot`, launcherEgg);\r\n\r\n//save UUAB to record\r\nif (!authBot) {\r\n    console.log(`${tags.system}.${tagName}]: no authbot`);\r\n    await os.requestAuthBotInBackground();\r\n}\r\n\r\nif (!authBot) {\r\n    console.log(`${tags.system}.${tagName}]: User not logged in.`);\r\n    destroy(launcherEgg);\r\n    return;\r\n}\r\n\r\nconst studio = configBot.tags.studio ?? authBot.id;\r\nconfigBot.tags.selected_studioID = studio;\r\n\r\nconst publishAttempt = await ab.links.store.abPublishAB({ab: launcherName, target: launcherEgg, sourceEvent: 'launcher_egg_publish', studio: studio, publicFacing: true});\r\n\r\nif (tags.debug) {\r\n    console.log(`[${tags.system}.${tagName}] saveData publishAttempt 1:`, publishAttempt);\r\n}\r\n\r\nif (!publishAttempt.success) {\r\n    const permissions = await os.grantInstAdminPermission(studio);\r\n\r\n    if (tags.debug) {\r\n        console.log(`[${tags.system}.${tagName}] saveData permissions:`, permissions);\r\n    }\r\n\r\n    const secondPublishAttempt = await ab.links.store.abPublishAB({ab: launcherName, target: launcherEgg, sourceEvent: 'uuab_egg_publish', studio: studio, publicFacing: true});\r\n        \r\n    if (tags.debug) {\r\n        console.log(`[${tags.system}.${tagName}]  saveData publishAttempt 2`, secondPublishAttempt);\r\n    }\r\n\r\n    if (!secondPublishAttempt.success){\r\n        if (tags.debug) {\r\n            console.log(`[${tags.system}.${tagName}] Could not publish`, secondPublishAttempt);\r\n        }\r\n        os.toast(\"could not publish\");\r\n        destroy(launcherEgg);\r\n        return;\r\n    } else {\r\n        os.toast(\"Publishing successful\");\r\n        ab.links.manifestation.abSetAwake({ awake: true });\r\n    }\r\n} else {\r\n    os.toast(\"Publishing successful\");\r\n}\r\n\r\n//delete UUAB\r\ndestroy(launcherEgg);\r\n\r\n//publish as ask\r\nconst confirm = await os.showConfirm({\r\n    title: \"confirm request\",\r\n    content: \"request \" + launcherName + \" to be published?\",\r\n    confirmText: \"request\",\r\n    cancelText: \"cancel\"\r\n})\r\nif (confirm) {\r\n    //request ask\r\n    ab.links.store.abPublishAskID({askID: launcherName, studioID: studio, patternID: launcherName});\r\n}\r\nlinks.uuabConfigurator.showUUABSetupMenu();","lockUUAB":"@tags.uuabLocked = true;","showUUABMenu":"@shout('abMenuRefresh');\r\nshout(\"clearNewMenuItemMenu\");\r\nshout(\"clearLauncherMenu\");\r\nshout(\"clearUUABMenu\");\r\n\r\nconfigBot.tags.menuPortal = 'uuabMenu';\r\n\r\nif (thisBot.vars.uuabMenuData && thisBot.vars.uuabMenuData.length != 0) {\r\n    for (let i = 0; i < thisBot.vars.uuabMenuData.length; ++i) {\r\n        if (thisBot.vars.uuabMenuData[i].groupID) {\r\n            ab.links.menu.abCreateMenuGroup(thisBot.vars.uuabMenuData[i]);\r\n        } else if (thisBot.vars.uuabMenuData[i].isInfo) {\r\n            const infoCopy = {\r\n                ...thisBot.vars.uuabMenuData[i],\r\n                label: thisBot.vars.uuabMenuData[i].info\r\n            }\r\n            ab.links.menu.abCreateMenuText(infoCopy);\r\n        } else {\r\n            await ab.links.menu.abCreateMenuButton(thisBot.vars.uuabMenuData[i]);\r\n        }\r\n    }\r\n} else {\r\n    os.toast(\"no menu items found\");\r\n}","unlockUUAB":"@tags.uuabLocked = false;"}}}}