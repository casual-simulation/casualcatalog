{"version":1,"state":{"eb926040-f2be-49bd-88e0-f994c1ee8d2f":{"id":"eb926040-f2be-49bd-88e0-f994c1ee8d2f","space":"shared","tags":{"system":"sim_toolbox.tools.simWizard","onABArtifactCollectShards":"@const shard: ABArtifactShard = {\r\n    data: {\r\n        label: tags.bbLabel,\r\n        dimensionData: {\r\n            dimension: ab.links.remember.tags.abActiveDimension,\r\n            [ab.links.remember.tags.abActiveDimension]: tags[ab.links.remember.tags.abActiveDimension],\r\n            [ab.links.remember.tags.abActiveDimension + 'X']: tags[ab.links.remember.tags.abActiveDimension + 'X'],\r\n            [ab.links.remember.tags.abActiveDimension + 'Y']: tags[ab.links.remember.tags.abActiveDimension + 'Y'],\r\n            [ab.links.remember.tags.abActiveDimension + 'Z']: tags[ab.links.remember.tags.abActiveDimension + 'Z'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationX']: tags[ab.links.remember.tags.abActiveDimension + 'RotationX'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationY']: tags[ab.links.remember.tags.abActiveDimension + 'RotationY'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationZ']: tags[ab.links.remember.tags.abActiveDimension + 'RotationZ'],\r\n        },\r\n        color: tags.color,\r\n        labelFloatingBackgroundColor: tags.bbLabelFloatingBackgroundColor,\r\n        labelColor: tags.bbLabelColor,\r\n        simID: tags.simID\r\n    },\r\n    dependencies: [\r\n        {\r\n            askID: 'simWizard'\r\n        }\r\n    ]\r\n}\r\n\r\nreturn shard;","onABArtifactReconstitute":"@const data = that.data;\r\ntags.bbLabel = data.label ?? 'wizard';\r\ntags.color = data.color ?? abPersonality?.tags?.abBaseColor ?? '#00D9CD';\r\ntags.bbLabelFloatingBackgroundColor = data.labelFloatingBackgroundColor ?? abPersonality?.tags?.abBaseColor ?? '#00D9CD'; \r\ntags.bbLabelColor = data.labelColor ?? 'white';\r\ntags.simID = data.simID ?? uuid();\r\n\r\n//Place bot correctly\r\nif (data.dimensionData) {\r\n    for (const tagName in data.dimensionData) {\r\n        tags[tagName] = data.dimensionData[tagName];\r\n    }\r\n}\r\n\r\n//If new action\r\nif (data.eggParameters) {\r\n    const dimension = data.eggParameters.gridInformation?.dimension ?? 'home';\r\n    const dimensionX = data.eggParameters.gridInformation?.position?.x ?? 0;\r\n    const dimensionY = data.eggParameters.gridInformation?.position?.y ?? 0;\r\n\r\n    tags.dimension = dimension;\r\n    tags[dimension] = true;\r\n    tags[dimension + 'X'] = dimensionX;\r\n    tags[dimension + 'Y'] = dimensionY;\r\n\r\n    thisBot.onClick();\r\n}\r\n\r\nif (!ab.links.console.masks.open) {\r\n    whisper(ab.links.console, \"showConsole\");\r\n    ab.links.console.masks.open = true;\r\n}","onABStripArtifactInstanceDataFromBotData":"@const { data } = that;\r\n\r\ndelete data.tags.bbLabel;\r\ndelete data.tags.bbLabelColor;\r\ndelete data.tags.bbLabelFloatingBackgroundColor;\r\ndelete data.tags.color;\r\ndelete data.tags[data.tags.dimension + \"X\"];\r\ndelete data.tags[data.tags.dimension + \"Y\"];\r\ndelete data.tags[data.tags.dimension + \"Z\"];\r\ndelete data.tags[data.tags.dimension + \"RotationX\"];\r\ndelete data.tags[data.tags.dimension + \"RotationY\"];\r\ndelete data.tags[data.tags.dimension + \"RotationZ\"];\r\ndelete data.tags[data.tags.dimension];\r\ndelete data.tags.dimension;\r\ndelete data.tags.simID;","onClick":"@if (that) {\r\n    if (that.modality == 'mouse' && that.buttonId == 'right') {\r\n        return;\r\n    }\r\n}\r\n\r\nshout('abMenuRefresh');\r\nshout(\"clearSimWizardMenu\");\r\n\r\nconfigBot.tags.menuPortal = 'simWizard_menu';\r\n\r\nconst menuOptions = {\r\n    simWizard_menu: true,\r\n    clearSimWizardMenu: `@destroy(thisBot);`,\r\n    abMenuRefresh: \"@ destroy(thisBot);\",\r\n    wizard: getLink(thisBot)\r\n}\r\n\r\nconst promptButton = {\r\n    ...menuOptions,\r\n    label: 'submit prompt',\r\n    simWizard_menuSortOrder: 1,\r\n    formAddress: 'edit',\r\n    onClick: `@\r\n        const response = await os.showInput(links.wizard.tags.wizardPrompt, {\r\n            autoSelect: true,\r\n            title: 'describe this simulation'\r\n        });\r\n        links.wizard.tags.wizardPrompt = response;\r\n        links.wizard.generateFromPrompt(response);\r\n        shout(\"clearSimWizardMenu\");\r\n    `\r\n}\r\n\r\nconst csvButton = {\r\n    ...menuOptions,\r\n    label: 'upload csv',\r\n    formAddress: 'upload',\r\n    simWizard_menuSortOrder: 2,\r\n    onClick: `@\r\n        links.wizard.generateFromCSV();\r\n        shout(\"clearSimWizardMenu\");\r\n    `\r\n}\r\n\r\nconst downloadButton = {\r\n    ...menuOptions,\r\n    label: 'download simulation',\r\n    formAddress: 'download',\r\n    simWizard_menuSortOrder: 3,\r\n    onClick: `@\r\n        links.wizard.downloadSim();\r\n        shout(\"clearSimWizardMenu\");\r\n    `\r\n}\r\n\r\nab.links.menu.abCreateMenuButton(promptButton);\r\nab.links.menu.abCreateMenuButton(csvButton);\r\nab.links.menu.abCreateMenuButton(downloadButton);","abIDOrigin":"simAction","onBotAdded":"@let waitTime = 0;\r\n\r\nwhile(!globalThis.ab?.links.bot_factory) {\r\n    if (waitTime >= 5000) {\r\n        return;\r\n    }\r\n    \r\n    await os.sleep(250);\r\n    waitTime += 250;\r\n}\r\n\r\nmasks.ready = true;\r\n\r\nthisBot.updateBillboardLabel();","onBotChanged":"@const needUpdateBillboardLabel = that.tags.some(t => t === 'bbLabel' || t === 'bbLabelFloatingBackgroundColor' || t === 'bbLabelColor');\r\n\r\nif (needUpdateBillboardLabel && tags.ready) {\r\n    thisBot.updateBillboardLabel();\r\n}","updateBillboardLabel":"@if (thisBot.vars.billboardLabelBot) {\r\n    destroy(thisBot.vars.billboardLabelBot);\r\n    thisBot.vars.billboardLabelBot = null;\r\n}\r\n\r\nthisBot.vars.billboardLabelBot = ab.links.bot_factory.abCreateBillboardLabel({ \r\n    bot: thisBot, \r\n    label: tags.bbLabel,\r\n    color: tags.bbLabelFloatingBackgroundColor,\r\n    dimension: tags.dimension,\r\n    // botLabelMargin: 0,\r\n    labelColor: tags.bbLabelColor,\r\n    space: 'tempLocal',\r\n})","onGridClick":"@shout(\"clearSimWizardMenu\");","strokeColor":"white","cursor":"pointer","scaleZ":"2","onABOpenMenu":"@if (that.menuType != 'abBotMenu' || ab.links.remember.links.abBotFocus != thisBot) {\r\n    return;\r\n}\r\n\r\nconst menuOptions = {\r\n    abMenuRefresh: `@destroy(thisBot);`,\r\n    abMenu: true,\r\n    action: getLink(thisBot)\r\n}\r\n\r\nconst actionMenuButton = {\r\n    ...menuOptions,\r\n    formAddress: 'menu',\r\n    label: 'show action menu',\r\n    abMenuSortOrder: -1,\r\n    onClick: `@\r\n        links.action.showActionMenu();\r\n        shout('abMenuRefresh');\r\n    `\r\n}\r\n\r\nconst resetRoleTagsButton = {\r\n    ...menuOptions,\r\n    formAddress: 'replay',\r\n    label: 'reset role tags',\r\n    onClick: `@\r\n        links.action.tags.roleTags = [];\r\n        shout('abMenuRefresh');\r\n        shout(\"clearSimActionMenu\");\r\n\r\n        links.action.onClick();\r\n    `\r\n}\r\n\r\nconst resetGroupTagsButton = {\r\n    ...menuOptions,\r\n    formAddress: 'replay',\r\n    label: 'reset group tags',\r\n    onClick: `@\r\n        links.action.tags.groupTags = [];\r\n        shout('abMenuRefresh');\r\n        shout(\"clearSimActionMenu\");\r\n\r\n        links.action.onClick();\r\n    `\r\n}\r\n\r\nconst resetPrereqsButton = {\r\n    ...menuOptions,\r\n    formAddress: 'replay',\r\n    label: 'reset prerequisites',\r\n    onClick: `@\r\n        links.action.tags.actionPrerequisites = null;\r\n        links.action.tags.lineTo = null;\r\n        shout('abMenuRefresh');\r\n    `\r\n}\r\n\r\nab.links.menu.abCreateMenuButton(actionMenuButton);\r\nab.links.menu.abCreateMenuButton(resetRoleTagsButton);\r\nab.links.menu.abCreateMenuButton(resetGroupTagsButton);\r\nab.links.menu.abCreateMenuButton(resetPrereqsButton);\r\n\r\nreturn;","abArtifactName":"simWizard","generateFromPrompt":"@const prompt = that;\r\n\r\n\r\nconst basePrompt = `You will be given a prompt for a simulation. You must return a csv with the simulation items that you decide should be created based on the content of the prompt.\r\n    \r\n    Your options for simulation items are:\r\n        - SIM ACTION: \r\n            description: an action for a user to take or complete.\r\n            configuration: {\r\n                label: the text that should appear on the action (keep it brief, less than 10 words)\r\n                simID: a unique id used to determine prerequisites\r\n                prerequisites: an array of actions or reactions that this action should follow. This can be an empty array.\r\n                roles: an array of roles that this action should appear for (example: a 'doctor' role can 'check test results', but a 'patient' role cannot). \r\n                startingAction: a true or false value representing whether or not this action is one of the first actions a user sees.\r\n            }\r\n\r\n        - SIM ROLE: \r\n            description: a role that a user can take on (example: doctor, patient).\r\n            configuration: {\r\n                name: the name of the role.\r\n                attributes: a json object of attribute name keys and attribute values.\r\n            }\r\n\r\n        - SIM REACTION: \r\n            description: an effect that can happen in response to an action, that changes a stat of a chosen role or prop.\r\n            configuration: {\r\n                label: A brief description of the reaction (less than 5 words).\r\n                affectedAttribute: the attribute of a prop or role that should be affected.\r\n                effect: the way that the attribute is affected. This value can be +, -, or =.\r\n                value: The amount that the attribute should be changed by (example 2).\r\n                simID: a unique id used to determine prerequisites.\r\n                prerequisites: an array of actions or reactions that this action should follow. This can be an empty array.\r\n            }\r\n\r\n        - SIM PROP:\r\n            description: a prop in the simulation that is not a player but has stats.\r\n            configuration: {\r\n                name: The name of the prop.\r\n                trackedAttribute: The main attribute that should be visually represented for this prop. This value can be left empty.\r\n                startingValue: The starting value for the tracked attribute.\r\n                endingValue: The ending value for the tracked attribute.\r\n                attributes: a json object of attribute name keys and attribute values.\r\n            }\r\n\r\n        - SIM PLACE:\r\n            description: a location in the simulation that a player can move to and items can be placed in.\r\n            configuration: {\r\n                prompt: A prompt describing the location that should be displayed.\r\n                name: the name of the location (keep it brief, less than 4 words).\r\n            }\r\n\r\n        - SIM DOOR: \r\n            description: a door that can be placed in a sim place that leads to a different sim place.\r\n            configuration: {\r\n                destination: the name of the place that this door should lead to.\r\n            }\r\n`","generateFromCSV":"@","downloadSim":"@"}}}}