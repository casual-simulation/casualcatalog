{"version":1,"state":{"d8eb584e-34bb-4deb-8b03-9ca9b924649c":{"id":"d8eb584e-34bb-4deb-8b03-9ca9b924649c","space":"shared","tags":{"system":"story_toolbox.storyPlace","storyPlace":"true","onEggHatch":"@if (that.eggParameters) {\r\n    const dimension = that.eggParameters.gridInformation?.dimension ?? 'home';\r\n    const dimensionX = that.eggParameters.gridInformation?.position?.x ?? 0;\r\n    const dimensionY = that.eggParameters.gridInformation?.position?.y ?? 0;\r\n\r\n    tags[dimension] = true;\r\n    tags[dimension + 'X'] = dimensionX;\r\n    tags[dimension + 'Y'] = dimensionY;\r\n}\r\n\r\nif (tags.abIDOrigin == 'storyPlace') {\r\n    shout(\"abMenuRefresh\");\r\n\r\n    thisBot.tags.formAddress = null;\r\n    thisBot.tags.label = 'storyPlace';\r\n\r\n    if (that.skyboxTags) {\r\n        thisBot.createSkybox({\"prompt\": that.skyboxTags.prompt});\r\n    } else {\r\n        thisBot.createSkybox();\r\n    }\r\n}","createSkybox":"@let prompt;\r\nif (that && that.prompt) {\r\n    prompt = that.prompt;\r\n} else {\r\n    prompt = await os.showInput('', {\r\n        title: \"What would you like this place to look like?\"\r\n    })\r\n}\r\n\r\ntags.placePrompt = prompt;\r\nconst generatingTip = await os.tip(\"generating...\", 60);\r\n\r\nlet skyboxImage = await ai.generateSkybox(prompt);\r\nos.hideTips(generatingTip);\r\n\r\ntags.formAddress = skyboxImage;\r\ntags.label = null;\r\n\r\nconst dimension = configBot.tags.gridPortal;\r\nconst artifactInstanceID = uuid();\r\ntags.artifactInstanceID = artifactInstanceID;\r\n\r\nconst artifact = await links.artifact.abCreateArtifactPromiseBot({\r\n    abArtifactName: 'msSkyBot',\r\n    abArtifactInstanceID: artifactInstanceID,\r\n    abArtifactShard: {\r\n        data: {\r\n            toolboxBot: tags.toolbox ?? \"\",\r\n            gridInformation: tags.gridInformation,\r\n            skyboxImage: skyboxImage,\r\n            skyboxTags: {\r\n                scale: 450,\r\n                [dimension + \"Z\"]: -100,\r\n                onInstJoined: tags.instJoinedString\r\n            }\r\n        },\r\n        dependencies: [\r\n            { askID: 'msSkyBot' }\r\n        ]\r\n\r\n    }\r\n})\r\n\r\nconsole.log(\"artifacty\", artifact);\r\n\r\ngridPortalBot.tags.portalCameraType = \"perspective\";\r\ngridPortalBot.tags.portalPannableMaxX = 30;\r\ngridPortalBot.tags.portalPannableMinX = -30;\r\ngridPortalBot.tags.portalPannableMaxY = 30;\r\ngridPortalBot.tags.portalPannableMinY = -30;\r\ngridPortalBot.tags.portalZoomable = false;","artifact":"ðŸ”—78e41503-c933-4f8a-817a-ba97bf8d5d27","onClick":"@if (tags.formAddress) {\r\n    if (links.skybox.tags[configBot.tags.gridPortal] != true) {\r\n       shout(\"onStorySceneChange\", tags.placePrompt); \r\n    } \r\n    links.skybox.link.toggle.onClick();\r\n} else {\r\n    thisBot.createSkybox();\r\n}","home":true,"homeX":-10,"homeY":2,"homeZ":0,"formAddress":"https://images.blockadelabs.com/images/imagine/Advanced_no_style_equirectangular-jpg_an_enchanted_forest_9542466302_14120752.jpg?ver=1","form":"sphere","label":null,"onAnyABArtifactReconstituted ":"@","onAnyBotsAdded":"@for (const bot of that.bots) {\r\n    if (bot.tags.abArtifactInstanceID == tags.artifactInstanceID && bot.tags.formAddress == tags.formAddress && bot.tags.form == \"skybox\") {\r\n        tags.skybox = getLink(bot);\r\n    }\r\n}\r\n\r\nlinks.skybox.links.toggle.tags[configBot.tags.gridPortal] = false;","abVersion":"10.5"}}}}