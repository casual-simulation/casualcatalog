{"version":1,"state":{"45a62a89-7045-43a4-8e63-9442f2c9ebaf":{"id":"45a62a89-7045-43a4-8e63-9442f2c9ebaf","space":"shared","tags":{"system":"story_toolbox.storyRecipe","onABArtifactCollectShards":"@const shard: ABArtifactShard = {\r\n    data: {\r\n        label: tags.label,\r\n        dimensionData: {\r\n            dimension: ab.links.remember.tags.abActiveDimension,\r\n            [ab.links.remember.tags.abActiveDimension]: tags[ab.links.remember.tags.abActiveDimension],\r\n            [ab.links.remember.tags.abActiveDimension + 'X']: tags[ab.links.remember.tags.abActiveDimension + 'X'],\r\n            [ab.links.remember.tags.abActiveDimension + 'Y']: tags[ab.links.remember.tags.abActiveDimension + 'Y'],\r\n            [ab.links.remember.tags.abActiveDimension + 'Z']: tags[ab.links.remember.tags.abActiveDimension + 'Z'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationX']: tags[ab.links.remember.tags.abActiveDimension + 'RotationX'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationY']: tags[ab.links.remember.tags.abActiveDimension + 'RotationY'],\r\n            [ab.links.remember.tags.abActiveDimension + 'RotationZ']: tags[ab.links.remember.tags.abActiveDimension + 'RotationZ'],\r\n        },\r\n        color: tags.color,\r\n        labelFloatingBackgroundColor: tags.labelFloatingBackgroundColor,\r\n        labelColor: tags.labelColor,\r\n        dropped: tags.dropped,\r\n        droppedOn: tags.droppedOn,\r\n        fuzzy: tags.fuzzy,\r\n        result: tags.result\r\n    },\r\n    dependencies: [\r\n        {\r\n            askID: 'storyRecipe'\r\n        }\r\n    ]\r\n}\r\n\r\nreturn shard;","onABArtifactReconstitute":"@let data = that.data;\r\nif (data.config) {\r\n    data = data.config;\r\n}\r\n\r\ntags.label = data.label ?? 'recipe';\r\ntags.color = data.color ?? abPersonality?.tags?.abBaseColor ?? '#00D9CD';\r\ntags.labelFloatingBackgroundColor = data.labelFloatingBackgroundColor ?? abPersonality?.tags?.abBaseColor ?? '#00D9CD'; \r\ntags.labelColor = data.labelColor ?? 'white';\r\ntags.dropped = data.dropped;\r\ntags.droppedOn = data.droppedOn;\r\ntags.fuzzy = data.fuzzy ?? true;\r\ntags.result = data.result;\r\n\r\n//Place bot correctly\r\nif (data.dimensionData) {\r\n    for (const tagName in data.dimensionData) {\r\n        tags[tagName] = data.dimensionData[tagName];\r\n    }\r\n}\r\n\r\n//If new action\r\nif (data.eggParameters) {\r\n    const dimension = data.eggParameters.gridInformation?.dimension ?? 'home';\r\n    const dimensionX = data.eggParameters.gridInformation?.position?.x ?? 0;\r\n    const dimensionY = data.eggParameters.gridInformation?.position?.y ?? 0;\r\n\r\n    tags.dimension = dimension;\r\n    tags[dimension] = true;\r\n    tags[dimension + 'X'] = dimensionX;\r\n    tags[dimension + 'Y'] = dimensionY;\r\n\r\n    thisBot.onClick();\r\n}","onABStripArtifactInstanceDataFromBotData":"@const { data } = that;\r\n\r\ndelete data.tags.label;\r\ndelete data.tags.labelColor;\r\ndelete data.tags.labelFloatingBackgroundColor;\r\ndelete data.tags.color;\r\ndelete data.tags[data.tags.dimension + \"X\"];\r\ndelete data.tags[data.tags.dimension + \"Y\"];\r\ndelete data.tags[data.tags.dimension + \"Z\"];\r\ndelete data.tags[data.tags.dimension + \"RotationX\"];\r\ndelete data.tags[data.tags.dimension + \"RotationY\"];\r\ndelete data.tags[data.tags.dimension + \"RotationZ\"];\r\ndelete data.tags[data.tags.dimension];\r\ndelete data.tags.dimension;\r\ndelete data.tags.dropped;\r\ndelete data.tags.droppedOn;\r\ndelete data.tags.fuzzy;\r\ndelete data.tags.result;","onClick":"@if (that) {\r\n    if (that.modality == 'mouse' && that.buttonId == 'right') {\r\n        return;\r\n    }\r\n}\r\n\r\nshout('abMenuRefresh');\r\nshout(\"clearStoryRecipeMenu\");\r\n\r\nconfigBot.tags.menuPortal = 'storyRecipe_menu';\r\n\r\nconst menuOptions = {\r\n    storyRecipe_menu: true,\r\n    clearStoryRecipeMenu: `@destroy(thisBot);`,\r\n    abMenuRefresh: \"@destroy(thisBot);\",\r\n    recipe: getLink(thisBot)\r\n}\r\n\r\nconst setAButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: 'element',\r\n    storyRecipe_menuSortOrder: 1,\r\n    onCreate: `@\r\n        masks.menuItemText = links.recipe.tags.dropped ?? '';\r\n    `,\r\n    onSubmit: `@\r\n        links.recipe.tags.dropped = that.text;\r\n    `,\r\n    onInputTyping: `@\r\n        links.recipe.tags.dropped = that.text;\r\n    `\r\n}\r\n\r\nconst setBButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: '+ element',\r\n    storyRecipe_menuSortOrder: 2,\r\n    onCreate: `@\r\n        masks.menuItemText = links.recipe.tags.droppedOn ?? '';\r\n    `,\r\n    onSubmit: `@\r\n        links.recipe.tags.droppedOn = that.text;\r\n    `,\r\n    onInputTyping: `@\r\n        links.recipe.tags.droppedOn = that.text;\r\n    `\r\n}\r\n\r\nconst setCButton = {\r\n    ...menuOptions,\r\n    formAddress: 'edit',\r\n    label: '= element',\r\n    storyRecipe_menuSortOrder: 3,\r\n    onCreate: `@\r\n        masks.menuItemText = links.recipe.tags.result ?? '';\r\n    `,\r\n    onSubmit: `@\r\n        links.recipe.tags.result = that.text;\r\n    `,\r\n    onInputTyping: `@\r\n        links.recipe.tags.result = that.text;\r\n    `\r\n}\r\n\r\nconst fuzzButton = {\r\n    ...menuOptions,\r\n    formAddress: tags.fuzzy ? 'toggle_on' : 'toggle_off',\r\n    label: 'fuzzy',\r\n    storyRecipe_menuSortOrder: 4,\r\n    onClick: `@\r\n        links.recipe.tags.fuzzy = !links.recipe.tags.fuzzy ?? true;\r\n        if (links.recipe.tags.fuzzy) {\r\n            tags.formAddress = 'toggle_on';\r\n        } else {\r\n            tags.formAddress = 'toggle_off';\r\n        }\r\n    `\r\n}\r\n\r\nab.links.menu.abCreateMenuInput(setAButton); \r\nab.links.menu.abCreateMenuInput(setBButton);\r\nab.links.menu.abCreateMenuInput(setCButton); \r\nab.links.menu.abCreateMenuButton(fuzzButton);   ","abArtifactName":"storyRecipe","abIDOrigin":"storyRecipe","onBotAdded":"@let waitTime = 0;\r\n\r\nwhile(!globalThis.ab?.links.bot_factory) {\r\n    if (waitTime >= 5000) {\r\n        return;\r\n    }\r\n    \r\n    await os.sleep(250);\r\n    waitTime += 250;\r\n}\r\n\r\nmasks.ready = true;","onGridClick":"@shout(\"clearStoryRecipeMenu\");","strokeColor":"white","cursor":"pointer","labelWordWrapMode":"breakWords","labelPosition":"floatingBillboard","labelFontSize":"1","labelSize":"2","onSimPlaceSkyboxLoaded":"    tags.destination = that.tags.simID;\n    tags.label = that.tags.label;\n    tags.color = null;\n    tags.form = \"sphere\";\n    tags.formAddress = that.tags.formAddress;\n    tags.scaleX = 2;\n    tags.scaleY = 2;\n    tags.scaleZ = 2;\n    makeMiniSkybox();\n}","scaleX":"1","scaleZ":".2","storyRecipe":"true","scaleY":"1"}}}}